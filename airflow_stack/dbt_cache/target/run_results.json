{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-14T06:06:36.983702Z", "invocation_id": "00b0d066-da8e-4b1a-ab6e-cd97eb19a05c", "invocation_started_at": "2025-12-14T06:06:33.709544Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.022407Z", "completed_at": "2025-12-14T06:06:36.028751Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.029082Z", "completed_at": "2025-12-14T06:06:36.137226Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1159665584564209, "adapter_response": {"_message": "SELECT 9980", "code": "SELECT", "rows_affected": 9980}, "message": "SELECT 9980", "failures": null, "unique_id": "model.caspian_vault.stg_readings", "compiled": true, "compiled_code": "\n\nwith sgx as (\n    select\n        cast(well_id as bigint)            as well_id,\n        cast(survey_type_id as bigint)     as survey_type_id,\n        cast(depth_ft as double precision)           as depth_ft,\n        cast(amplitude as double precision)          as amplitude,\n        cast(quality_flag as int)          as quality_flag,\n        'sgx'                               as source_format,\n        cast(source_file as varchar)        as source_file\n    from \"airflow\".\"public\".\"raw_sgx_all\"\n),\np1 as (\n    -- If columns differ, adjust here after you inspect schema\n    select\n        cast(well_id as bigint)            as well_id,\n        cast(survey_type_id as bigint)     as survey_type_id,\n        cast(depth_ft as double precision)           as depth_ft,\n        cast(amplitude as double precision)          as amplitude,\n        cast(quality_flag as int)          as quality_flag,\n        'parquet_recovered'                as source_format,\n        'archive_batch_seismic_readings.parquet' as source_file\n    from \"airflow\".\"public\".\"raw_recovered_1\"\n),\np2 as (\n    select\n        cast(well_id as bigint)            as well_id,\n        cast(survey_type_id as bigint)     as survey_type_id,\n        cast(depth_ft as double precision)           as depth_ft,\n        cast(amplitude as double precision)          as amplitude,\n        cast(quality_flag as int)          as quality_flag,\n        'parquet_recovered'                as source_format,\n        'archive_batch_seismic_readings_2.parquet' as source_file\n    from \"airflow\".\"public\".\"raw_recovered_2\"\n),\n\nunioned as (\n    select * from sgx\n    union all\n    select * from p1\n    union all\n    select * from p2\n)\n\nselect\n    *,\n    current_timestamp as ingest_ts,\n    -- simple deterministic checksum (DuckDB supports md5)\n    md5(\n      cast(well_id as varchar) || '|' ||\n      cast(survey_type_id as varchar) || '|' ||\n      cast(depth_ft as varchar) || '|' ||\n      cast(amplitude as varchar) || '|' ||\n      cast(quality_flag as varchar) || '|' ||\n      source_file || '|' || source_format\n    ) as row_checksum\nfrom unioned", "relation_name": "\"airflow\".\"public\".\"stg_readings\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.143178Z", "completed_at": "2025-12-14T06:06:36.149849Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.150523Z", "completed_at": "2025-12-14T06:06:36.177873Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03861379623413086, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"airflow\".\"public\".\"stg_readings\"\n\nwhere not(survey_type_id is not null)\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.146655Z", "completed_at": "2025-12-14T06:06:36.150169Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.163363Z", "completed_at": "2025-12-14T06:06:36.178989Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038776397705078125, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"airflow\".\"public\".\"stg_readings\"\n\nwhere not(well_id is not null)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.191628Z", "completed_at": "2025-12-14T06:06:36.196989Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.203886Z", "completed_at": "2025-12-14T06:06:36.278766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09442996978759766, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.caspian_vault.dv_hub_survey_type", "compiled": true, "compiled_code": "\n\nselect distinct\n    md5(cast(survey_type_id as varchar)) as hk_survey_type,\n    survey_type_id             as survey_type_bk,\n    min(ingest_ts)             as load_ts,\n    min(source_file)     as record_source\nfrom \"airflow\".\"public\".\"stg_readings\"\nwhere survey_type_id is not null\ngroup by 1,2", "relation_name": "\"airflow\".\"public\".\"dv_hub_survey_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.193831Z", "completed_at": "2025-12-14T06:06:36.203526Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.207076Z", "completed_at": "2025-12-14T06:06:36.280124Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09542536735534668, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.caspian_vault.dv_hub_well", "compiled": true, "compiled_code": "\n\nselect distinct\n    md5(cast(well_id as varchar)) as hk_well,\n    well_id             as well_id_bk,\n    min(ingest_ts)      as load_ts,\n    min(source_file) as record_source\nfrom \"airflow\".\"public\".\"stg_readings\"\nwhere well_id is not null\ngroup by 1,2", "relation_name": "\"airflow\".\"public\".\"dv_hub_well\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.188382Z", "completed_at": "2025-12-14T06:06:36.196426Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.200820Z", "completed_at": "2025-12-14T06:06:36.299738Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11860394477844238, "adapter_response": {"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}, "message": "SELECT 50", "failures": null, "unique_id": "model.caspian_vault.dv_link_well_survey", "compiled": true, "compiled_code": "\n\nselect distinct\n    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,\n    md5(cast(well_id as varchar))                   as hk_well,\n    md5(cast(survey_type_id as varchar))            as hk_survey_type,\n    min(ingest_ts)                        as load_ts,\n    min(source_file)                as record_source\nfrom \"airflow\".\"public\".\"stg_readings\"\nwhere well_id is not null and survey_type_id is not null\ngroup by 1,2,3", "relation_name": "\"airflow\".\"public\".\"dv_link_well_survey\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.197281Z", "completed_at": "2025-12-14T06:06:36.206704Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.210090Z", "completed_at": "2025-12-14T06:06:36.300772Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1138918399810791, "adapter_response": {"_message": "SELECT 9980", "code": "SELECT", "rows_affected": 9980}, "message": "SELECT 9980", "failures": null, "unique_id": "model.caspian_vault.dv_sat_readings", "compiled": true, "compiled_code": "\n\nselect\n    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,\n    ingest_ts                               as load_ts,\n    source_file                             as record_source,\n    source_format,\n    row_checksum,\n    depth_ft,\n    amplitude,\n    quality_flag,\n    -- hashdiff over descriptive attributes\n    md5(\n      cast(depth_ft as varchar) || '|' ||\n      cast(amplitude as varchar) || '|' ||\n      cast(quality_flag as varchar) || '|' ||\n      source_format\n    ) as hashdiff\nfrom \"airflow\".\"public\".\"stg_readings\"\nwhere well_id is not null and survey_type_id is not null", "relation_name": "\"airflow\".\"public\".\"dv_sat_readings\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.291981Z", "completed_at": "2025-12-14T06:06:36.301029Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.305713Z", "completed_at": "2025-12-14T06:06:36.331869Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.043730735778808594, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hk_survey_type\nfrom \"airflow\".\"public\".\"dv_hub_survey_type\"\nwhere hk_survey_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.301398Z", "completed_at": "2025-12-14T06:06:36.307999Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.309805Z", "completed_at": "2025-12-14T06:06:36.335866Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04693770408630371, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect survey_type_bk\nfrom \"airflow\".\"public\".\"dv_hub_survey_type\"\nwhere survey_type_bk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.315406Z", "completed_at": "2025-12-14T06:06:36.321097Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.324682Z", "completed_at": "2025-12-14T06:06:36.347983Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04972553253173828, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    hk_survey_type as unique_field,\n    count(*) as n_records\n\nfrom \"airflow\".\"public\".\"dv_hub_survey_type\"\nwhere hk_survey_type is not null\ngroup by hk_survey_type\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.321904Z", "completed_at": "2025-12-14T06:06:36.327163Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.328630Z", "completed_at": "2025-12-14T06:06:36.359326Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.053076744079589844, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hk_well\nfrom \"airflow\".\"public\".\"dv_hub_well\"\nwhere hk_well is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.343177Z", "completed_at": "2025-12-14T06:06:36.354934Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.355265Z", "completed_at": "2025-12-14T06:06:36.383968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.052535295486450195, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect well_id_bk\nfrom \"airflow\".\"public\".\"dv_hub_well\"\nwhere well_id_bk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.349267Z", "completed_at": "2025-12-14T06:06:36.358202Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.360281Z", "completed_at": "2025-12-14T06:06:36.389935Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.056691884994506836, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    hk_well as unique_field,\n    count(*) as n_records\n\nfrom \"airflow\".\"public\".\"dv_hub_well\"\nwhere hk_well is not null\ngroup by hk_well\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.370153Z", "completed_at": "2025-12-14T06:06:36.376816Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.378402Z", "completed_at": "2025-12-14T06:06:36.414848Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05813455581665039, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hk_survey_type\nfrom \"airflow\".\"public\".\"dv_link_well_survey\"\nwhere hk_survey_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.384389Z", "completed_at": "2025-12-14T06:06:36.390761Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.391089Z", "completed_at": "2025-12-14T06:06:36.432068Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.052846431732177734, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hk_well\nfrom \"airflow\".\"public\".\"dv_link_well_survey\"\nwhere hk_well is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.400442Z", "completed_at": "2025-12-14T06:06:36.407074Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.408013Z", "completed_at": "2025-12-14T06:06:36.441036Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04777264595031738, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hk_well_survey\nfrom \"airflow\".\"public\".\"dv_link_well_survey\"\nwhere hk_well_survey is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.416129Z", "completed_at": "2025-12-14T06:06:36.423667Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.423989Z", "completed_at": "2025-12-14T06:06:36.453650Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04767131805419922, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select hk_survey_type as from_field\n    from \"airflow\".\"public\".\"dv_link_well_survey\"\n    where hk_survey_type is not null\n),\n\nparent as (\n    select hk_survey_type as to_field\n    from \"airflow\".\"public\".\"dv_hub_survey_type\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.435070Z", "completed_at": "2025-12-14T06:06:36.439486Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.442806Z", "completed_at": "2025-12-14T06:06:36.464668Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0359647274017334, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select hk_well as from_field\n    from \"airflow\".\"public\".\"dv_link_well_survey\"\n    where hk_well is not null\n),\n\nparent as (\n    select hk_well as to_field\n    from \"airflow\".\"public\".\"dv_hub_well\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.449346Z", "completed_at": "2025-12-14T06:06:36.454331Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.455736Z", "completed_at": "2025-12-14T06:06:36.482402Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04200601577758789, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    hk_well_survey as unique_field,\n    count(*) as n_records\n\nfrom \"airflow\".\"public\".\"dv_link_well_survey\"\nwhere hk_well_survey is not null\ngroup by hk_well_survey\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.459622Z", "completed_at": "2025-12-14T06:06:36.466955Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.467846Z", "completed_at": "2025-12-14T06:06:36.495590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.047679901123046875, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hk_well_survey\nfrom \"airflow\".\"public\".\"dv_sat_readings\"\nwhere hk_well_survey is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.472746Z", "completed_at": "2025-12-14T06:06:36.477426Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.478554Z", "completed_at": "2025-12-14T06:06:36.508443Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04522252082824707, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect load_ts\nfrom \"airflow\".\"public\".\"dv_sat_readings\"\nwhere load_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.485113Z", "completed_at": "2025-12-14T06:06:36.489555Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.490583Z", "completed_at": "2025-12-14T06:06:36.516387Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03859376907348633, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect row_checksum\nfrom \"airflow\".\"public\".\"dv_sat_readings\"\nwhere row_checksum is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.497683Z", "completed_at": "2025-12-14T06:06:36.502920Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.504078Z", "completed_at": "2025-12-14T06:06:36.529933Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04388260841369629, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select hk_well_survey as from_field\n    from \"airflow\".\"public\".\"dv_sat_readings\"\n    where hk_well_survey is not null\n),\n\nparent as (\n    select hk_well_survey as to_field\n    from \"airflow\".\"public\".\"dv_link_well_survey\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.512053Z", "completed_at": "2025-12-14T06:06:36.516918Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.517269Z", "completed_at": "2025-12-14T06:06:36.546146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0381016731262207, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.caspian_vault.test_counts_match", "compiled": true, "compiled_code": "-- test passes if returns 0 rows\n-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)\n\nwith src as (\n  select count(*) as n from \"airflow\".\"public\".\"stg_readings\"\n),\nsat as (\n  select count(*) as n from \"airflow\".\"public\".\"dv_sat_readings\"\n)\nselect\n  src.n as src_rows,\n  sat.n as sat_rows\nfrom src, sat\nwhere src.n > 0\n  and src.n != sat.n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.525895Z", "completed_at": "2025-12-14T06:06:36.531195Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.532547Z", "completed_at": "2025-12-14T06:06:36.613735Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0917813777923584, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.caspian_vault.dim_survey_type", "compiled": true, "compiled_code": "\n\nselect\n  hk_survey_type,\n  survey_type_bk as survey_type_id,\n  load_ts,\n  record_source\nfrom \"airflow\".\"public\".\"dv_hub_survey_type\"", "relation_name": "\"airflow\".\"public\".\"dim_survey_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.535611Z", "completed_at": "2025-12-14T06:06:36.538990Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.540259Z", "completed_at": "2025-12-14T06:06:36.611183Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08194231986999512, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.caspian_vault.dim_well", "compiled": true, "compiled_code": "\n\n-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords\n-- within a Caspian-ish bounding box so the map can still work for the demo.\nwith base as (\n  select\n    hk_well,\n    well_id_bk as well_id,\n    load_ts,\n    record_source\n  from \"airflow\".\"public\".\"dv_hub_well\"\n),\ngeo as (\n  select\n    *,\n    -- deterministic pseudo geo: map well_id -> lat/lon\n    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44\n47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54\n  from base\n)\nselect * from geo", "relation_name": "\"airflow\".\"public\".\"dim_well\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.557617Z", "completed_at": "2025-12-14T06:06:36.562971Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.564152Z", "completed_at": "2025-12-14T06:06:36.626736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08002972602844238, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.caspian_vault.dim_time", "compiled": true, "compiled_code": "\n\n-- Time dimension derived from load timestamps (ingest_ts / load_ts)\nwith t as (\n  select distinct cast(load_ts as timestamp) as ts\n  from \"airflow\".\"public\".\"dv_sat_readings\"\n)\nselect\n  ts,\n  date(ts) as d,\n  extract(year from ts) as year,\n  extract(month from ts) as month,\n  extract(day from ts) as day,\n  to_char(ts, 'YYYY-MM') as year_month,\n  to_char(ts, 'YYYY-MM-DD') as ymd,\n  extract(hour from ts) as hour\nfrom t", "relation_name": "\"airflow\".\"public\".\"dim_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.554166Z", "completed_at": "2025-12-14T06:06:36.556888Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.560048Z", "completed_at": "2025-12-14T06:06:36.636172Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08506035804748535, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.caspian_vault.dim_source_format", "compiled": true, "compiled_code": "\n\nselect distinct\n  source_format,\n  md5(source_format) as hk_source_format\nfrom \"airflow\".\"public\".\"dv_sat_readings\"", "relation_name": "\"airflow\".\"public\".\"dim_source_format\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.622573Z", "completed_at": "2025-12-14T06:06:36.627018Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.627790Z", "completed_at": "2025-12-14T06:06:36.674681Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05320453643798828, "adapter_response": {"_message": "SELECT 9980", "code": "SELECT", "rows_affected": 9980}, "message": "SELECT 9980", "failures": null, "unique_id": "model.caspian_vault.fct_readings", "compiled": true, "compiled_code": "\n\nwith sat as (\n  select\n    hk_well_survey,\n    load_ts,\n    record_source,\n    source_format,\n    row_checksum,\n    depth_ft,\n    amplitude,\n    quality_flag,\n    hashdiff\n  from \"airflow\".\"public\".\"dv_sat_readings\"\n),\nlnk as (\n  select\n    hk_well_survey,\n    hk_well,\n    hk_survey_type\n  from \"airflow\".\"public\".\"dv_link_well_survey\"\n)\nselect\n  sat.hk_well_survey,\n  lnk.hk_well,\n  lnk.hk_survey_type,\n  sat.load_ts,\n  sat.record_source,\n  sat.source_format,\n  sat.row_checksum,\n  sat.depth_ft,\n  sat.amplitude,\n  sat.quality_flag,\n  sat.hashdiff\nfrom sat\njoin lnk using (hk_well_survey)", "relation_name": "\"airflow\".\"public\".\"fct_readings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.681280Z", "completed_at": "2025-12-14T06:06:36.687925Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.688658Z", "completed_at": "2025-12-14T06:06:36.827007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15019917488098145, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.caspian_vault.mart_sensor_analysis", "compiled": true, "compiled_code": "\n\n-- treating survey_type as sensor type (only available categorical dimension)\nselect\n  hk_survey_type as hk_sensor_type,\n  count(*) as total_readings,\n  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,\n  avg(amplitude) as avg_amplitude\nfrom \"airflow\".\"public\".\"fct_readings\"\ngroup by 1", "relation_name": "\"airflow\".\"public\".\"mart_sensor_analysis\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.683596Z", "completed_at": "2025-12-14T06:06:36.688232Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.691682Z", "completed_at": "2025-12-14T06:06:36.828817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15160751342773438, "adapter_response": {"_message": "SELECT 6", "code": "SELECT", "rows_affected": 6}, "message": "SELECT 6", "failures": null, "unique_id": "model.caspian_vault.mart_survey_summary", "compiled": true, "compiled_code": "\n\nselect\n  hk_survey_type,\n  source_format,\n  count(distinct hk_well) as wells_surveyed,\n  count(*) as total_readings,\n  avg(amplitude) as avg_amplitude,\n  min(load_ts) as first_ingest_ts,\n  max(load_ts) as last_ingest_ts\nfrom \"airflow\".\"public\".\"fct_readings\"\ngroup by 1,2", "relation_name": "\"airflow\".\"public\".\"mart_survey_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.685627Z", "completed_at": "2025-12-14T06:06:36.691338Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.694357Z", "completed_at": "2025-12-14T06:06:36.830557Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15282058715820312, "adapter_response": {"_message": "SELECT 21", "code": "SELECT", "rows_affected": 21}, "message": "SELECT 21", "failures": null, "unique_id": "model.caspian_vault.mart_well_performance", "compiled": true, "compiled_code": "\n\nselect\n  hk_well,\n  source_format,\n  count(*) as total_readings,\n  avg(amplitude) as avg_amplitude,\n  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate\nfrom \"airflow\".\"public\".\"fct_readings\"\ngroup by 1,2", "relation_name": "\"airflow\".\"public\".\"mart_well_performance\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-14T06:06:36.835506Z", "completed_at": "2025-12-14T06:06:36.837744Z"}, {"name": "execute", "started_at": "2025-12-14T06:06:36.838091Z", "completed_at": "2025-12-14T06:06:36.972344Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13793540000915527, "adapter_response": {"_message": "INSERT 0 21", "code": "INSERT", "rows_affected": 21}, "message": "INSERT 0 21", "failures": null, "unique_id": "snapshot.caspian_vault.snap_mart_well_performance", "compiled": true, "compiled_code": "\n\n\nselect\n  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,\n  m.*,\n  cast(current_timestamp as timestamp) as load_ts\nfrom \"airflow\".\"public\".\"mart_well_performance\" m\n", "relation_name": "\"airflow\".\"snapshots\".\"snap_mart_well_performance\"", "batch_results": null}], "elapsed_time": 1.0758719444274902, "args": {"require_nested_cumulative_type_params": false, "export_saved_queries": false, "log_level": "info", "log_format": "default", "static_parser": true, "show": false, "which": "build", "select": [], "use_fast_test_edges": false, "use_colors_file": true, "project_dir": "/opt/project/caspian_vault", "require_resource_names_without_spaces": true, "log_file_max_bytes": 10485760, "show_all_deprecations": false, "defer": false, "favor_state": false, "invocation_command": "dbt build --profile caspian_vault --target dev", "require_yaml_configuration_for_mf_time_spines": false, "send_anonymous_usage_stats": true, "skip_nodes_if_on_run_start_fails": false, "vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "show_resource_report": false, "cache_selected_only": false, "macro_debugging": false, "target_path": "/opt/airflow/dbt_cache/target", "populate_cache": true, "state_modified_compare_more_unrendered_values": false, "upload_to_artifacts_ingest_api": false, "print": true, "source_freshness_run_project_hooks": true, "partial_parse_file_diff": true, "log_path": "/opt/airflow/dbt_cache/logs", "state_modified_compare_vars": false, "target": "dev", "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "profiles_dir": "/opt/airflow/dbt_profiles", "version_check": true, "profile": "caspian_vault", "require_all_warnings_handled_by_warn_error": false, "indirect_selection": "eager", "require_batched_execution_for_custom_microbatch_strategy": false, "require_generic_test_arguments_property": true, "use_colors": true, "resource_types": [], "log_level_file": "debug", "write_json": true, "include_saved_query": false, "exclude": [], "printer_width": 80, "empty": false, "introspect": true, "quiet": false, "strict_mode": false, "validate_macro_args": false, "log_format_file": "debug", "exclude_resource_types": []}}