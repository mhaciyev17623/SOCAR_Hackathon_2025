[0m20:22:23.677837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d689860860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d687d63e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d687bd9340>]}


============================== 20:22:23.684288 | 1bee74bd-8ceb-4406-b1c6-b9494d488039 ==============================
[0m20:22:23.684288 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:22:23.684939 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/logs/dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug --profile caspian_vault --target dev', 'empty': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/home/airflow/.dbt', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True'}
[0m20:22:23.694895 [info ] [MainThread]: dbt version: 1.10.15
[0m20:22:23.695346 [info ] [MainThread]: python version: 3.12.4
[0m20:22:23.695684 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:22:23.696000 [info ] [MainThread]: os info: Linux-6.14.0-1014-azure-x86_64-with-glibc2.36
[0m20:22:23.751043 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m20:22:23.751641 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m20:22:23.752030 [info ] [MainThread]: Using dbt_project.yml file at /opt/project/caspian_vault/dbt_project.yml
[0m20:22:23.752613 [info ] [MainThread]: adapter type: postgres
[0m20:22:23.752970 [info ] [MainThread]: adapter version: 1.9.0
[0m20:22:23.759765 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:22:23.760285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1bee74bd-8ceb-4406-b1c6-b9494d488039', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d686703bc0>]}
[0m20:22:23.760903 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:22:23.761353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1bee74bd-8ceb-4406-b1c6-b9494d488039', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d686703470>]}
[0m20:22:23.865037 [info ] [MainThread]: Configuration:
[0m20:22:23.865700 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:22:23.866108 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:22:23.866501 [info ] [MainThread]: Required dependencies:
[0m20:22:23.866884 [debug] [MainThread]: Executing "git --help"
[0m20:22:23.869331 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:22:23.869828 [debug] [MainThread]: STDERR: "b''"
[0m20:22:23.870188 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:22:23.870578 [info ] [MainThread]: Connection:
[0m20:22:23.870936 [info ] [MainThread]:   host: postgres
[0m20:22:23.871267 [info ] [MainThread]:   port: 5432
[0m20:22:23.871603 [info ] [MainThread]:   user: airflow
[0m20:22:23.871930 [info ] [MainThread]:   database: airflow
[0m20:22:23.872259 [info ] [MainThread]:   schema: public
[0m20:22:23.872573 [info ] [MainThread]:   connect_timeout: 10
[0m20:22:23.872893 [info ] [MainThread]:   role: None
[0m20:22:23.873212 [info ] [MainThread]:   search_path: None
[0m20:22:23.873548 [info ] [MainThread]:   keepalives_idle: 0
[0m20:22:23.873875 [info ] [MainThread]:   sslmode: None
[0m20:22:23.874197 [info ] [MainThread]:   sslcert: None
[0m20:22:23.874533 [info ] [MainThread]:   sslkey: None
[0m20:22:23.874845 [info ] [MainThread]:   sslrootcert: None
[0m20:22:23.875159 [info ] [MainThread]:   application_name: dbt
[0m20:22:23.875490 [info ] [MainThread]:   retries: 1
[0m20:22:23.876012 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:22:23.994803 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:22:24.024885 [debug] [MainThread]: Using postgres connection "debug"
[0m20:22:24.025452 [debug] [MainThread]: On debug: select 1 as id
[0m20:22:24.025817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:24.032644 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m20:22:24.033916 [debug] [MainThread]: On debug: Close
[0m20:22:24.034382 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:22:24.034793 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:22:24.035471 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:22:24.036652 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4019029, "process_in_blocks": "0", "process_kernel_time": 0.28136, "process_mem_max_rss": "118300", "process_out_blocks": "32", "process_user_time": 1.678183}
[0m20:22:24.037238 [debug] [MainThread]: Command `dbt debug` succeeded at 20:22:24.037133 after 0.40 seconds
[0m20:22:24.037634 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:22:24.038029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d686f08230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d6880b0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d687b6b980>]}
[0m20:22:24.038483 [debug] [MainThread]: Flushing usage events
[0m20:22:24.462403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:38.594267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517b6063c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517c520740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517a560da0>]}


============================== 20:22:38.599146 | c3cf38a9-b142-4be8-92d8-5ed298fc5596 ==============================
[0m20:22:38.599146 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:22:38.599630 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/logs/dbt', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'empty': 'None', 'no_print': 'None'}
[0m20:22:38.605853 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:22:38.606223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3cf38a9-b142-4be8-92d8-5ed298fc5596', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51798da240>]}
[0m20:22:38.606627 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:22:38.606931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3cf38a9-b142-4be8-92d8-5ed298fc5596', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51798da240>]}
[0m20:22:38.708990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3cf38a9-b142-4be8-92d8-5ed298fc5596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517983d2b0>]}
[0m20:22:38.728155 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kegui2d8'
[0m20:22:38.728558 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:22:38.975562 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:22:38.976260 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:22:38.986518 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:22:38.989617 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:22:39.211990 [info ] [MainThread]: Installed from version 1.3.0
[0m20:22:39.212434 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:22:39.212753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c3cf38a9-b142-4be8-92d8-5ed298fc5596', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51798da030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517976e150>]}
[0m20:22:39.213082 [info ] [MainThread]: 
[0m20:22:39.213472 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:22:39.214121 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:22:39.214964 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6630466, "process_in_blocks": "0", "process_kernel_time": 0.198766, "process_mem_max_rss": "108168", "process_out_blocks": "2296", "process_user_time": 1.337428}
[0m20:22:39.215412 [debug] [MainThread]: Command `dbt deps` succeeded at 20:22:39.215335 after 0.66 seconds
[0m20:22:39.215709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517a9669c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51797237d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51798da030>]}
[0m20:22:39.216002 [debug] [MainThread]: Flushing usage events
[0m20:22:39.704480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:41.201644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f5782ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f660c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f61440e0>]}


============================== 20:22:41.206657 | 0c14737e-a60f-4bfb-9a58-7a665e693d56 ==============================
[0m20:22:41.206657 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:22:41.207101 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': '/opt/airflow/dbt_target', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'printer_width': '80', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'empty': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/logs/dbt'}
[0m20:22:41.251120 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:22:41.251604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f3ee6b40>]}
[0m20:22:41.252049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:22:41.252406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f415e870>]}
[0m20:22:41.370819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f33373e0>]}
[0m20:22:41.428634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f4d76780>]}
[0m20:22:41.429461 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:22:41.541681 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:22:41.667287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:41.667712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:41.672989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:22:41.723833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f33f0d40>]}
[0m20:22:41.821976 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:22:41.823645 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:22:41.852301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f2bb0d10>]}
[0m20:22:41.852761 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:22:41.856330 [info ] [MainThread]: 
[0m20:22:41.856693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:41.856977 [info ] [MainThread]: 
[0m20:22:41.857458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:41.861689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:22:41.868554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:22:41.897228 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:22:41.897595 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:22:41.897935 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:22:41.898238 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:22:41.898551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:41.898832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:41.903810 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m20:22:41.904112 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m20:22:41.905138 [debug] [ThreadPool]: On list_airflow: Close
[0m20:22:41.906117 [debug] [ThreadPool]: On list_airflow: Close
[0m20:22:41.908123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:22:41.908584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:22:41.912973 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:22:41.914300 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:22:41.914620 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:22:41.914907 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:22:41.915180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:41.915460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:41.919319 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:22:41.919625 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:22:41.919931 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:22:41.920220 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:22:41.920536 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:22:41.920843 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:22:41.923110 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:22:41.923388 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:22:41.924366 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:22:41.925946 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:22:41.926348 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:22:41.926604 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:22:41.936241 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:41.936586 [debug] [MainThread]: On master: BEGIN
[0m20:22:41.936858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:41.940473 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:22:41.940807 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:41.941133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:41.963436 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:22:41.964595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0802540>]}
[0m20:22:41.965027 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:41.965443 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:41.965729 [debug] [MainThread]: On master: BEGIN
[0m20:22:41.966145 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:22:41.966473 [debug] [MainThread]: On master: COMMIT
[0m20:22:41.966737 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:41.966981 [debug] [MainThread]: On master: COMMIT
[0m20:22:41.967316 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:41.967597 [debug] [MainThread]: On master: Close
[0m20:22:41.971223 [debug] [Thread-1 (]: Began running node model.caspian_vault.raw_recovered_1
[0m20:22:41.971597 [debug] [Thread-2 (]: Began running node model.caspian_vault.raw_recovered_2
[0m20:22:41.971998 [debug] [Thread-3 (]: Began running node model.caspian_vault.raw_sgx_all
[0m20:22:41.972442 [info ] [Thread-1 (]: 1 of 36 START sql view model public.raw_recovered_1 ............................ [RUN]
[0m20:22:41.972920 [info ] [Thread-2 (]: 2 of 36 START sql view model public.raw_recovered_2 ............................ [RUN]
[0m20:22:41.973355 [info ] [Thread-3 (]: 3 of 36 START sql view model public.raw_sgx_all ................................ [RUN]
[0m20:22:41.973748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.raw_recovered_1)
[0m20:22:41.974102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.raw_recovered_2)
[0m20:22:41.974531 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.caspian_vault.raw_sgx_all'
[0m20:22:41.974867 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.raw_recovered_1
[0m20:22:41.975184 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.raw_recovered_2
[0m20:22:41.975507 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.raw_sgx_all
[0m20:22:41.980600 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_1"
[0m20:22:41.982481 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_2"
[0m20:22:41.985178 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.raw_sgx_all"
[0m20:22:41.985920 [debug] [Thread-1 (]: Began executing node model.caspian_vault.raw_recovered_1
[0m20:22:41.991454 [debug] [Thread-2 (]: Began executing node model.caspian_vault.raw_recovered_2
[0m20:22:42.012398 [debug] [Thread-3 (]: Began executing node model.caspian_vault.raw_sgx_all
[0m20:22:42.012111 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_1"
[0m20:22:42.015288 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_2"
[0m20:22:42.017955 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.raw_sgx_all"
[0m20:22:42.018711 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:22:42.019062 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: BEGIN
[0m20:22:42.019444 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:22:42.019774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.020131 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:22:42.020465 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: BEGIN
[0m20:22:42.020902 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: BEGIN
[0m20:22:42.021257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.021577 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:22:42.024878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.025256 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:22:42.025643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:22:42.026012 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */

  create view "airflow"."public"."raw_recovered_1__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:22:42.026388 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:22:42.026708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.027104 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */

  create view "airflow"."public"."raw_recovered_2__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:22:42.027458 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:22:42.027847 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */

  create view "airflow"."public"."raw_sgx_all__dbt_tmp"
    
    
  as (
    

-- TEMP: SGX source not available yet.
-- Keeps downstream models working by providing correct schema with no rows.
select
  cast(null as bigint) as well_id,
  cast(null as bigint) as survey_type_id,
  cast(null as double precision) as depth_ft,
  cast(null as double precision) as amplitude,
  cast(null as int) as quality_flag,
  cast(null as varchar) as source_file
where 1=0
  );
[0m20:22:42.028150 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:22:42.032921 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:22:42.033260 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:22:42.033554 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:22:42.033884 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1" rename to "raw_recovered_1__dbt_backup"
[0m20:22:42.036141 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:22:42.038445 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:22:42.038848 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2" rename to "raw_recovered_2__dbt_backup"
[0m20:22:42.039192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.039511 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all" rename to "raw_sgx_all__dbt_backup"
[0m20:22:42.041619 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:22:42.041945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.042329 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1__dbt_tmp" rename to "raw_recovered_1"
[0m20:22:42.043418 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.096778 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:22:42.099206 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:22:42.099575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.099933 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2__dbt_tmp" rename to "raw_recovered_2"
[0m20:22:42.100288 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all__dbt_tmp" rename to "raw_sgx_all"
[0m20:22:42.112616 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:22:42.112998 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.113382 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:22:42.114443 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:22:42.114763 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.115102 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:22:42.115450 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:22:42.116459 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:22:42.116885 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:22:42.117217 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:22:42.117603 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:22:42.118355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:22:42.123121 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."raw_recovered_1__dbt_backup"
[0m20:22:42.123475 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m20:22:42.123822 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m20:22:42.127917 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:22:42.129664 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."raw_sgx_all__dbt_backup"
[0m20:22:42.131331 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."raw_recovered_2__dbt_backup"
[0m20:22:42.131752 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
drop view if exists "airflow"."public"."raw_recovered_1__dbt_backup" cascade
[0m20:22:42.132241 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:22:42.132723 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:22:42.133101 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
drop view if exists "airflow"."public"."raw_sgx_all__dbt_backup" cascade
[0m20:22:42.133442 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
drop view if exists "airflow"."public"."raw_recovered_2__dbt_backup" cascade
[0m20:22:42.134867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:22:42.136714 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: Close
[0m20:22:42.137046 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:22:42.137350 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:22:42.138405 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: Close
[0m20:22:42.140365 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: Close
[0m20:22:42.140682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f6b4f260>]}
[0m20:22:42.141211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f07217f0>]}
[0m20:22:42.142207 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0721910>]}
[0m20:22:42.141808 [info ] [Thread-1 (]: 1 of 36 OK created sql view model public.raw_recovered_1 ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:22:42.142687 [info ] [Thread-2 (]: 2 of 36 OK created sql view model public.raw_recovered_2 ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:22:42.143285 [info ] [Thread-3 (]: 3 of 36 OK created sql view model public.raw_sgx_all ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:22:42.143974 [debug] [Thread-1 (]: Finished running node model.caspian_vault.raw_recovered_1
[0m20:22:42.144435 [debug] [Thread-2 (]: Finished running node model.caspian_vault.raw_recovered_2
[0m20:22:42.144890 [debug] [Thread-3 (]: Finished running node model.caspian_vault.raw_sgx_all
[0m20:22:42.145709 [debug] [Thread-4 (]: Began running node model.caspian_vault.stg_readings
[0m20:22:42.146286 [info ] [Thread-4 (]: 4 of 36 START sql table model public.stg_readings .............................. [RUN]
[0m20:22:42.146716 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.caspian_vault.stg_readings'
[0m20:22:42.147013 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:22:42.149853 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:22:42.150362 [debug] [Thread-4 (]: Began executing node model.caspian_vault.stg_readings
[0m20:22:42.166549 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:22:42.167123 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:22:42.167447 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:22:42.167725 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:22:42.171417 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:22:42.171759 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:22:42.172100 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:22:42.179138 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:22:42.184097 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:22:42.184442 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m20:22:42.184925 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.188121 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:22:42.188472 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m20:22:42.188917 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.189888 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:22:42.190205 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:22:42.190506 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:22:42.193210 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:42.194890 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m20:22:42.197364 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:22:42.197699 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m20:22:42.200333 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:22:42.201355 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: Close
[0m20:22:42.201842 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0791f10>]}
[0m20:22:42.202362 [info ] [Thread-4 (]: 4 of 36 OK created sql table model public.stg_readings ......................... [[32mSELECT 0[0m in 0.06s]
[0m20:22:42.202815 [debug] [Thread-4 (]: Finished running node model.caspian_vault.stg_readings
[0m20:22:42.203551 [debug] [Thread-2 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:22:42.203909 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:22:42.204316 [info ] [Thread-2 (]: 5 of 36 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m20:22:42.204702 [info ] [Thread-3 (]: 6 of 36 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m20:22:42.205089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_2, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969)
[0m20:22:42.205461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_sgx_all, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd)
[0m20:22:42.205795 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:22:42.206119 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:22:42.216053 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:22:42.219323 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:22:42.219890 [debug] [Thread-2 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:22:42.220242 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:22:42.233092 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:22:42.234697 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:22:42.235334 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:22:42.235718 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:22:42.236030 [debug] [Thread-2 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m20:22:42.236367 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m20:22:42.236685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.236993 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.241220 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.241577 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.241926 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:22:42.242280 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:22:42.242617 [debug] [Thread-2 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:22:42.242964 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:22:42.243836 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.244139 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.246641 [debug] [Thread-2 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m20:22:42.247752 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m20:22:42.248197 [debug] [Thread-2 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m20:22:42.248523 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m20:22:42.249075 [info ] [Thread-2 (]: 5 of 36 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m20:22:42.249467 [info ] [Thread-3 (]: 6 of 36 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m20:22:42.250050 [debug] [Thread-2 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:22:42.250495 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:22:42.251274 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:22:42.251632 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:22:42.252305 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:22:42.252037 [info ] [Thread-4 (]: 7 of 36 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m20:22:42.252728 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:22:42.253146 [info ] [Thread-1 (]: 8 of 36 START sql table model public.dv_hub_well ............................... [RUN]
[0m20:22:42.253592 [info ] [Thread-2 (]: 9 of 36 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m20:22:42.253968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m20:22:42.254387 [info ] [Thread-3 (]: 10 of 36 START sql table model public.dv_sat_readings .......................... [RUN]
[0m20:22:42.254771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_1, now model.caspian_vault.dv_hub_well)
[0m20:22:42.255111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m20:22:42.255455 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m20:22:42.255799 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m20:22:42.256133 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m20:22:42.256466 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m20:22:42.259349 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.259711 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m20:22:42.261866 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m20:22:42.266193 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.268538 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m20:22:42.269024 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m20:22:42.269419 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_well
[0m20:22:42.272235 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.272665 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m20:22:42.275278 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m20:22:42.275619 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m20:22:42.278341 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m20:22:42.278897 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.281530 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.282022 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:22:42.282374 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m20:22:42.282885 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m20:22:42.283260 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:22:42.283649 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.283952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.284286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.284606 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m20:22:42.284924 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m20:22:42.285462 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.285781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.289010 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.289439 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.289792 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m20:22:42.290114 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.290462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.290882 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:22:42.291209 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.291575 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:22:42.291926 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m20:22:42.292286 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.292625 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m20:22:42.293030 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m20:22:42.296395 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:22:42.298867 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.299190 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m20:22:42.299696 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.300003 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:22:42.300330 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:22:42.300647 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:22:42.302667 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.305000 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:22:42.308177 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:22:42.310487 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.310841 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m20:22:42.311188 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m20:22:42.311556 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m20:22:42.311902 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m20:22:42.312458 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.312804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.313160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.314151 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:22:42.314492 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.316594 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:22:42.318651 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:22:42.319001 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.321107 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.321473 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m20:22:42.321815 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m20:22:42.322147 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:22:42.322499 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m20:22:42.323021 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.323358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.323662 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.324644 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:22:42.325619 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:22:42.325938 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:42.326911 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:22:42.327285 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:22:42.327619 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:22:42.329316 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m20:22:42.329681 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.330001 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:22:42.330326 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:22:42.330788 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:22:42.331118 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:22:42.331566 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m20:22:42.332821 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:22:42.334524 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m20:22:42.334839 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:42.335137 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.335484 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:22:42.335919 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:22:42.337586 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m20:22:42.338642 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m20:22:42.340299 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m20:22:42.340643 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m20:22:42.342082 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:22:42.342620 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:22:42.343059 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0663050>]}
[0m20:22:42.343494 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m20:22:42.343835 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m20:22:42.344364 [info ] [Thread-4 (]: 7 of 36 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 0[0m in 0.09s]
[0m20:22:42.345014 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:22:42.345410 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:22:42.345955 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:22:42.346933 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m20:22:42.347238 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:22:42.347590 [info ] [Thread-4 (]: 11 of 36 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m20:22:42.347977 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.348384 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0662cc0>]}
[0m20:22:42.349358 [debug] [Thread-2 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m20:22:42.349709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m20:22:42.350692 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: Close
[0m20:22:42.351164 [info ] [Thread-3 (]: 10 of 36 OK created sql table model public.dv_sat_readings ..................... [[32mSELECT 0[0m in 0.09s]
[0m20:22:42.351597 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:22:42.351961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f06625a0>]}
[0m20:22:42.352470 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:22:42.352824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0661f40>]}
[0m20:22:42.357707 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:22:42.358243 [info ] [Thread-2 (]: 9 of 36 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 0[0m in 0.10s]
[0m20:22:42.358684 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:22:42.359223 [info ] [Thread-1 (]: 8 of 36 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 0[0m in 0.10s]
[0m20:22:42.359920 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:22:42.360315 [info ] [Thread-3 (]: 12 of 36 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m20:22:42.360649 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:22:42.361107 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:22:42.361468 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:22:42.361875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m20:22:42.363607 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:22:42.363984 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:22:42.364345 [info ] [Thread-2 (]: 13 of 36 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m20:22:42.364716 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:22:42.365280 [info ] [Thread-1 (]: 14 of 36 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m20:22:42.365668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m20:22:42.368499 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:22:42.368893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m20:22:42.369280 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:22:42.369610 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:22:42.370024 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:22:42.370396 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m20:22:42.370732 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:22:42.375010 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:22:42.377671 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:22:42.378020 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.379653 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:22:42.380410 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:22:42.380752 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:22:42.382413 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:22:42.384011 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:22:42.384382 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:22:42.384952 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:22:42.385421 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m20:22:42.385799 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:22:42.386181 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:22:42.386502 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:22:42.386827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.387153 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m20:22:42.387487 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m20:22:42.387811 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.388232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.388554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.389448 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.390642 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m20:22:42.391060 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m20:22:42.391883 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.391601 [info ] [Thread-4 (]: 11 of 36 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m20:22:42.392413 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:22:42.392742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:22:42.393117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.393575 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:22:42.393911 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.394268 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:22:42.394607 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:22:42.394970 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:22:42.395426 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.395781 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:22:42.396102 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.396447 [info ] [Thread-4 (]: 15 of 36 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m20:22:42.397681 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m20:22:42.398059 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.398399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m20:22:42.398707 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:22:42.399831 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m20:22:42.400148 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m20:22:42.400493 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:22:42.401540 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m20:22:42.404479 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:22:42.404803 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m20:22:42.405263 [info ] [Thread-3 (]: 12 of 36 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.04s]
[0m20:22:42.405799 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m20:22:42.407983 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:22:42.407597 [info ] [Thread-1 (]: 14 of 36 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m20:22:42.408453 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:22:42.408835 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:22:42.409236 [info ] [Thread-2 (]: 13 of 36 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m20:22:42.409784 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:22:42.411312 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:22:42.411676 [info ] [Thread-3 (]: 16 of 36 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m20:22:42.412148 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:22:42.412512 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m20:22:42.412964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m20:22:42.413379 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:22:42.413819 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:22:42.414164 [info ] [Thread-1 (]: 17 of 36 START test test_counts_match .......................................... [RUN]
[0m20:22:42.414578 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:22:42.414935 [info ] [Thread-2 (]: 18 of 36 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m20:22:42.415305 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m20:22:42.415644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m20:22:42.418352 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:22:42.418726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m20:22:42.419059 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.419402 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m20:22:42.419804 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:22:42.420263 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:22:42.422417 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m20:22:42.425169 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:22:42.426771 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:22:42.427116 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m20:22:42.427783 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m20:22:42.428177 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:22:42.428537 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:22:42.430035 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m20:22:42.430383 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:22:42.430739 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.432291 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:22:42.432733 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m20:22:42.433116 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:22:42.433573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.433940 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m20:22:42.434225 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.434562 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:22:42.434998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.436130 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m20:22:42.436508 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m20:22:42.436988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.437282 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m20:22:42.437906 [info ] [Thread-4 (]: 15 of 36 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m20:22:42.438492 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:22:42.438813 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.439195 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:22:42.439596 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:22:42.439937 [info ] [Thread-4 (]: 19 of 36 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m20:22:42.440339 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.440669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.441079 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m20:22:42.441429 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:22:42.441834 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:22:42.442162 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:22:42.442517 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.442814 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:22:42.443155 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m20:22:42.446033 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:22:42.447160 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m20:22:42.447533 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.448129 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:22:42.448483 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m20:22:42.450010 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:22:42.450350 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:22:42.450692 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:42.451153 [info ] [Thread-3 (]: 16 of 36 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m20:22:42.452324 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m20:22:42.452745 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:22:42.453805 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m20:22:42.454286 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:22:42.454665 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m20:22:42.455022 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m20:22:42.455359 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m20:22:42.455692 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:22:42.456057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.456580 [info ] [Thread-2 (]: 18 of 36 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m20:22:42.456982 [info ] [Thread-1 (]: 17 of 36 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m20:22:42.457264 [info ] [Thread-3 (]: 20 of 36 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m20:22:42.458058 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:22:42.458533 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:22:42.458904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m20:22:42.459313 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:22:42.459718 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:22:42.460182 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:22:42.460535 [info ] [Thread-2 (]: 21 of 36 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m20:22:42.460904 [info ] [Thread-1 (]: 22 of 36 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m20:22:42.465024 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:22:42.465406 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m20:22:42.465766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m20:22:42.466127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m20:22:42.466573 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:22:42.466930 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:22:42.467232 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:22:42.467586 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:22:42.467919 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.473860 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:22:42.475436 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:22:42.479233 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:22:42.480007 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:22:42.480381 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:22:42.480714 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.481023 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:22:42.482678 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:22:42.483034 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m20:22:42.484146 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m20:22:42.485697 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:22:42.486137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.486597 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:22:42.487167 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m20:22:42.487558 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:22:42.487915 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m20:22:42.488321 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m20:22:42.488745 [info ] [Thread-4 (]: 19 of 36 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.05s]
[0m20:22:42.489121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.489452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.489882 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:22:42.490472 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:22:42.490855 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.491259 [info ] [Thread-4 (]: 23 of 36 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m20:22:42.491654 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:22:42.492015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m20:22:42.492371 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.492708 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:22:42.495418 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:22:42.495802 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:42.497062 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m20:22:42.497423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:22:42.497788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m20:22:42.498186 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:22:42.498565 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m20:22:42.498880 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:22:42.499223 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:22:42.500829 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:22:42.501283 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.501765 [info ] [Thread-3 (]: 20 of 36 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m20:22:42.502151 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.502802 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:22:42.503228 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:22:42.503621 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:22:42.503923 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.504259 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.504633 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m20:22:42.504959 [info ] [Thread-3 (]: 24 of 36 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m20:22:42.506062 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m20:22:42.507134 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m20:22:42.507500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.507851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m20:22:42.508292 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m20:22:42.508674 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m20:22:42.509004 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:22:42.509544 [info ] [Thread-1 (]: 22 of 36 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m20:22:42.512518 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:22:42.512969 [info ] [Thread-2 (]: 21 of 36 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.05s]
[0m20:22:42.513546 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:22:42.513914 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.514472 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:22:42.514888 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:22:42.515195 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:22:42.515607 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:22:42.515981 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:22:42.516351 [info ] [Thread-1 (]: 25 of 36 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m20:22:42.519211 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:22:42.519624 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:22:42.520006 [info ] [Thread-2 (]: 26 of 36 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m20:22:42.520390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m20:22:42.520925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m20:22:42.521313 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:22:42.521642 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:22:42.521937 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.522282 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:22:42.522599 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m20:22:42.525239 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:22:42.526403 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m20:22:42.530381 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:22:42.530741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.531298 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m20:22:42.531820 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:22:42.532199 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:22:42.532730 [info ] [Thread-4 (]: 23 of 36 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m20:22:42.534283 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:22:42.535824 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:22:42.536343 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:22:42.536663 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.537294 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:22:42.537764 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:22:42.538110 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:22:42.538541 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:22:42.538876 [info ] [Thread-4 (]: 27 of 36 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m20:22:42.539230 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m20:22:42.539575 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m20:22:42.539908 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.540279 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m20:22:42.540595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.540901 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.541271 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:22:42.541770 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.544474 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:22:42.545656 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m20:22:42.546082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.546478 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.546924 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:22:42.547257 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:22:42.547556 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m20:22:42.547898 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:22:42.549553 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:22:42.549910 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.550324 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:22:42.550762 [info ] [Thread-3 (]: 24 of 36 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m20:22:42.551427 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:22:42.551768 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.552180 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:22:42.552496 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:42.552830 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m20:22:42.553906 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m20:22:42.554296 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:22:42.555400 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m20:22:42.555733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.556182 [info ] [Thread-3 (]: 28 of 36 START sql table model public.dim_survey_type .......................... [RUN]
[0m20:22:42.556520 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m20:22:42.557021 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m20:22:42.557357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now model.caspian_vault.dim_survey_type)
[0m20:22:42.557907 [info ] [Thread-1 (]: 25 of 36 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m20:22:42.558417 [info ] [Thread-2 (]: 26 of 36 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m20:22:42.558753 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m20:22:42.559234 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:22:42.559722 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:22:42.561819 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m20:22:42.562273 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_source_format
[0m20:22:42.562645 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:22:42.563026 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_time
[0m20:22:42.563540 [info ] [Thread-1 (]: 29 of 36 START sql table model public.dim_source_format ........................ [RUN]
[0m20:22:42.563937 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:22:42.564396 [info ] [Thread-2 (]: 30 of 36 START sql table model public.dim_time ................................. [RUN]
[0m20:22:42.564782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now model.caspian_vault.dim_source_format)
[0m20:22:42.565095 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m20:22:42.565468 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:22:42.565825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_time)
[0m20:22:42.566149 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_source_format
[0m20:22:42.568918 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m20:22:42.569355 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_time
[0m20:22:42.572459 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m20:22:42.572811 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:22:42.574899 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m20:22:42.576193 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m20:22:42.576576 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:22:42.576957 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_source_format
[0m20:22:42.577426 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m20:22:42.577782 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m20:22:42.580329 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m20:22:42.580664 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_time
[0m20:22:42.581010 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.581588 [info ] [Thread-4 (]: 27 of 36 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m20:22:42.584327 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m20:22:42.584717 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:22:42.585298 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:22:42.585742 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m20:22:42.586156 [debug] [Thread-4 (]: Began running node model.caspian_vault.fct_readings
[0m20:22:42.586507 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:22:42.586977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.587385 [info ] [Thread-4 (]: 31 of 36 START sql table model public.fct_readings ............................. [RUN]
[0m20:22:42.587744 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: BEGIN
[0m20:22:42.588201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now model.caspian_vault.fct_readings)
[0m20:22:42.588589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.588921 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m20:22:42.589280 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.fct_readings
[0m20:22:42.589714 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:22:42.591956 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m20:22:42.592364 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m20:22:42.592695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.593228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.593563 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:22:42.593917 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:22:42.594277 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m20:22:42.594592 [debug] [Thread-4 (]: Began executing node model.caspian_vault.fct_readings
[0m20:22:42.594944 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m20:22:42.597660 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m20:22:42.598037 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:42.600589 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:22:42.600957 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m20:22:42.601330 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:22:42.601760 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:22:42.602090 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: BEGIN
[0m20:22:42.602396 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.604703 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:22:42.605099 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:22:42.605444 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.607500 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:22:42.607850 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m20:22:42.610964 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:22:42.611447 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m20:22:42.611851 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:22:42.612207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.614321 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:22:42.614647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.615015 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m20:22:42.615361 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:22:42.616371 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:22:42.616692 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m20:22:42.618802 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:22:42.619174 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:22:42.619506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.619854 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:22:42.620196 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:22:42.620541 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:22:42.621598 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:22:42.621957 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m20:22:42.622435 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:22:42.622745 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.623102 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:22:42.624067 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:22:42.624406 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:42.624785 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:22:42.626455 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m20:22:42.626786 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:42.627111 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:22:42.627414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:42.627882 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:22:42.630204 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:22:42.631962 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m20:22:42.632318 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:42.632612 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m20:22:42.632943 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m20:22:42.633426 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:22:42.635024 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m20:22:42.635467 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m20:22:42.635809 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.636241 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:22:42.638346 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:22:42.638715 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.639011 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m20:22:42.639322 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.639650 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m20:22:42.640655 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m20:22:42.641699 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: Close
[0m20:22:42.642286 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f3ee4aa0>]}
[0m20:22:42.642667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f07f1d90>]}
[0m20:22:42.642999 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.643366 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:22:42.643902 [info ] [Thread-3 (]: 28 of 36 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 0[0m in 0.08s]
[0m20:22:42.644426 [info ] [Thread-1 (]: 29 of 36 OK created sql table model public.dim_source_format ................... [[32mSELECT 0[0m in 0.08s]
[0m20:22:42.645491 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:22:42.646534 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: Close
[0m20:22:42.646997 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:22:42.647440 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:22:42.647770 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:22:42.648184 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_well
[0m20:22:42.648573 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f2329520>]}
[0m20:22:42.649062 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:22:42.649488 [info ] [Thread-3 (]: 32 of 36 START sql table model public.dim_well ................................. [RUN]
[0m20:22:42.649992 [info ] [Thread-2 (]: 30 of 36 OK created sql table model public.dim_time ............................ [[32mSELECT 0[0m in 0.08s]
[0m20:22:42.650455 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.dim_well)
[0m20:22:42.650898 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_time
[0m20:22:42.651217 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_well
[0m20:22:42.653635 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m20:22:42.653973 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m20:22:42.656830 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m20:22:42.657336 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:22:42.657675 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m20:22:42.658048 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_well
[0m20:22:42.660608 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m20:22:42.660932 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.662018 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: Close
[0m20:22:42.662483 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f05a97f0>]}
[0m20:22:42.662824 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:22:42.663312 [info ] [Thread-4 (]: 31 of 36 OK created sql table model public.fct_readings ........................ [[32mSELECT 0[0m in 0.07s]
[0m20:22:42.663676 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: BEGIN
[0m20:22:42.664104 [debug] [Thread-4 (]: Finished running node model.caspian_vault.fct_readings
[0m20:22:42.664422 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.664994 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:22:42.665405 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:22:42.665774 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:22:42.666168 [info ] [Thread-1 (]: 33 of 36 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m20:22:42.666627 [info ] [Thread-2 (]: 34 of 36 START sql table model public.mart_survey_summary ...................... [RUN]
[0m20:22:42.667073 [info ] [Thread-4 (]: 35 of 36 START sql table model public.mart_well_performance .................... [RUN]
[0m20:22:42.667481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_sensor_analysis)
[0m20:22:42.667829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m20:22:42.668171 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now model.caspian_vault.mart_well_performance)
[0m20:22:42.668507 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m20:22:42.668862 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m20:22:42.669196 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m20:22:42.669518 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.671596 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.673652 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m20:22:42.675611 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m20:22:42.675970 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:22:42.676643 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m20:22:42.676959 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m20:22:42.677337 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m20:22:42.679958 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.680324 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_well_performance
[0m20:22:42.682944 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m20:22:42.685688 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m20:22:42.686116 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.686712 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:22:42.687067 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m20:22:42.687378 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:42.687724 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m20:22:42.688046 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:22:42.688377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:42.690749 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:22:42.691083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:22:42.691419 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m20:22:42.691858 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m20:22:42.692333 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:22:42.692953 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.695808 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:22:42.696321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:22:42.696657 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m20:22:42.696984 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:22:42.697340 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:22:42.697683 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.698073 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:22:42.698425 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:22:42.698720 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.699057 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m20:22:42.699415 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:22:42.699753 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:22:42.700772 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:22:42.701282 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:22:42.701571 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:22:42.703557 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:42.705199 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m20:22:42.705534 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:42.706058 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:22:42.708363 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.708706 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.008 seconds
[0m20:22:42.709056 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.008 seconds
[0m20:22:42.709416 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m20:22:42.709780 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m20:22:42.712059 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:22:42.714382 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:22:42.714850 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m20:22:42.715172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.715515 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m20:22:42.717648 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.718011 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.718348 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:22:42.718706 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:42.719029 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m20:22:42.720042 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: Close
[0m20:22:42.722051 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:22:42.724107 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:22:42.724600 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m20:22:42.725071 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f3f4b980>]}
[0m20:22:42.725461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.725778 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m20:22:42.726367 [info ] [Thread-3 (]: 32 of 36 OK created sql table model public.dim_well ............................ [[32mSELECT 0[0m in 0.07s]
[0m20:22:42.727445 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:22:42.727763 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:42.728294 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_well
[0m20:22:42.728621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:42.728972 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.729968 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:22:42.731071 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:22:42.731424 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:22:42.731759 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:22:42.732084 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:22:42.732468 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:22:42.732776 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:22:42.733998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:42.735742 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m20:22:42.736069 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:42.736406 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:42.736887 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:22:42.739433 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m20:22:42.741037 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m20:22:42.741406 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m20:22:42.741868 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:22:42.742344 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:22:42.742724 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m20:22:42.743054 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m20:22:42.744929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:22:42.745940 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m20:22:42.746242 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.746566 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:42.747592 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: Close
[0m20:22:42.747994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0587740>]}
[0m20:22:42.749008 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: Close
[0m20:22:42.749514 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f05870b0>]}
[0m20:22:42.749989 [info ] [Thread-1 (]: 33 of 36 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 0[0m in 0.08s]
[0m20:22:42.751048 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f0586840>]}
[0m20:22:42.750626 [info ] [Thread-4 (]: 35 of 36 OK created sql table model public.mart_well_performance ............... [[32mSELECT 0[0m in 0.08s]
[0m20:22:42.751604 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:22:42.752062 [info ] [Thread-2 (]: 34 of 36 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 0[0m in 0.08s]
[0m20:22:42.752565 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:22:42.753102 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:22:42.753658 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:42.754165 [info ] [Thread-3 (]: 36 of 36 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m20:22:42.754553 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:22:42.754859 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:42.757331 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:42.792568 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.792965 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:22:42.793278 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:22:42.797478 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:22:42.797815 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.798126 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:22:42.803300 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:22:42.834040 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.834501 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp202242833341"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:22:42.836667 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.002 seconds
[0m20:22:42.838807 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.839137 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp202242833341'
        
      order by ordinal_position

  
[0m20:22:42.841436 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:22:42.843631 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.843968 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:22:42.845771 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:22:42.847949 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.848298 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp202242833341'
        
      order by ordinal_position

  
[0m20:22:42.850082 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:22:42.853443 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.853787 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:22:42.855566 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:22:42.860371 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.860722 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp202242833341'
        
      order by ordinal_position

  
[0m20:22:42.862513 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:22:42.875433 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.875856 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:22:42.876593 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:22:42.880482 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.880825 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:22:42.881327 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:22:42.881749 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.882268 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.882625 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp202242833341" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp202242833341" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:22:42.883374 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:22:42.884342 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:22:42.884656 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:42.884937 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:22:42.886983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:42.888979 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:22:42.889513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c14737e-a60f-4bfb-9a58-7a665e693d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f047bb90>]}
[0m20:22:42.890151 [info ] [Thread-3 (]: 36 of 36 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 0[0m in 0.13s]
[0m20:22:42.890655 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:42.891999 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:42.892341 [debug] [MainThread]: On master: BEGIN
[0m20:22:42.892617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:42.896682 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:22:42.897009 [debug] [MainThread]: On master: COMMIT
[0m20:22:42.897316 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:42.897582 [debug] [MainThread]: On master: COMMIT
[0m20:22:42.897922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:42.898211 [debug] [MainThread]: On master: Close
[0m20:22:42.898618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:42.898890 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m20:22:42.899131 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m20:22:42.899382 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:22:42.899615 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m20:22:42.899973 [info ] [MainThread]: 
[0m20:22:42.900290 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests, 3 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m20:22:42.904154 [debug] [MainThread]: Command end result
[0m20:22:42.929812 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:22:42.931352 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:22:42.937345 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:22:42.937688 [info ] [MainThread]: 
[0m20:22:42.938025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:42.938340 [info ] [MainThread]: 
[0m20:22:42.938638 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=36
[0m20:22:42.939158 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:22:42.940742 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7814555, "process_in_blocks": "0", "process_kernel_time": 0.370436, "process_mem_max_rss": "135460", "process_out_blocks": "3744", "process_user_time": 2.698464}
[0m20:22:42.941206 [debug] [MainThread]: Command `dbt build` succeeded at 20:22:42.941125 after 1.78 seconds
[0m20:22:42.941573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f41c69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f2f40ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626f06a9e20>]}
[0m20:22:42.941906 [debug] [MainThread]: Flushing usage events
[0m20:22:43.466499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:45.025035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fcdc98650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fccd59400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fcdb48bc0>]}


============================== 20:22:45.030016 | 67b0528f-615e-4c61-beb2-7174aebef8c9 ==============================
[0m20:22:45.030016 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:22:45.030474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'target_path': '/opt/airflow/dbt_target', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/logs/dbt', 'introspect': 'True'}
[0m20:22:45.074607 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:22:45.075066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fca71b200>]}
[0m20:22:45.075534 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:22:45.075866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fca71b200>]}
[0m20:22:45.194985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fca731a30>]}
[0m20:22:45.252924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fcc3d9df0>]}
[0m20:22:45.253726 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:22:45.366026 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:22:45.490795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:45.491210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:45.496426 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:22:45.546941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fca34e300>]}
[0m20:22:45.644180 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:22:45.645826 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:22:45.663939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fc932b8f0>]}
[0m20:22:45.664404 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:22:45.664742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fcbcd86e0>]}
[0m20:22:45.666691 [info ] [MainThread]: 
[0m20:22:45.667050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:45.667366 [info ] [MainThread]: 
[0m20:22:45.667827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:45.668661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:22:45.701056 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:22:45.701431 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:22:45.701712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:45.706946 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m20:22:45.707971 [debug] [ThreadPool]: On list_airflow: Close
[0m20:22:45.712286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:22:45.712830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m20:22:45.717098 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:22:45.719221 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:22:45.719562 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:22:45.719855 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:22:45.720140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:45.720489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:45.724207 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:22:45.724568 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:22:45.724861 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:22:45.725167 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m20:22:45.725514 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:22:45.725789 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:22:45.727428 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:22:45.728392 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:22:45.728675 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.003 seconds
[0m20:22:45.730196 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:22:45.730481 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:22:45.730864 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:22:45.740489 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:45.740816 [debug] [MainThread]: On master: BEGIN
[0m20:22:45.741089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:45.744731 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:22:45.745046 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:45.745395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:45.767834 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:22:45.769098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fca328dd0>]}
[0m20:22:45.769548 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:45.769962 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:45.770268 [debug] [MainThread]: On master: BEGIN
[0m20:22:45.770707 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:22:45.771009 [debug] [MainThread]: On master: COMMIT
[0m20:22:45.771297 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:45.771565 [debug] [MainThread]: On master: COMMIT
[0m20:22:45.771908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:45.772186 [debug] [MainThread]: On master: Close
[0m20:22:45.775671 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:45.776124 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m20:22:45.776504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:22:45.776801 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:45.782308 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:45.819983 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.820390 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:22:45.820696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.824776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:22:45.825123 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.825442 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:22:45.830562 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:22:45.869180 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.869673 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp202245863773"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:22:45.871856 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m20:22:45.874869 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.875209 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp202245863773'
        
      order by ordinal_position

  
[0m20:22:45.877561 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:22:45.879801 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.880135 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:22:45.882007 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m20:22:45.884190 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.884538 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp202245863773'
        
      order by ordinal_position

  
[0m20:22:45.886397 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:22:45.888624 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.888955 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:22:45.890775 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m20:22:45.895500 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.895845 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp202245863773'
        
      order by ordinal_position

  
[0m20:22:45.897726 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:22:45.910577 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.910996 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:22:45.911725 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:22:45.915557 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.915898 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:22:45.916410 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:22:45.916835 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.917359 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.917706 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp202245863773" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp202245863773" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:22:45.918473 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:22:45.928808 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:22:45.929170 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:22:45.929478 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:22:45.932831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:45.935612 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:22:45.936951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b0528f-615e-4c61-beb2-7174aebef8c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fcdbc2f90>]}
[0m20:22:45.937625 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 0[0m in 0.16s]
[0m20:22:45.938115 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:22:45.939417 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:45.939743 [debug] [MainThread]: On master: BEGIN
[0m20:22:45.940017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:45.943958 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:22:45.944293 [debug] [MainThread]: On master: COMMIT
[0m20:22:45.944571 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:45.944823 [debug] [MainThread]: On master: COMMIT
[0m20:22:45.945153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:45.945458 [debug] [MainThread]: On master: Close
[0m20:22:45.945836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:45.946105 [debug] [MainThread]: Connection 'list_airflow_snapshots' was properly closed.
[0m20:22:45.946374 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:22:45.946654 [info ] [MainThread]: 
[0m20:22:45.946949 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m20:22:45.947514 [debug] [MainThread]: Command end result
[0m20:22:46.025476 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:22:46.027117 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:22:46.032098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:22:46.032448 [info ] [MainThread]: 
[0m20:22:46.032820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:46.033100 [info ] [MainThread]: 
[0m20:22:46.033422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:22:46.033907 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:22:46.034776 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0521773, "process_in_blocks": "0", "process_kernel_time": 0.298103, "process_mem_max_rss": "128996", "process_out_blocks": "2800", "process_user_time": 2.001695}
[0m20:22:46.035236 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:22:46.035155 after 1.05 seconds
[0m20:22:46.035612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fc97b3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fc97b3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fc9711e80>]}
[0m20:22:46.035945 [debug] [MainThread]: Flushing usage events
[0m20:22:46.437955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:58.573929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce646c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce5f93680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce5f91610>]}


============================== 20:23:58.578703 | cb4c006d-3a81-4b45-b853-b9cb2031b2e4 ==============================
[0m20:23:58.578703 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:23:58.579135 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None', 'log_path': '/opt/airflow/logs/dbt', 'printer_width': '80', 'invocation_command': 'dbt ls --resource-type source', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'profiles_dir': '/home/airflow/.dbt', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'None'}
[0m20:23:58.622920 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:23:58.623407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb4c006d-3a81-4b45-b853-b9cb2031b2e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce4b13440>]}
[0m20:23:58.623840 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:23:58.624151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb4c006d-3a81-4b45-b853-b9cb2031b2e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce50c32f0>]}
[0m20:23:58.742610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb4c006d-3a81-4b45-b853-b9cb2031b2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce6599ca0>]}
[0m20:23:58.800191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb4c006d-3a81-4b45-b853-b9cb2031b2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce54c09b0>]}
[0m20:23:58.800979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:23:58.901605 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in /opt/airflow/dbt_packages. Run "dbt deps" to install package dependencies.
[0m20:23:58.902309 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:23:58.903189 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.37117127, "process_in_blocks": "0", "process_kernel_time": 0.260436, "process_mem_max_rss": "112340", "process_out_blocks": "16", "process_user_time": 1.423918}
[0m20:23:58.903679 [debug] [MainThread]: Command `dbt ls` failed at 20:23:58.903587 after 0.37 seconds
[0m20:23:58.904016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce51cc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce652dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ce4718a40>]}
[0m20:23:58.904353 [debug] [MainThread]: Flushing usage events
[0m20:23:59.351477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:24.016331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921ddc41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921e001ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921c668bf0>]}


============================== 20:35:24.021146 | a35f3d21-b445-4752-9619-423c0c6525b2 ==============================
[0m20:35:24.021146 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:35:24.021587 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/logs/dbt', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'None', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m20:35:24.027787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:35:24.028135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a35f3d21-b445-4752-9619-423c0c6525b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921b3c5880>]}
[0m20:35:24.028534 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:35:24.028815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a35f3d21-b445-4752-9619-423c0c6525b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921b3c5880>]}
[0m20:35:24.130735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a35f3d21-b445-4752-9619-423c0c6525b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921b4c2ae0>]}
[0m20:35:24.142866 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l4c3kqeu'
[0m20:35:24.143182 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:35:24.228414 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:35:24.229020 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:35:24.239747 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:35:24.242798 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:35:24.485473 [info ] [MainThread]: Installed from version 1.3.0
[0m20:35:24.485891 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:35:24.486260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a35f3d21-b445-4752-9619-423c0c6525b2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921b09e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921af4ae40>]}
[0m20:35:24.486575 [info ] [MainThread]: 
[0m20:35:24.486835 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:35:24.487492 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:35:24.488309 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5137073, "process_in_blocks": "0", "process_kernel_time": 0.205582, "process_mem_max_rss": "107888", "process_out_blocks": "2304", "process_user_time": 1.3293}
[0m20:35:24.488721 [debug] [MainThread]: Command `dbt deps` succeeded at 20:35:24.488645 after 0.51 seconds
[0m20:35:24.488993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921bf775f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921b31ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c921af133b0>]}
[0m20:35:24.489340 [debug] [MainThread]: Flushing usage events
[0m20:35:24.936282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:35.564785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d673f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d7f04ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d68dd1c0>]}


============================== 20:35:35.569658 | 77c72390-74c6-469d-8d4f-595f37fb5371 ==============================
[0m20:35:35.569658 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:35:35.570097 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profile caspian_vault --target dev --no-partial-parse', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/home/airflow/.dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/opt/airflow/logs/dbt', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m20:35:35.614364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:35:35.614812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d4b371d0>]}
[0m20:35:35.615264 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:35:35.615579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d535efc0>]}
[0m20:35:35.735762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d4b360c0>]}
[0m20:35:35.794122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d4743f20>]}
[0m20:35:35.794924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:35:35.907520 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:35:35.908140 [debug] [MainThread]: Partial parsing not enabled
[0m20:35:37.305576 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:35:37.306080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d33f26c0>]}
[0m20:35:37.513666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:35:37.522398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d1eb0650>]}
[0m20:35:37.689538 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:35:37.691166 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:35:37.720281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d1c49730>]}
[0m20:35:37.720733 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:35:37.724387 [info ] [MainThread]: 
[0m20:35:37.724747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:37.725038 [info ] [MainThread]: 
[0m20:35:37.725493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:37.729668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:35:37.730266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:35:37.763919 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:35:37.764306 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:35:37.764619 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:35:37.764917 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:35:37.765192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:37.765468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:37.770874 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.006 seconds
[0m20:35:37.771163 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.006 seconds
[0m20:35:37.772183 [debug] [ThreadPool]: On list_airflow: Close
[0m20:35:37.773147 [debug] [ThreadPool]: On list_airflow: Close
[0m20:35:37.775118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:35:37.775596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:35:37.780055 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:35:37.781401 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:35:37.781704 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:35:37.781982 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:35:37.782238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:37.782506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:37.786198 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:35:37.786533 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:35:37.786782 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:35:37.787080 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:35:37.787378 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:35:37.787710 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:37.789586 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:35:37.789862 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:35:37.790811 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:35:37.792285 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:35:37.792654 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:35:37.792911 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:35:37.802810 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:37.803110 [debug] [MainThread]: On master: BEGIN
[0m20:35:37.803375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:37.806970 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:35:37.807280 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:37.807592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:37.829843 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:35:37.831014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d1f4bdd0>]}
[0m20:35:37.831444 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:37.831831 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:37.832095 [debug] [MainThread]: On master: BEGIN
[0m20:35:37.832515 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:35:37.832793 [debug] [MainThread]: On master: COMMIT
[0m20:35:37.833050 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:37.833298 [debug] [MainThread]: On master: COMMIT
[0m20:35:37.833621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:37.833884 [debug] [MainThread]: On master: Close
[0m20:35:37.837511 [debug] [Thread-1 (]: Began running node model.caspian_vault.raw_recovered_1
[0m20:35:37.837859 [debug] [Thread-2 (]: Began running node model.caspian_vault.raw_recovered_2
[0m20:35:37.838231 [debug] [Thread-3 (]: Began running node model.caspian_vault.raw_sgx_all
[0m20:35:37.838659 [info ] [Thread-1 (]: 1 of 36 START sql view model public.raw_recovered_1 ............................ [RUN]
[0m20:35:37.839120 [info ] [Thread-2 (]: 2 of 36 START sql view model public.raw_recovered_2 ............................ [RUN]
[0m20:35:37.839574 [info ] [Thread-3 (]: 3 of 36 START sql view model public.raw_sgx_all ................................ [RUN]
[0m20:35:37.839993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.raw_recovered_1)
[0m20:35:37.840434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.raw_recovered_2)
[0m20:35:37.840833 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.caspian_vault.raw_sgx_all'
[0m20:35:37.841155 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.raw_recovered_1
[0m20:35:37.841489 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.raw_recovered_2
[0m20:35:37.841790 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.raw_sgx_all
[0m20:35:37.846831 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_1"
[0m20:35:37.848687 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_2"
[0m20:35:37.850561 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.raw_sgx_all"
[0m20:35:37.851453 [debug] [Thread-2 (]: Began executing node model.caspian_vault.raw_recovered_2
[0m20:35:37.851759 [debug] [Thread-1 (]: Began executing node model.caspian_vault.raw_recovered_1
[0m20:35:37.878411 [debug] [Thread-3 (]: Began executing node model.caspian_vault.raw_sgx_all
[0m20:35:37.883085 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_1"
[0m20:35:37.883521 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_2"
[0m20:35:37.886068 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.raw_sgx_all"
[0m20:35:37.886989 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:35:37.887331 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:35:37.887660 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: BEGIN
[0m20:35:37.888019 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:35:37.888316 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: BEGIN
[0m20:35:37.888610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:37.888907 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: BEGIN
[0m20:35:37.889195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:37.889608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:37.893416 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:37.893735 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:37.894100 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:35:37.894418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:37.894740 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:35:37.895062 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */

  create view "airflow"."public"."raw_recovered_2__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:35:37.895392 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:35:37.895713 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */

  create view "airflow"."public"."raw_sgx_all__dbt_tmp"
    
    
  as (
    

-- TEMP: SGX source not available yet.
-- Keeps downstream models working by providing correct schema with no rows.
select
  cast(null as bigint) as well_id,
  cast(null as bigint) as survey_type_id,
  cast(null as double precision) as depth_ft,
  cast(null as double precision) as amplitude,
  cast(null as int) as quality_flag,
  cast(null as varchar) as source_file
where 1=0
  );
[0m20:35:37.896104 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */

  create view "airflow"."public"."raw_recovered_1__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:35:37.896990 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:35:37.897281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:35:37.902029 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:35:37.902349 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:35:37.904597 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:35:37.904942 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2" rename to "raw_recovered_2__dbt_backup"
[0m20:35:37.907192 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:35:37.907552 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1" rename to "raw_recovered_1__dbt_backup"
[0m20:35:37.907916 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all" rename to "raw_sgx_all__dbt_backup"
[0m20:35:37.908209 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:37.910352 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:35:37.910704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:35:37.910987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:35:37.911284 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2__dbt_tmp" rename to "raw_recovered_2"
[0m20:35:37.913407 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:35:37.916162 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:35:37.916568 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all__dbt_tmp" rename to "raw_sgx_all"
[0m20:35:37.916899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:37.917186 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1__dbt_tmp" rename to "raw_recovered_1"
[0m20:35:37.928979 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:35:37.929317 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m20:35:37.929689 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:35:37.930008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:37.930945 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:35:37.931270 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:35:37.932204 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:35:37.932545 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:35:37.932895 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:35:37.933193 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:35:37.933496 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:35:37.935300 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:37.939871 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."raw_recovered_2__dbt_backup"
[0m20:35:37.940191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m20:35:37.940526 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m20:35:37.944693 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:35:37.946392 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."raw_recovered_1__dbt_backup"
[0m20:35:37.948031 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."raw_sgx_all__dbt_backup"
[0m20:35:37.948384 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
drop table if exists "airflow"."public"."raw_recovered_2__dbt_backup" cascade
[0m20:35:37.948856 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:35:37.949304 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:35:37.949662 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
drop table if exists "airflow"."public"."raw_recovered_1__dbt_backup" cascade
[0m20:35:37.949969 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
drop table if exists "airflow"."public"."raw_sgx_all__dbt_backup" cascade
[0m20:35:37.951803 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:37.953722 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: Close
[0m20:35:37.954026 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:35:37.954314 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:35:37.955337 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: Close
[0m20:35:37.957182 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: Close
[0m20:35:37.957820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d33f1fa0>]}
[0m20:35:37.958219 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0a64680>]}
[0m20:35:37.958523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d1e5b260>]}
[0m20:35:37.959014 [info ] [Thread-2 (]: 2 of 36 OK created sql view model public.raw_recovered_2 ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:35:37.959527 [info ] [Thread-3 (]: 3 of 36 OK created sql view model public.raw_sgx_all ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:35:37.960037 [info ] [Thread-1 (]: 1 of 36 OK created sql view model public.raw_recovered_1 ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:35:37.960549 [debug] [Thread-2 (]: Finished running node model.caspian_vault.raw_recovered_2
[0m20:35:37.960967 [debug] [Thread-3 (]: Finished running node model.caspian_vault.raw_sgx_all
[0m20:35:37.961389 [debug] [Thread-1 (]: Finished running node model.caspian_vault.raw_recovered_1
[0m20:35:37.962152 [debug] [Thread-4 (]: Began running node model.caspian_vault.stg_readings
[0m20:35:37.962752 [info ] [Thread-4 (]: 4 of 36 START sql table model public.stg_readings .............................. [RUN]
[0m20:35:37.963184 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.caspian_vault.stg_readings'
[0m20:35:37.963485 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:35:37.966268 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:35:37.966770 [debug] [Thread-4 (]: Began executing node model.caspian_vault.stg_readings
[0m20:35:37.982731 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:35:37.983314 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:35:37.983604 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:35:37.983861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:35:37.987886 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:35:37.988194 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:35:37.988545 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:35:37.993637 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:35:37.998493 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:35:37.998809 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m20:35:37.999301 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.001327 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:35:38.001626 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m20:35:38.002038 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.004008 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:35:38.004340 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:35:38.004613 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:35:38.006566 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.008175 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m20:35:38.008600 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:35:38.008873 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m20:35:38.012230 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:35:38.013195 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: Close
[0m20:35:38.013673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0150aa0>]}
[0m20:35:38.014134 [info ] [Thread-4 (]: 4 of 36 OK created sql table model public.stg_readings ......................... [[32mSELECT 0[0m in 0.05s]
[0m20:35:38.014599 [debug] [Thread-4 (]: Finished running node model.caspian_vault.stg_readings
[0m20:35:38.015304 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:35:38.015639 [debug] [Thread-1 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:35:38.016011 [info ] [Thread-3 (]: 5 of 36 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m20:35:38.016418 [info ] [Thread-1 (]: 6 of 36 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m20:35:38.016816 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_sgx_all, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969)
[0m20:35:38.017158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_1, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd)
[0m20:35:38.017493 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:35:38.017795 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:35:38.020855 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:35:38.023585 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:35:38.024195 [debug] [Thread-1 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:35:38.024517 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:35:38.047619 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:35:38.048014 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:35:38.048671 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:35:38.048990 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m20:35:38.049317 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:35:38.049624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.049925 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m20:35:38.050337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.053926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:35:38.054297 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:35:38.054598 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:35:38.054901 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.055279 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:35:38.055577 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:35:38.055862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.058372 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m20:35:38.058683 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:35:38.059764 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m20:35:38.060053 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m20:35:38.060464 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m20:35:38.060906 [info ] [Thread-1 (]: 6 of 36 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m20:35:38.061491 [debug] [Thread-1 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:35:38.061876 [info ] [Thread-3 (]: 5 of 36 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.05s]
[0m20:35:38.062504 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:35:38.063072 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:35:38.063443 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:35:38.064098 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:35:38.063835 [info ] [Thread-4 (]: 7 of 36 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m20:35:38.064509 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:35:38.064892 [info ] [Thread-2 (]: 8 of 36 START sql table model public.dv_hub_well ............................... [RUN]
[0m20:35:38.065325 [info ] [Thread-1 (]: 9 of 36 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m20:35:38.065701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m20:35:38.066104 [info ] [Thread-3 (]: 10 of 36 START sql table model public.dv_sat_readings .......................... [RUN]
[0m20:35:38.066479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_2, now model.caspian_vault.dv_hub_well)
[0m20:35:38.066805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m20:35:38.067122 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m20:35:38.067464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m20:35:38.067789 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m20:35:38.068093 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m20:35:38.070608 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.070950 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m20:35:38.073052 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m20:35:38.075590 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.078974 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m20:35:38.079408 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m20:35:38.079974 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m20:35:38.080274 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m20:35:38.082873 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.085469 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m20:35:38.085776 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m20:35:38.088344 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.091160 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m20:35:38.091526 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.091868 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:35:38.092455 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m20:35:38.092772 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.093096 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:35:38.093416 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m20:35:38.093710 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.094013 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m20:35:38.094326 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m20:35:38.094614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.095012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.095325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.098809 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.099214 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.099529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.099903 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m20:35:38.100212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.100532 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.100858 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:35:38.101260 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.101593 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:35:38.101933 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m20:35:38.102278 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m20:35:38.102626 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m20:35:38.109348 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.008 seconds
[0m20:35:38.111958 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.112284 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m20:35:38.112759 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.113047 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:35:38.113405 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:35:38.115383 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.115678 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m20:35:38.117914 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:35:38.120208 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:35:38.120561 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m20:35:38.123564 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.123897 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m20:35:38.124222 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m20:35:38.124615 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m20:35:38.124937 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.125396 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.126340 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:35:38.126641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:38.128684 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:35:38.128980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:35:38.129312 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.131352 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:35:38.131701 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m20:35:38.133787 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.134126 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:35:38.134462 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m20:35:38.134850 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m20:35:38.135160 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.136363 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:35:38.136653 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:38.136971 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:35:38.137259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:35:38.138197 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:35:38.138530 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:35:38.138799 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:35:38.139768 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:35:38.140094 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:35:38.141836 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m20:35:38.142185 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.142483 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.142785 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:35:38.143216 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:35:38.143539 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:35:38.145182 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m20:35:38.145564 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m20:35:38.146101 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:35:38.146488 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m20:35:38.147190 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.148820 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m20:35:38.149101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:35:38.149458 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:35:38.149850 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:35:38.150132 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:35:38.151774 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m20:35:38.152821 [debug] [Thread-4 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m20:35:38.153127 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m20:35:38.154089 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m20:35:38.154535 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:35:38.155059 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0101fa0>]}
[0m20:35:38.155449 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m20:35:38.155821 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0a61310>]}
[0m20:35:38.156343 [info ] [Thread-4 (]: 7 of 36 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 0[0m in 0.09s]
[0m20:35:38.157200 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.156917 [info ] [Thread-3 (]: 10 of 36 OK created sql table model public.dv_sat_readings ..................... [[32mSELECT 0[0m in 0.09s]
[0m20:35:38.157806 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:35:38.158794 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m20:35:38.159230 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:35:38.159683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:35:38.160232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0a61430>]}
[0m20:35:38.160573 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:35:38.160882 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:35:38.161915 [debug] [Thread-1 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m20:35:38.162462 [info ] [Thread-2 (]: 8 of 36 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 0[0m in 0.09s]
[0m20:35:38.162833 [info ] [Thread-4 (]: 11 of 36 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m20:35:38.163199 [info ] [Thread-3 (]: 12 of 36 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m20:35:38.163800 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:35:38.164173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0102810>]}
[0m20:35:38.164539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m20:35:38.164888 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m20:35:38.165241 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:35:38.165857 [info ] [Thread-1 (]: 9 of 36 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 0[0m in 0.10s]
[0m20:35:38.166233 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:35:38.166564 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:35:38.166876 [info ] [Thread-2 (]: 13 of 36 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m20:35:38.167342 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:35:38.173363 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:35:38.175995 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:35:38.176373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m20:35:38.176721 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:35:38.177410 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:35:38.177805 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:35:38.178129 [info ] [Thread-1 (]: 14 of 36 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m20:35:38.178468 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:35:38.182648 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:35:38.184214 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:35:38.184581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m20:35:38.186133 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:35:38.186699 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:35:38.186996 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:35:38.187356 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:35:38.188921 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:35:38.191584 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:35:38.191997 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:35:38.192304 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m20:35:38.192798 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m20:35:38.193186 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:35:38.193489 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.193847 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:35:38.194142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.194465 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m20:35:38.196170 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:35:38.196616 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.197156 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:35:38.197469 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m20:35:38.197735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.198645 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.198954 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:35:38.199237 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.199778 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.200080 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.200429 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:35:38.201615 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m20:35:38.201931 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.202319 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.202637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.203019 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:35:38.203333 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m20:35:38.203707 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:35:38.204037 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:35:38.204358 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.204715 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.205140 [info ] [Thread-4 (]: 11 of 36 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m20:35:38.206342 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m20:35:38.206688 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.207185 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:35:38.207536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.208610 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m20:35:38.208938 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m20:35:38.209287 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:35:38.210365 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m20:35:38.210797 [info ] [Thread-4 (]: 15 of 36 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m20:35:38.211647 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m20:35:38.211342 [info ] [Thread-3 (]: 12 of 36 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.05s]
[0m20:35:38.212081 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m20:35:38.212405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m20:35:38.212922 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:35:38.213326 [info ] [Thread-2 (]: 13 of 36 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m20:35:38.213753 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:35:38.214185 [info ] [Thread-1 (]: 14 of 36 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.03s]
[0m20:35:38.214630 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:35:38.215099 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:35:38.218012 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:35:38.218499 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:35:38.218831 [info ] [Thread-3 (]: 16 of 36 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m20:35:38.219215 [debug] [Thread-2 (]: Began running node test.caspian_vault.test_counts_match
[0m20:35:38.219742 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:35:38.220108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m20:35:38.220731 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:35:38.220480 [info ] [Thread-2 (]: 17 of 36 START test test_counts_match .......................................... [RUN]
[0m20:35:38.221125 [info ] [Thread-1 (]: 18 of 36 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m20:35:38.221474 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:35:38.223041 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:35:38.223395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.test_counts_match)
[0m20:35:38.223736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m20:35:38.227507 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:35:38.227939 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.test_counts_match
[0m20:35:38.228276 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:35:38.228708 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:35:38.230825 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m20:35:38.231193 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:35:38.233799 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:35:38.234134 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m20:35:38.235719 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:35:38.236228 [debug] [Thread-2 (]: Began executing node test.caspian_vault.test_counts_match
[0m20:35:38.236538 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.236884 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:35:38.238469 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m20:35:38.238878 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:35:38.240566 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:35:38.241006 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m20:35:38.241532 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:35:38.241820 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.242149 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m20:35:38.242460 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:35:38.242901 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.243187 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:35:38.243542 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m20:35:38.243950 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:35:38.244241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.244581 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.245511 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.246628 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m20:35:38.247124 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m20:35:38.247475 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.247824 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.248623 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:35:38.248325 [info ] [Thread-4 (]: 15 of 36 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m20:35:38.249009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.249354 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:35:38.249675 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.250119 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:35:38.250444 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:35:38.250769 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m20:35:38.251179 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:35:38.251546 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:35:38.251845 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.252225 [info ] [Thread-4 (]: 19 of 36 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m20:35:38.253339 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m20:35:38.253720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:35:38.254058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m20:35:38.254379 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.255480 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m20:35:38.255781 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m20:35:38.256090 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:35:38.257122 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m20:35:38.257547 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: Close
[0m20:35:38.260339 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:35:38.260780 [info ] [Thread-3 (]: 16 of 36 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m20:35:38.261374 [info ] [Thread-2 (]: 17 of 36 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m20:35:38.261687 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m20:35:38.262191 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:35:38.262623 [debug] [Thread-2 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:35:38.262978 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:35:38.263355 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:35:38.263733 [info ] [Thread-1 (]: 18 of 36 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m20:35:38.264223 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:35:38.265946 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:35:38.266331 [info ] [Thread-3 (]: 20 of 36 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m20:35:38.266802 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:35:38.267111 [info ] [Thread-2 (]: 21 of 36 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m20:35:38.267577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m20:35:38.267984 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:35:38.268319 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:35:38.268669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m20:35:38.268976 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:35:38.269290 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m20:35:38.269603 [info ] [Thread-1 (]: 22 of 36 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m20:35:38.269947 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:35:38.272678 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:35:38.273023 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.273383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m20:35:38.277156 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:35:38.277758 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:35:38.278040 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:35:38.279660 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:35:38.280048 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:35:38.282604 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:35:38.284324 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:35:38.284665 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m20:35:38.285240 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:35:38.285676 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:35:38.285968 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:35:38.286325 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:35:38.286631 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m20:35:38.286944 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.288438 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:35:38.288761 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m20:35:38.289056 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.289505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.289861 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:35:38.290243 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:35:38.291511 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m20:35:38.291846 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m20:35:38.292193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.292563 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m20:35:38.293054 [info ] [Thread-4 (]: 19 of 36 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m20:35:38.293567 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:35:38.293852 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.294217 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:35:38.294621 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:35:38.294959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.295312 [info ] [Thread-4 (]: 23 of 36 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m20:35:38.295687 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:35:38.296073 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:35:38.296382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:35:38.296708 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m20:35:38.297091 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.297425 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:35:38.297709 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.298012 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:35:38.298376 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.299485 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m20:35:38.302313 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:35:38.302644 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:35:38.303132 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m20:35:38.304267 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m20:35:38.304591 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:35:38.304966 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:35:38.305490 [info ] [Thread-3 (]: 20 of 36 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m20:35:38.305836 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m20:35:38.306883 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m20:35:38.308544 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:35:38.309000 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:35:38.309553 [info ] [Thread-2 (]: 21 of 36 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m20:35:38.309914 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m20:35:38.310348 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:35:38.310814 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:35:38.311224 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:35:38.311695 [info ] [Thread-3 (]: 24 of 36 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m20:35:38.312134 [info ] [Thread-1 (]: 22 of 36 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m20:35:38.312495 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m20:35:38.312835 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:35:38.313180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m20:35:38.313665 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:35:38.313960 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.314281 [info ] [Thread-2 (]: 25 of 36 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m20:35:38.314620 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:35:38.314952 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:35:38.315417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m20:35:38.318995 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:35:38.319664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.319394 [info ] [Thread-1 (]: 26 of 36 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m20:35:38.320088 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:35:38.320534 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:35:38.320871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m20:35:38.321199 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:35:38.324626 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:35:38.324977 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.325310 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:35:38.326861 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:35:38.331631 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:35:38.331994 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m20:35:38.332306 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:35:38.332882 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:35:38.333975 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m20:35:38.335543 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:35:38.335888 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m20:35:38.336190 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:35:38.336649 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m20:35:38.336952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.337321 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:35:38.338781 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:35:38.339365 [info ] [Thread-4 (]: 23 of 36 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m20:35:38.339725 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m20:35:38.340296 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:35:38.340668 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:35:38.340956 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.341304 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:35:38.341671 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m20:35:38.342079 [info ] [Thread-4 (]: 27 of 36 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m20:35:38.342445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.342839 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m20:35:38.343147 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.343581 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:35:38.343898 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:35:38.346572 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:35:38.347025 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.347362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.347713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.348168 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:35:38.348528 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:35:38.348812 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:35:38.349165 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.349484 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.349814 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:35:38.351440 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:35:38.352629 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m20:35:38.353012 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:38.354195 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m20:35:38.354549 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:35:38.354854 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:35:38.355133 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m20:35:38.355506 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m20:35:38.355793 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m20:35:38.356827 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m20:35:38.357184 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.357602 [info ] [Thread-3 (]: 24 of 36 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m20:35:38.358103 [info ] [Thread-2 (]: 25 of 36 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m20:35:38.358620 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m20:35:38.359071 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:35:38.359512 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:35:38.359909 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:35:38.360367 [info ] [Thread-1 (]: 26 of 36 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m20:35:38.360826 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_source_format
[0m20:35:38.361261 [info ] [Thread-3 (]: 28 of 36 START sql table model public.dim_survey_type .......................... [RUN]
[0m20:35:38.361749 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:35:38.362165 [info ] [Thread-2 (]: 29 of 36 START sql table model public.dim_source_format ........................ [RUN]
[0m20:35:38.362520 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.362878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now model.caspian_vault.dim_survey_type)
[0m20:35:38.363220 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_time
[0m20:35:38.363620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_source_format)
[0m20:35:38.363964 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:35:38.364290 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m20:35:38.364660 [info ] [Thread-1 (]: 30 of 36 START sql table model public.dim_time ................................. [RUN]
[0m20:35:38.365022 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_source_format
[0m20:35:38.365350 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:35:38.367510 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m20:35:38.367862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_time)
[0m20:35:38.369794 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m20:35:38.370283 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_time
[0m20:35:38.372426 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m20:35:38.372874 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m20:35:38.373224 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:35:38.375986 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m20:35:38.376356 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_source_format
[0m20:35:38.376718 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_time
[0m20:35:38.377808 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m20:35:38.381672 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m20:35:38.384156 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m20:35:38.384651 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:35:38.385063 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m20:35:38.385533 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:35:38.385833 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m20:35:38.386198 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:35:38.386545 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m20:35:38.386987 [info ] [Thread-4 (]: 27 of 36 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m20:35:38.387390 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.387701 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: BEGIN
[0m20:35:38.388003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.388437 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:35:38.388829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.389275 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_well
[0m20:35:38.389940 [info ] [Thread-4 (]: 31 of 36 START sql table model public.dim_well ................................. [RUN]
[0m20:35:38.390301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now model.caspian_vault.dim_well)
[0m20:35:38.390584 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_well
[0m20:35:38.392645 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m20:35:38.393175 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.393559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.393865 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_well
[0m20:35:38.394168 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.394506 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:35:38.394819 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:35:38.397426 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m20:35:38.397767 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:35:38.398089 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m20:35:38.398437 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m20:35:38.398857 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m20:35:38.399291 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:35:38.399704 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: BEGIN
[0m20:35:38.399973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.403115 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:35:38.405611 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:35:38.405921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:35:38.406262 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m20:35:38.406569 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:35:38.406912 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:35:38.407233 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.008 seconds
[0m20:35:38.407574 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m20:35:38.407879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:38.410236 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:35:38.412577 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:35:38.414693 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:35:38.415036 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:35:38.415375 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m20:35:38.415699 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m20:35:38.416213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.416551 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.418571 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:35:38.418879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:35:38.419160 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:35:38.422064 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:35:38.422414 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:35:38.423393 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:35:38.425671 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:35:38.426007 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m20:35:38.426404 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:35:38.426727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.427009 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m20:35:38.427374 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:35:38.427684 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.428600 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:35:38.429648 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:35:38.429978 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:35:38.430267 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:38.430585 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:35:38.430877 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:35:38.432931 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:35:38.433216 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:38.433538 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:35:38.433889 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m20:35:38.435565 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m20:35:38.435866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.436401 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:35:38.436694 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.438275 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m20:35:38.438575 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.438877 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m20:35:38.439845 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:35:38.440307 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:35:38.441946 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m20:35:38.442342 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:35:38.442645 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m20:35:38.443135 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:35:38.443457 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:35:38.443805 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m20:35:38.444334 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.445307 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m20:35:38.445778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0a61700>]}
[0m20:35:38.446075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.446864 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:35:38.446579 [info ] [Thread-3 (]: 28 of 36 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 0[0m in 0.08s]
[0m20:35:38.447292 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:35:38.448224 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: Close
[0m20:35:38.449918 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m20:35:38.450374 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:35:38.451340 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: Close
[0m20:35:38.451887 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:35:38.452287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d1c49730>]}
[0m20:35:38.452640 [debug] [Thread-3 (]: Began running node model.caspian_vault.fct_readings
[0m20:35:38.453038 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m20:35:38.453395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0a61850>]}
[0m20:35:38.453868 [info ] [Thread-1 (]: 30 of 36 OK created sql table model public.dim_time ............................ [[32mSELECT 0[0m in 0.08s]
[0m20:35:38.454354 [info ] [Thread-3 (]: 32 of 36 START sql table model public.fct_readings ............................. [RUN]
[0m20:35:38.454930 [info ] [Thread-2 (]: 29 of 36 OK created sql table model public.dim_source_format ................... [[32mSELECT 0[0m in 0.09s]
[0m20:35:38.455419 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_time
[0m20:35:38.455752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m20:35:38.456180 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:35:38.456588 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.fct_readings
[0m20:35:38.459041 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m20:35:38.459551 [debug] [Thread-3 (]: Began executing node model.caspian_vault.fct_readings
[0m20:35:38.459833 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:35:38.462398 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m20:35:38.464465 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: Close
[0m20:35:38.464996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124a1e8fd10>]}
[0m20:35:38.465360 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:35:38.465790 [info ] [Thread-4 (]: 31 of 36 OK created sql table model public.dim_well ............................ [[32mSELECT 0[0m in 0.07s]
[0m20:35:38.466133 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: BEGIN
[0m20:35:38.466559 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_well
[0m20:35:38.466845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.470782 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:35:38.471091 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:35:38.471414 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m20:35:38.484665 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.013 seconds
[0m20:35:38.548577 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:35:38.549004 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m20:35:38.549777 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.551944 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:35:38.552258 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m20:35:38.552750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.553716 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:35:38.554010 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:35:38.554277 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:35:38.556416 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.558070 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m20:35:38.558503 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:35:38.558779 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m20:35:38.561368 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.562368 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: Close
[0m20:35:38.562841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124a1e53800>]}
[0m20:35:38.563328 [info ] [Thread-3 (]: 32 of 36 OK created sql table model public.fct_readings ........................ [[32mSELECT 0[0m in 0.11s]
[0m20:35:38.563767 [debug] [Thread-3 (]: Finished running node model.caspian_vault.fct_readings
[0m20:35:38.564458 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:35:38.564788 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:35:38.565215 [info ] [Thread-1 (]: 33 of 36 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m20:35:38.565643 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:35:38.566028 [info ] [Thread-2 (]: 34 of 36 START sql table model public.mart_survey_summary ...................... [RUN]
[0m20:35:38.566445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_sensor_analysis)
[0m20:35:38.566850 [info ] [Thread-4 (]: 35 of 36 START sql table model public.mart_well_performance .................... [RUN]
[0m20:35:38.567214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_survey_summary)
[0m20:35:38.567553 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m20:35:38.567889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_well_performance)
[0m20:35:38.568200 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m20:35:38.570392 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.570748 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m20:35:38.572730 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m20:35:38.574808 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m20:35:38.575294 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m20:35:38.575727 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m20:35:38.578348 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.580937 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m20:35:38.581257 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_well_performance
[0m20:35:38.584903 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m20:35:38.585367 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:35:38.585695 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.586076 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m20:35:38.586441 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m20:35:38.586753 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:35:38.587073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:38.587373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:38.587670 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m20:35:38.588177 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:38.591909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.592231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.592612 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:35:38.592919 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:35:38.593243 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.593580 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:35:38.593902 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:35:38.594218 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m20:35:38.594621 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:35:38.598595 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:35:38.598881 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:35:38.601321 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.603584 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:35:38.603932 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.009 seconds
[0m20:35:38.604232 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m20:35:38.604589 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m20:35:38.606842 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:35:38.607280 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m20:35:38.607638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.607927 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:38.608208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:38.610338 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.612333 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:35:38.614367 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:35:38.614698 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m20:35:38.615016 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m20:35:38.615351 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m20:35:38.615831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.616154 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:38.617105 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:35:38.617414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:35:38.618365 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:35:38.618691 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.619639 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:35:38.619968 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:35:38.620278 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:35:38.620582 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:35:38.620877 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:35:38.621223 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:35:38.623339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:38.625101 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m20:35:38.625456 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:38.625868 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:35:38.626165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m20:35:38.627769 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m20:35:38.628092 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m20:35:38.630770 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m20:35:38.631240 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:35:38.631753 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:35:38.632071 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m20:35:38.632401 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m20:35:38.633628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.634613 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m20:35:38.634876 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.635196 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:38.636175 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: Close
[0m20:35:38.636590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d01467b0>]}
[0m20:35:38.637567 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: Close
[0m20:35:38.638567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0146990>]}
[0m20:35:38.638175 [info ] [Thread-1 (]: 33 of 36 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 0[0m in 0.07s]
[0m20:35:38.639157 [info ] [Thread-4 (]: 35 of 36 OK created sql table model public.mart_well_performance ............... [[32mSELECT 0[0m in 0.07s]
[0m20:35:38.639544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0146930>]}
[0m20:35:38.640000 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:35:38.640427 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:35:38.640866 [info ] [Thread-2 (]: 34 of 36 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 0[0m in 0.07s]
[0m20:35:38.641551 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:35:38.642042 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:35:38.642455 [info ] [Thread-3 (]: 36 of 36 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m20:35:38.642912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:35:38.643204 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:35:38.645586 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:35:38.679995 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.680384 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:35:38.680657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:38.684902 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:35:38.685225 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.685531 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:35:38.690707 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:35:38.721165 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.721612 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp203538720469"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:35:38.723728 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.002 seconds
[0m20:35:38.725907 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.726224 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp203538720469'
        
      order by ordinal_position

  
[0m20:35:38.728478 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:35:38.730741 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.731057 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:35:38.732850 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:35:38.735047 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.735386 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp203538720469'
        
      order by ordinal_position

  
[0m20:35:38.737166 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:35:38.739368 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.739687 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:35:38.741433 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:35:38.747292 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.747623 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp203538720469'
        
      order by ordinal_position

  
[0m20:35:38.749417 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:35:38.762216 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.762644 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:35:38.763344 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:35:38.767146 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.767492 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:35:38.767932 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:35:38.768348 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.768879 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.769195 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp203538720469" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp203538720469" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:35:38.769927 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:35:38.770863 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:35:38.771157 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:35:38.771432 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:35:38.774243 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m20:35:38.776196 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:35:38.776709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c72390-74c6-469d-8d4f-595f37fb5371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d0be6ff0>]}
[0m20:35:38.777348 [info ] [Thread-3 (]: 36 of 36 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 0[0m in 0.13s]
[0m20:35:38.777827 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:35:38.779119 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:38.779446 [debug] [MainThread]: On master: BEGIN
[0m20:35:38.779701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:38.783687 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:35:38.783990 [debug] [MainThread]: On master: COMMIT
[0m20:35:38.784272 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:38.784519 [debug] [MainThread]: On master: COMMIT
[0m20:35:38.784829 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:38.785084 [debug] [MainThread]: On master: Close
[0m20:35:38.785458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:38.785703 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m20:35:38.785916 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m20:35:38.786122 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:35:38.786345 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m20:35:38.786680 [info ] [MainThread]: 
[0m20:35:38.786963 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests, 3 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m20:35:38.790799 [debug] [MainThread]: Command end result
[0m20:35:38.816020 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:35:38.817538 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:35:38.823316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:35:38.823625 [info ] [MainThread]: 
[0m20:35:38.823949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:38.824269 [info ] [MainThread]: 
[0m20:35:38.824555 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=36
[0m20:35:38.826267 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:35:38.827116 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.304667, "process_in_blocks": "0", "process_kernel_time": 0.326233, "process_mem_max_rss": "141376", "process_out_blocks": "5032", "process_user_time": 4.262109}
[0m20:35:38.827575 [debug] [MainThread]: Command `dbt build` succeeded at 20:35:38.827494 after 3.31 seconds
[0m20:35:38.827879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d829aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d8018e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124d5465850>]}
[0m20:35:38.828186 [debug] [MainThread]: Flushing usage events
[0m20:35:39.347487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:46.098518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf442d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf362f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf3e9db20>]}


============================== 20:45:46.103386 | 3145eb22-8c4c-473c-ba9a-bd78d81ce6bb ==============================
[0m20:45:46.103386 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:45:46.103810 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'log_path': '/opt/airflow/logs/dbt', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager'}
[0m20:45:46.109995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:45:46.110365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3145eb22-8c4c-473c-ba9a-bd78d81ce6bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf3364800>]}
[0m20:45:46.110741 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:45:46.111026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3145eb22-8c4c-473c-ba9a-bd78d81ce6bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf3364800>]}
[0m20:45:46.213297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3145eb22-8c4c-473c-ba9a-bd78d81ce6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf304a180>]}
[0m20:45:46.232157 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uyjiblm1'
[0m20:45:46.232512 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:45:46.513679 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:45:46.514372 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:45:46.585961 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:45:46.589254 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:45:46.828047 [info ] [MainThread]: Installed from version 1.3.0
[0m20:45:46.828488 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:45:46.828841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3145eb22-8c4c-473c-ba9a-bd78d81ce6bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf2ff6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf2f87bf0>]}
[0m20:45:46.829150 [info ] [MainThread]: 
[0m20:45:46.829430 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:45:46.830060 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:45:46.830877 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7741368, "process_in_blocks": "0", "process_kernel_time": 0.207001, "process_mem_max_rss": "108428", "process_out_blocks": "2312", "process_user_time": 1.327009}
[0m20:45:46.831309 [debug] [MainThread]: Command `dbt deps` succeeded at 20:45:46.831209 after 0.77 seconds
[0m20:45:46.831584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf5f0a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf304a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cdf30f9700>]}
[0m20:45:46.831845 [debug] [MainThread]: Flushing usage events
[0m20:45:47.303729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:13.946172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad597d6ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad599094aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad598f80c50>]}


============================== 20:46:13.950968 | a58c99ec-4eb0-4919-b501-c8ecec7595b8 ==============================
[0m20:46:13.950968 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:46:13.951411 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profile caspian_vault --target dev --no-partial-parse', 'target_path': 'None', 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/logs/dbt', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'False', 'quiet': 'False', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True'}
[0m20:46:13.995283 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:46:13.995732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5963adca0>]}
[0m20:46:13.996185 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:46:13.996512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad59638d1c0>]}
[0m20:46:14.115672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5964b8c80>]}
[0m20:46:14.173561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5981b48c0>]}
[0m20:46:14.174339 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:46:14.287055 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:46:14.287697 [debug] [MainThread]: Partial parsing not enabled
[0m20:46:15.674959 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:46:15.675505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad59573acf0>]}
[0m20:46:15.881415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:46:15.890148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad592ed38c0>]}
[0m20:46:16.048014 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:46:16.049690 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:46:16.078434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad592d1abd0>]}
[0m20:46:16.078889 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:46:16.082581 [info ] [MainThread]: 
[0m20:46:16.082928 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:16.083213 [info ] [MainThread]: 
[0m20:46:16.083670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:16.087832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:46:16.088433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:46:16.122450 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:46:16.122816 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:46:16.123128 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:46:16.123435 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:46:16.123708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:16.123964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:16.129344 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m20:46:16.129631 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.006 seconds
[0m20:46:16.130669 [debug] [ThreadPool]: On list_airflow: Close
[0m20:46:16.131599 [debug] [ThreadPool]: On list_airflow: Close
[0m20:46:16.133534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:46:16.133977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:46:16.138209 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:46:16.139552 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:46:16.139850 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:46:16.140121 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:46:16.140385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:16.140635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:16.144410 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:46:16.144741 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:46:16.144987 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:46:16.145294 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:46:16.145576 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:46:16.145905 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:46:16.147772 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:46:16.148055 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:46:16.148981 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:46:16.150465 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:46:16.150832 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:46:16.151066 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:46:16.160860 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:16.161161 [debug] [MainThread]: On master: BEGIN
[0m20:46:16.161428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:16.165014 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:46:16.165339 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:16.165667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:16.187937 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:46:16.189115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad592d42cc0>]}
[0m20:46:16.189558 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:16.189944 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:16.190212 [debug] [MainThread]: On master: BEGIN
[0m20:46:16.190636 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:46:16.190920 [debug] [MainThread]: On master: COMMIT
[0m20:46:16.191171 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:16.191428 [debug] [MainThread]: On master: COMMIT
[0m20:46:16.191746 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:46:16.192008 [debug] [MainThread]: On master: Close
[0m20:46:16.195458 [debug] [Thread-1 (]: Began running node model.caspian_vault.raw_recovered_1
[0m20:46:16.195799 [debug] [Thread-2 (]: Began running node model.caspian_vault.raw_recovered_2
[0m20:46:16.196172 [debug] [Thread-3 (]: Began running node model.caspian_vault.raw_sgx_all
[0m20:46:16.196879 [debug] [Thread-4 (]: Began running node model.caspian_vault.stg_readings
[0m20:46:16.196600 [info ] [Thread-1 (]: 1 of 36 START sql view model public.raw_recovered_1 ............................ [RUN]
[0m20:46:16.197376 [info ] [Thread-2 (]: 2 of 36 START sql view model public.raw_recovered_2 ............................ [RUN]
[0m20:46:16.197792 [info ] [Thread-3 (]: 3 of 36 START sql view model public.raw_sgx_all ................................ [RUN]
[0m20:46:16.198302 [info ] [Thread-4 (]: 4 of 36 START sql table model public.stg_readings .............................. [RUN]
[0m20:46:16.198704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.raw_recovered_1)
[0m20:46:16.199036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.raw_recovered_2)
[0m20:46:16.199430 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.caspian_vault.raw_sgx_all'
[0m20:46:16.199811 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.caspian_vault.stg_readings'
[0m20:46:16.200118 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.raw_recovered_1
[0m20:46:16.200437 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.raw_recovered_2
[0m20:46:16.200755 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.raw_sgx_all
[0m20:46:16.201063 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:46:16.206085 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_1"
[0m20:46:16.207923 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_2"
[0m20:46:16.209785 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.raw_sgx_all"
[0m20:46:16.212487 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:46:16.213268 [debug] [Thread-1 (]: Began executing node model.caspian_vault.raw_recovered_1
[0m20:46:16.213576 [debug] [Thread-2 (]: Began executing node model.caspian_vault.raw_recovered_2
[0m20:46:16.213949 [debug] [Thread-3 (]: Began executing node model.caspian_vault.raw_sgx_all
[0m20:46:16.241282 [debug] [Thread-4 (]: Began executing node model.caspian_vault.stg_readings
[0m20:46:16.244620 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_1"
[0m20:46:16.245748 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_2"
[0m20:46:16.248402 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.raw_sgx_all"
[0m20:46:16.264418 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:46:16.265123 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:46:16.265556 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:46:16.265937 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:46:16.266277 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: BEGIN
[0m20:46:16.266624 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: BEGIN
[0m20:46:16.266989 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:46:16.267285 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: BEGIN
[0m20:46:16.267589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.267879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.268172 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:46:16.268470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:46:16.268968 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:46:16.272961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.273293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.273689 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:46:16.273996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.274334 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:46:16.274628 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.274962 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */

  create view "airflow"."public"."raw_recovered_2__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:46:16.275288 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:46:16.275606 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */

  create view "airflow"."public"."raw_recovered_1__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:46:16.275921 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:46:16.276299 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */

  create view "airflow"."public"."raw_sgx_all__dbt_tmp"
    
    
  as (
    

-- TEMP: SGX source not available yet.
-- Keeps downstream models working by providing correct schema with no rows.
select
  cast(null as bigint) as well_id,
  cast(null as bigint) as survey_type_id,
  cast(null as double precision) as depth_ft,
  cast(null as double precision) as amplitude,
  cast(null as int) as quality_flag,
  cast(null as varchar) as source_file
where 1=0
  );
[0m20:46:16.276722 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:46:16.277217 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:46:16.282116 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:46:16.282435 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:46:16.282725 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:46:16.283057 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2" rename to "raw_recovered_2__dbt_backup"
[0m20:46:16.285334 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:46:16.288318 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:46:16.288689 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m20:46:16.289017 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1" rename to "raw_recovered_1__dbt_backup"
[0m20:46:16.289346 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all" rename to "raw_sgx_all__dbt_backup"
[0m20:46:16.294030 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:46:16.294486 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m20:46:16.294945 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.296935 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:46:16.297234 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m20:46:16.297689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.309262 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:46:16.309603 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:46:16.309867 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:46:16.316648 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m20:46:16.321361 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m20:46:16.321814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:46:16.325853 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:46:16.326201 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:46:16.326600 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:46:16.328757 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:46:16.329091 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m20:46:16.331196 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:46:16.333340 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:46:16.333718 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1__dbt_tmp" rename to "raw_recovered_1"
[0m20:46:16.334154 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2__dbt_tmp" rename to "raw_recovered_2"
[0m20:46:16.334509 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all__dbt_tmp" rename to "raw_sgx_all"
[0m20:46:16.335111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.336222 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:46:16.336532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:46:16.336815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:46:16.337095 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:46:16.337432 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:46:16.338392 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:46:16.339359 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:46:16.341150 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: Close
[0m20:46:16.341495 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:46:16.341802 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:46:16.342120 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:46:16.343426 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:46:16.343831 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:46:16.344115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad598ff72c0>]}
[0m20:46:16.344514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:46:16.345110 [info ] [Thread-4 (]: 4 of 36 OK created sql table model public.stg_readings ......................... [[32mSELECT 0[0m in 0.14s]
[0m20:46:16.346879 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."raw_recovered_1__dbt_backup"
[0m20:46:16.347226 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:46:16.347674 [debug] [Thread-4 (]: Finished running node model.caspian_vault.stg_readings
[0m20:46:16.350164 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:46:16.350508 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m20:46:16.353038 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."raw_recovered_2__dbt_backup"
[0m20:46:16.353583 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
drop view if exists "airflow"."public"."raw_recovered_1__dbt_backup" cascade
[0m20:46:16.354035 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:46:16.355628 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."raw_sgx_all__dbt_backup"
[0m20:46:16.356080 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:46:16.356477 [info ] [Thread-4 (]: 5 of 36 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m20:46:16.356995 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:46:16.357348 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
drop view if exists "airflow"."public"."raw_recovered_2__dbt_backup" cascade
[0m20:46:16.357697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969)
[0m20:46:16.358041 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
drop view if exists "airflow"."public"."raw_sgx_all__dbt_backup" cascade
[0m20:46:16.358368 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:46:16.358732 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:46:16.359792 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: Close
[0m20:46:16.362720 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:46:16.363086 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:46:16.363416 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m20:46:16.363880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591bd8890>]}
[0m20:46:16.364938 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: Close
[0m20:46:16.365951 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: Close
[0m20:46:16.366260 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:46:16.366746 [info ] [Thread-1 (]: 1 of 36 OK created sql view model public.raw_recovered_1 ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:46:16.367218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591b457f0>]}
[0m20:46:16.367622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591acf200>]}
[0m20:46:16.379925 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:46:16.380432 [debug] [Thread-1 (]: Finished running node model.caspian_vault.raw_recovered_1
[0m20:46:16.380910 [info ] [Thread-3 (]: 3 of 36 OK created sql view model public.raw_sgx_all ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:46:16.381429 [info ] [Thread-2 (]: 2 of 36 OK created sql view model public.raw_recovered_2 ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:46:16.381904 [debug] [Thread-1 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:46:16.382426 [debug] [Thread-3 (]: Finished running node model.caspian_vault.raw_sgx_all
[0m20:46:16.382858 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:46:16.383285 [debug] [Thread-2 (]: Finished running node model.caspian_vault.raw_recovered_2
[0m20:46:16.383594 [info ] [Thread-1 (]: 6 of 36 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m20:46:16.384033 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m20:46:16.384460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_1, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd)
[0m20:46:16.384767 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.385070 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:46:16.387928 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:46:16.388386 [debug] [Thread-1 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:46:16.389888 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:46:16.390434 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:46:16.390770 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.391070 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m20:46:16.391389 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:46:16.391690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.391997 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:46:16.392974 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.395398 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m20:46:16.395853 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m20:46:16.396164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:46:16.396554 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:46:16.396978 [info ] [Thread-4 (]: 5 of 36 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m20:46:16.397361 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:46:16.397819 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:46:16.398563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:46:16.399619 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m20:46:16.400009 [debug] [Thread-1 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m20:46:16.400480 [info ] [Thread-1 (]: 6 of 36 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.02s]
[0m20:46:16.400905 [debug] [Thread-1 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:46:16.401573 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:46:16.401860 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:46:16.402193 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:46:16.402563 [info ] [Thread-3 (]: 7 of 36 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m20:46:16.402894 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:46:16.403284 [info ] [Thread-2 (]: 8 of 36 START sql table model public.dv_hub_well ............................... [RUN]
[0m20:46:16.403717 [info ] [Thread-4 (]: 9 of 36 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m20:46:16.404083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_sgx_all, now model.caspian_vault.dv_hub_survey_type)
[0m20:46:16.404480 [info ] [Thread-1 (]: 10 of 36 START sql table model public.dv_sat_readings .......................... [RUN]
[0m20:46:16.404839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_2, now model.caspian_vault.dv_hub_well)
[0m20:46:16.405161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m20:46:16.405479 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m20:46:16.405787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m20:46:16.406092 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m20:46:16.406398 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m20:46:16.408818 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.409149 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m20:46:16.411361 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m20:46:16.413785 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.416065 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m20:46:16.416531 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m20:46:16.417025 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m20:46:16.417327 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m20:46:16.421187 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.423703 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.424040 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m20:46:16.426582 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m20:46:16.429338 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m20:46:16.429777 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.430436 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.430755 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:46:16.431041 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m20:46:16.431389 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m20:46:16.431696 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:46:16.432013 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m20:46:16.432321 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.432620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.432917 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m20:46:16.433203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.433721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.437437 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.437846 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.438162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.438520 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m20:46:16.438856 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.439309 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m20:46:16.439605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.439975 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:46:16.440303 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:46:16.440603 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:46:16.440922 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m20:46:16.441348 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m20:46:16.445532 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:46:16.448191 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.448511 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m20:46:16.448979 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.450948 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.451259 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m20:46:16.451613 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:46:16.451933 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:46:16.452275 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.012 seconds
[0m20:46:16.454540 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:46:16.454835 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:46:16.457234 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:46:16.460191 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.460543 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m20:46:16.461530 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:46:16.461857 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m20:46:16.462184 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m20:46:16.462608 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.462932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.463317 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:46:16.463642 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.465612 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:46:16.465908 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:46:16.468005 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:46:16.468345 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m20:46:16.470394 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.470728 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m20:46:16.471087 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m20:46:16.471490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.471778 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m20:46:16.473525 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m20:46:16.473852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:46:16.474848 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:46:16.475385 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:46:16.475730 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:46:16.476682 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:46:16.477019 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:46:16.477336 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m20:46:16.478304 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:46:16.478629 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:46:16.478930 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:46:16.479297 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.479597 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:46:16.479932 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:46:16.481366 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:46:16.482347 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m20:46:16.482624 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:46:16.482914 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:46:16.483219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:46:16.485022 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m20:46:16.485472 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad59019c350>]}
[0m20:46:16.487121 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m20:46:16.488730 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m20:46:16.489191 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:46:16.489718 [info ] [Thread-4 (]: 9 of 36 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 0[0m in 0.08s]
[0m20:46:16.490309 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:46:16.490767 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:46:16.491078 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m20:46:16.491524 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:46:16.491831 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m20:46:16.492142 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m20:46:16.492819 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:46:16.493199 [info ] [Thread-4 (]: 11 of 36 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m20:46:16.493541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m20:46:16.493817 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:46:16.498578 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:46:16.498899 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:46:16.499197 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:46:16.499511 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:46:16.500617 [debug] [Thread-3 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m20:46:16.501626 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m20:46:16.501912 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:46:16.502899 [debug] [Thread-1 (]: On model.caspian_vault.dv_sat_readings: Close
[0m20:46:16.503395 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591b9c320>]}
[0m20:46:16.503842 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591b44830>]}
[0m20:46:16.506414 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:46:16.507021 [info ] [Thread-3 (]: 7 of 36 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 0[0m in 0.10s]
[0m20:46:16.507501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad55af5b440>]}
[0m20:46:16.507984 [info ] [Thread-2 (]: 8 of 36 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 0[0m in 0.10s]
[0m20:46:16.508549 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:46:16.508952 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:46:16.509401 [info ] [Thread-1 (]: 10 of 36 OK created sql table model public.dv_sat_readings ..................... [[32mSELECT 0[0m in 0.10s]
[0m20:46:16.509924 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:46:16.510281 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:46:16.510738 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m20:46:16.511151 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:46:16.511481 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:46:16.511886 [info ] [Thread-3 (]: 12 of 36 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m20:46:16.512227 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.512553 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:46:16.512906 [info ] [Thread-2 (]: 13 of 36 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m20:46:16.513291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m20:46:16.513814 [info ] [Thread-1 (]: 14 of 36 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m20:46:16.514172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m20:46:16.514513 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:46:16.514839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m20:46:16.515170 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:46:16.517981 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:46:16.518393 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:46:16.518697 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.521323 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:46:16.525601 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:46:16.525968 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:46:16.526334 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:46:16.526916 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.527292 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:46:16.528836 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:46:16.529159 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:46:16.530763 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:46:16.531172 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:46:16.532660 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:46:16.533060 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:46:16.534277 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m20:46:16.534685 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:46:16.535060 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m20:46:16.535443 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:46:16.535772 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m20:46:16.536075 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.536345 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m20:46:16.536658 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m20:46:16.536941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.537389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.537785 [info ] [Thread-4 (]: 11 of 36 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m20:46:16.538540 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:46:16.538885 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:46:16.539257 [info ] [Thread-4 (]: 15 of 36 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m20:46:16.539586 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m20:46:16.539856 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:46:16.542500 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:46:16.543056 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m20:46:16.543398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.543771 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:46:16.544068 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:46:16.544434 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:46:16.544749 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:46:16.545060 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:46:16.545384 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.547019 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:46:16.547374 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:46:16.547704 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.548362 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:46:16.548654 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.549019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.549304 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m20:46:16.549576 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.550702 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m20:46:16.551746 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m20:46:16.552054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.553065 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m20:46:16.553572 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m20:46:16.553856 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m20:46:16.554313 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m20:46:16.554847 [info ] [Thread-3 (]: 12 of 36 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m20:46:16.555435 [info ] [Thread-1 (]: 14 of 36 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m20:46:16.555975 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:46:16.556382 [info ] [Thread-2 (]: 13 of 36 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m20:46:16.556902 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:46:16.557320 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:46:16.557685 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.558113 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:46:16.558468 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:46:16.558823 [info ] [Thread-3 (]: 16 of 36 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m20:46:16.559164 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:46:16.559538 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:46:16.559906 [info ] [Thread-1 (]: 17 of 36 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m20:46:16.560282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m20:46:16.560634 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.560983 [info ] [Thread-2 (]: 18 of 36 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m20:46:16.561358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m20:46:16.561688 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:46:16.562069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m20:46:16.562398 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:46:16.562690 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.566737 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:46:16.567072 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:46:16.570417 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:46:16.571533 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m20:46:16.574235 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:46:16.574691 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:46:16.575179 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m20:46:16.575544 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:46:16.577112 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:46:16.578686 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:46:16.578990 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:46:16.579414 [info ] [Thread-4 (]: 15 of 36 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m20:46:16.581197 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:46:16.581584 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:46:16.582028 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:46:16.582353 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:46:16.582778 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m20:46:16.583142 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:46:16.583493 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:46:16.583816 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m20:46:16.584152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.584468 [info ] [Thread-4 (]: 19 of 36 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m20:46:16.584786 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m20:46:16.585083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.585511 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m20:46:16.585839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.586291 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:46:16.589151 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:46:16.589672 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.590050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.590407 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:46:16.590725 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.591058 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:46:16.591360 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:46:16.591691 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.592006 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:46:16.592345 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.593888 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:46:16.594292 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:46:16.594649 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:46:16.595936 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m20:46:16.596281 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:46:16.596688 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:46:16.596989 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:46:16.598028 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m20:46:16.598348 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m20:46:16.598674 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m20:46:16.599715 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m20:46:16.600124 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m20:46:16.600414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.600825 [info ] [Thread-3 (]: 16 of 36 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.04s]
[0m20:46:16.601266 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m20:46:16.601794 [info ] [Thread-1 (]: 17 of 36 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m20:46:16.602336 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:46:16.603194 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:46:16.602811 [info ] [Thread-2 (]: 18 of 36 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m20:46:16.603654 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:46:16.604057 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:46:16.604525 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:46:16.604840 [info ] [Thread-3 (]: 20 of 36 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m20:46:16.605203 [info ] [Thread-1 (]: 21 of 36 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m20:46:16.605516 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.605880 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:46:16.606230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m20:46:16.606681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m20:46:16.607003 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:46:16.607326 [info ] [Thread-2 (]: 22 of 36 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m20:46:16.607668 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:46:16.607973 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:46:16.608289 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.608630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m20:46:16.611534 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:46:16.614934 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:46:16.615345 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:46:16.615838 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.616277 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:46:16.620115 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:46:16.620464 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:46:16.621573 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m20:46:16.623110 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:46:16.624692 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:46:16.625106 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:46:16.625482 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m20:46:16.627085 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:46:16.627587 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:46:16.628348 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:46:16.628054 [info ] [Thread-4 (]: 19 of 36 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m20:46:16.628800 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m20:46:16.629153 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m20:46:16.629567 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:46:16.630002 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:46:16.630303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.630591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.630884 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m20:46:16.631211 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:46:16.631757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.632052 [info ] [Thread-4 (]: 23 of 36 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m20:46:16.632555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m20:46:16.632832 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:46:16.635469 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:46:16.636015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.636351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.636761 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.637062 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:46:16.637359 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:46:16.637686 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:46:16.637994 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:46:16.638318 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.639862 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:46:16.640212 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.640562 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:46:16.641189 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:46:16.641512 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m20:46:16.641784 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.642099 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.642395 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.642670 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:46:16.643776 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m20:46:16.644958 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m20:46:16.646021 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m20:46:16.646470 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m20:46:16.646757 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m20:46:16.647088 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m20:46:16.647634 [info ] [Thread-3 (]: 20 of 36 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m20:46:16.648397 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.648050 [info ] [Thread-1 (]: 21 of 36 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m20:46:16.649323 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:46:16.648947 [info ] [Thread-2 (]: 22 of 36 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m20:46:16.649713 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:46:16.650136 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:46:16.650471 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:46:16.650929 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:46:16.651239 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.651592 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:46:16.651915 [info ] [Thread-3 (]: 24 of 36 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m20:46:16.652312 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:46:16.652811 [info ] [Thread-1 (]: 25 of 36 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m20:46:16.653192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m20:46:16.653542 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.653842 [info ] [Thread-2 (]: 26 of 36 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m20:46:16.654232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m20:46:16.654580 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:46:16.655637 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m20:46:16.655989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m20:46:16.656345 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:46:16.659154 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:46:16.659567 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:46:16.659857 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m20:46:16.662565 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:46:16.666105 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:46:16.667032 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:46:16.666686 [info ] [Thread-4 (]: 23 of 36 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.03s]
[0m20:46:16.667601 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:46:16.670300 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:46:16.670686 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:46:16.671095 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:46:16.672566 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:46:16.674211 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:46:16.674643 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:46:16.674961 [debug] [Thread-4 (]: Began running node test.caspian_vault.test_counts_match
[0m20:46:16.675581 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m20:46:16.675935 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:46:16.676262 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:46:16.676569 [info ] [Thread-4 (]: 27 of 36 START test test_counts_match .......................................... [RUN]
[0m20:46:16.676887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.677191 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m20:46:16.677507 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m20:46:16.677822 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m20:46:16.678224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.678524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.678833 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.test_counts_match
[0m20:46:16.681100 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m20:46:16.681585 [debug] [Thread-4 (]: Began executing node test.caspian_vault.test_counts_match
[0m20:46:16.681898 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.683422 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m20:46:16.683846 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:46:16.684153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.684518 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.684910 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.685282 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:46:16.685590 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:46:16.685919 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:46:16.686301 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.686607 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m20:46:16.686890 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.687211 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:46:16.687585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.688699 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m20:46:16.689039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.690283 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m20:46:16.690578 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m20:46:16.690929 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:46:16.691458 [info ] [Thread-3 (]: 24 of 36 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m20:46:16.692581 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m20:46:16.692873 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m20:46:16.693351 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:46:16.693646 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:46:16.694067 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m20:46:16.694405 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:46:16.694794 [info ] [Thread-1 (]: 25 of 36 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m20:46:16.695210 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:46:16.695684 [info ] [Thread-3 (]: 28 of 36 START sql table model public.dim_survey_type .......................... [RUN]
[0m20:46:16.696138 [info ] [Thread-2 (]: 26 of 36 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m20:46:16.696648 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:46:16.696998 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m20:46:16.697377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now model.caspian_vault.dim_survey_type)
[0m20:46:16.697816 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:46:16.698143 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_well
[0m20:46:16.698558 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m20:46:16.699019 [info ] [Thread-1 (]: 29 of 36 START sql table model public.dim_well ................................. [RUN]
[0m20:46:16.699339 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:46:16.701511 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m20:46:16.701859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now model.caspian_vault.dim_well)
[0m20:46:16.702916 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m20:46:16.703319 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_well
[0m20:46:16.703672 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m20:46:16.705746 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m20:46:16.706095 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: Close
[0m20:46:16.708709 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m20:46:16.709233 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_well
[0m20:46:16.709740 [info ] [Thread-4 (]: 27 of 36 PASS test_counts_match ................................................ [[32mPASS[0m in 0.03s]
[0m20:46:16.712375 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m20:46:16.712853 [debug] [Thread-4 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:46:16.713200 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:46:16.713880 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m20:46:16.714233 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_source_format
[0m20:46:16.714539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.714818 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_time
[0m20:46:16.715126 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:46:16.715541 [info ] [Thread-2 (]: 30 of 36 START sql table model public.dim_source_format ........................ [RUN]
[0m20:46:16.716088 [info ] [Thread-4 (]: 31 of 36 START sql table model public.dim_time ................................. [RUN]
[0m20:46:16.716467 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: BEGIN
[0m20:46:16.716837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_source_format)
[0m20:46:16.717187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now model.caspian_vault.dim_time)
[0m20:46:16.717514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.717814 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_source_format
[0m20:46:16.718112 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_time
[0m20:46:16.721331 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m20:46:16.723396 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m20:46:16.723729 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m20:46:16.724077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:46:16.724637 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:46:16.724986 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_time
[0m20:46:16.725307 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:46:16.725592 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_source_format
[0m20:46:16.725918 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m20:46:16.728521 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m20:46:16.728890 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m20:46:16.731381 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m20:46:16.732116 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:46:16.732452 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:46:16.732761 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: BEGIN
[0m20:46:16.733194 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m20:46:16.733504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.733797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.735454 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:46:16.737917 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:46:16.738326 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m20:46:16.738622 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.738970 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.739314 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:46:16.739621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.739931 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:46:16.740261 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:46:16.742513 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:46:16.744514 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:46:16.744850 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m20:46:16.745188 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m20:46:16.745523 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m20:46:16.745843 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m20:46:16.746431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.746718 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.748755 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:46:16.749821 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:46:16.750132 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:46:16.750459 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m20:46:16.750742 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:46:16.751071 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:46:16.753375 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:46:16.756534 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:46:16.756896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:46:16.757188 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:46:16.757526 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m20:46:16.757847 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:46:16.758813 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:46:16.759298 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:46:16.759620 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.759900 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:46:16.760184 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:46:16.760540 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:46:16.826664 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:46:16.829062 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:46:16.829440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:46:16.831125 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m20:46:16.831480 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:46:16.831809 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m20:46:16.833509 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m20:46:16.833967 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:46:16.834533 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:46:16.834879 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:46:16.835162 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m20:46:16.835465 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:46:16.835776 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m20:46:16.836758 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:46:16.837765 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:46:16.838135 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:46:16.838456 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:46:16.838756 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:46:16.839042 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:46:16.839338 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:46:16.840452 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m20:46:16.840727 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:46:16.841737 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: Close
[0m20:46:16.842141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad59013f5f0>]}
[0m20:46:16.842471 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:46:16.842830 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:46:16.843235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad59016b080>]}
[0m20:46:16.843781 [info ] [Thread-3 (]: 28 of 36 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 0[0m in 0.14s]
[0m20:46:16.845524 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m20:46:16.847156 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m20:46:16.847707 [info ] [Thread-1 (]: 29 of 36 OK created sql table model public.dim_well ............................ [[32mSELECT 0[0m in 0.14s]
[0m20:46:16.848185 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:46:16.848632 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:46:16.849086 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:46:16.849516 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_well
[0m20:46:16.849842 [debug] [Thread-3 (]: Began running node model.caspian_vault.fct_readings
[0m20:46:16.850208 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m20:46:16.850563 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m20:46:16.851034 [info ] [Thread-3 (]: 32 of 36 START sql table model public.fct_readings ............................. [RUN]
[0m20:46:16.851525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m20:46:16.851814 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.fct_readings
[0m20:46:16.854139 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m20:46:16.854464 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:46:16.854797 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:46:16.855859 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: Close
[0m20:46:16.856878 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: Close
[0m20:46:16.857170 [debug] [Thread-3 (]: Began executing node model.caspian_vault.fct_readings
[0m20:46:16.857664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591a8c500>]}
[0m20:46:16.858096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591bb4e00>]}
[0m20:46:16.860768 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m20:46:16.861260 [info ] [Thread-4 (]: 31 of 36 OK created sql table model public.dim_time ............................ [[32mSELECT 0[0m in 0.14s]
[0m20:46:16.861765 [info ] [Thread-2 (]: 30 of 36 OK created sql table model public.dim_source_format ................... [[32mSELECT 0[0m in 0.14s]
[0m20:46:16.862366 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_time
[0m20:46:16.862806 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:46:16.863360 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:46:16.863662 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: BEGIN
[0m20:46:16.863925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:16.867836 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:46:16.868150 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:46:16.868460 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m20:46:16.872313 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:46:16.874704 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:46:16.875018 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m20:46:16.875472 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.878579 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:46:16.878882 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m20:46:16.879385 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.880331 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:46:16.880622 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:46:16.880877 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:46:16.883234 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:46:16.884790 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m20:46:16.885211 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:46:16.885503 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m20:46:16.887638 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:46:16.888602 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: Close
[0m20:46:16.889027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591a973b0>]}
[0m20:46:16.889484 [info ] [Thread-3 (]: 32 of 36 OK created sql table model public.fct_readings ........................ [[32mSELECT 0[0m in 0.04s]
[0m20:46:16.889897 [debug] [Thread-3 (]: Finished running node model.caspian_vault.fct_readings
[0m20:46:16.890557 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:46:16.890913 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:46:16.891574 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:46:16.891299 [info ] [Thread-1 (]: 33 of 36 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m20:46:16.891993 [info ] [Thread-4 (]: 34 of 36 START sql table model public.mart_survey_summary ...................... [RUN]
[0m20:46:16.892524 [info ] [Thread-2 (]: 35 of 36 START sql table model public.mart_well_performance .................... [RUN]
[0m20:46:16.892896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_sensor_analysis)
[0m20:46:16.893258 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m20:46:16.893599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m20:46:16.893912 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m20:46:16.894216 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m20:46:16.894532 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m20:46:16.896646 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.898627 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m20:46:16.900592 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m20:46:16.901276 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m20:46:16.901606 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_well_performance
[0m20:46:16.904190 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.904524 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m20:46:16.907070 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m20:46:16.909719 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m20:46:16.910399 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.910770 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:46:16.911089 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m20:46:16.911435 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:46:16.911819 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m20:46:16.912121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:16.912435 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m20:46:16.912725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:16.913127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:16.916842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.917162 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:46:16.917546 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.917864 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:46:16.918165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:46:16.918517 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m20:46:16.918839 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:46:16.919158 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:46:16.919590 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:46:16.923184 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:46:16.923476 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:46:16.926921 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.929184 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:46:16.929506 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:46:16.929835 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m20:46:16.930159 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m20:46:16.932413 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:46:16.932842 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m20:46:16.933127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.933480 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:46:16.935478 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.935772 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:46:16.937828 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:46:16.938157 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m20:46:16.940185 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:46:16.940531 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m20:46:16.940894 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m20:46:16.941216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:46:16.942265 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:46:16.942613 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.942897 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:46:16.943198 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:46:16.943512 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:46:16.944469 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:46:16.945430 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:46:16.945799 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:46:16.946111 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:46:16.946428 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:46:16.946717 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:46:16.949128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:46:16.950840 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m20:46:16.951134 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:46:16.951479 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m20:46:16.951893 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:46:16.953502 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m20:46:16.955109 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m20:46:16.955447 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m20:46:16.955941 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:46:16.956383 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:46:16.956742 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m20:46:16.957052 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m20:46:16.958572 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:46:16.959564 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m20:46:16.960030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591b45340>]}
[0m20:46:16.960516 [info ] [Thread-1 (]: 33 of 36 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 0[0m in 0.07s]
[0m20:46:16.960938 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:46:16.967121 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m20:46:16.967456 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m20:46:16.968481 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: Close
[0m20:46:16.969463 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: Close
[0m20:46:16.969910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591a83fb0>]}
[0m20:46:16.970308 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad591b9c710>]}
[0m20:46:16.970748 [info ] [Thread-2 (]: 35 of 36 OK created sql table model public.mart_well_performance ............... [[32mSELECT 0[0m in 0.08s]
[0m20:46:16.971238 [info ] [Thread-4 (]: 34 of 36 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 0[0m in 0.08s]
[0m20:46:16.971752 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:46:16.972171 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:46:16.972753 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:46:16.973209 [info ] [Thread-3 (]: 36 of 36 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m20:46:16.973568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:46:16.973847 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:46:16.977509 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:46:17.012265 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.012636 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:46:17.012902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:17.017157 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:46:17.017498 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.017780 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:46:17.022978 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:46:17.053225 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.053680 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp204617052547"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:46:17.055814 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.002 seconds
[0m20:46:17.057981 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.058309 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp204617052547'
        
      order by ordinal_position

  
[0m20:46:17.060587 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:46:17.062823 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.063138 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:46:17.064950 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:46:17.067180 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.067510 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp204617052547'
        
      order by ordinal_position

  
[0m20:46:17.069315 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:46:17.071547 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.071865 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:46:17.073627 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:46:17.079375 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.079700 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp204617052547'
        
      order by ordinal_position

  
[0m20:46:17.081491 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:46:17.094124 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.094532 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:46:17.095216 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:46:17.099110 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.099447 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:46:17.099946 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:46:17.100366 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.100845 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.101196 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp204617052547" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp204617052547" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:46:17.101952 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:46:17.102884 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:46:17.103179 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:46:17.103459 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:46:17.105603 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:46:17.107573 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:46:17.108075 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58c99ec-4eb0-4919-b501-c8ecec7595b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad55afdfc80>]}
[0m20:46:17.108723 [info ] [Thread-3 (]: 36 of 36 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 0[0m in 0.13s]
[0m20:46:17.109191 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:46:17.110490 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:17.110785 [debug] [MainThread]: On master: BEGIN
[0m20:46:17.111037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:17.115024 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:46:17.115346 [debug] [MainThread]: On master: COMMIT
[0m20:46:17.115610 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:17.115850 [debug] [MainThread]: On master: COMMIT
[0m20:46:17.116162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:46:17.116443 [debug] [MainThread]: On master: Close
[0m20:46:17.116812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:17.117060 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m20:46:17.117295 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m20:46:17.117511 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:46:17.117718 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m20:46:17.118066 [info ] [MainThread]: 
[0m20:46:17.118375 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests, 3 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m20:46:17.122192 [debug] [MainThread]: Command end result
[0m20:46:17.147924 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:46:17.149523 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:46:17.155408 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:46:17.155739 [info ] [MainThread]: 
[0m20:46:17.156062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:17.156372 [info ] [MainThread]: 
[0m20:46:17.156657 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=36
[0m20:46:17.158418 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:46:17.159275 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.2550504, "process_in_blocks": "0", "process_kernel_time": 0.336882, "process_mem_max_rss": "140376", "process_out_blocks": "5008", "process_user_time": 4.222591}
[0m20:46:17.159718 [debug] [MainThread]: Command `dbt build` succeeded at 20:46:17.159640 after 3.26 seconds
[0m20:46:17.160026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad596763b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad598f80c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad592d40860>]}
[0m20:46:17.160355 [debug] [MainThread]: Flushing usage events
[0m20:46:17.662062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:29.485059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77fabce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c781a6b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c78107eb40>]}


============================== 20:47:29.489859 | 955d0a3d-4a2f-4b26-b75a-642eaa1461fa ==============================
[0m20:47:29.489859 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:47:29.490301 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/logs/dbt', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ls --resource-type model --profile caspian_vault --target dev'}
[0m20:47:29.534229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:47:29.534698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77ef28470>]}
[0m20:47:29.535128 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:47:29.535453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77f7e3020>]}
[0m20:47:29.654185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77f913b00>]}
[0m20:47:29.711441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c78085aae0>]}
[0m20:47:29.712207 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:47:29.825151 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:47:29.950884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:29.951293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:29.956519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:47:30.007357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77eb168d0>]}
[0m20:47:30.105843 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:47:30.107450 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:47:30.124112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77ef611f0>]}
[0m20:47:30.124551 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:47:30.124862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '955d0a3d-4a2f-4b26-b75a-642eaa1461fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77f8e1e20>]}
[0m20:47:30.125865 [info ] [MainThread]: caspian_vault.marts.dim.dim_source_format
[0m20:47:30.126174 [info ] [MainThread]: caspian_vault.marts.dim.dim_survey_type
[0m20:47:30.126446 [info ] [MainThread]: caspian_vault.marts.dim.dim_time
[0m20:47:30.126685 [info ] [MainThread]: caspian_vault.marts.dim.dim_well
[0m20:47:30.126915 [info ] [MainThread]: caspian_vault.vault.dv_hub_survey_type
[0m20:47:30.127140 [info ] [MainThread]: caspian_vault.vault.dv_hub_well
[0m20:47:30.127381 [info ] [MainThread]: caspian_vault.vault.dv_link_well_survey
[0m20:47:30.127605 [info ] [MainThread]: caspian_vault.vault.dv_sat_readings
[0m20:47:30.127825 [info ] [MainThread]: caspian_vault.marts.fct.fct_readings
[0m20:47:30.128043 [info ] [MainThread]: caspian_vault.marts.mart.mart_sensor_analysis
[0m20:47:30.128272 [info ] [MainThread]: caspian_vault.marts.mart.mart_survey_summary
[0m20:47:30.128494 [info ] [MainThread]: caspian_vault.marts.mart.mart_well_performance
[0m20:47:30.128709 [info ] [MainThread]: caspian_vault._disabled_raw.raw_recovered_1
[0m20:47:30.128928 [info ] [MainThread]: caspian_vault._disabled_raw.raw_recovered_2
[0m20:47:30.129145 [info ] [MainThread]: caspian_vault._disabled_raw.raw_sgx_all
[0m20:47:30.129387 [info ] [MainThread]: caspian_vault.staging.stg_readings
[0m20:47:30.129834 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:47:30.130656 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6875615, "process_in_blocks": "0", "process_kernel_time": 0.237522, "process_mem_max_rss": "119056", "process_out_blocks": "1432", "process_user_time": 1.748484}
[0m20:47:30.131111 [debug] [MainThread]: Command `dbt ls` succeeded at 20:47:30.131029 after 0.69 seconds
[0m20:47:30.131442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c780d9a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c783eb33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c77e7b4ef0>]}
[0m20:47:30.131736 [debug] [MainThread]: Flushing usage events
[0m20:47:30.645698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:58.863724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506184e05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75061770ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506189fcce0>]}


============================== 20:49:58.868532 | 2f3d82e4-1619-4974-a47d-1e5a0da6fde1 ==============================
[0m20:49:58.868532 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:49:58.868960 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt ls --resource-type model --profile caspian_vault --target dev', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/logs/dbt', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True'}
[0m20:49:58.912822 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:49:58.913292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506177de6f0>]}
[0m20:49:58.913714 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:49:58.914023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506173cd1f0>]}
[0m20:49:59.033199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75061757f4a0>]}
[0m20:49:59.091010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75061787b620>]}
[0m20:49:59.091809 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:49:59.204922 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:49:59.330269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:59.330669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:59.335862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:49:59.386570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750616b29790>]}
[0m20:49:59.483580 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:49:59.485182 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:49:59.501807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750616b4e5a0>]}
[0m20:49:59.502232 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:49:59.502561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3d82e4-1619-4974-a47d-1e5a0da6fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750616b793d0>]}
[0m20:49:59.503560 [info ] [MainThread]: caspian_vault.marts.dim.dim_source_format
[0m20:49:59.503864 [info ] [MainThread]: caspian_vault.marts.dim.dim_survey_type
[0m20:49:59.504104 [info ] [MainThread]: caspian_vault.marts.dim.dim_time
[0m20:49:59.504357 [info ] [MainThread]: caspian_vault.marts.dim.dim_well
[0m20:49:59.504587 [info ] [MainThread]: caspian_vault.vault.dv_hub_survey_type
[0m20:49:59.504813 [info ] [MainThread]: caspian_vault.vault.dv_hub_well
[0m20:49:59.505033 [info ] [MainThread]: caspian_vault.vault.dv_link_well_survey
[0m20:49:59.505270 [info ] [MainThread]: caspian_vault.vault.dv_sat_readings
[0m20:49:59.505501 [info ] [MainThread]: caspian_vault.marts.fct.fct_readings
[0m20:49:59.505716 [info ] [MainThread]: caspian_vault.marts.mart.mart_sensor_analysis
[0m20:49:59.505931 [info ] [MainThread]: caspian_vault.marts.mart.mart_survey_summary
[0m20:49:59.506147 [info ] [MainThread]: caspian_vault.marts.mart.mart_well_performance
[0m20:49:59.506393 [info ] [MainThread]: caspian_vault._disabled_raw.raw_recovered_1
[0m20:49:59.506612 [info ] [MainThread]: caspian_vault._disabled_raw.raw_recovered_2
[0m20:49:59.506823 [info ] [MainThread]: caspian_vault._disabled_raw.raw_sgx_all
[0m20:49:59.507033 [info ] [MainThread]: caspian_vault.staging.stg_readings
[0m20:49:59.507488 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:49:59.508314 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6866396, "process_in_blocks": "0", "process_kernel_time": 0.252598, "process_mem_max_rss": "118940", "process_out_blocks": "1432", "process_user_time": 1.730252}
[0m20:49:59.508752 [debug] [MainThread]: Command `dbt ls` succeeded at 20:49:59.508673 after 0.69 seconds
[0m20:49:59.509063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506191b7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506167bd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7506167be630>]}
[0m20:49:59.509393 [debug] [MainThread]: Flushing usage events
[0m20:49:59.974773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:36.100844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f269cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f1a57dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f1c1c8f0>]}


============================== 20:50:36.105742 | f132a10d-10f1-4df3-b0b7-a3da3317f964 ==============================
[0m20:50:36.105742 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:50:36.106189 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/logs/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'introspect': 'True', 'profiles_dir': '/home/airflow/.dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'empty': 'None', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False'}
[0m20:50:36.112470 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:50:36.112829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f132a10d-10f1-4df3-b0b7-a3da3317f964', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f17d7a40>]}
[0m20:50:36.113204 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:50:36.113505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f132a10d-10f1-4df3-b0b7-a3da3317f964', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f17d7a40>]}
[0m20:50:36.215615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f132a10d-10f1-4df3-b0b7-a3da3317f964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f25254f0>]}
[0m20:50:36.227836 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qlhtqew3'
[0m20:50:36.228154 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:50:36.429825 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:50:36.430467 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:50:36.442146 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:50:36.445280 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:50:36.685805 [info ] [MainThread]: Installed from version 1.3.0
[0m20:50:36.686233 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:50:36.686607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f132a10d-10f1-4df3-b0b7-a3da3317f964', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f1648170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f164bb00>]}
[0m20:50:36.686918 [info ] [MainThread]: 
[0m20:50:36.687184 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:50:36.687851 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:50:36.688672 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62955236, "process_in_blocks": "0", "process_kernel_time": 0.220968, "process_mem_max_rss": "107988", "process_out_blocks": "2304", "process_user_time": 1.307816}
[0m20:50:36.689078 [debug] [MainThread]: Command `dbt deps` succeeded at 20:50:36.689003 after 0.63 seconds
[0m20:50:36.689372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f2a32db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f164bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f1648170>]}
[0m20:50:36.689639 [debug] [MainThread]: Flushing usage events
[0m20:50:37.090886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:57.004518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3ba9f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3babd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3ba9da90>]}


============================== 20:50:57.009420 | 2e503337-9cba-40a1-8204-f3e0cb8d70c1 ==============================
[0m20:50:57.009420 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:50:57.009851 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build --profile caspian_vault --target dev --no-partial-parse', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'introspect': 'True', 'log_path': '/opt/airflow/logs/dbt', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:57.053649 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:50:57.054103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3abbdd30>]}
[0m20:50:57.054564 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:50:57.054866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3ab7ab10>]}
[0m20:50:57.173450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3a3882c0>]}
[0m20:50:57.230835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3ba9da00>]}
[0m20:50:57.231627 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:57.344194 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:50:57.344834 [debug] [MainThread]: Partial parsing not enabled
[0m20:50:58.727282 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:50:58.727786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d38126540>]}
[0m20:50:58.932674 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:50:58.941414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d334332c0>]}
[0m20:50:59.099330 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:50:59.100930 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:50:59.129645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d33431f40>]}
[0m20:50:59.130097 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:50:59.133788 [info ] [MainThread]: 
[0m20:50:59.134143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:59.134454 [info ] [MainThread]: 
[0m20:50:59.134892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:59.139053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:50:59.139650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:50:59.173614 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:50:59.173979 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:50:59.174285 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:50:59.174581 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:50:59.174858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:59.175120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:59.180650 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m20:50:59.180947 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m20:50:59.182005 [debug] [ThreadPool]: On list_airflow: Close
[0m20:50:59.182938 [debug] [ThreadPool]: On list_airflow: Close
[0m20:50:59.184879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:50:59.185349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:50:59.189559 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:50:59.190909 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:50:59.191214 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:50:59.191506 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:50:59.191824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:59.192081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:59.195781 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:50:59.196104 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:50:59.196367 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:50:59.196662 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:50:59.196944 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:50:59.197274 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:50:59.199133 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:50:59.199392 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.002 seconds
[0m20:50:59.200337 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:50:59.201790 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:50:59.202155 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:50:59.202403 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:50:59.211679 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.211982 [debug] [MainThread]: On master: BEGIN
[0m20:50:59.212228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:59.215904 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:50:59.216304 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.216624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:59.237126 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m20:50:59.238285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d33438620>]}
[0m20:50:59.238698 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:59.239090 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.239377 [debug] [MainThread]: On master: BEGIN
[0m20:50:59.239775 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:50:59.240051 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.240316 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.240554 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.240871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:59.241129 [debug] [MainThread]: On master: Close
[0m20:50:59.244752 [debug] [Thread-1 (]: Began running node model.caspian_vault.raw_recovered_1
[0m20:50:59.245094 [debug] [Thread-2 (]: Began running node model.caspian_vault.raw_recovered_2
[0m20:50:59.245481 [debug] [Thread-3 (]: Began running node model.caspian_vault.raw_sgx_all
[0m20:50:59.246177 [debug] [Thread-4 (]: Began running node model.caspian_vault.stg_readings
[0m20:50:59.245897 [info ] [Thread-1 (]: 1 of 36 START sql view model public.raw_recovered_1 ............................ [RUN]
[0m20:50:59.246688 [info ] [Thread-2 (]: 2 of 36 START sql view model public.raw_recovered_2 ............................ [RUN]
[0m20:50:59.247119 [info ] [Thread-3 (]: 3 of 36 START sql view model public.raw_sgx_all ................................ [RUN]
[0m20:50:59.247551 [info ] [Thread-4 (]: 4 of 36 START sql table model public.stg_readings .............................. [RUN]
[0m20:50:59.247945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.raw_recovered_1)
[0m20:50:59.248313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.raw_recovered_2)
[0m20:50:59.248716 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.caspian_vault.raw_sgx_all'
[0m20:50:59.249104 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.caspian_vault.stg_readings'
[0m20:50:59.249429 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.raw_recovered_1
[0m20:50:59.249743 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.raw_recovered_2
[0m20:50:59.250036 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.raw_sgx_all
[0m20:50:59.250331 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:50:59.255496 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_1"
[0m20:50:59.257382 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_2"
[0m20:50:59.259272 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.raw_sgx_all"
[0m20:50:59.261994 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:50:59.263085 [debug] [Thread-2 (]: Began executing node model.caspian_vault.raw_recovered_2
[0m20:50:59.263417 [debug] [Thread-3 (]: Began executing node model.caspian_vault.raw_sgx_all
[0m20:50:59.263756 [debug] [Thread-4 (]: Began executing node model.caspian_vault.stg_readings
[0m20:50:59.269158 [debug] [Thread-1 (]: Began executing node model.caspian_vault.raw_recovered_1
[0m20:50:59.299149 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_2"
[0m20:50:59.302027 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.raw_sgx_all"
[0m20:50:59.320467 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_1"
[0m20:50:59.320902 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:50:59.321889 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:50:59.322361 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:50:59.322715 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:50:59.323045 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: BEGIN
[0m20:50:59.323383 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: BEGIN
[0m20:50:59.323711 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: BEGIN
[0m20:50:59.324083 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:50:59.324387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:59.324681 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:59.324966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:59.325281 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:50:59.325916 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:59.329863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:50:59.330182 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:50:59.330595 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:50:59.330902 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:50:59.331255 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m20:50:59.331553 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:50:59.331887 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */

  create view "airflow"."public"."raw_recovered_1__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:50:59.332213 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:50:59.332539 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:50:59.332856 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */

  create view "airflow"."public"."raw_recovered_2__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:50:59.333295 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:50:59.333672 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */

  create view "airflow"."public"."raw_sgx_all__dbt_tmp"
    
    
  as (
    

-- TEMP: SGX source not available yet.
-- Keeps downstream models working by providing correct schema with no rows.
select
  cast(null as bigint) as well_id,
  cast(null as bigint) as survey_type_id,
  cast(null as double precision) as depth_ft,
  cast(null as double precision) as amplitude,
  cast(null as int) as quality_flag,
  cast(null as varchar) as source_file
where 1=0
  );
[0m20:50:59.334180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:50:59.334543 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.raw_sgx_all" does not exist
LINE 23:     from "airflow"."public"."raw_sgx_all"
                  ^

[0m20:50:59.339183 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:50:59.339514 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:50:59.339802 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:50:59.340125 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: ROLLBACK
[0m20:50:59.340452 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1__dbt_tmp" rename to "raw_recovered_1"
[0m20:50:59.342556 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:50:59.344597 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:50:59.345850 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: Close
[0m20:50:59.346158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:50:59.346468 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2__dbt_tmp" rename to "raw_recovered_2"
[0m20:50:59.346791 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all__dbt_tmp" rename to "raw_sgx_all"
[0m20:50:59.358062 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:50:59.358550 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:50:59.359823 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:50:59.360130 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:50:59.360492 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:50:59.360869 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:50:59.361893 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:50:59.362228 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:50:59.362689 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:50:59.363112 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:50:59.363725 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:50:59.364976 [debug] [Thread-4 (]: Database Error in model stg_readings (models/staging/stg_readings.sql)
  relation "public.raw_sgx_all" does not exist
  LINE 23:     from "airflow"."public"."raw_sgx_all"
                    ^
  compiled code at /opt/airflow/dbt_target/run/caspian_vault/models/staging/stg_readings.sql
[0m20:50:59.366312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d33438830>]}
[0m20:50:59.366826 [error] [Thread-4 (]: 4 of 36 ERROR creating sql table model public.stg_readings ..................... [[31mERROR[0m in 0.12s]
[0m20:50:59.367296 [debug] [Thread-4 (]: Finished running node model.caspian_vault.stg_readings
[0m20:50:59.367753 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.stg_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_readings (models/staging/stg_readings.sql)
  relation "public.raw_sgx_all" does not exist
  LINE 23:     from "airflow"."public"."raw_sgx_all"
                    ^
  compiled code at /opt/airflow/dbt_target/run/caspian_vault/models/staging/stg_readings.sql.
[0m20:50:59.368064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:50:59.373330 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."raw_recovered_1__dbt_backup"
[0m20:50:59.373694 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:50:59.373994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m20:50:59.374310 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m20:50:59.378448 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:50:59.378837 [info ] [Thread-4 (]: 5 of 36 SKIP test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[33mSKIP[0m]
[0m20:50:59.380555 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."raw_recovered_2__dbt_backup"
[0m20:50:59.382211 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."raw_sgx_all__dbt_backup"
[0m20:50:59.382574 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
drop view if exists "airflow"."public"."raw_recovered_1__dbt_backup" cascade
[0m20:50:59.382926 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:50:59.383379 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:50:59.383820 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:50:59.384209 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:50:59.384571 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:50:59.384871 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
drop view if exists "airflow"."public"."raw_recovered_2__dbt_backup" cascade
[0m20:50:59.385142 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969' to be skipped because of status 'skipped'. 
[0m20:50:59.385521 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
drop view if exists "airflow"."public"."raw_sgx_all__dbt_backup" cascade
[0m20:50:59.385874 [info ] [Thread-4 (]: 6 of 36 SKIP test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [[33mSKIP[0m]
[0m20:50:59.387688 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: Close
[0m20:50:59.388197 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:50:59.388572 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:50:59.388884 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:50:59.389897 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: Close
[0m20:50:59.390291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3d7cac60>]}
[0m20:50:59.390624 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd' to be skipped because of status 'skipped'. 
[0m20:50:59.391646 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: Close
[0m20:50:59.392558 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d32103680>]}
[0m20:50:59.392178 [info ] [Thread-1 (]: 1 of 36 OK created sql view model public.raw_recovered_1 ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:50:59.393259 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:50:59.394048 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e503337-9cba-40a1-8204-f3e0cb8d70c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d321823c0>]}
[0m20:50:59.393724 [info ] [Thread-2 (]: 2 of 36 OK created sql view model public.raw_recovered_2 ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:50:59.394605 [debug] [Thread-1 (]: Finished running node model.caspian_vault.raw_recovered_1
[0m20:50:59.394933 [info ] [Thread-4 (]: 7 of 36 SKIP relation public.dv_hub_survey_type ................................ [[33mSKIP[0m]
[0m20:50:59.395424 [info ] [Thread-3 (]: 3 of 36 OK created sql view model public.raw_sgx_all ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:50:59.395887 [debug] [Thread-2 (]: Finished running node model.caspian_vault.raw_recovered_2
[0m20:50:59.396219 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:50:59.396596 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:50:59.397005 [debug] [Thread-3 (]: Finished running node model.caspian_vault.raw_sgx_all
[0m20:50:59.397333 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:50:59.397676 [info ] [Thread-1 (]: 8 of 36 SKIP relation public.dv_hub_well ....................................... [[33mSKIP[0m]
[0m20:50:59.398030 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:50:59.398316 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dv_hub_survey_type' to be skipped because of status 'skipped'. 
[0m20:50:59.398665 [info ] [Thread-2 (]: 9 of 36 SKIP relation public.dv_link_well_survey ............................... [[33mSKIP[0m]
[0m20:50:59.399003 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:50:59.399323 [info ] [Thread-4 (]: 10 of 36 SKIP relation public.dv_sat_readings .................................. [[33mSKIP[0m]
[0m20:50:59.399883 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:50:59.400187 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:50:59.400522 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:50:59.400784 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dv_hub_well' to be skipped because of status 'skipped'. 
[0m20:50:59.401104 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:50:59.401434 [info ] [Thread-3 (]: 11 of 36 SKIP test not_null_dv_hub_survey_type_hk_survey_type .................. [[33mSKIP[0m]
[0m20:50:59.401788 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:50:59.402102 [info ] [Thread-1 (]: 12 of 36 SKIP test not_null_dv_hub_survey_type_survey_type_bk .................. [[33mSKIP[0m]
[0m20:50:59.402497 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dv_link_well_survey' to be skipped because of status 'skipped'. 
[0m20:50:59.402908 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:50:59.403239 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:50:59.403586 [info ] [Thread-2 (]: 13 of 36 SKIP test unique_dv_hub_survey_type_hk_survey_type .................... [[33mSKIP[0m]
[0m20:50:59.403920 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:50:59.404284 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dv_sat_readings' to be skipped because of status 'skipped'. 
[0m20:50:59.404718 [info ] [Thread-4 (]: 14 of 36 SKIP test not_null_dv_hub_well_hk_well ................................ [[33mSKIP[0m]
[0m20:50:59.405074 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:50:59.405399 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:50:59.405707 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:50:59.406033 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033' to be skipped because of status 'skipped'. 
[0m20:50:59.406451 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:50:59.406762 [info ] [Thread-3 (]: 15 of 36 SKIP test not_null_dv_hub_well_well_id_bk ............................. [[33mSKIP[0m]
[0m20:50:59.407104 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:50:59.407423 [info ] [Thread-1 (]: 16 of 36 SKIP test unique_dv_hub_well_hk_well .................................. [[33mSKIP[0m]
[0m20:50:59.407759 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007' to be skipped because of status 'skipped'. 
[0m20:50:59.408091 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:50:59.408411 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:50:59.408722 [info ] [Thread-2 (]: 17 of 36 SKIP test not_null_dv_link_well_survey_hk_survey_type ................. [[33mSKIP[0m]
[0m20:50:59.409046 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:50:59.409358 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d' to be skipped because of status 'skipped'. 
[0m20:50:59.409682 [info ] [Thread-4 (]: 18 of 36 SKIP test not_null_dv_link_well_survey_hk_well ........................ [[33mSKIP[0m]
[0m20:50:59.410043 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:50:59.410366 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:50:59.410676 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:50:59.410978 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743' to be skipped because of status 'skipped'. 
[0m20:50:59.411348 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:50:59.411658 [info ] [Thread-3 (]: 19 of 36 SKIP test not_null_dv_link_well_survey_hk_well_survey ................. [[33mSKIP[0m]
[0m20:50:59.412002 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:50:59.412323 [info ] [Thread-1 (]: 20 of 36 SKIP test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[33mSKIP[0m]
[0m20:50:59.412667 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7' to be skipped because of status 'skipped'. 
[0m20:50:59.412992 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:50:59.413303 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:50:59.413616 [info ] [Thread-2 (]: 21 of 36 SKIP test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[33mSKIP[0m]
[0m20:50:59.413945 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:50:59.414235 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc' to be skipped because of status 'skipped'. 
[0m20:50:59.414574 [info ] [Thread-4 (]: 22 of 36 SKIP test unique_dv_link_well_survey_hk_well_survey ................... [[33mSKIP[0m]
[0m20:50:59.414907 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:50:59.415207 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:50:59.415525 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:50:59.415819 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652' to be skipped because of status 'skipped'. 
[0m20:50:59.416170 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:50:59.416487 [info ] [Thread-3 (]: 23 of 36 SKIP test not_null_dv_sat_readings_hk_well_survey ..................... [[33mSKIP[0m]
[0m20:50:59.416820 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:50:59.417115 [info ] [Thread-1 (]: 24 of 36 SKIP test not_null_dv_sat_readings_load_ts ............................ [[33mSKIP[0m]
[0m20:50:59.417459 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b' to be skipped because of status 'skipped'. 
[0m20:50:59.417773 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:50:59.418065 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:50:59.418376 [info ] [Thread-2 (]: 25 of 36 SKIP test not_null_dv_sat_readings_row_checksum ....................... [[33mSKIP[0m]
[0m20:50:59.418700 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:50:59.418994 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6' to be skipped because of status 'skipped'. 
[0m20:50:59.419320 [info ] [Thread-4 (]: 26 of 36 SKIP test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[33mSKIP[0m]
[0m20:50:59.419686 [debug] [Thread-3 (]: Began running node test.caspian_vault.test_counts_match
[0m20:50:59.419999 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:50:59.420319 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:50:59.420619 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4' to be skipped because of status 'skipped'. 
[0m20:50:59.420934 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:50:59.421263 [info ] [Thread-3 (]: 27 of 36 SKIP test test_counts_match ........................................... [[33mSKIP[0m]
[0m20:50:59.421606 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_well
[0m20:50:59.421906 [info ] [Thread-1 (]: 28 of 36 SKIP relation public.dim_survey_type .................................. [[33mSKIP[0m]
[0m20:50:59.422262 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685' to be skipped because of status 'skipped'. 
[0m20:50:59.422658 [debug] [Thread-3 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:50:59.422962 [info ] [Thread-2 (]: 29 of 36 SKIP relation public.dim_well ......................................... [[33mSKIP[0m]
[0m20:50:59.423302 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:50:59.423589 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb' to be skipped because of status 'skipped'. 
[0m20:50:59.423963 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_well
[0m20:50:59.424319 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688' to be skipped because of status 'skipped'. 
[0m20:50:59.424665 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09' to be skipped because of status 'skipped'. 
[0m20:50:59.424935 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b' to be skipped because of status 'skipped'. 
[0m20:50:59.425187 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e' to be skipped because of status 'skipped'. 
[0m20:50:59.425463 [debug] [Thread-7 (]: Marking all children of 'test.caspian_vault.test_counts_match' to be skipped because of status 'skipped'. 
[0m20:50:59.425732 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dim_survey_type' to be skipped because of status 'skipped'. 
[0m20:50:59.425990 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dim_well' to be skipped because of status 'skipped'. 
[0m20:50:59.426393 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_source_format
[0m20:50:59.426678 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_time
[0m20:50:59.427004 [info ] [Thread-4 (]: 30 of 36 SKIP relation public.dim_source_format ................................ [[33mSKIP[0m]
[0m20:50:59.427317 [debug] [Thread-1 (]: Began running node model.caspian_vault.fct_readings
[0m20:50:59.427629 [info ] [Thread-3 (]: 31 of 36 SKIP relation public.dim_time ......................................... [[33mSKIP[0m]
[0m20:50:59.427962 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:50:59.428277 [info ] [Thread-1 (]: 32 of 36 SKIP relation public.fct_readings ..................................... [[33mSKIP[0m]
[0m20:50:59.428610 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_time
[0m20:50:59.428904 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dim_source_format' to be skipped because of status 'skipped'. 
[0m20:50:59.429218 [debug] [Thread-1 (]: Finished running node model.caspian_vault.fct_readings
[0m20:50:59.429578 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.dim_time' to be skipped because of status 'skipped'. 
[0m20:50:59.429922 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.fct_readings' to be skipped because of status 'skipped'. 
[0m20:50:59.430494 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:50:59.430773 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:50:59.431093 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:50:59.431386 [info ] [Thread-2 (]: 33 of 36 SKIP relation public.mart_sensor_analysis ............................. [[33mSKIP[0m]
[0m20:50:59.431735 [info ] [Thread-4 (]: 34 of 36 SKIP relation public.mart_survey_summary .............................. [[33mSKIP[0m]
[0m20:50:59.432091 [info ] [Thread-3 (]: 35 of 36 SKIP relation public.mart_well_performance ............................ [[33mSKIP[0m]
[0m20:50:59.432454 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:50:59.432761 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:50:59.433073 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:50:59.433375 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.mart_sensor_analysis' to be skipped because of status 'skipped'. 
[0m20:50:59.433790 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.mart_survey_summary' to be skipped because of status 'skipped'. 
[0m20:50:59.434070 [debug] [Thread-7 (]: Marking all children of 'model.caspian_vault.mart_well_performance' to be skipped because of status 'skipped'. 
[0m20:50:59.434564 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:50:59.434938 [info ] [Thread-1 (]: 36 of 36 SKIP relation snapshots.snap_mart_well_performance .................... [[33mSKIP[0m]
[0m20:50:59.435272 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:50:59.435544 [debug] [Thread-7 (]: Marking all children of 'snapshot.caspian_vault.snap_mart_well_performance' to be skipped because of status 'skipped'. 
[0m20:50:59.436621 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.436927 [debug] [MainThread]: On master: BEGIN
[0m20:50:59.437191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:59.441383 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:50:59.441682 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.441942 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.442185 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.442521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:59.442786 [debug] [MainThread]: On master: Close
[0m20:50:59.443140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:59.443401 [debug] [MainThread]: Connection 'model.caspian_vault.raw_recovered_2' was properly closed.
[0m20:50:59.443619 [debug] [MainThread]: Connection 'model.caspian_vault.raw_recovered_1' was properly closed.
[0m20:50:59.443824 [debug] [MainThread]: Connection 'model.caspian_vault.raw_sgx_all' was properly closed.
[0m20:50:59.444029 [debug] [MainThread]: Connection 'model.caspian_vault.stg_readings' was properly closed.
[0m20:50:59.444386 [info ] [MainThread]: 
[0m20:50:59.444673 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests, 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:50:59.446129 [debug] [MainThread]: Command end result
[0m20:50:59.472011 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:50:59.473503 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:50:59.478786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:50:59.479091 [info ] [MainThread]: 
[0m20:50:59.479433 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:59.479720 [info ] [MainThread]: 
[0m20:50:59.480038 [error] [MainThread]: [31mFailure in model stg_readings (models/staging/stg_readings.sql)[0m
[0m20:50:59.480362 [error] [MainThread]:   Database Error in model stg_readings (models/staging/stg_readings.sql)
  relation "public.raw_sgx_all" does not exist
  LINE 23:     from "airflow"."public"."raw_sgx_all"
                    ^
  compiled code at /opt/airflow/dbt_target/run/caspian_vault/models/staging/stg_readings.sql
[0m20:50:59.480606 [info ] [MainThread]: 
[0m20:50:59.480893 [info ] [MainThread]:   compiled code at /opt/airflow/dbt_target/compiled/caspian_vault/models/staging/stg_readings.sql
[0m20:50:59.481144 [info ] [MainThread]: 
[0m20:50:59.481437 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=32 NO-OP=0 TOTAL=36
[0m20:50:59.481964 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:50:59.482803 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5202107, "process_in_blocks": "0", "process_kernel_time": 0.339124, "process_mem_max_rss": "138232", "process_out_blocks": "4216", "process_user_time": 3.491989}
[0m20:50:59.483235 [debug] [MainThread]: Command `dbt build` failed at 20:50:59.483156 after 2.52 seconds
[0m20:50:59.483585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3f3e2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d3af36fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728d335dfcb0>]}
[0m20:50:59.483898 [debug] [MainThread]: Flushing usage events
[0m20:50:59.987881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:07.481685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708251f53e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70825186b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708251868c80>]}


============================== 20:52:07.486499 | 2560c427-20ed-4eae-b340-514fe82916dd ==============================
[0m20:52:07.486499 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:52:07.486929 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/logs/dbt', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ls --resource-type model --profile caspian_vault --target dev', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'empty': 'None', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager'}
[0m20:52:07.530861 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:52:07.531342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708250a9b1a0>]}
[0m20:52:07.531764 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:52:07.532074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70825169f0e0>]}
[0m20:52:07.651043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708250192e70>]}
[0m20:52:07.709141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708250972c60>]}
[0m20:52:07.709949 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:52:07.821239 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:52:07.947228 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m20:52:07.947830 [debug] [MainThread]: Partial parsing: added file: caspian_vault://models/__disabled_raw/raw_recovered_2.sql
[0m20:52:07.948136 [debug] [MainThread]: Partial parsing: added file: caspian_vault://models/__disabled_raw/raw_sgx_all.sql
[0m20:52:07.948430 [debug] [MainThread]: Partial parsing: added file: caspian_vault://models/__disabled_raw/raw_recovered_1.sql
[0m20:52:07.948671 [debug] [MainThread]: Partial parsing: deleted file: caspian_vault://models/_disabled_raw/raw_recovered_1.sql
[0m20:52:07.948913 [debug] [MainThread]: Partial parsing: deleted file: caspian_vault://models/_disabled_raw/raw_recovered_2.sql
[0m20:52:07.949144 [debug] [MainThread]: Partial parsing: deleted file: caspian_vault://models/_disabled_raw/raw_sgx_all.sql
[0m20:52:08.194687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:52:08.206697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70824f187050>]}
[0m20:52:08.302517 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:52:08.304132 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:52:08.321077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70824e993ce0>]}
[0m20:52:08.321520 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:52:08.321838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2560c427-20ed-4eae-b340-514fe82916dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70824ed8f770>]}
[0m20:52:08.322846 [info ] [MainThread]: caspian_vault.marts.dim.dim_source_format
[0m20:52:08.323164 [info ] [MainThread]: caspian_vault.marts.dim.dim_survey_type
[0m20:52:08.323440 [info ] [MainThread]: caspian_vault.marts.dim.dim_time
[0m20:52:08.323676 [info ] [MainThread]: caspian_vault.marts.dim.dim_well
[0m20:52:08.323902 [info ] [MainThread]: caspian_vault.vault.dv_hub_survey_type
[0m20:52:08.324123 [info ] [MainThread]: caspian_vault.vault.dv_hub_well
[0m20:52:08.324368 [info ] [MainThread]: caspian_vault.vault.dv_link_well_survey
[0m20:52:08.324590 [info ] [MainThread]: caspian_vault.vault.dv_sat_readings
[0m20:52:08.324807 [info ] [MainThread]: caspian_vault.marts.fct.fct_readings
[0m20:52:08.325024 [info ] [MainThread]: caspian_vault.marts.mart.mart_sensor_analysis
[0m20:52:08.325241 [info ] [MainThread]: caspian_vault.marts.mart.mart_survey_summary
[0m20:52:08.325475 [info ] [MainThread]: caspian_vault.marts.mart.mart_well_performance
[0m20:52:08.325690 [info ] [MainThread]: caspian_vault.__disabled_raw.raw_recovered_1
[0m20:52:08.325905 [info ] [MainThread]: caspian_vault.__disabled_raw.raw_recovered_2
[0m20:52:08.326118 [info ] [MainThread]: caspian_vault.__disabled_raw.raw_sgx_all
[0m20:52:08.326349 [info ] [MainThread]: caspian_vault.staging.stg_readings
[0m20:52:08.326799 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:52:08.327640 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.88782007, "process_in_blocks": "0", "process_kernel_time": 0.281808, "process_mem_max_rss": "122128", "process_out_blocks": "2720", "process_user_time": 1.902705}
[0m20:52:08.328084 [debug] [MainThread]: Command `dbt ls` succeeded at 20:52:08.328003 after 0.89 seconds
[0m20:52:08.328430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708250a17740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70824e9d5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70824e9d7890>]}
[0m20:52:08.328728 [debug] [MainThread]: Flushing usage events
[0m20:52:08.877478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:38.563540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09bdfebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09bfa2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09bfa06e0>]}


============================== 20:53:38.568384 | d1356a46-4ec3-49db-802c-bd6552243cc2 ==============================
[0m20:53:38.568384 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:53:38.568814 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/logs/dbt', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'False', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type model --profile caspian_vault --target dev --no-partial-parse', 'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/home/airflow/.dbt'}
[0m20:53:38.612680 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:53:38.613139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09aa0b110>]}
[0m20:53:38.613579 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:53:38.613882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09aa0a030>]}
[0m20:53:38.732466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09a945e20>]}
[0m20:53:38.789766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09a15af90>]}
[0m20:53:38.790582 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:53:38.902934 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:53:38.903590 [debug] [MainThread]: Partial parsing not enabled
[0m20:53:40.277545 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:53:40.278052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f099d301a0>]}
[0m20:53:40.482436 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:53:40.491096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09732e1e0>]}
[0m20:53:40.647939 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:53:40.649535 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:53:40.666140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09732c6e0>]}
[0m20:53:40.666598 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:53:40.666916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1356a46-4ec3-49db-802c-bd6552243cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f0973c5b80>]}
[0m20:53:40.667910 [info ] [MainThread]: caspian_vault.marts.dim.dim_source_format
[0m20:53:40.668218 [info ] [MainThread]: caspian_vault.marts.dim.dim_survey_type
[0m20:53:40.668495 [info ] [MainThread]: caspian_vault.marts.dim.dim_time
[0m20:53:40.668750 [info ] [MainThread]: caspian_vault.marts.dim.dim_well
[0m20:53:40.668980 [info ] [MainThread]: caspian_vault.vault.dv_hub_survey_type
[0m20:53:40.669203 [info ] [MainThread]: caspian_vault.vault.dv_hub_well
[0m20:53:40.669448 [info ] [MainThread]: caspian_vault.vault.dv_link_well_survey
[0m20:53:40.669670 [info ] [MainThread]: caspian_vault.vault.dv_sat_readings
[0m20:53:40.669888 [info ] [MainThread]: caspian_vault.marts.fct.fct_readings
[0m20:53:40.670105 [info ] [MainThread]: caspian_vault.marts.mart.mart_sensor_analysis
[0m20:53:40.670340 [info ] [MainThread]: caspian_vault.marts.mart.mart_survey_summary
[0m20:53:40.670559 [info ] [MainThread]: caspian_vault.marts.mart.mart_well_performance
[0m20:53:40.670774 [info ] [MainThread]: caspian_vault.__disabled_raw.raw_recovered_1
[0m20:53:40.670989 [info ] [MainThread]: caspian_vault.__disabled_raw.raw_recovered_2
[0m20:53:40.671203 [info ] [MainThread]: caspian_vault.__disabled_raw.raw_sgx_all
[0m20:53:40.671439 [info ] [MainThread]: caspian_vault.staging.stg_readings
[0m20:53:40.671953 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:53:40.672801 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.1512816, "process_in_blocks": "0", "process_kernel_time": 0.270992, "process_mem_max_rss": "126996", "process_out_blocks": "2696", "process_user_time": 3.182912}
[0m20:53:40.673241 [debug] [MainThread]: Command `dbt ls` succeeded at 20:53:40.673159 after 2.15 seconds
[0m20:53:40.673593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09b98b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f0973c5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f09732e0c0>]}
[0m20:53:40.673887 [debug] [MainThread]: Flushing usage events
[0m20:53:41.176844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:51.918355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f385beef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f385bef020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3854b56a0>]}


============================== 20:54:51.923188 | 161fd8b0-94c9-46fc-a3ab-047168f9b720 ==============================
[0m20:54:51.923188 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:54:51.923630 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'empty': 'None', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/logs/dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt ls --resource-type model --profile caspian_vault --target dev --no-partial-parse', 'partial_parse': 'False', 'introspect': 'True', 'fail_fast': 'False'}
[0m20:54:51.967665 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:54:51.968121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f38470ec90>]}
[0m20:54:51.968558 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:54:51.968866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3845361e0>]}
[0m20:54:52.087938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f383d12480>]}
[0m20:54:52.145766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f385add7f0>]}
[0m20:54:52.146563 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:52.259974 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:54:52.260626 [debug] [MainThread]: Partial parsing not enabled
[0m20:54:53.649236 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:54:53.649780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3813dacf0>]}
[0m20:54:53.857788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:54:53.866574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f38120d220>]}
[0m20:54:54.025631 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:54:54.027285 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:54:54.044150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3811c45c0>]}
[0m20:54:54.044604 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:54:54.044914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161fd8b0-94c9-46fc-a3ab-047168f9b720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f38110fce0>]}
[0m20:54:54.045917 [info ] [MainThread]: caspian_vault.marts.dim.dim_source_format
[0m20:54:54.046232 [info ] [MainThread]: caspian_vault.marts.dim.dim_survey_type
[0m20:54:54.046507 [info ] [MainThread]: caspian_vault.marts.dim.dim_time
[0m20:54:54.046754 [info ] [MainThread]: caspian_vault.marts.dim.dim_well
[0m20:54:54.046984 [info ] [MainThread]: caspian_vault.vault.dv_hub_survey_type
[0m20:54:54.047209 [info ] [MainThread]: caspian_vault.vault.dv_hub_well
[0m20:54:54.047453 [info ] [MainThread]: caspian_vault.vault.dv_link_well_survey
[0m20:54:54.047670 [info ] [MainThread]: caspian_vault.vault.dv_sat_readings
[0m20:54:54.047885 [info ] [MainThread]: caspian_vault.marts.fct.fct_readings
[0m20:54:54.048099 [info ] [MainThread]: caspian_vault.marts.mart.mart_sensor_analysis
[0m20:54:54.048336 [info ] [MainThread]: caspian_vault.marts.mart.mart_survey_summary
[0m20:54:54.048556 [info ] [MainThread]: caspian_vault.marts.mart.mart_well_performance
[0m20:54:54.048772 [info ] [MainThread]: caspian_vault._trash_disabled_raw.raw_recovered_1
[0m20:54:54.048986 [info ] [MainThread]: caspian_vault._trash_disabled_raw.raw_recovered_2
[0m20:54:54.049199 [info ] [MainThread]: caspian_vault._trash_disabled_raw.raw_sgx_all
[0m20:54:54.049430 [info ] [MainThread]: caspian_vault.staging.stg_readings
[0m20:54:54.049945 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:54:54.050800 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.1746895, "process_in_blocks": "0", "process_kernel_time": 0.284394, "process_mem_max_rss": "127224", "process_out_blocks": "2696", "process_user_time": 3.19919}
[0m20:54:54.051239 [debug] [MainThread]: Command `dbt ls` succeeded at 20:54:54.051159 after 2.18 seconds
[0m20:54:54.051571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3811cfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f388e4aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f388e4b020>]}
[0m20:54:54.051863 [debug] [MainThread]: Flushing usage events
[0m20:54:54.495013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:56.049057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce9b22e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce9c6981a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce9a7e5b20>]}


============================== 20:54:56.053942 | a804426b-b276-4707-90e1-1677e8e86148 ==============================
[0m20:54:56.053942 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:54:56.054384 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/airflow/.dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'log_format': 'default', 'log_path': '/opt/airflow/logs/dbt', 'static_parser': 'True'}
[0m20:54:56.060573 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:54:56.060943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a804426b-b276-4707-90e1-1677e8e86148', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce99971c40>]}
[0m20:54:56.061338 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:54:56.061623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a804426b-b276-4707-90e1-1677e8e86148', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce99971c40>]}
[0m20:54:56.163629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a804426b-b276-4707-90e1-1677e8e86148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce99972390>]}
[0m20:54:56.175679 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z2rd2gj1'
[0m20:54:56.175997 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:54:56.295344 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:54:56.295995 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:54:56.328944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:54:56.332127 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:54:56.584195 [info ] [MainThread]: Installed from version 1.3.0
[0m20:54:56.584683 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:54:56.585006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a804426b-b276-4707-90e1-1677e8e86148', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce998aff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce9999b710>]}
[0m20:54:56.585333 [info ] [MainThread]: 
[0m20:54:56.585603 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:54:56.586269 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:54:56.587085 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57992136, "process_in_blocks": "0", "process_kernel_time": 0.20704, "process_mem_max_rss": "108264", "process_out_blocks": "2296", "process_user_time": 1.306256}
[0m20:54:56.587510 [debug] [MainThread]: Command `dbt deps` succeeded at 20:54:56.587432 after 0.58 seconds
[0m20:54:56.587780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce99a3a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce999714c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ce99972390>]}
[0m20:54:56.588041 [debug] [MainThread]: Flushing usage events
[0m20:54:57.011037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:58.526763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51f75bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51f604cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51f6070e0>]}


============================== 20:54:58.531693 | 6837193c-e797-42e0-826f-f65b8c39f092 ==============================
[0m20:54:58.531693 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:54:58.532131 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'profiles_dir': '/home/airflow/.dbt', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'False', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profile caspian_vault --target dev --no-partial-parse', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/logs/dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m20:54:58.576122 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:54:58.576599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51e8fecc0>]}
[0m20:54:58.577026 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:54:58.577354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51e82bf80>]}
[0m20:54:58.697376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c521512ed0>]}
[0m20:54:58.755106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51e97f800>]}
[0m20:54:58.755905 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:58.869331 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:54:58.869957 [debug] [MainThread]: Partial parsing not enabled
[0m20:55:00.275198 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:55:00.275734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5133de7e0>]}
[0m20:55:00.483651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:55:00.492450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5132f6d50>]}
[0m20:55:00.650805 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:55:00.652418 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:55:00.681165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51314ddc0>]}
[0m20:55:00.681629 [info ] [MainThread]: Found 16 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:55:00.685369 [info ] [MainThread]: 
[0m20:55:00.685724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:55:00.686007 [info ] [MainThread]: 
[0m20:55:00.686462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:00.690684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:55:00.691313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:55:00.725293 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:55:00.725640 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:55:00.725955 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:55:00.726267 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:55:00.726547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:00.726804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:00.732169 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m20:55:00.732477 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m20:55:00.733476 [debug] [ThreadPool]: On list_airflow: Close
[0m20:55:00.734439 [debug] [ThreadPool]: On list_airflow: Close
[0m20:55:00.736425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:55:00.736888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:55:00.741226 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:55:00.742583 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:55:00.742886 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:55:00.743159 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:55:00.743498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:00.743755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:00.747382 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:55:00.747702 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:55:00.747953 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:55:00.748259 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:55:00.748544 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:55:00.748884 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:55:00.750796 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:55:00.751049 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:55:00.752620 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:55:00.753541 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:55:00.753910 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:55:00.754144 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:55:00.764127 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:00.764452 [debug] [MainThread]: On master: BEGIN
[0m20:55:00.764702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:00.768377 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:55:00.768682 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:00.768992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:00.791220 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:55:00.792392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51321f080>]}
[0m20:55:00.792807 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:00.793199 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:00.793486 [debug] [MainThread]: On master: BEGIN
[0m20:55:00.793890 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:55:00.794177 [debug] [MainThread]: On master: COMMIT
[0m20:55:00.794449 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:00.794681 [debug] [MainThread]: On master: COMMIT
[0m20:55:00.794998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:55:00.795285 [debug] [MainThread]: On master: Close
[0m20:55:00.798843 [debug] [Thread-1 (]: Began running node model.caspian_vault.raw_recovered_1
[0m20:55:00.799192 [debug] [Thread-2 (]: Began running node model.caspian_vault.raw_recovered_2
[0m20:55:00.799583 [debug] [Thread-3 (]: Began running node model.caspian_vault.raw_sgx_all
[0m20:55:00.800294 [debug] [Thread-4 (]: Began running node model.caspian_vault.stg_readings
[0m20:55:00.799997 [info ] [Thread-1 (]: 1 of 36 START sql view model public.raw_recovered_1 ............................ [RUN]
[0m20:55:00.800823 [info ] [Thread-2 (]: 2 of 36 START sql view model public.raw_recovered_2 ............................ [RUN]
[0m20:55:00.801277 [info ] [Thread-3 (]: 3 of 36 START sql view model public.raw_sgx_all ................................ [RUN]
[0m20:55:00.801713 [info ] [Thread-4 (]: 4 of 36 START sql table model public.stg_readings .............................. [RUN]
[0m20:55:00.802200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.raw_recovered_1)
[0m20:55:00.802554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.raw_recovered_2)
[0m20:55:00.802950 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.caspian_vault.raw_sgx_all'
[0m20:55:00.803348 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.caspian_vault.stg_readings'
[0m20:55:00.803662 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.raw_recovered_1
[0m20:55:00.803967 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.raw_recovered_2
[0m20:55:00.804277 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.raw_sgx_all
[0m20:55:00.804594 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:55:00.809663 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_1"
[0m20:55:00.811514 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.raw_recovered_2"
[0m20:55:00.813388 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.raw_sgx_all"
[0m20:55:00.816106 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:55:00.817125 [debug] [Thread-2 (]: Began executing node model.caspian_vault.raw_recovered_2
[0m20:55:00.817576 [debug] [Thread-4 (]: Began executing node model.caspian_vault.stg_readings
[0m20:55:00.822988 [debug] [Thread-1 (]: Began executing node model.caspian_vault.raw_recovered_1
[0m20:55:00.838652 [debug] [Thread-3 (]: Began executing node model.caspian_vault.raw_sgx_all
[0m20:55:00.859845 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_2"
[0m20:55:00.864365 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:55:00.867085 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.raw_recovered_1"
[0m20:55:00.869779 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.raw_sgx_all"
[0m20:55:00.870994 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:55:00.871357 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:55:00.871740 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:55:00.872076 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: BEGIN
[0m20:55:00.872413 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:55:00.872747 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: BEGIN
[0m20:55:00.873058 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:55:00.873370 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:55:00.873673 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: BEGIN
[0m20:55:00.873965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:00.874267 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:55:00.874684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:00.878768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:00.879095 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:00.879509 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:55:00.879851 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:00.880211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:00.880533 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:55:00.880856 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */

  create view "airflow"."public"."raw_sgx_all__dbt_tmp"
    
    
  as (
    

-- TEMP: SGX source not available yet.
-- Keeps downstream models working by providing correct schema with no rows.
select
  cast(null as bigint) as well_id,
  cast(null as bigint) as survey_type_id,
  cast(null as double precision) as depth_ft,
  cast(null as double precision) as amplitude,
  cast(null as int) as quality_flag,
  cast(null as varchar) as source_file
where 1=0
  );
[0m20:55:00.881178 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:55:00.881509 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:55:00.881828 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */

  create view "airflow"."public"."raw_recovered_2__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:55:00.882263 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:55:00.882632 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */

  create view "airflow"."public"."raw_recovered_1__dbt_tmp"
    
    
  as (
    

-- TEMP: recovered sources not available yet.
-- Provides correct columns, returns 0 rows, unblocks downstream.
select
  cast(null as bigint)            as well_id,
  cast(null as bigint)            as survey_type_id,
  cast(null as double precision)  as depth_ft,
  cast(null as double precision)  as amplitude,
  cast(null as int)               as quality_flag
where 1=0
  );
[0m20:55:00.883215 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:55:00.888202 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:55:00.888552 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:55:00.888852 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:55:00.889144 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:55:00.889483 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all" rename to "raw_sgx_all__dbt_backup"
[0m20:55:00.891838 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:55:00.899234 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:55:00.899547 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:55:00.899952 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2" rename to "raw_recovered_2__dbt_backup"
[0m20:55:00.900296 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1" rename to "raw_recovered_1__dbt_backup"
[0m20:55:00.900629 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m20:55:00.901229 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:00.903232 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:55:00.903553 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m20:55:00.904029 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:00.915614 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:55:00.915966 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:55:00.916230 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:55:00.918744 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:00.919073 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m20:55:00.919450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m20:55:00.919753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m20:55:00.924413 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m20:55:00.926540 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:55:00.928652 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:55:00.930711 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:55:00.934982 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:55:00.935364 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
alter table "airflow"."public"."raw_recovered_2__dbt_tmp" rename to "raw_recovered_2"
[0m20:55:00.935740 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
alter table "airflow"."public"."raw_sgx_all__dbt_tmp" rename to "raw_sgx_all"
[0m20:55:00.936095 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
alter table "airflow"."public"."raw_recovered_1__dbt_tmp" rename to "raw_recovered_1"
[0m20:55:00.936440 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m20:55:00.937016 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:00.937324 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:00.937644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:00.938626 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:55:00.939604 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:55:00.939911 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:00.940890 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:55:00.941219 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:55:00.941552 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:55:00.943372 [debug] [Thread-4 (]: On model.caspian_vault.stg_readings: Close
[0m20:55:00.943712 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:55:00.944015 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: COMMIT
[0m20:55:00.944333 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: COMMIT
[0m20:55:00.944696 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: COMMIT
[0m20:55:00.946057 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c52153e840>]}
[0m20:55:00.946731 [info ] [Thread-4 (]: 4 of 36 OK created sql table model public.stg_readings ......................... [[32mSELECT 0[0m in 0.14s]
[0m20:55:00.947194 [debug] [Thread-4 (]: Finished running node model.caspian_vault.stg_readings
[0m20:55:00.947551 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:00.949520 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."raw_sgx_all__dbt_backup"
[0m20:55:00.949847 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:55:00.950142 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:55:00.950455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:55:00.953111 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.raw_sgx_all"
[0m20:55:00.953496 [info ] [Thread-4 (]: 5 of 36 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m20:55:00.956098 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."raw_recovered_2__dbt_backup"
[0m20:55:00.957721 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."raw_recovered_1__dbt_backup"
[0m20:55:00.958073 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_sgx_all"} */
drop view if exists "airflow"."public"."raw_sgx_all__dbt_backup" cascade
[0m20:55:00.958458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969)
[0m20:55:00.958910 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.raw_recovered_2"
[0m20:55:00.959364 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.raw_recovered_1"
[0m20:55:00.959740 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:55:00.960049 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_2"} */
drop view if exists "airflow"."public"."raw_recovered_2__dbt_backup" cascade
[0m20:55:00.960369 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.raw_recovered_1"} */
drop view if exists "airflow"."public"."raw_recovered_1__dbt_backup" cascade
[0m20:55:00.963422 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:55:00.963758 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:55:00.964987 [debug] [Thread-3 (]: On model.caspian_vault.raw_sgx_all: Close
[0m20:55:00.965466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511e01be0>]}
[0m20:55:00.965790 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:55:00.966296 [info ] [Thread-3 (]: 3 of 36 OK created sql view model public.raw_sgx_all ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:55:00.976858 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.013 seconds
[0m20:55:00.978925 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:55:00.979383 [debug] [Thread-3 (]: Finished running node model.caspian_vault.raw_sgx_all
[0m20:55:00.979665 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m20:55:00.980700 [debug] [Thread-2 (]: On model.caspian_vault.raw_recovered_2: Close
[0m20:55:00.981168 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:55:00.982172 [debug] [Thread-1 (]: On model.caspian_vault.raw_recovered_1: Close
[0m20:55:00.982664 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:55:00.983346 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511eb1970>]}
[0m20:55:00.983011 [info ] [Thread-3 (]: 6 of 36 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m20:55:00.983821 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m20:55:00.984176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511e10c80>]}
[0m20:55:00.984685 [info ] [Thread-2 (]: 2 of 36 OK created sql view model public.raw_recovered_2 ....................... [[32mCREATE VIEW[0m in 0.18s]
[0m20:55:00.985054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_sgx_all, now test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd)
[0m20:55:00.985410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:00.985887 [info ] [Thread-1 (]: 1 of 36 OK created sql view model public.raw_recovered_1 ....................... [[32mCREATE VIEW[0m in 0.18s]
[0m20:55:00.986384 [debug] [Thread-2 (]: Finished running node model.caspian_vault.raw_recovered_2
[0m20:55:00.986694 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:55:00.987233 [debug] [Thread-1 (]: Finished running node model.caspian_vault.raw_recovered_1
[0m20:55:00.990205 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:55:00.990720 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:00.991101 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:55:00.991457 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:55:00.991763 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:55:00.993401 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:55:00.993704 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:55:00.996305 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m20:55:00.996739 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:55:00.997057 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m20:55:00.997356 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m20:55:00.997694 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:00.998109 [info ] [Thread-4 (]: 5 of 36 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m20:55:00.998710 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:55:01.001862 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:55:01.002179 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:55:01.002483 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:55:01.003202 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:55:01.004342 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m20:55:01.004734 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m20:55:01.005208 [info ] [Thread-3 (]: 6 of 36 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.02s]
[0m20:55:01.005652 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:55:01.006384 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:55:01.006707 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:55:01.007068 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:55:01.007738 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:55:01.007475 [info ] [Thread-2 (]: 7 of 36 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m20:55:01.008207 [info ] [Thread-1 (]: 8 of 36 START sql table model public.dv_hub_well ............................... [RUN]
[0m20:55:01.008657 [info ] [Thread-4 (]: 9 of 36 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m20:55:01.009075 [info ] [Thread-3 (]: 10 of 36 START sql table model public.dv_sat_readings .......................... [RUN]
[0m20:55:01.009466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_2, now model.caspian_vault.dv_hub_survey_type)
[0m20:55:01.009798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.raw_recovered_1, now model.caspian_vault.dv_hub_well)
[0m20:55:01.010122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m20:55:01.010456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m20:55:01.010765 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m20:55:01.011073 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m20:55:01.011373 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m20:55:01.011659 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m20:55:01.014121 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.016328 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m20:55:01.018831 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.021136 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m20:55:01.021753 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m20:55:01.025987 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.026316 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m20:55:01.026717 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_well
[0m20:55:01.027115 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m20:55:01.029780 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.032336 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m20:55:01.032696 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.035318 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m20:55:01.035942 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.036239 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m20:55:01.036645 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:55:01.037007 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m20:55:01.037383 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:55:01.037682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.037987 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m20:55:01.038288 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.038591 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m20:55:01.039004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.039416 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.042758 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.043080 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.043541 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.043868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.044223 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.044541 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.044870 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m20:55:01.045204 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:55:01.045535 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:55:01.045863 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m20:55:01.046272 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m20:55:01.046605 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m20:55:01.051421 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:55:01.053986 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.054312 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m20:55:01.054772 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.056764 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.057073 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:55:01.057391 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m20:55:01.057701 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.011 seconds
[0m20:55:01.058037 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m20:55:01.060366 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:55:01.062632 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:55:01.065582 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.065981 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m20:55:01.066337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.066628 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m20:55:01.066954 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m20:55:01.067992 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:55:01.068373 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:01.068729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.069051 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.069347 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:01.071472 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:55:01.073520 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:55:01.073836 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:55:01.075880 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.076218 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m20:55:01.076558 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m20:55:01.076934 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m20:55:01.077464 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.077747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.078064 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:01.079006 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:55:01.079345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.080272 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:55:01.081334 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:55:01.081661 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:55:01.083325 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m20:55:01.083658 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:55:01.083980 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.084310 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:55:01.084763 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:55:01.085069 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:55:01.085375 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:55:01.085724 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m20:55:01.087411 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.089054 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m20:55:01.089429 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:01.089713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:55:01.090001 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m20:55:01.090426 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:55:01.091462 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m20:55:01.093128 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m20:55:01.094813 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m20:55:01.095139 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m20:55:01.095657 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:55:01.096074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5105d4ce0>]}
[0m20:55:01.096561 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:55:01.096940 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m20:55:01.097468 [info ] [Thread-2 (]: 7 of 36 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 0[0m in 0.09s]
[0m20:55:01.097861 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m20:55:01.098410 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:55:01.099007 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:55:01.099306 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:55:01.099641 [info ] [Thread-2 (]: 11 of 36 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m20:55:01.100721 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m20:55:01.101047 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:01.101366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m20:55:01.101732 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:01.102140 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511e01640>]}
[0m20:55:01.103093 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_well: Close
[0m20:55:01.103420 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:55:01.104420 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m20:55:01.104888 [info ] [Thread-3 (]: 10 of 36 OK created sql table model public.dv_sat_readings ..................... [[32mSELECT 0[0m in 0.09s]
[0m20:55:01.110455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511e01790>]}
[0m20:55:01.110063 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:55:01.111005 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:55:01.111366 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511e013a0>]}
[0m20:55:01.111884 [info ] [Thread-1 (]: 8 of 36 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 0[0m in 0.10s]
[0m20:55:01.112401 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:55:01.113201 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:55:01.112926 [info ] [Thread-4 (]: 9 of 36 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 0[0m in 0.10s]
[0m20:55:01.113925 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:55:01.114240 [info ] [Thread-3 (]: 12 of 36 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m20:55:01.116926 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:55:01.117433 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:55:01.117771 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:55:01.118157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m20:55:01.118688 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:55:01.119082 [info ] [Thread-1 (]: 13 of 36 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m20:55:01.119460 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:55:01.120032 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:55:01.120354 [info ] [Thread-4 (]: 14 of 36 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m20:55:01.120710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m20:55:01.121029 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m20:55:01.123710 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:55:01.124070 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m20:55:01.124400 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:55:01.124703 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.125114 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:55:01.125477 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:55:01.129773 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:55:01.132677 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:55:01.134206 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:55:01.134748 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m20:55:01.135238 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:55:01.135692 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:55:01.136000 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:55:01.136325 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:55:01.137828 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:55:01.139336 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:55:01.139674 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.139998 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m20:55:01.140643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.140951 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:55:01.141334 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.141722 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:55:01.142065 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m20:55:01.143296 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m20:55:01.143646 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m20:55:01.143968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.144332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.144647 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m20:55:01.145234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.145730 [info ] [Thread-2 (]: 11 of 36 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m20:55:01.146129 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:55:01.146622 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:55:01.146943 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.147303 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:55:01.147716 [info ] [Thread-2 (]: 15 of 36 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m20:55:01.148042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m20:55:01.148356 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.148717 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:55:01.149050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.149382 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.150621 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m20:55:01.153417 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:55:01.153777 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:55:01.154109 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:55:01.154552 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m20:55:01.154891 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:55:01.155271 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.155580 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:55:01.156100 [info ] [Thread-3 (]: 12 of 36 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.04s]
[0m20:55:01.157803 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:55:01.158285 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:55:01.158572 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:55:01.158989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:55:01.159360 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:55:01.159798 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:55:01.160871 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m20:55:01.161931 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m20:55:01.162270 [info ] [Thread-3 (]: 16 of 36 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m20:55:01.162632 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m20:55:01.163057 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m20:55:01.163382 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m20:55:01.163662 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m20:55:01.163974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.164340 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:55:01.164734 [info ] [Thread-4 (]: 14 of 36 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m20:55:01.165333 [info ] [Thread-1 (]: 13 of 36 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m20:55:01.169266 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:55:01.169791 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:55:01.170101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.170579 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:55:01.171024 [debug] [Thread-4 (]: Began running node test.caspian_vault.test_counts_match
[0m20:55:01.171403 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:55:01.171757 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:55:01.172096 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:55:01.172557 [info ] [Thread-4 (]: 17 of 36 START test test_counts_match .......................................... [RUN]
[0m20:55:01.174237 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:55:01.174597 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.174940 [info ] [Thread-1 (]: 18 of 36 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m20:55:01.175320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m20:55:01.175814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m20:55:01.176137 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:55:01.176455 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.176768 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.test_counts_match
[0m20:55:01.177080 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:55:01.177385 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m20:55:01.178461 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m20:55:01.180535 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m20:55:01.183196 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:55:01.183541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.184003 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m20:55:01.184613 [debug] [Thread-4 (]: Began executing node test.caspian_vault.test_counts_match
[0m20:55:01.184909 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:55:01.186578 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m20:55:01.187009 [info ] [Thread-2 (]: 15 of 36 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m20:55:01.188675 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:55:01.189288 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:55:01.189648 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.190093 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:55:01.190462 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:55:01.190876 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:55:01.191190 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:55:01.191531 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m20:55:01.191845 [info ] [Thread-2 (]: 19 of 36 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m20:55:01.192204 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.192533 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m20:55:01.192833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.193160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m20:55:01.193534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.193962 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:55:01.194235 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:55:01.195486 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m20:55:01.198184 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:55:01.198765 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m20:55:01.199077 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.199420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.200241 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:55:01.199946 [info ] [Thread-3 (]: 16 of 36 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m20:55:01.200640 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:55:01.200971 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:55:01.202509 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:55:01.202955 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:55:01.203286 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m20:55:01.203624 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.204048 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:55:01.204524 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:55:01.205216 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.204930 [info ] [Thread-3 (]: 20 of 36 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m20:55:01.205656 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.205949 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m20:55:01.207045 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m20:55:01.207401 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m20:55:01.208464 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m20:55:01.208776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.209127 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:55:01.209467 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: Close
[0m20:55:01.212433 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:55:01.212738 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m20:55:01.213288 [info ] [Thread-4 (]: 17 of 36 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m20:55:01.213630 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.214222 [info ] [Thread-1 (]: 18 of 36 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m20:55:01.214589 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:55:01.215056 [debug] [Thread-4 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:55:01.215388 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:55:01.215822 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:55:01.218628 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:55:01.219015 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:55:01.219358 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.219910 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:55:01.220383 [info ] [Thread-4 (]: 21 of 36 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m20:55:01.220828 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:55:01.221158 [info ] [Thread-1 (]: 22 of 36 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m20:55:01.221482 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.221811 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m20:55:01.222130 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m20:55:01.222469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m20:55:01.223552 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m20:55:01.223875 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:55:01.224171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.224484 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:55:01.227233 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:55:01.227564 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m20:55:01.230345 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:55:01.230886 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:55:01.231337 [info ] [Thread-2 (]: 19 of 36 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m20:55:01.231844 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m20:55:01.233382 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:55:01.233892 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:55:01.234193 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:55:01.234540 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:55:01.234986 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:55:01.236573 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:55:01.237043 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:55:01.237368 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:55:01.237712 [info ] [Thread-2 (]: 23 of 36 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m20:55:01.238166 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m20:55:01.238557 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:55:01.238950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m20:55:01.239290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.239581 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.239886 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m20:55:01.240200 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:55:01.241432 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m20:55:01.241751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.244433 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:55:01.245032 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.245408 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m20:55:01.245760 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:55:01.246154 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:55:01.246882 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.246612 [info ] [Thread-3 (]: 20 of 36 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m20:55:01.248586 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:55:01.249138 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:55:01.249453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:55:01.249802 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.250215 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:55:01.250718 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:55:01.251088 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:55:01.252151 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m20:55:01.252535 [info ] [Thread-3 (]: 24 of 36 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m20:55:01.252919 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.253258 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m20:55:01.253639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m20:55:01.253958 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m20:55:01.254277 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.254577 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:55:01.254906 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.255364 [info ] [Thread-4 (]: 21 of 36 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.03s]
[0m20:55:01.259131 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:55:01.260323 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m20:55:01.260647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.261102 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:55:01.261604 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:55:01.261907 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:55:01.262199 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m20:55:01.262570 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:55:01.262944 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.264558 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:55:01.264944 [info ] [Thread-4 (]: 25 of 36 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m20:55:01.265371 [info ] [Thread-1 (]: 22 of 36 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m20:55:01.265889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m20:55:01.266228 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:55:01.266548 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.266983 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:55:01.267288 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:55:01.267599 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m20:55:01.268649 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m20:55:01.268999 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:55:01.272509 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:55:01.272844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.273209 [info ] [Thread-1 (]: 26 of 36 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m20:55:01.273575 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m20:55:01.274099 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:55:01.274417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m20:55:01.277300 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:55:01.277799 [info ] [Thread-2 (]: 23 of 36 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m20:55:01.278200 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:55:01.278526 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.279077 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:55:01.279475 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:55:01.282844 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:55:01.283196 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:55:01.283555 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:55:01.283904 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m20:55:01.284328 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.284678 [info ] [Thread-2 (]: 27 of 36 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m20:55:01.285053 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.285360 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:55:01.285770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m20:55:01.287443 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:55:01.287789 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:55:01.288110 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:55:01.289330 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m20:55:01.289788 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:55:01.292418 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:55:01.292745 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m20:55:01.293133 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m20:55:01.293444 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m20:55:01.293855 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:55:01.294209 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:55:01.294513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.294890 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.295378 [info ] [Thread-3 (]: 24 of 36 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m20:55:01.297066 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:55:01.297724 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:55:01.298182 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:55:01.298706 [info ] [Thread-3 (]: 28 of 36 START sql table model public.dim_survey_type .......................... [RUN]
[0m20:55:01.299110 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:55:01.299462 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:55:01.299806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now model.caspian_vault.dim_survey_type)
[0m20:55:01.300927 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m20:55:01.301305 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m20:55:01.301618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:55:01.301958 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m20:55:01.302329 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.302613 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m20:55:01.302943 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:55:01.305026 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m20:55:01.305549 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:55:01.305994 [info ] [Thread-4 (]: 25 of 36 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m20:55:01.306681 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:55:01.307012 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_source_format
[0m20:55:01.307367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.307665 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m20:55:01.308084 [info ] [Thread-4 (]: 29 of 36 START sql table model public.dim_source_format ........................ [RUN]
[0m20:55:01.309196 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m20:55:01.311942 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m20:55:01.312347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_source_format)
[0m20:55:01.312666 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m20:55:01.313164 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_source_format
[0m20:55:01.313464 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m20:55:01.313834 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:55:01.314207 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:55:01.316292 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m20:55:01.316708 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:55:01.317179 [info ] [Thread-1 (]: 26 of 36 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m20:55:01.317571 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m20:55:01.318200 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:55:01.318521 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_source_format
[0m20:55:01.318844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.319125 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:55:01.319494 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_time
[0m20:55:01.322092 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m20:55:01.323341 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m20:55:01.323780 [info ] [Thread-1 (]: 30 of 36 START sql table model public.dim_time ................................. [RUN]
[0m20:55:01.324370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_time)
[0m20:55:01.324706 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:55:01.325046 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m20:55:01.325349 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_time
[0m20:55:01.325662 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m20:55:01.326176 [info ] [Thread-2 (]: 27 of 36 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m20:55:01.326528 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m20:55:01.329703 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m20:55:01.330062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.330535 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:55:01.330845 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:55:01.331434 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_well
[0m20:55:01.331711 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_time
[0m20:55:01.332184 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m20:55:01.332685 [info ] [Thread-2 (]: 31 of 36 START sql table model public.dim_well ................................. [RUN]
[0m20:55:01.335294 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m20:55:01.335754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now model.caspian_vault.dim_well)
[0m20:55:01.336193 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.336495 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_well
[0m20:55:01.336836 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:55:01.337141 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:55:01.339215 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m20:55:01.339572 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m20:55:01.339887 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: BEGIN
[0m20:55:01.340385 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_well
[0m20:55:01.340665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.340957 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:55:01.343612 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m20:55:01.346175 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:55:01.346562 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:55:01.346974 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m20:55:01.347384 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:55:01.347698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:55:01.349992 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:55:01.350388 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: BEGIN
[0m20:55:01.350748 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.351062 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:55:01.351406 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m20:55:01.351718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.353744 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:55:01.354073 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m20:55:01.354580 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m20:55:01.354866 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.357025 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:55:01.357336 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:55:01.357694 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m20:55:01.358001 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:55:01.359037 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:55:01.359388 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:55:01.359733 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:55:01.360020 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.360337 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:55:01.362663 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:55:01.363005 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m20:55:01.365030 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:55:01.365359 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:55:01.365670 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:55:01.366046 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:55:01.366450 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:55:01.366765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.368752 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:55:01.369041 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m20:55:01.369363 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:55:01.370931 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m20:55:01.371340 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m20:55:01.371647 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:55:01.371938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:01.372400 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:55:01.373997 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m20:55:01.376364 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:55:01.377360 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:55:01.377682 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m20:55:01.378125 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:55:01.378466 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m20:55:01.378784 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:55:01.379139 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m20:55:01.379501 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:55:01.379782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.381861 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:55:01.382146 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:01.382475 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m20:55:01.383460 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m20:55:01.383791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:55:01.384107 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:55:01.386094 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m20:55:01.386528 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511e1ed20>]}
[0m20:55:01.386875 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:55:01.387860 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: Close
[0m20:55:01.388324 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:55:01.388837 [info ] [Thread-3 (]: 28 of 36 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 0[0m in 0.09s]
[0m20:55:01.389834 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:55:01.390235 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m20:55:01.390659 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51032bf80>]}
[0m20:55:01.391109 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:55:01.391434 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:55:01.391955 [info ] [Thread-4 (]: 29 of 36 OK created sql table model public.dim_source_format ................... [[32mSELECT 0[0m in 0.08s]
[0m20:55:01.392398 [debug] [Thread-3 (]: Began running node model.caspian_vault.fct_readings
[0m20:55:01.392766 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:55:01.393191 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:55:01.393587 [info ] [Thread-3 (]: 32 of 36 START sql table model public.fct_readings ............................. [RUN]
[0m20:55:01.393928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:55:01.394463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m20:55:01.395490 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: Close
[0m20:55:01.395781 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.396108 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.fct_readings
[0m20:55:01.398080 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m20:55:01.398455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c510413050>]}
[0m20:55:01.400921 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m20:55:01.401407 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:55:01.401871 [info ] [Thread-1 (]: 30 of 36 OK created sql table model public.dim_time ............................ [[32mSELECT 0[0m in 0.07s]
[0m20:55:01.402332 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m20:55:01.402784 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_time
[0m20:55:01.403174 [debug] [Thread-3 (]: Began executing node model.caspian_vault.fct_readings
[0m20:55:01.405886 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m20:55:01.406210 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:01.407310 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: Close
[0m20:55:01.407765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51048b470>]}
[0m20:55:01.408140 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:55:01.408643 [info ] [Thread-2 (]: 31 of 36 OK created sql table model public.dim_well ............................ [[32mSELECT 0[0m in 0.07s]
[0m20:55:01.409011 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: BEGIN
[0m20:55:01.409445 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_well
[0m20:55:01.409738 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.413669 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:55:01.413986 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:55:01.414295 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m20:55:01.418366 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:55:01.421969 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:55:01.422299 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m20:55:01.422789 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.490654 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:55:01.491058 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m20:55:01.491672 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.492729 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:55:01.493024 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:55:01.493291 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:55:01.495302 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.496965 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m20:55:01.497409 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:55:01.497691 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m20:55:01.500001 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:55:01.501020 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: Close
[0m20:55:01.501501 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c5103ba840>]}
[0m20:55:01.501978 [info ] [Thread-3 (]: 32 of 36 OK created sql table model public.fct_readings ........................ [[32mSELECT 0[0m in 0.11s]
[0m20:55:01.502447 [debug] [Thread-3 (]: Finished running node model.caspian_vault.fct_readings
[0m20:55:01.503174 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:55:01.503534 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:55:01.503927 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:55:01.504327 [info ] [Thread-4 (]: 33 of 36 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m20:55:01.504802 [info ] [Thread-1 (]: 34 of 36 START sql table model public.mart_survey_summary ...................... [RUN]
[0m20:55:01.505259 [info ] [Thread-2 (]: 35 of 36 START sql table model public.mart_well_performance .................... [RUN]
[0m20:55:01.505752 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_sensor_analysis)
[0m20:55:01.506115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m20:55:01.506484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_well_performance)
[0m20:55:01.506806 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m20:55:01.507119 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m20:55:01.507441 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m20:55:01.509624 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.511660 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m20:55:01.513645 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m20:55:01.514348 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m20:55:01.514696 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m20:55:01.517352 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.519961 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m20:55:01.520390 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_well_performance
[0m20:55:01.523045 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m20:55:01.523523 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.523930 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m20:55:01.524258 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:55:01.524572 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:01.524878 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:55:01.525193 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m20:55:01.525628 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m20:55:01.525929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.526211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:01.529371 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:55:01.529696 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.530063 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m20:55:01.530404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:55:01.530714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:55:01.531099 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:55:01.531421 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:55:01.531733 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:55:01.532050 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:55:01.534756 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:55:01.538180 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.538512 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:55:01.538804 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m20:55:01.539122 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m20:55:01.541426 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:55:01.543701 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:55:01.544095 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m20:55:01.544444 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.544735 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m20:55:01.546821 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.547128 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:55:01.547499 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m20:55:01.547825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.549916 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:55:01.551988 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:55:01.552343 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:55:01.552629 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m20:55:01.552956 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m20:55:01.553935 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:55:01.554364 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.554684 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:55:01.554962 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:55:01.555235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:01.556191 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:55:01.557196 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:55:01.557542 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:55:01.557853 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:55:01.558154 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:55:01.558461 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:55:01.558835 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.560497 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m20:55:01.560793 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.561327 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:55:01.561629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:55:01.563281 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m20:55:01.563608 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m20:55:01.565233 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m20:55:01.565704 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:55:01.566186 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:55:01.566521 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m20:55:01.566832 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m20:55:01.568075 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:55:01.570090 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m20:55:01.570441 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:55:01.570746 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:55:01.571721 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m20:55:01.572124 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511ee28d0>]}
[0m20:55:01.573109 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: Close
[0m20:55:01.573673 [info ] [Thread-4 (]: 33 of 36 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 0[0m in 0.07s]
[0m20:55:01.574090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511ee41d0>]}
[0m20:55:01.574596 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:55:01.574935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511ee6000>]}
[0m20:55:01.575417 [info ] [Thread-1 (]: 34 of 36 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 0[0m in 0.07s]
[0m20:55:01.576042 [info ] [Thread-2 (]: 35 of 36 OK created sql table model public.mart_well_performance ............... [[32mSELECT 0[0m in 0.07s]
[0m20:55:01.576511 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:55:01.576915 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:55:01.577593 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:55:01.578042 [info ] [Thread-3 (]: 36 of 36 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m20:55:01.578387 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:55:01.578664 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:55:01.580991 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:55:01.615907 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.616305 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:55:01.616582 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:01.620728 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:55:01.621045 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.621343 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:55:01.626611 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:55:01.657240 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.657678 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp205501656565"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:55:01.659752 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.002 seconds
[0m20:55:01.661920 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.662234 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205501656565'
        
      order by ordinal_position

  
[0m20:55:01.664514 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:55:01.666773 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.667088 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:55:01.668890 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:55:01.671103 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.671431 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205501656565'
        
      order by ordinal_position

  
[0m20:55:01.673212 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:55:01.675435 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.675748 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:55:01.677479 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:55:01.683395 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.683722 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205501656565'
        
      order by ordinal_position

  
[0m20:55:01.685500 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:55:01.698478 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.698891 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:55:01.699610 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:55:01.703453 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.703776 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:55:01.704278 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:55:01.704681 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.705197 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.705552 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp205501656565" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp205501656565" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:55:01.706304 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:55:01.707228 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:55:01.707548 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:55:01.707807 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:55:01.709701 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:55:01.711676 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:55:01.712183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6837193c-e797-42e0-826f-f65b8c39f092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c511ee08f0>]}
[0m20:55:01.712831 [info ] [Thread-3 (]: 36 of 36 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 0[0m in 0.13s]
[0m20:55:01.713338 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:55:01.714677 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:01.714981 [debug] [MainThread]: On master: BEGIN
[0m20:55:01.715235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:01.719169 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:55:01.719494 [debug] [MainThread]: On master: COMMIT
[0m20:55:01.719759 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:01.719996 [debug] [MainThread]: On master: COMMIT
[0m20:55:01.720323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:55:01.720589 [debug] [MainThread]: On master: Close
[0m20:55:01.720944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:01.721187 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m20:55:01.721434 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m20:55:01.721644 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:55:01.721847 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m20:55:01.722183 [info ] [MainThread]: 
[0m20:55:01.722488 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests, 3 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m20:55:01.726392 [debug] [MainThread]: Command end result
[0m20:55:01.752377 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:55:01.753938 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:55:01.759849 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:55:01.760161 [info ] [MainThread]: 
[0m20:55:01.760524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:01.760830 [info ] [MainThread]: 
[0m20:55:01.761112 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=36
[0m20:55:01.762851 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:55:01.763719 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.2790236, "process_in_blocks": "0", "process_kernel_time": 0.374178, "process_mem_max_rss": "140944", "process_out_blocks": "5000", "process_user_time": 4.229315}
[0m20:55:01.764175 [debug] [MainThread]: Command `dbt build` succeeded at 20:55:01.764091 after 3.28 seconds
[0m20:55:01.764510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51fd6d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51f7d2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c51f7d3a10>]}
[0m20:55:01.764823 [debug] [MainThread]: Flushing usage events
[0m20:55:02.291151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:55.042178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900c4970b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900b18acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900c0e9a30>]}


============================== 20:55:55.047110 | aa8486f7-f448-4923-9778-868338482b5d ==============================
[0m20:55:55.047110 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:55:55.047542 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/logs/dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type model --profile caspian_vault --target dev --no-partial-parse', 'log_format': 'default', 'profiles_dir': '/home/airflow/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'False', 'empty': 'None', 'static_parser': 'True'}
[0m20:55:55.091509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:55:55.091959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900aea7050>]}
[0m20:55:55.092402 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:55:55.092708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900a317830>]}
[0m20:55:55.211794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900aea6f30>]}
[0m20:55:55.269464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900bdb3020>]}
[0m20:55:55.270265 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:55:55.382895 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:55:55.383559 [debug] [MainThread]: Partial parsing not enabled
[0m20:55:56.757606 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:55:56.758114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7690081bfa70>]}
[0m20:55:56.962988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:55:56.971561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769003bc01d0>]}
[0m20:55:57.126961 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:55:57.128567 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:55:57.145054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7690039f4e90>]}
[0m20:55:57.145489 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:55:57.145803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa8486f7-f448-4923-9778-868338482b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7690039ae3c0>]}
[0m20:55:57.146780 [info ] [MainThread]: caspian_vault.marts.dim.dim_source_format
[0m20:55:57.147091 [info ] [MainThread]: caspian_vault.marts.dim.dim_survey_type
[0m20:55:57.147354 [info ] [MainThread]: caspian_vault.marts.dim.dim_time
[0m20:55:57.147591 [info ] [MainThread]: caspian_vault.marts.dim.dim_well
[0m20:55:57.147818 [info ] [MainThread]: caspian_vault.vault.dv_hub_survey_type
[0m20:55:57.148042 [info ] [MainThread]: caspian_vault.vault.dv_hub_well
[0m20:55:57.148287 [info ] [MainThread]: caspian_vault.vault.dv_link_well_survey
[0m20:55:57.148525 [info ] [MainThread]: caspian_vault.vault.dv_sat_readings
[0m20:55:57.148745 [info ] [MainThread]: caspian_vault.marts.fct.fct_readings
[0m20:55:57.148970 [info ] [MainThread]: caspian_vault.marts.mart.mart_sensor_analysis
[0m20:55:57.149189 [info ] [MainThread]: caspian_vault.marts.mart.mart_survey_summary
[0m20:55:57.149426 [info ] [MainThread]: caspian_vault.marts.mart.mart_well_performance
[0m20:55:57.149647 [info ] [MainThread]: caspian_vault.staging.stg_readings
[0m20:55:57.150154 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:55:57.151005 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.1507685, "process_in_blocks": "0", "process_kernel_time": 0.275464, "process_mem_max_rss": "127108", "process_out_blocks": "2672", "process_user_time": 3.172829}
[0m20:55:57.151456 [debug] [MainThread]: Command `dbt ls` succeeded at 20:55:57.151375 after 2.15 seconds
[0m20:55:57.151769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76900c0e9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7690039af980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7690039e3fb0>]}
[0m20:55:57.152066 [debug] [MainThread]: Flushing usage events
[0m20:55:57.658706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:49.709693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a4c73fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a39e3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a2b23e90>]}


============================== 20:56:49.714519 | e5f68586-4d59-457f-910f-a272b427e3f7 ==============================
[0m20:56:49.714519 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:56:49.714958 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_path': '/opt/airflow/logs/dbt', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'warn_error': 'None', 'target_path': 'None'}
[0m20:56:49.721147 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:56:49.721520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e5f68586-4d59-457f-910f-a272b427e3f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a2abdd00>]}
[0m20:56:49.721913 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:56:49.722190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e5f68586-4d59-457f-910f-a272b427e3f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a2abdc40>]}
[0m20:56:49.824033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5f68586-4d59-457f-910f-a272b427e3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a2827200>]}
[0m20:56:49.836107 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hnvcevve'
[0m20:56:49.836442 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:56:49.975956 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:56:49.976640 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:56:49.990781 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:56:49.993863 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:56:50.232384 [info ] [MainThread]: Installed from version 1.3.0
[0m20:56:50.232797 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:56:50.233129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5f68586-4d59-457f-910f-a272b427e3f7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a28242f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a2825730>]}
[0m20:56:50.233456 [info ] [MainThread]: 
[0m20:56:50.233717 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:56:50.234379 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:56:50.235175 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5673892, "process_in_blocks": "0", "process_kernel_time": 0.176865, "process_mem_max_rss": "108120", "process_out_blocks": "2304", "process_user_time": 1.332987}
[0m20:56:50.235597 [debug] [MainThread]: Command `dbt deps` succeeded at 20:56:50.235522 after 0.57 seconds
[0m20:56:50.235869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a294c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a26f08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0a2852d80>]}
[0m20:56:50.236132 [debug] [MainThread]: Flushing usage events
[0m20:56:50.662397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:52.151951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6173273e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6173b488f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61742092b0>]}


============================== 20:56:52.156894 | fae25481-08e6-42a9-a8e9-6e0057074b5c ==============================
[0m20:56:52.156894 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:56:52.157341 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profile caspian_vault --target dev --no-partial-parse', 'log_path': '/opt/airflow/logs/dbt', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/home/airflow/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m20:56:52.201221 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:56:52.201676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6172892f90>]}
[0m20:56:52.202133 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:56:52.202458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6172f66270>]}
[0m20:56:52.321806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6172e36c60>]}
[0m20:56:52.379889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a617351d3a0>]}
[0m20:56:52.380688 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:52.493961 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:56:52.494624 [debug] [MainThread]: Partial parsing not enabled
[0m20:56:53.875709 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:56:53.876234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6170dc71a0>]}
[0m20:56:54.082295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:56:54.090991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a616b9506e0>]}
[0m20:56:54.247513 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:56:54.249068 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:56:54.277313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61701f9100>]}
[0m20:56:54.277753 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:56:54.281198 [info ] [MainThread]: 
[0m20:56:54.281569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:54.281835 [info ] [MainThread]: 
[0m20:56:54.282281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:54.286263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:56:54.291876 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:56:54.319795 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:56:54.320126 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:56:54.320468 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:56:54.320758 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:56:54.321033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:54.321309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:54.326640 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m20:56:54.326935 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m20:56:54.327971 [debug] [ThreadPool]: On list_airflow: Close
[0m20:56:54.328910 [debug] [ThreadPool]: On list_airflow: Close
[0m20:56:54.330768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:56:54.331240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:56:54.336244 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:56:54.337619 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:56:54.337913 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:56:54.338183 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:56:54.338453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:54.338704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:54.342381 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.342783 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:56:54.343034 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.343342 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:56:54.343630 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:56:54.343959 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:54.345859 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.346136 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:56:54.347061 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:56:54.348537 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:56:54.348909 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:56:54.349136 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:56:54.358623 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.358929 [debug] [MainThread]: On master: BEGIN
[0m20:56:54.359173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:54.362931 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.363232 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.363644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:54.385613 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:56:54.386791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a616b92d580>]}
[0m20:56:54.387206 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:54.387610 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.387877 [debug] [MainThread]: On master: BEGIN
[0m20:56:54.388293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:56:54.388559 [debug] [MainThread]: On master: COMMIT
[0m20:56:54.388802 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:54.389048 [debug] [MainThread]: On master: COMMIT
[0m20:56:54.389376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:54.389637 [debug] [MainThread]: On master: Close
[0m20:56:54.393018 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m20:56:54.393465 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m20:56:54.393816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m20:56:54.394099 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:56:54.399914 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:56:54.400543 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m20:56:54.428386 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:56:54.429054 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:56:54.429370 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:56:54.429632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.433715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.434031 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:56:54.434374 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:56:54.463512 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.029 seconds
[0m20:56:54.471061 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:56:54.471395 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m20:56:54.471922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.473931 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:56:54.474226 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m20:56:54.474678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.487484 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:56:54.487830 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:56:54.488098 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:56:54.518292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m20:56:54.523196 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m20:56:54.527368 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:56:54.527685 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m20:56:54.530687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:56:54.532542 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m20:56:54.533850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61743fa5a0>]}
[0m20:56:54.534387 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.14s]
[0m20:56:54.534859 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m20:56:54.535708 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:56:54.536061 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:56:54.536451 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m20:56:54.536841 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m20:56:54.537302 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m20:56:54.537685 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m20:56:54.538006 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:56:54.538323 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:56:54.541516 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:56:54.544408 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:56:54.545009 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:56:54.550480 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:56:54.559419 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:56:54.560622 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:56:54.561309 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:56:54.561637 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:56:54.561956 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m20:56:54.562275 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m20:56:54.562577 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:56:54.562869 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:56:54.567033 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.567360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.567682 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:56:54.567991 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:56:54.568314 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:56:54.568637 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:56:54.570497 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.570805 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.573236 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m20:56:54.574436 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m20:56:54.574847 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m20:56:54.575157 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m20:56:54.575658 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m20:56:54.576139 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m20:56:54.576647 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:56:54.577087 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:56:54.577859 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:56:54.578304 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:56:54.578954 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:56:54.578700 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m20:56:54.579333 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:56:54.579704 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m20:56:54.580104 [info ] [Thread-4 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m20:56:54.580488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m20:56:54.580874 [info ] [Thread-3 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m20:56:54.581241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m20:56:54.581604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m20:56:54.581925 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m20:56:54.582261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m20:56:54.582578 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m20:56:54.582885 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m20:56:54.585190 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.585538 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m20:56:54.587681 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m20:56:54.590134 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.593628 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m20:56:54.594052 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m20:56:54.594543 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m20:56:54.594932 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m20:56:54.597601 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.597979 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m20:56:54.600503 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m20:56:54.602999 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.605683 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m20:56:54.606170 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.606907 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:56:54.607192 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m20:56:54.607509 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.607839 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:56:54.608150 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m20:56:54.608452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.608749 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m20:56:54.609049 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m20:56:54.609341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:54.609733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:54.610027 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:54.613476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.613836 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.614149 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.614548 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m20:56:54.614865 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.615213 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.615537 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:56:54.615925 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.616240 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:56:54.616585 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m20:56:54.616929 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m20:56:54.617274 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m20:56:54.630151 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.014 seconds
[0m20:56:54.632740 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.633045 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m20:56:54.633574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.633901 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.016 seconds
[0m20:56:54.635875 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.638173 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:56:54.638525 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m20:56:54.638848 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m20:56:54.639320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.639626 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.640577 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:56:54.643410 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:56:54.643739 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.644047 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m20:56:54.644358 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:56:54.644808 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.645732 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:56:54.646031 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.028 seconds
[0m20:56:54.646371 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:56:54.648600 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.648913 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:56:54.649216 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m20:56:54.649777 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.650065 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.032 seconds
[0m20:56:54.652111 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.654345 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:56:54.654676 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m20:56:54.654998 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m20:56:54.655474 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.655750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.656709 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:56:54.658711 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:56:54.659060 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.659382 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m20:56:54.659685 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:56:54.660149 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.661085 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:56:54.661395 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:56:54.661652 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:56:54.669582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m20:56:54.671425 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m20:56:54.671870 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:56:54.672161 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m20:56:54.677196 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m20:56:54.677565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m20:56:54.679183 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m20:56:54.679535 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m20:56:54.679873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m20:56:54.681644 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m20:56:54.682099 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:56:54.683794 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m20:56:54.684905 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m20:56:54.685368 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:56:54.685692 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m20:56:54.686131 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:56:54.686524 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m20:56:54.686979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a616a6b5d60>]}
[0m20:56:54.687379 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m20:56:54.687957 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.11s]
[0m20:56:54.688503 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:56:54.689031 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:56:54.689344 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m20:56:54.689663 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:56:54.690009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m20:56:54.690995 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m20:56:54.691349 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:56:54.691654 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:56:54.691950 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:56:54.692982 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m20:56:54.698463 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a616a680950>]}
[0m20:56:54.699231 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:56:54.700241 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m20:56:54.700773 [info ] [Thread-3 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.12s]
[0m20:56:54.701155 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6170d66b70>]}
[0m20:56:54.701788 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:56:54.702221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6170dc7c80>]}
[0m20:56:54.702611 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:56:54.703060 [info ] [Thread-4 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.12s]
[0m20:56:54.703473 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:56:54.703938 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.12s]
[0m20:56:54.705650 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:56:54.706212 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:56:54.706549 [info ] [Thread-3 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m20:56:54.707012 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:56:54.707436 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:56:54.708056 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:56:54.708398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m20:56:54.708738 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:56:54.709170 [info ] [Thread-4 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m20:56:54.709565 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m20:56:54.709872 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:56:54.710186 [info ] [Thread-2 (]: 11 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m20:56:54.710558 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m20:56:54.710879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.713536 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:56:54.713887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m20:56:54.714204 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:56:54.714730 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:56:54.718999 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:56:54.719337 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:56:54.722215 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:56:54.722570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:56:54.724164 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:56:54.724565 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:56:54.724942 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:56:54.725311 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:56:54.726823 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:56:54.727221 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:56:54.727534 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.729061 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:56:54.729486 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m20:56:54.729863 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:56:54.730296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:54.730666 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:56:54.730947 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m20:56:54.731230 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.731642 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m20:56:54.731929 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:54.733174 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m20:56:54.733515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:54.734046 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m20:56:54.734590 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.04s]
[0m20:56:54.735087 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:56:54.735387 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.735749 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:56:54.736104 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:56:54.736435 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m20:56:54.736809 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.737201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m20:56:54.737602 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:54.737935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.738274 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:56:54.738563 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.738871 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:56:54.739184 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:56:54.741956 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:56:54.743066 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m20:56:54.743416 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:56:54.743750 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.744274 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m20:56:54.744576 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:56:54.744924 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.747599 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:56:54.748022 [info ] [Thread-3 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m20:56:54.748353 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:56:54.749407 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m20:56:54.749936 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:56:54.750330 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:56:54.751345 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m20:56:54.751741 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:56:54.752058 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m20:56:54.752372 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m20:56:54.752728 [info ] [Thread-3 (]: 13 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m20:56:54.753012 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m20:56:54.753352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.753731 [info ] [Thread-4 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m20:56:54.754128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m20:56:54.754730 [info ] [Thread-2 (]: 11 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m20:56:54.755267 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:56:54.755603 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:56:54.756069 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:56:54.756437 [debug] [Thread-4 (]: Began running node test.caspian_vault.test_counts_match
[0m20:56:54.759374 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:56:54.759785 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:56:54.760116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:56:54.760446 [info ] [Thread-4 (]: 14 of 33 START test test_counts_match .......................................... [RUN]
[0m20:56:54.760892 [info ] [Thread-2 (]: 15 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m20:56:54.761310 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:56:54.761621 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:56:54.761962 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.test_counts_match)
[0m20:56:54.762306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m20:56:54.762635 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.764287 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:56:54.764619 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.test_counts_match
[0m20:56:54.764921 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:56:54.767041 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m20:56:54.767438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.770058 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:56:54.770431 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:56:54.771628 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m20:56:54.772114 [debug] [Thread-4 (]: Began executing node test.caspian_vault.test_counts_match
[0m20:56:54.772440 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m20:56:54.772736 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:56:54.774384 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m20:56:54.774678 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m20:56:54.774974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:54.776523 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:56:54.777589 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:56:54.777222 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m20:56:54.778100 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m20:56:54.778554 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:56:54.778876 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:56:54.779171 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:54.779509 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:56:54.779852 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m20:56:54.780275 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m20:56:54.780658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:54.780983 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:54.781343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m20:56:54.781769 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:56:54.782102 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:56:54.782470 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.785185 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:56:54.785761 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:56:54.786094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.786434 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:56:54.786782 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:56:54.787070 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:56:54.787358 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.787689 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m20:56:54.789266 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:56:54.789598 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.790718 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m20:56:54.791328 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:56:54.791640 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:56:54.791933 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m20:56:54.792203 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m20:56:54.793233 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m20:56:54.793585 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:56:54.793849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.794972 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m20:56:54.795670 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m20:56:54.795410 [info ] [Thread-3 (]: 13 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m20:56:54.796460 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:56:54.796930 [info ] [Thread-2 (]: 15 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.03s]
[0m20:56:54.797323 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: Close
[0m20:56:54.797673 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:56:54.798183 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:56:54.798568 [info ] [Thread-3 (]: 17 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m20:56:54.799006 [info ] [Thread-4 (]: 14 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m20:56:54.799471 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:56:54.799809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:54.800147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m20:56:54.800639 [debug] [Thread-4 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:56:54.800967 [info ] [Thread-2 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m20:56:54.801355 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:56:54.801711 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:56:54.802076 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:56:54.802483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m20:56:54.802921 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.807106 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:56:54.807490 [info ] [Thread-4 (]: 19 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m20:56:54.807859 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:56:54.808386 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m20:56:54.808771 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.809067 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:56:54.812466 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:56:54.812818 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:56:54.813898 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m20:56:54.815469 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:56:54.819012 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:56:54.819490 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:56:54.819839 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m20:56:54.821630 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:56:54.822013 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:56:54.822425 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:56:54.822892 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m20:56:54.823369 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m20:56:54.823727 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:56:54.825237 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:56:54.825729 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:56:54.826032 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:54.826347 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m20:56:54.826776 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:56:54.827259 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:56:54.827663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:54.827971 [info ] [Thread-1 (]: 20 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m20:56:54.828376 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m20:56:54.828843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m20:56:54.829183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:54.829550 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:56:54.832363 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:56:54.832902 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:56:54.833212 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:54.834823 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:56:54.835134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m20:56:54.835461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:54.835806 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:56:54.836229 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:56:54.836592 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:56:54.836910 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:56:54.837346 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.837685 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.838026 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.838357 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m20:56:54.838798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.839169 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:56:54.839453 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.840604 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m20:56:54.840962 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.841985 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m20:56:54.843081 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m20:56:54.843469 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m20:56:54.843774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.844072 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m20:56:54.844497 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m20:56:54.844784 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:56:54.845195 [info ] [Thread-3 (]: 17 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.05s]
[0m20:56:54.845774 [info ] [Thread-2 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m20:56:54.846553 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:56:54.846173 [info ] [Thread-4 (]: 19 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m20:56:54.847136 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:56:54.847587 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:56:54.848089 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:56:54.848447 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:56:54.848846 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:56:54.849121 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.849537 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:56:54.849884 [info ] [Thread-3 (]: 21 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m20:56:54.850222 [info ] [Thread-2 (]: 22 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m20:56:54.851314 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m20:56:54.851641 [info ] [Thread-4 (]: 23 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m20:56:54.852017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m20:56:54.852389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m20:56:54.852781 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m20:56:54.853094 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m20:56:54.853388 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:56:54.853694 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:56:54.853996 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:56:54.856967 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:56:54.857398 [info ] [Thread-1 (]: 20 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.03s]
[0m20:56:54.860198 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:56:54.864897 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:56:54.865499 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:56:54.865957 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:56:54.866361 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:56:54.866708 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:56:54.868479 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:56:54.868791 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:56:54.870261 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:56:54.870596 [info ] [Thread-1 (]: 24 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m20:56:54.872194 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:56:54.872668 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:56:54.873026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m20:56:54.873399 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:56:54.873783 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m20:56:54.874102 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:56:54.874447 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m20:56:54.874746 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:56:54.875058 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:54.877656 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:56:54.877996 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:54.878331 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m20:56:54.878990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:54.879326 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:56:54.881061 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:56:54.881506 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:56:54.881785 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m20:56:54.882029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.882601 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.882922 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m20:56:54.883294 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:56:54.883603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.883922 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:56:54.884229 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.884560 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:56:54.884875 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.885265 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:56:54.885684 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.885952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.887076 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m20:56:54.887409 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.887752 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:56:54.888045 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:56:54.889110 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m20:56:54.889448 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m20:56:54.890461 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m20:56:54.890790 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:56:54.891185 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m20:56:54.891617 [info ] [Thread-2 (]: 22 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m20:56:54.892059 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m20:56:54.892538 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:56:54.892959 [info ] [Thread-3 (]: 21 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m20:56:54.893300 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:56:54.894086 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:56:54.893788 [info ] [Thread-4 (]: 23 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m20:56:54.894667 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:56:54.895707 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m20:56:54.896117 [info ] [Thread-2 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m20:56:54.896631 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:56:54.896975 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_source_format
[0m20:56:54.897411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now model.caspian_vault.dim_survey_type)
[0m20:56:54.897715 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m20:56:54.898060 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_time
[0m20:56:54.898481 [info ] [Thread-3 (]: 26 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m20:56:54.898832 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m20:56:54.899330 [info ] [Thread-4 (]: 27 of 33 START sql table model public.dim_time ................................. [RUN]
[0m20:56:54.899815 [info ] [Thread-1 (]: 24 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.03s]
[0m20:56:54.900177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now model.caspian_vault.dim_source_format)
[0m20:56:54.902424 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m20:56:54.902783 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_time)
[0m20:56:54.903213 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:56:54.903530 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_source_format
[0m20:56:54.903919 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_time
[0m20:56:54.904260 [debug] [Thread-1 (]: Began running node model.caspian_vault.fct_readings
[0m20:56:54.906392 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m20:56:54.906721 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_survey_type
[0m20:56:54.908740 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m20:56:54.909150 [info ] [Thread-1 (]: 28 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m20:56:54.913362 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m20:56:54.913710 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_source_format
[0m20:56:54.914142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now model.caspian_vault.fct_readings)
[0m20:56:54.914507 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_time
[0m20:56:54.917051 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m20:56:54.917437 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.fct_readings
[0m20:56:54.917834 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:56:54.920420 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m20:56:54.922668 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m20:56:54.923061 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:56:54.923358 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m20:56:54.923884 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:56:54.924198 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m20:56:54.924524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:54.924843 [debug] [Thread-1 (]: Began executing node model.caspian_vault.fct_readings
[0m20:56:54.925127 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: BEGIN
[0m20:56:54.925446 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:54.928160 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m20:56:54.928518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:54.929297 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:56:54.929636 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:54.929979 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: BEGIN
[0m20:56:54.930345 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:56:54.930670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.930990 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m20:56:54.932162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m20:56:54.932524 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:56:54.932817 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.933147 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m20:56:54.933472 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:56:54.933832 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m20:56:54.934557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:54.934834 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:56:54.935108 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m20:56:54.935440 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.004 seconds
[0m20:56:54.937957 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:56:54.938276 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m20:56:54.938744 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.940734 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:56:54.941031 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m20:56:54.941467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.942409 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:56:54.942701 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:56:54.942971 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:56:54.943227 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:56:54.945627 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:56:54.945933 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:56:54.946434 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.948436 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:56:54.948742 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.015 seconds
[0m20:56:54.949148 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:56:54.952336 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:56:54.952725 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m20:56:54.953022 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.953382 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.018 seconds
[0m20:56:54.953721 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m20:56:54.954059 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.955004 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:56:54.957269 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:56:54.958934 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m20:56:54.960967 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:56:54.961307 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:56:54.961626 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m20:56:54.962069 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:56:54.962393 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m20:56:54.962716 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:56:54.963085 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m20:56:54.963436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:54.965593 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:56:54.965898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:56:54.966227 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m20:56:54.967205 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:56:54.967598 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:56:54.967880 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:56:54.968188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:56:54.969106 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:56:54.969415 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:56:54.969671 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:56:54.996796 [debug] [Thread-3 (]: SQL status: COMMIT in 0.029 seconds
[0m20:56:54.997345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m20:56:54.997663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m20:56:54.999405 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m20:56:54.999719 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:56:55.001399 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m20:56:55.003113 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m20:56:55.003602 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:56:55.004681 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: Close
[0m20:56:55.005125 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:56:55.005590 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:56:55.005905 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m20:56:55.006296 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m20:56:55.006879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6168500170>]}
[0m20:56:55.007312 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m20:56:55.008008 [info ] [Thread-2 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.11s]
[0m20:56:55.008611 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:56:55.008937 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_well
[0m20:56:55.009307 [info ] [Thread-2 (]: 29 of 33 START sql table model public.dim_well ................................. [RUN]
[0m20:56:55.009723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.dim_well)
[0m20:56:55.010038 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:56:55.010381 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_well
[0m20:56:55.011395 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: Close
[0m20:56:55.011739 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:56:55.014017 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m20:56:55.014351 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:56:55.015408 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: Close
[0m20:56:55.015767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6168585b20>]}
[0m20:56:55.016846 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: Close
[0m20:56:55.017747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6170d1c5c0>]}
[0m20:56:55.018061 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_well
[0m20:56:55.017424 [info ] [Thread-3 (]: 26 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.12s]
[0m20:56:55.018668 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.10s]
[0m20:56:55.019062 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6170d645f0>]}
[0m20:56:55.022892 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m20:56:55.023392 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:56:55.023816 [debug] [Thread-1 (]: Finished running node model.caspian_vault.fct_readings
[0m20:56:55.024271 [info ] [Thread-4 (]: 27 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.12s]
[0m20:56:55.024995 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:56:55.025448 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:56:55.025775 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:56:55.026185 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_time
[0m20:56:55.026501 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: BEGIN
[0m20:56:55.026873 [info ] [Thread-3 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m20:56:55.027290 [info ] [Thread-1 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m20:56:55.027687 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:56:55.028037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:55.028369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_sensor_analysis)
[0m20:56:55.028688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now model.caspian_vault.mart_survey_summary)
[0m20:56:55.029069 [info ] [Thread-4 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m20:56:55.029540 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m20:56:55.029851 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m20:56:55.030192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_well_performance)
[0m20:56:55.032261 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.034218 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m20:56:55.034614 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m20:56:55.034911 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:56:55.037098 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m20:56:55.037538 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m20:56:55.037825 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m20:56:55.038153 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:56:55.040754 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m20:56:55.043354 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.043655 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_well_performance
[0m20:56:55.044002 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m20:56:55.046840 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m20:56:55.047208 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:56:55.047671 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.048079 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m20:56:55.048419 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m20:56:55.048716 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:56:55.049020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:55.049321 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:55.049617 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m20:56:55.050098 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:56:55.051566 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.004 seconds
[0m20:56:55.053922 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:56:55.054410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:55.054713 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m20:56:55.055020 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:56:55.055358 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:55.055677 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:56:55.056024 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:56:55.056335 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:55.056608 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.056919 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:56:55.057239 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:56:55.059240 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:56:55.059593 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m20:56:55.060024 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m20:56:55.060554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:55.061507 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:56:55.061795 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:56:55.062045 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:56:55.066823 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m20:56:55.069445 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m20:56:55.069871 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:56:55.070141 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m20:56:55.070439 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.010 seconds
[0m20:56:55.070757 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.011 seconds
[0m20:56:55.073119 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.073438 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m20:56:55.075654 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:56:55.075984 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m20:56:55.078193 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:56:55.078552 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m20:56:55.078849 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m20:56:55.079221 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m20:56:55.080227 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: Close
[0m20:56:55.080531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:56:55.082881 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.083321 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6168590170>]}
[0m20:56:55.083631 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:56:55.083966 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m20:56:55.084281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:56:55.084777 [info ] [Thread-2 (]: 29 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.07s]
[0m20:56:55.086915 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:56:55.089055 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:56:55.089368 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:56:55.089781 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_well
[0m20:56:55.090090 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m20:56:55.090437 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m20:56:55.091429 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:56:55.091972 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.092316 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:55.092590 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:56:55.092863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:56:55.093824 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:56:55.094830 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:56:55.095154 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:56:55.095471 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:56:55.095763 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:56:55.096044 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:56:55.096329 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:56:55.098089 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m20:56:55.098390 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:56:55.098825 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:56:55.100582 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m20:56:55.100898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:56:55.101208 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m20:56:55.101672 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:56:55.104190 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m20:56:55.104592 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m20:56:55.105031 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:56:55.105398 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m20:56:55.106462 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:56:55.107420 [debug] [Thread-3 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m20:56:55.107702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:56:55.108033 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:56:55.108993 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m20:56:55.109369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61685c8f80>]}
[0m20:56:55.110358 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: Close
[0m20:56:55.110863 [info ] [Thread-3 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.08s]
[0m20:56:55.111333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61681cb050>]}
[0m20:56:55.111695 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61681dab10>]}
[0m20:56:55.112118 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:56:55.112568 [info ] [Thread-1 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.08s]
[0m20:56:55.113045 [info ] [Thread-4 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.08s]
[0m20:56:55.113627 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:56:55.114036 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:56:55.114760 [debug] [Thread-2 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:56:55.115151 [info ] [Thread-2 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m20:56:55.115503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:56:55.115784 [debug] [Thread-2 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:56:55.118176 [debug] [Thread-2 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:56:55.152831 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.153214 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:56:55.153501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:55.157714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:55.158035 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.158335 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:56:55.163496 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:56:55.193773 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.194208 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp205655193057"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:56:55.196666 [debug] [Thread-2 (]: SQL status: SELECT 42 in 0.002 seconds
[0m20:56:55.199029 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.199370 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205655193057'
        
      order by ordinal_position

  
[0m20:56:55.201777 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:56:55.204075 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.204403 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:56:55.206188 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:56:55.208345 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.208658 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205655193057'
        
      order by ordinal_position

  
[0m20:56:55.210445 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:56:55.212609 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.212913 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:56:55.214657 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.001 seconds
[0m20:56:55.220573 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.220902 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205655193057'
        
      order by ordinal_position

  
[0m20:56:55.222688 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.001 seconds
[0m20:56:55.235418 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.235812 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:56:55.236478 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:56:55.240278 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.240607 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:56:55.241048 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:56:55.241480 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.241993 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.242329 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp205655193057" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp205655193057" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:56:55.243160 [debug] [Thread-2 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m20:56:55.244101 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:56:55.244412 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:56:55.244663 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:56:55.249066 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:56:55.251032 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:56:55.251550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae25481-08e6-42a9-a8e9-6e0057074b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6137730ad0>]}
[0m20:56:55.252169 [info ] [Thread-2 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m20:56:55.252660 [debug] [Thread-2 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:56:55.253938 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:55.254259 [debug] [MainThread]: On master: BEGIN
[0m20:56:55.254518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:55.258628 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:56:55.258925 [debug] [MainThread]: On master: COMMIT
[0m20:56:55.259183 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:55.259443 [debug] [MainThread]: On master: COMMIT
[0m20:56:55.259761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:55.260018 [debug] [MainThread]: On master: Close
[0m20:56:55.260382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:55.260636 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:56:55.260862 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m20:56:55.261077 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m20:56:55.261298 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m20:56:55.261629 [info ] [MainThread]: 
[0m20:56:55.261914 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m20:56:55.265499 [debug] [MainThread]: Command end result
[0m20:56:55.361759 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:56:55.363601 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:56:55.369588 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:56:55.369938 [info ] [MainThread]: 
[0m20:56:55.370288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:55.370596 [info ] [MainThread]: 
[0m20:56:55.370881 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m20:56:55.371478 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:56:55.372383 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.2623036, "process_in_blocks": "0", "process_kernel_time": 0.346833, "process_mem_max_rss": "141816", "process_out_blocks": "4888", "process_user_time": 4.11188}
[0m20:56:55.372830 [debug] [MainThread]: Command `dbt build` succeeded at 20:56:55.372748 after 3.26 seconds
[0m20:56:55.373148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6172eb99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a617019e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a61742ad6a0>]}
[0m20:56:55.373496 [debug] [MainThread]: Flushing usage events
[0m20:56:55.900629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:26.800041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b1867320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b36a0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b1de9460>]}


============================== 20:57:26.804890 | 4dc5ea7d-264e-4c43-83e5-4dc8132b6dd0 ==============================
[0m20:57:26.804890 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:57:26.805347 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'log_path': '/opt/airflow/logs/dbt', 'empty': 'None', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev'}
[0m20:57:26.811506 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:57:26.811872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4dc5ea7d-264e-4c43-83e5-4dc8132b6dd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b0cda180>]}
[0m20:57:26.812262 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:57:26.812566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4dc5ea7d-264e-4c43-83e5-4dc8132b6dd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b0cda180>]}
[0m20:57:26.913434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dc5ea7d-264e-4c43-83e5-4dc8132b6dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b0a76180>]}
[0m20:57:26.932381 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mrx4o2f5'
[0m20:57:26.932729 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:57:27.079084 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:57:27.079854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:57:27.102712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:57:27.105879 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:57:27.349782 [info ] [MainThread]: Installed from version 1.3.0
[0m20:57:27.350213 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:57:27.350555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4dc5ea7d-264e-4c43-83e5-4dc8132b6dd0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b08d5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b089c980>]}
[0m20:57:27.350897 [info ] [MainThread]: 
[0m20:57:27.351183 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:57:27.351853 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:57:27.352701 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59498703, "process_in_blocks": "0", "process_kernel_time": 0.215689, "process_mem_max_rss": "108264", "process_out_blocks": "2304", "process_user_time": 1.295137}
[0m20:57:27.353132 [debug] [MainThread]: Command `dbt deps` succeeded at 20:57:27.353055 after 0.60 seconds
[0m20:57:27.353452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b1c62600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b4ccca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d14b333f350>]}
[0m20:57:27.353739 [debug] [MainThread]: Flushing usage events
[0m20:57:27.819070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:29.315528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa8b2d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa7791be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaa74c7d0>]}


============================== 20:57:29.320541 | f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f ==============================
[0m20:57:29.320541 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:57:29.320981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'target_path': '/opt/airflow/dbt_target', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/opt/airflow/logs/dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'indirect_selection': 'eager'}
[0m20:57:29.365014 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:57:29.365495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa6a15070>]}
[0m20:57:29.365928 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:57:29.366266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa6a15070>]}
[0m20:57:29.484172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa67833e0>]}
[0m20:57:29.541791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa68aaa20>]}
[0m20:57:29.542605 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:57:29.655021 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:57:29.781159 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 2 files changed.
[0m20:57:29.781887 [debug] [MainThread]: Partial parsing: updated file: caspian_vault://models/raw/sources.yml
[0m20:57:29.782232 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m20:57:29.786399 [debug] [MainThread]: Partial parsing exception processing file caspian_vault://models/raw/raw_sgx_all.sql
[0m20:57:29.786808 [debug] [MainThread]: PP exception info: {'exception': "AttributeError: 'SingularTestNode' object has no attribute 'attached_node'", 'code': 'if child_test.attached_node:', 'location': 'line 920 in remove_tests', 'traceback': 'Traceback (most recent call last):\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 545, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 194, in get_parsing_files\n    self.delete_from_saved(file_id)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 283, in delete_from_saved\n    self.remove_mssat_file(saved_source_file)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 416, in remove_mssat_file\n    self.schedule_referencing_nodes_for_parsing(unique_id)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 422, in schedule_referencing_nodes_for_parsing\n    self.schedule_nodes_for_parsing(self.saved_manifest.child_map[unique_id])\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 434, in schedule_nodes_for_parsing\n    self.remove_mssat_file(source_file)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 415, in remove_mssat_file\n    self.remove_node_in_saved(source_file, unique_id)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 376, in remove_node_in_saved\n    self.delete_schema_mssa_links(schema_file, dict_key, elem_patch)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 852, in delete_schema_mssa_links\n    self._delete_schema_mssa_links(schema_file, dict_key, elem, elem_unique_ids)\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 905, in _delete_schema_mssa_links\n    self.remove_tests(schema_file, dict_key, elem["name"])\n  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/partial.py", line 920, in remove_tests\n    if child_test.attached_node:\n       ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: \'SingularTestNode\' object has no attribute \'attached_node\'\n', 'parse_file_type': 'model'}
[0m20:57:29.787166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa67e7230>]}
[0m20:57:31.105420 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:57:31.105957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa320cec0>]}
[0m20:57:31.304180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:57:31.371728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa32d5160>]}
[0m20:57:31.465859 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:57:31.467595 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:57:31.496281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa32a0080>]}
[0m20:57:31.496751 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:57:31.500237 [info ] [MainThread]: 
[0m20:57:31.500637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:31.500930 [info ] [MainThread]: 
[0m20:57:31.501397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:57:31.505400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:57:31.505984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:57:31.538827 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:57:31.539205 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:57:31.539543 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:57:31.539850 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:57:31.540143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:31.540441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:31.545895 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m20:57:31.546209 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m20:57:31.547328 [debug] [ThreadPool]: On list_airflow: Close
[0m20:57:31.548289 [debug] [ThreadPool]: On list_airflow: Close
[0m20:57:31.550159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m20:57:31.550676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:57:31.554840 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:57:31.557017 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:57:31.557344 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:57:31.557637 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:57:31.557921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:31.558188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:31.561918 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:57:31.562271 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:57:31.562542 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:57:31.562863 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:57:31.563167 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:57:31.563540 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:57:31.565473 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:31.565741 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:57:31.566838 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:57:31.568360 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:57:31.568757 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:57:31.569048 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:57:31.578538 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:31.578872 [debug] [MainThread]: On master: BEGIN
[0m20:57:31.579136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:31.582875 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:57:31.583196 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:31.583543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:57:31.605612 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:57:31.606912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa2f057c0>]}
[0m20:57:31.607378 [debug] [MainThread]: On master: ROLLBACK
[0m20:57:31.607783 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:31.608075 [debug] [MainThread]: On master: BEGIN
[0m20:57:31.608513 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:57:31.608813 [debug] [MainThread]: On master: COMMIT
[0m20:57:31.609079 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:31.609354 [debug] [MainThread]: On master: COMMIT
[0m20:57:31.609699 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:57:31.609988 [debug] [MainThread]: On master: Close
[0m20:57:31.613427 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m20:57:31.613894 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m20:57:31.614284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m20:57:31.614594 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m20:57:31.620492 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m20:57:31.621004 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m20:57:31.649325 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m20:57:31.649926 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:57:31.650234 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m20:57:31.650537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:31.654661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:31.655000 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:57:31.655367 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m20:57:31.688194 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.032 seconds
[0m20:57:31.695883 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:57:31.696229 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m20:57:31.696789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.698820 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:57:31.699138 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m20:57:31.699604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.711346 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:57:31.711704 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:57:31.711991 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m20:57:31.739863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m20:57:31.745875 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m20:57:31.750122 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m20:57:31.750486 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m20:57:31.753573 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:57:31.755492 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m20:57:31.756839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa7d62570>]}
[0m20:57:31.757401 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.14s]
[0m20:57:31.757889 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m20:57:31.758791 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:57:31.759200 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:57:31.759641 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m20:57:31.760045 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m20:57:31.760515 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m20:57:31.760921 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m20:57:31.761277 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:57:31.761605 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:57:31.764816 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:57:31.767642 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:57:31.768218 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:57:31.773697 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:57:31.781234 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:57:31.782829 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:57:31.783474 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:57:31.783855 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:57:31.784169 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m20:57:31.784516 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m20:57:31.784833 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:57:31.785149 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:57:31.789377 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:31.789767 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:31.790088 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m20:57:31.790436 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m20:57:31.790776 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:57:31.791113 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m20:57:31.793026 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:31.793341 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:31.795894 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m20:57:31.796980 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m20:57:31.797434 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m20:57:31.797741 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m20:57:31.798295 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m20:57:31.798805 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m20:57:31.799213 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m20:57:31.799872 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m20:57:31.800543 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m20:57:31.800870 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m20:57:31.801620 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m20:57:31.801337 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m20:57:31.802084 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m20:57:31.802464 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m20:57:31.802899 [info ] [Thread-4 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m20:57:31.803297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m20:57:31.803697 [info ] [Thread-3 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m20:57:31.804068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m20:57:31.804546 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m20:57:31.804893 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m20:57:31.805231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m20:57:31.805573 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m20:57:31.805895 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m20:57:31.808203 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.808577 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m20:57:31.810706 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m20:57:31.813163 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.815508 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m20:57:31.816076 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m20:57:31.816643 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m20:57:31.816959 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m20:57:31.820762 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.823404 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.823797 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m20:57:31.826341 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m20:57:31.829136 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m20:57:31.829634 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.830052 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.830525 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m20:57:31.830932 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:57:31.831300 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m20:57:31.831659 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:57:31.831983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:31.832315 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m20:57:31.832640 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:31.832954 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m20:57:31.833396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:31.833828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:31.837066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:31.837434 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.837838 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:31.838163 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m20:57:31.838552 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:31.838936 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:31.839264 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.839664 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:57:31.839998 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:57:31.840353 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m20:57:31.840707 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m20:57:31.841054 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m20:57:31.856453 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.017 seconds
[0m20:57:31.859125 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.859467 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m20:57:31.859830 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.018 seconds
[0m20:57:31.860148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.862437 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:57:31.864496 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.864845 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m20:57:31.865179 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m20:57:31.865704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.866002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.867960 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:57:31.868984 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:57:31.869343 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m20:57:31.869683 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.870042 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m20:57:31.870344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.871355 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:57:31.871678 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.030 seconds
[0m20:57:31.872025 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:57:31.875218 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.875603 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.034 seconds
[0m20:57:31.875916 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m20:57:31.876243 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m20:57:31.878581 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:57:31.879022 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m20:57:31.879391 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.879695 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.881705 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.883712 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:57:31.884057 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m20:57:31.884410 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m20:57:31.884894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.885199 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:31.886182 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:57:31.887155 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:57:31.887515 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.887840 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:57:31.888151 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m20:57:31.888474 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m20:57:31.902109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m20:57:31.903959 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m20:57:31.904446 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m20:57:31.904744 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m20:57:31.908431 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m20:57:31.908785 [debug] [Thread-4 (]: SQL status: COMMIT in 0.020 seconds
[0m20:57:31.909104 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m20:57:31.910771 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m20:57:31.912470 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m20:57:31.912785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m20:57:31.914460 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m20:57:31.914933 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m20:57:31.915404 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m20:57:31.916492 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m20:57:31.916945 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m20:57:31.917293 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m20:57:31.917632 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m20:57:31.918014 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m20:57:31.918532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa05539e0>]}
[0m20:57:31.919205 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.12s]
[0m20:57:31.919696 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m20:57:31.920235 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:57:31.920560 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m20:57:31.920902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m20:57:31.921214 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:57:31.926071 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:57:31.926507 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m20:57:31.926834 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m20:57:31.927190 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m20:57:31.928283 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m20:57:31.929310 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m20:57:31.929630 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:57:31.930657 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m20:57:31.931185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa0592e70>]}
[0m20:57:31.933961 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:57:31.934374 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa05bfa40>]}
[0m20:57:31.935002 [info ] [Thread-4 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.13s]
[0m20:57:31.935509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa05bc6e0>]}
[0m20:57:31.936086 [info ] [Thread-3 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.13s]
[0m20:57:31.936633 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m20:57:31.936974 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:57:31.937481 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.13s]
[0m20:57:31.937969 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m20:57:31.938331 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:57:31.938732 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m20:57:31.939297 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m20:57:31.939639 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:57:31.940031 [info ] [Thread-4 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m20:57:31.940481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:31.940828 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:57:31.941200 [info ] [Thread-3 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m20:57:31.941682 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m20:57:31.942229 [info ] [Thread-2 (]: 11 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m20:57:31.942601 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m20:57:31.942952 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:57:31.943308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m20:57:31.943651 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:57:31.946383 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:57:31.946768 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:57:31.947085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:31.951333 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:57:31.954068 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:57:31.954495 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m20:57:31.954810 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:57:31.955405 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:57:31.955783 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:57:31.956126 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:57:31.957746 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:57:31.959335 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:57:31.960853 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:57:31.961178 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:57:31.961879 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:57:31.963117 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m20:57:31.963535 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:57:31.963909 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m20:57:31.964238 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:57:31.964659 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m20:57:31.965001 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m20:57:31.965324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:31.965648 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m20:57:31.965958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:31.966490 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.05s]
[0m20:57:31.966931 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:31.967499 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m20:57:31.967992 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:57:31.968329 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m20:57:31.968764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m20:57:31.969104 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:57:31.971896 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:57:31.972449 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:31.972804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:57:31.973195 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:31.973524 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m20:57:31.973896 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m20:57:31.974263 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m20:57:31.974574 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:57:31.974931 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m20:57:31.975293 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:57:31.975641 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m20:57:31.977204 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:57:31.977888 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:57:31.978216 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:31.978523 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:31.978828 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:31.979147 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m20:57:31.980304 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m20:57:31.981381 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m20:57:31.982459 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m20:57:31.982792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:31.983279 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m20:57:31.983582 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m20:57:31.983884 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m20:57:31.984508 [info ] [Thread-2 (]: 11 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m20:57:31.984981 [info ] [Thread-4 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m20:57:31.985561 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m20:57:31.985980 [info ] [Thread-3 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m20:57:31.986512 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m20:57:31.986883 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:57:31.987387 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m20:57:31.987779 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:57:31.988161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:31.988500 [info ] [Thread-2 (]: 13 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m20:57:31.988888 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:57:31.989326 [info ] [Thread-4 (]: 14 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m20:57:31.989686 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m20:57:31.990040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m20:57:31.990395 [info ] [Thread-3 (]: 15 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m20:57:31.990763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m20:57:31.991109 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:57:31.991457 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:57:31.991793 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m20:57:31.992123 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:57:31.996177 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:57:31.996549 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:57:31.996880 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:57:32.000296 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:57:32.001513 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m20:57:32.004270 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:57:32.004764 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:57:32.005216 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:57:32.005605 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m20:57:32.007149 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:57:32.008723 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:57:32.009083 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:57:32.009669 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m20:57:32.011476 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:57:32.011838 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:57:32.012221 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:57:32.012682 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m20:57:32.013092 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m20:57:32.013575 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:57:32.013891 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m20:57:32.014258 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:57:32.014612 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:32.014938 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m20:57:32.015263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:32.015587 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m20:57:32.016028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:32.016504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m20:57:32.017000 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:57:32.019678 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:57:32.020261 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:57:32.020621 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.021019 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:57:32.021380 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m20:57:32.021734 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:57:32.022071 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m20:57:32.022429 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m20:57:32.022769 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.024380 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:57:32.024740 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:57:32.025102 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.025784 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:57:32.026140 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.026453 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m20:57:32.026771 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.027088 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.028225 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m20:57:32.028578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:32.029627 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m20:57:32.030702 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m20:57:32.031228 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m20:57:32.031602 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m20:57:32.031958 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m20:57:32.032480 [info ] [Thread-2 (]: 13 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m20:57:32.032897 [info ] [Thread-3 (]: 15 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m20:57:32.033991 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m20:57:32.033573 [info ] [Thread-4 (]: 14 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m20:57:32.034571 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m20:57:32.034887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:57:32.035274 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:57:32.035777 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m20:57:32.036130 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:57:32.036500 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m20:57:32.036843 [info ] [Thread-2 (]: 17 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m20:57:32.037228 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:57:32.037595 [info ] [Thread-3 (]: 18 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m20:57:32.037973 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.038367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m20:57:32.038705 [info ] [Thread-4 (]: 19 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m20:57:32.039058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m20:57:32.039463 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:57:32.039802 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m20:57:32.040121 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:57:32.043021 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:57:32.043401 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:57:32.043704 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:57:32.047661 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:57:32.051160 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:57:32.052357 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m20:57:32.052736 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:57:32.053405 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:57:32.054945 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:57:32.055296 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:57:32.055607 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m20:57:32.057138 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:57:32.058897 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:57:32.059301 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:57:32.059875 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m20:57:32.060486 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:57:32.060833 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m20:57:32.061196 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:57:32.061669 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m20:57:32.061995 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m20:57:32.062325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:32.062654 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m20:57:32.063012 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m20:57:32.063380 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:32.063815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:32.064173 [info ] [Thread-1 (]: 20 of 33 START test test_counts_match .......................................... [RUN]
[0m20:57:32.064831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m20:57:32.065170 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m20:57:32.067237 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m20:57:32.067771 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.068115 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.068540 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m20:57:32.068848 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m20:57:32.069188 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.069544 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m20:57:32.069881 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.071474 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m20:57:32.071830 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m20:57:32.072174 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.072693 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.073110 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:57:32.073535 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m20:57:32.073830 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.074138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:32.074448 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.075574 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m20:57:32.075937 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:32.077082 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m20:57:32.078218 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m20:57:32.078559 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m20:57:32.078993 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m20:57:32.079340 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m20:57:32.079853 [info ] [Thread-2 (]: 17 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m20:57:32.080390 [info ] [Thread-3 (]: 18 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m20:57:32.080739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:32.081273 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m20:57:32.081695 [info ] [Thread-4 (]: 19 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m20:57:32.082167 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m20:57:32.082505 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m20:57:32.082874 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:57:32.083371 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m20:57:32.083712 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:57:32.084073 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m20:57:32.084434 [info ] [Thread-2 (]: 21 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m20:57:32.084818 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:57:32.085168 [info ] [Thread-3 (]: 22 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m20:57:32.085610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m20:57:32.085950 [info ] [Thread-4 (]: 23 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m20:57:32.086319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m20:57:32.086654 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:57:32.086998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m20:57:32.087331 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:57:32.087640 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:32.090550 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:57:32.090912 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:57:32.093666 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:57:32.094810 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m20:57:32.098367 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:57:32.098891 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:57:32.099326 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m20:57:32.102210 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:57:32.102645 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:57:32.103025 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:57:32.103572 [info ] [Thread-1 (]: 20 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m20:57:32.105162 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:57:32.106796 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:57:32.107195 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:57:32.107676 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m20:57:32.108215 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m20:57:32.108638 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:57:32.108975 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:57:32.109435 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:57:32.109742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:32.110176 [info ] [Thread-1 (]: 24 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m20:57:32.110562 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m20:57:32.110919 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m20:57:32.111406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m20:57:32.111734 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:32.112073 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:32.112429 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:57:32.115332 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:57:32.115886 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:57:32.116218 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:57:32.116556 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.116939 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m20:57:32.117279 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.118835 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:57:32.119217 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m20:57:32.119591 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.119925 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m20:57:32.120386 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.120809 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:57:32.121181 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m20:57:32.121595 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m20:57:32.121889 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.122265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:32.122566 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.123733 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m20:57:32.124051 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:32.125241 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m20:57:32.126418 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m20:57:32.126772 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m20:57:32.127172 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m20:57:32.127506 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m20:57:32.128024 [info ] [Thread-2 (]: 21 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m20:57:32.128563 [info ] [Thread-4 (]: 23 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m20:57:32.128912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:32.129415 [info ] [Thread-3 (]: 22 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m20:57:32.129875 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m20:57:32.130338 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m20:57:32.130662 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m20:57:32.131100 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m20:57:32.131475 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_survey_type
[0m20:57:32.131831 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_source_format
[0m20:57:32.132214 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:57:32.132591 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_time
[0m20:57:32.133031 [info ] [Thread-2 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m20:57:32.133469 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m20:57:32.133952 [info ] [Thread-3 (]: 27 of 33 START sql table model public.dim_time ................................. [RUN]
[0m20:57:32.134343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now model.caspian_vault.dim_survey_type)
[0m20:57:32.134683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:57:32.135035 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_source_format)
[0m20:57:32.135391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now model.caspian_vault.dim_time)
[0m20:57:32.135725 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m20:57:32.136819 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m20:57:32.137163 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_source_format
[0m20:57:32.137496 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_time
[0m20:57:32.139710 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m20:57:32.141756 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m20:57:32.142080 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m20:57:32.144121 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m20:57:32.144943 [info ] [Thread-1 (]: 24 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.03s]
[0m20:57:32.145313 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_source_format
[0m20:57:32.145753 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_survey_type
[0m20:57:32.146195 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m20:57:32.148907 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m20:57:32.149239 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_time
[0m20:57:32.153095 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m20:57:32.153506 [debug] [Thread-1 (]: Began running node model.caspian_vault.fct_readings
[0m20:57:32.156294 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m20:57:32.156822 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:57:32.157271 [info ] [Thread-1 (]: 28 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m20:57:32.157788 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m20:57:32.158183 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:57:32.158573 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:57:32.158913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now model.caspian_vault.fct_readings)
[0m20:57:32.159242 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:32.159576 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m20:57:32.159902 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: BEGIN
[0m20:57:32.160230 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.fct_readings
[0m20:57:32.160675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:32.160989 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:32.163215 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m20:57:32.163917 [debug] [Thread-1 (]: Began executing node model.caspian_vault.fct_readings
[0m20:57:32.166552 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m20:57:32.166902 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m20:57:32.167486 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:57:32.167806 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:32.168136 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m20:57:32.168562 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:57:32.168878 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m20:57:32.169213 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:57:32.169564 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:57:32.169896 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: BEGIN
[0m20:57:32.170307 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m20:57:32.170654 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m20:57:32.170984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:32.174757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:32.175097 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:57:32.175553 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m20:57:32.179387 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.008 seconds
[0m20:57:32.182003 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:57:32.182342 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:57:32.182699 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m20:57:32.185006 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:57:32.185392 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.015 seconds
[0m20:57:32.185773 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:57:32.186089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.188455 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:57:32.190586 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:57:32.190952 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m20:57:32.191276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:57:32.191615 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m20:57:32.193768 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:57:32.194172 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.018 seconds
[0m20:57:32.194624 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:57:32.194927 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:57:32.195281 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:57:32.198483 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:57:32.200545 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:57:32.201559 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:57:32.201955 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m20:57:32.202323 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.202636 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m20:57:32.202976 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:57:32.204009 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:57:32.204344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:57:32.204710 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m20:57:32.205008 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.205459 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:57:32.207499 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:57:32.208536 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:57:32.208878 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: COMMIT
[0m20:57:32.209205 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m20:57:32.209560 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:57:32.209966 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m20:57:32.210311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.211263 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:57:32.211583 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:57:32.211856 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m20:57:32.226503 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m20:57:32.228288 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m20:57:32.228662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m20:57:32.229009 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m20:57:32.229461 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m20:57:32.229766 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m20:57:32.231500 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m20:57:32.233116 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m20:57:32.233483 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m20:57:32.235103 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m20:57:32.235634 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m20:57:32.236089 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m20:57:32.236605 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m20:57:32.236970 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m20:57:32.237335 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m20:57:32.237668 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m20:57:32.238568 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:57:32.239654 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: Close
[0m20:57:32.240168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa4f78290>]}
[0m20:57:32.240529 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:57:32.241409 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:57:32.241080 [info ] [Thread-2 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.11s]
[0m20:57:32.242561 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: Close
[0m20:57:32.242866 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:57:32.243913 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: Close
[0m20:57:32.244391 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_survey_type
[0m20:57:32.245454 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: Close
[0m20:57:32.245839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa0593410>]}
[0m20:57:32.246338 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_well
[0m20:57:32.246725 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa05e2cf0>]}
[0m20:57:32.247869 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa33c0350>]}
[0m20:57:32.247465 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.09s]
[0m20:57:32.248398 [info ] [Thread-2 (]: 29 of 33 START sql table model public.dim_well ................................. [RUN]
[0m20:57:32.248932 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.11s]
[0m20:57:32.249484 [info ] [Thread-3 (]: 27 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.11s]
[0m20:57:32.249985 [debug] [Thread-1 (]: Finished running node model.caspian_vault.fct_readings
[0m20:57:32.250349 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.dim_well)
[0m20:57:32.250806 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_source_format
[0m20:57:32.251242 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_time
[0m20:57:32.251870 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m20:57:32.252193 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_well
[0m20:57:32.252586 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_survey_summary
[0m20:57:32.252978 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_well_performance
[0m20:57:32.253421 [info ] [Thread-1 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m20:57:32.255881 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m20:57:32.256329 [info ] [Thread-4 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m20:57:32.256753 [info ] [Thread-3 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m20:57:32.257132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now model.caspian_vault.mart_sensor_analysis)
[0m20:57:32.257571 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_survey_summary)
[0m20:57:32.257946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_well_performance)
[0m20:57:32.258325 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_well
[0m20:57:32.258640 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m20:57:32.258995 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m20:57:32.259352 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m20:57:32.262032 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m20:57:32.265138 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.267161 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m20:57:32.269137 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m20:57:32.269906 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m20:57:32.270287 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:57:32.270826 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m20:57:32.273362 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.273726 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_well_performance
[0m20:57:32.274058 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: BEGIN
[0m20:57:32.276689 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m20:57:32.279354 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m20:57:32.279794 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.280101 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:32.280709 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m20:57:32.281053 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:57:32.281567 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:57:32.281914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:32.282306 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m20:57:32.282658 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m20:57:32.283084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:32.283413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:32.285009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:57:32.285354 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:57:32.285669 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m20:57:32.286265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:32.286566 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.286908 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m20:57:32.287231 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:32.287774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:32.288122 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:57:32.288479 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:57:32.288831 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:57:32.289174 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m20:57:32.289930 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.004 seconds
[0m20:57:32.292332 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:57:32.292653 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m20:57:32.293147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.295189 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:57:32.295516 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m20:57:32.295974 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.296935 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:57:32.297235 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.009 seconds
[0m20:57:32.297578 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:57:32.299888 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.301198 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.012 seconds
[0m20:57:32.301564 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.012 seconds
[0m20:57:32.301857 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m20:57:32.302192 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m20:57:32.365425 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:57:32.368053 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:57:32.368603 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m20:57:32.368972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.369319 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m20:57:32.371501 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.371866 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:57:32.372164 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:57:32.372541 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m20:57:32.372898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.374484 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m20:57:32.376504 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:57:32.378627 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:57:32.378986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:57:32.379492 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m20:57:32.379836 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m20:57:32.380172 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m20:57:32.381199 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:57:32.381560 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m20:57:32.381984 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.382352 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:57:32.382673 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:57:32.383048 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m20:57:32.384021 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:57:32.385007 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:57:32.385417 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:57:32.385716 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:57:32.386082 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:57:32.386442 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m20:57:32.386777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:57:32.387774 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: Close
[0m20:57:32.388101 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m20:57:32.389835 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m20:57:32.390157 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:57:32.390821 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa040b9e0>]}
[0m20:57:32.391300 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m20:57:32.392915 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m20:57:32.393349 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:57:32.393857 [info ] [Thread-2 (]: 29 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.14s]
[0m20:57:32.394230 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m20:57:32.394700 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m20:57:32.396329 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m20:57:32.396800 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_well
[0m20:57:32.397181 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m20:57:32.397654 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m20:57:32.398154 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m20:57:32.399083 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:57:32.400095 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m20:57:32.400416 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:57:32.401607 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: Close
[0m20:57:32.402015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa04c6960>]}
[0m20:57:32.402367 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:57:32.402899 [info ] [Thread-1 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.14s]
[0m20:57:32.403325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa04c78c0>]}
[0m20:57:32.404419 [debug] [Thread-4 (]: On model.caspian_vault.mart_survey_summary: Close
[0m20:57:32.404871 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m20:57:32.405361 [info ] [Thread-3 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.15s]
[0m20:57:32.405936 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa04dddc0>]}
[0m20:57:32.406396 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_well_performance
[0m20:57:32.406859 [info ] [Thread-4 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.15s]
[0m20:57:32.407421 [debug] [Thread-2 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:32.407868 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m20:57:32.408274 [info ] [Thread-2 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m20:57:32.408722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:57:32.409020 [debug] [Thread-2 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:32.412577 [debug] [Thread-2 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:32.447593 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.447986 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:57:32.448298 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:32.452629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:32.452953 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.453264 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:57:32.458454 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:57:32.488832 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.489283 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp205732488145"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:57:32.491741 [debug] [Thread-2 (]: SQL status: SELECT 42 in 0.002 seconds
[0m20:57:32.493903 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.494238 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205732488145'
        
      order by ordinal_position

  
[0m20:57:32.496646 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:57:32.498885 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.499218 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:57:32.501101 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.002 seconds
[0m20:57:32.503340 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.503675 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205732488145'
        
      order by ordinal_position

  
[0m20:57:32.505544 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:57:32.507798 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.508138 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:57:32.509985 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.002 seconds
[0m20:57:32.515719 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.516098 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205732488145'
        
      order by ordinal_position

  
[0m20:57:32.518001 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:57:32.530767 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.531184 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:57:32.531927 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:57:32.535873 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.536215 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:57:32.536737 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:57:32.537156 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.537683 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.538046 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp205732488145" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp205732488145" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:57:32.538927 [debug] [Thread-2 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m20:57:32.539883 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:57:32.540192 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:32.540492 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:57:32.542821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:57:32.544795 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:57:32.545333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4cdfd58-d6e1-4f4a-812e-7c93fe8abd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa046c230>]}
[0m20:57:32.545977 [info ] [Thread-2 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m20:57:32.546467 [debug] [Thread-2 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:32.547802 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:32.548111 [debug] [MainThread]: On master: BEGIN
[0m20:57:32.548403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:32.552412 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:57:32.552736 [debug] [MainThread]: On master: COMMIT
[0m20:57:32.553017 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:32.553295 [debug] [MainThread]: On master: COMMIT
[0m20:57:32.553647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:57:32.553933 [debug] [MainThread]: On master: Close
[0m20:57:32.554328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:32.554600 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:57:32.554840 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m20:57:32.555069 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m20:57:32.555313 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m20:57:32.555653 [info ] [MainThread]: 
[0m20:57:32.555951 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m20:57:32.559546 [debug] [MainThread]: Command end result
[0m20:57:32.585460 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:57:32.586988 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:57:32.592783 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:57:32.593126 [info ] [MainThread]: 
[0m20:57:32.593476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:32.593782 [info ] [MainThread]: 
[0m20:57:32.594078 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m20:57:32.594678 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:57:32.595565 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.322251, "process_in_blocks": "0", "process_kernel_time": 0.33803, "process_mem_max_rss": "140248", "process_out_blocks": "4896", "process_user_time": 4.170372}
[0m20:57:32.596036 [debug] [MainThread]: Command `dbt build` succeeded at 20:57:32.595956 after 3.32 seconds
[0m20:57:32.596388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaa74c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa8b2e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa0432ed0>]}
[0m20:57:32.596724 [debug] [MainThread]: Flushing usage events
[0m20:57:33.118463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:34.677880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e36c3c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e364840b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e358b3e00>]}


============================== 20:57:34.682692 | 18624d5b-2654-442c-a76f-60bb756427d1 ==============================
[0m20:57:34.682692 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:57:34.683125 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': '/opt/airflow/dbt_target', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/logs/dbt', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'empty': 'False', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles'}
[0m20:57:34.726880 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m20:57:34.727351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e350a2780>]}
[0m20:57:34.727793 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:57:34.728126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e36c3c8c0>]}
[0m20:57:34.845860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e381336e0>]}
[0m20:57:34.903767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e356f2e10>]}
[0m20:57:34.904570 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:57:35.016039 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m20:57:35.140810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:35.141218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:35.146305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m20:57:35.196818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e34d6b140>]}
[0m20:57:35.293591 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:57:35.295195 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:57:35.312863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e345a4170>]}
[0m20:57:35.313332 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m20:57:35.313667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e3595b380>]}
[0m20:57:35.315567 [info ] [MainThread]: 
[0m20:57:35.315923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:35.316203 [info ] [MainThread]: 
[0m20:57:35.316683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:57:35.317527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:57:35.349881 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:57:35.350232 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:57:35.350547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:35.355891 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m20:57:35.356924 [debug] [ThreadPool]: On list_airflow: Close
[0m20:57:35.361089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:57:35.365400 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:57:35.365814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_snapshots'
[0m20:57:35.366171 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:57:35.368241 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:57:35.368567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:35.368856 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m20:57:35.369316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:35.372802 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:57:35.373147 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:57:35.373423 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:57:35.373736 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:57:35.374036 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m20:57:35.374405 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:57:35.376382 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m20:57:35.376704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:57:35.378214 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:57:35.379156 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m20:57:35.379558 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:57:35.379815 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m20:57:35.389182 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:35.389528 [debug] [MainThread]: On master: BEGIN
[0m20:57:35.389790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:35.393441 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:57:35.393766 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:35.394097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:57:35.416211 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:57:35.417381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e33d425d0>]}
[0m20:57:35.417810 [debug] [MainThread]: On master: ROLLBACK
[0m20:57:35.418203 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:35.418512 [debug] [MainThread]: On master: BEGIN
[0m20:57:35.418924 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:57:35.419213 [debug] [MainThread]: On master: COMMIT
[0m20:57:35.419496 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:35.419751 [debug] [MainThread]: On master: COMMIT
[0m20:57:35.420073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:57:35.420374 [debug] [MainThread]: On master: Close
[0m20:57:35.423942 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:35.424417 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m20:57:35.424787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now snapshot.caspian_vault.snap_mart_well_performance)
[0m20:57:35.425085 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:35.430604 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:35.468861 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.469270 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m20:57:35.469562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:35.473862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:57:35.474193 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.474513 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:57:35.479721 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m20:57:35.518550 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.519007 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp205735512998"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:57:35.521439 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m20:57:35.524555 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.524895 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205735512998'
        
      order by ordinal_position

  
[0m20:57:35.527291 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:57:35.529638 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.529976 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:57:35.531790 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m20:57:35.534119 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.534465 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205735512998'
        
      order by ordinal_position

  
[0m20:57:35.536335 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:57:35.538724 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.539057 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:57:35.540900 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m20:57:35.545771 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.546115 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp205735512998'
        
      order by ordinal_position

  
[0m20:57:35.547992 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m20:57:35.560859 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.561294 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:57:35.562020 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:57:35.565883 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.566226 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:57:35.566759 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:57:35.567188 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.567718 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.568070 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp205735512998" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp205735512998" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:57:35.568950 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m20:57:35.579462 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:57:35.579822 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m20:57:35.580112 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m20:57:35.585078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:57:35.587854 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m20:57:35.589192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18624d5b-2654-442c-a76f-60bb756427d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e34d95370>]}
[0m20:57:35.589873 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m20:57:35.590386 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m20:57:35.591702 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:35.592023 [debug] [MainThread]: On master: BEGIN
[0m20:57:35.592305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:35.596282 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:57:35.596611 [debug] [MainThread]: On master: COMMIT
[0m20:57:35.596889 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:35.597147 [debug] [MainThread]: On master: COMMIT
[0m20:57:35.597507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:57:35.597786 [debug] [MainThread]: On master: Close
[0m20:57:35.598154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:35.598448 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m20:57:35.598707 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m20:57:35.598972 [info ] [MainThread]: 
[0m20:57:35.599270 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m20:57:35.599813 [debug] [MainThread]: Command end result
[0m20:57:35.672845 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m20:57:35.674414 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m20:57:35.679270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m20:57:35.679608 [info ] [MainThread]: 
[0m20:57:35.679971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:35.680270 [info ] [MainThread]: 
[0m20:57:35.680581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:57:35.681069 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:57:35.681948 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0460825, "process_in_blocks": "0", "process_kernel_time": 0.267216, "process_mem_max_rss": "128332", "process_out_blocks": "2760", "process_user_time": 2.009108}
[0m20:57:35.682418 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:57:35.682335 after 1.05 seconds
[0m20:57:35.682744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e3590e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e30706b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e30706f00>]}
[0m20:57:35.683068 [debug] [MainThread]: Flushing usage events
[0m20:57:36.086630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:02.759776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bc73eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bc3ef590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bc305a30>]}


============================== 21:00:02.764613 | 254a8e03-deab-4d20-aa39-0c277e195ac4 ==============================
[0m21:00:02.764613 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:00:02.765061 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/opt/airflow/logs/dbt', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:02.771171 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m21:00:02.771567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '254a8e03-deab-4d20-aa39-0c277e195ac4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bc47a030>]}
[0m21:00:02.771947 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m21:00:02.772272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '254a8e03-deab-4d20-aa39-0c277e195ac4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bc47a030>]}
[0m21:00:02.872879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '254a8e03-deab-4d20-aa39-0c277e195ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0baf49d00>]}
[0m21:00:02.891667 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dvgux375'
[0m21:00:02.892013 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:00:02.981390 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:00:02.982034 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:00:03.943203 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:00:03.946565 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:00:04.258087 [info ] [MainThread]: Installed from version 1.3.0
[0m21:00:04.258546 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:00:04.258869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '254a8e03-deab-4d20-aa39-0c277e195ac4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bc2bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bade1670>]}
[0m21:00:04.259200 [info ] [MainThread]: 
[0m21:00:04.259500 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:00:04.260144 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:00:04.260990 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5430913, "process_in_blocks": "0", "process_kernel_time": 0.218635, "process_mem_max_rss": "107744", "process_out_blocks": "2304", "process_user_time": 1.291843}
[0m21:00:04.261453 [debug] [MainThread]: Command `dbt deps` succeeded at 21:00:04.261376 after 1.54 seconds
[0m21:00:04.261747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bb1612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bae865a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0bde0dd00>]}
[0m21:00:04.262029 [debug] [MainThread]: Flushing usage events
[0m21:00:04.730782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:06.231427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc14a0df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc13807440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc13793e30>]}


============================== 21:00:06.236286 | 3ddf042b-6712-4a82-909e-02f76d47c02b ==============================
[0m21:00:06.236286 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:00:06.236733 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': '/opt/airflow/dbt_target', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'log_path': '/opt/airflow/logs/dbt', 'log_format': 'default'}
[0m21:00:06.281019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m21:00:06.281492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc12b26cf0>]}
[0m21:00:06.281940 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m21:00:06.282282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc13432a80>]}
[0m21:00:06.401525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc14412ab0>]}
[0m21:00:06.459890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc14da23f0>]}
[0m21:00:06.460692 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:00:06.574384 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m21:00:06.700005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:06.700439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:06.705605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m21:00:06.756570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1275b680>]}
[0m21:00:06.853849 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m21:00:06.855484 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m21:00:06.883264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc11f3fbc0>]}
[0m21:00:06.883726 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m21:00:06.887152 [info ] [MainThread]: 
[0m21:00:06.887522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:06.887801 [info ] [MainThread]: 
[0m21:00:06.888270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:06.892329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m21:00:06.892883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m21:00:06.927942 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m21:00:06.928334 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m21:00:06.928658 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m21:00:06.928966 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m21:00:06.929279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:06.929556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:06.934987 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m21:00:06.935297 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m21:00:06.936325 [debug] [ThreadPool]: On list_airflow: Close
[0m21:00:06.937332 [debug] [ThreadPool]: On list_airflow: Close
[0m21:00:06.939191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m21:00:06.939650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m21:00:06.943975 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m21:00:06.945309 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m21:00:06.945624 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m21:00:06.945914 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m21:00:06.946187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:06.946475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:06.950154 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:00:06.950510 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m21:00:06.950777 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:00:06.951095 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:00:06.951411 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m21:00:06.951761 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:00:06.953682 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m21:00:06.953962 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m21:00:06.955688 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m21:00:06.956611 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m21:00:06.957000 [debug] [ThreadPool]: On list_airflow_public: Close
[0m21:00:06.957263 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m21:00:06.966788 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:06.967113 [debug] [MainThread]: On master: BEGIN
[0m21:00:06.967395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:06.971040 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:00:06.971372 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:06.971703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:06.993401 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m21:00:06.994560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1138a150>]}
[0m21:00:06.994993 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:06.995415 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:06.995705 [debug] [MainThread]: On master: BEGIN
[0m21:00:06.996129 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:00:06.996458 [debug] [MainThread]: On master: COMMIT
[0m21:00:06.996724 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:06.996977 [debug] [MainThread]: On master: COMMIT
[0m21:00:06.997313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:06.997596 [debug] [MainThread]: On master: Close
[0m21:00:07.001113 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m21:00:07.001580 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m21:00:07.001951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.stg_readings)
[0m21:00:07.002272 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m21:00:07.008073 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m21:00:07.008614 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m21:00:07.037804 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m21:00:07.038389 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m21:00:07.038705 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m21:00:07.038980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.043140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.043492 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m21:00:07.043835 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m21:00:07.082165 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.038 seconds
[0m21:00:07.089819 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m21:00:07.090172 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m21:00:07.090752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.092863 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m21:00:07.093179 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m21:00:07.093647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.105367 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m21:00:07.105724 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m21:00:07.106015 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m21:00:07.110709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:00:07.115309 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m21:00:07.119433 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m21:00:07.119770 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m21:00:07.122781 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:00:07.124664 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m21:00:07.126007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc16063260>]}
[0m21:00:07.126560 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.12s]
[0m21:00:07.127046 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m21:00:07.127907 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m21:00:07.128312 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m21:00:07.128684 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m21:00:07.129076 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m21:00:07.129557 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m21:00:07.129957 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m21:00:07.130339 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m21:00:07.130682 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m21:00:07.140874 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m21:00:07.144177 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m21:00:07.144754 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m21:00:07.145127 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m21:00:07.158020 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m21:00:07.159655 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m21:00:07.160290 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m21:00:07.160681 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m21:00:07.161003 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m21:00:07.161345 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m21:00:07.161667 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:07.161970 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:00:07.165742 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.166131 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m21:00:07.166461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.166805 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m21:00:07.167139 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m21:00:07.167529 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m21:00:07.168772 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.169104 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.171583 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m21:00:07.172693 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m21:00:07.173139 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m21:00:07.173510 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m21:00:07.173987 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m21:00:07.174531 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m21:00:07.174939 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.05s]
[0m21:00:07.175557 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m21:00:07.176234 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m21:00:07.176606 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m21:00:07.176974 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m21:00:07.177630 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_sat_readings
[0m21:00:07.177371 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m21:00:07.178109 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m21:00:07.178550 [info ] [Thread-3 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m21:00:07.178971 [info ] [Thread-4 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m21:00:07.179364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m21:00:07.179714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.dv_hub_well)
[0m21:00:07.181322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m21:00:07.181676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m21:00:07.182007 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m21:00:07.182337 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m21:00:07.182657 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m21:00:07.182991 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m21:00:07.232710 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.235094 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m21:00:07.238214 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.240592 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m21:00:07.241314 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m21:00:07.241702 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m21:00:07.244471 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.244804 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m21:00:07.247461 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m21:00:07.247794 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m21:00:07.250573 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m21:00:07.251027 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.253698 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.254138 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m21:00:07.254589 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m21:00:07.255018 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m21:00:07.255440 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m21:00:07.255795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.256118 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.256476 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m21:00:07.256790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.257229 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m21:00:07.257568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.257984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.261284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.261642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.262061 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.262450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.262823 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.263143 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m21:00:07.263500 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m21:00:07.263851 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m21:00:07.264190 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.264539 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m21:00:07.264952 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m21:00:07.265326 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m21:00:07.289462 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.025 seconds
[0m21:00:07.293109 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.293460 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m21:00:07.293966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.295928 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.296268 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m21:00:07.296725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.297716 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m21:00:07.298063 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.032 seconds
[0m21:00:07.298408 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.300671 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m21:00:07.301008 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m21:00:07.301347 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m21:00:07.301915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.303965 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m21:00:07.304299 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m21:00:07.304755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.305724 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m21:00:07.306038 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m21:00:07.306327 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m21:00:07.309721 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.044 seconds
[0m21:00:07.311970 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.312304 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m21:00:07.312807 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.314775 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.315106 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.049 seconds
[0m21:00:07.315479 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m21:00:07.317832 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m21:00:07.318229 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m21:00:07.318579 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.319573 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m21:00:07.319879 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.320209 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.322216 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m21:00:07.322571 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m21:00:07.322894 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m21:00:07.323426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.324380 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m21:00:07.324697 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m21:00:07.324983 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m21:00:07.340174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m21:00:07.342004 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m21:00:07.342532 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m21:00:07.342841 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m21:00:07.371648 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m21:00:07.372104 [debug] [Thread-3 (]: SQL status: COMMIT in 0.049 seconds
[0m21:00:07.375084 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m21:00:07.375458 [debug] [Thread-2 (]: SQL status: COMMIT in 0.069 seconds
[0m21:00:07.375786 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m21:00:07.377440 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m21:00:07.377954 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m21:00:07.379638 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m21:00:07.380793 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m21:00:07.381277 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m21:00:07.381628 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m21:00:07.382137 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m21:00:07.382575 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m21:00:07.383093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1069d610>]}
[0m21:00:07.383563 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m21:00:07.384208 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.20s]
[0m21:00:07.384812 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m21:00:07.385390 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m21:00:07.385700 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m21:00:07.386037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m21:00:07.386360 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:00:07.386708 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m21:00:07.387128 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:00:07.387477 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:00:07.388513 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: Close
[0m21:00:07.393428 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m21:00:07.394509 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m21:00:07.395516 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m21:00:07.396026 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1032f140>]}
[0m21:00:07.396518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc105cd0a0>]}
[0m21:00:07.396965 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m21:00:07.397362 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc104cfd10>]}
[0m21:00:07.397828 [info ] [Thread-4 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.21s]
[0m21:00:07.398376 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.22s]
[0m21:00:07.400048 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m21:00:07.400558 [info ] [Thread-3 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.22s]
[0m21:00:07.401057 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m21:00:07.401495 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m21:00:07.401998 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m21:00:07.402408 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m21:00:07.402743 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m21:00:07.403172 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m21:00:07.403680 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m21:00:07.404214 [info ] [Thread-4 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m21:00:07.404608 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m21:00:07.404942 [info ] [Thread-2 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m21:00:07.405315 [info ] [Thread-3 (]: 11 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m21:00:07.405694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m21:00:07.406018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.406368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m21:00:07.406713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m21:00:07.407036 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m21:00:07.407493 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m21:00:07.407817 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m21:00:07.410626 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m21:00:07.415072 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m21:00:07.415440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m21:00:07.418073 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m21:00:07.418685 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m21:00:07.419040 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m21:00:07.419392 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m21:00:07.421046 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m21:00:07.421460 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.421782 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m21:00:07.424431 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m21:00:07.426115 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m21:00:07.426545 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m21:00:07.426870 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:00:07.427420 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m21:00:07.427822 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m21:00:07.428197 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m21:00:07.429382 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m21:00:07.429720 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.430049 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m21:00:07.430390 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m21:00:07.430897 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m21:00:07.431221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.431599 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.432193 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.05s]
[0m21:00:07.432831 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m21:00:07.433171 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m21:00:07.433554 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m21:00:07.433898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m21:00:07.434243 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m21:00:07.434565 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.437356 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m21:00:07.437823 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m21:00:07.438174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m21:00:07.438594 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m21:00:07.438982 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.439350 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m21:00:07.439695 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m21:00:07.440030 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m21:00:07.441694 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m21:00:07.442030 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:00:07.442391 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:00:07.442765 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.444074 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m21:00:07.444632 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m21:00:07.444996 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m21:00:07.445293 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m21:00:07.445617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.445933 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.446257 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:00:07.446825 [info ] [Thread-4 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m21:00:07.447955 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m21:00:07.449024 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m21:00:07.449534 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m21:00:07.450036 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m21:00:07.450360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.450678 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m21:00:07.451024 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m21:00:07.451376 [info ] [Thread-4 (]: 13 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m21:00:07.451756 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m21:00:07.452281 [info ] [Thread-2 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.05s]
[0m21:00:07.453082 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m21:00:07.452785 [info ] [Thread-3 (]: 11 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.05s]
[0m21:00:07.453554 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.454047 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m21:00:07.454404 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m21:00:07.454863 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m21:00:07.455299 [debug] [Thread-2 (]: Began running node test.caspian_vault.test_counts_match
[0m21:00:07.458207 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m21:00:07.458709 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m21:00:07.459032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:00:07.459443 [info ] [Thread-2 (]: 14 of 33 START test test_counts_match .......................................... [RUN]
[0m21:00:07.459892 [info ] [Thread-3 (]: 15 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m21:00:07.461026 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m21:00:07.461424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.test_counts_match)
[0m21:00:07.461736 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m21:00:07.462134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m21:00:07.462551 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.test_counts_match
[0m21:00:07.462876 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m21:00:07.464447 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m21:00:07.464803 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m21:00:07.466925 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m21:00:07.467554 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.03s]
[0m21:00:07.470441 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m21:00:07.470954 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m21:00:07.471451 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m21:00:07.471849 [debug] [Thread-2 (]: Began executing node test.caspian_vault.test_counts_match
[0m21:00:07.472202 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m21:00:07.472587 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m21:00:07.472991 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m21:00:07.474557 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m21:00:07.474898 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.475228 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m21:00:07.476798 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m21:00:07.477403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m21:00:07.477736 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m21:00:07.478194 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m21:00:07.478606 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m21:00:07.478919 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m21:00:07.482653 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m21:00:07.483065 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m21:00:07.483419 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.483739 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m21:00:07.484164 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.484651 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m21:00:07.484987 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m21:00:07.486661 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m21:00:07.487029 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.487594 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m21:00:07.487961 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m21:00:07.488295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.488644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.489027 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m21:00:07.489366 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:00:07.489682 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.490150 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m21:00:07.491338 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m21:00:07.491706 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m21:00:07.492165 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.492501 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m21:00:07.493060 [info ] [Thread-4 (]: 13 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m21:00:07.493490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.493858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.494311 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m21:00:07.494613 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:00:07.495719 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m21:00:07.496072 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m21:00:07.496446 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m21:00:07.497550 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m21:00:07.497947 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.498305 [info ] [Thread-4 (]: 17 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m21:00:07.498636 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m21:00:07.499048 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: Close
[0m21:00:07.499400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m21:00:07.499965 [info ] [Thread-3 (]: 15 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m21:00:07.500373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.500711 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m21:00:07.501127 [info ] [Thread-2 (]: 14 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m21:00:07.501637 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m21:00:07.502704 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m21:00:07.505603 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m21:00:07.506085 [debug] [Thread-2 (]: Finished running node test.caspian_vault.test_counts_match
[0m21:00:07.506444 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m21:00:07.506955 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m21:00:07.507262 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m21:00:07.508123 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m21:00:07.507779 [info ] [Thread-3 (]: 18 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m21:00:07.508492 [info ] [Thread-2 (]: 19 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m21:00:07.510270 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m21:00:07.510709 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.03s]
[0m21:00:07.511101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m21:00:07.511459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m21:00:07.511979 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m21:00:07.512349 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m21:00:07.512701 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m21:00:07.513029 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m21:00:07.513375 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m21:00:07.516152 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m21:00:07.516545 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m21:00:07.519201 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m21:00:07.519585 [info ] [Thread-1 (]: 20 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m21:00:07.520032 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.520484 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m21:00:07.520864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m21:00:07.521377 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m21:00:07.522958 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m21:00:07.523334 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m21:00:07.524996 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m21:00:07.527817 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m21:00:07.528294 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m21:00:07.528650 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m21:00:07.529263 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m21:00:07.529659 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m21:00:07.529981 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m21:00:07.530299 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m21:00:07.530655 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:00:07.530994 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m21:00:07.531329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.533793 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m21:00:07.534200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.534902 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m21:00:07.535289 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m21:00:07.535600 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.535918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.537043 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m21:00:07.537610 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m21:00:07.538612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m21:00:07.538299 [info ] [Thread-4 (]: 17 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m21:00:07.539051 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m21:00:07.539365 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.539832 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m21:00:07.540177 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.540591 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m21:00:07.540934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.541330 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m21:00:07.541847 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.542207 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m21:00:07.542583 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.542895 [info ] [Thread-4 (]: 21 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m21:00:07.543343 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.543679 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m21:00:07.544770 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m21:00:07.545140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m21:00:07.546270 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m21:00:07.546634 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.546985 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m21:00:07.547343 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m21:00:07.548425 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m21:00:07.548745 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m21:00:07.554945 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m21:00:07.555521 [info ] [Thread-3 (]: 18 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m21:00:07.555879 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m21:00:07.556973 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m21:00:07.556517 [info ] [Thread-2 (]: 19 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m21:00:07.557550 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m21:00:07.558348 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m21:00:07.558054 [info ] [Thread-1 (]: 20 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m21:00:07.558919 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m21:00:07.560537 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m21:00:07.560900 [info ] [Thread-3 (]: 22 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m21:00:07.561383 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m21:00:07.561729 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m21:00:07.562187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m21:00:07.562621 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m21:00:07.562956 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m21:00:07.563336 [info ] [Thread-2 (]: 23 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m21:00:07.563695 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m21:00:07.564053 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m21:00:07.564400 [info ] [Thread-1 (]: 24 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m21:00:07.564766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m21:00:07.568677 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m21:00:07.569045 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.569399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m21:00:07.569737 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m21:00:07.570302 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m21:00:07.570603 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m21:00:07.574620 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m21:00:07.577340 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m21:00:07.577702 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m21:00:07.579329 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m21:00:07.579897 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m21:00:07.580263 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m21:00:07.580648 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m21:00:07.581077 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.581508 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m21:00:07.583106 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m21:00:07.584662 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m21:00:07.585079 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m21:00:07.585632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.585974 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.586486 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m21:00:07.586887 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m21:00:07.588042 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m21:00:07.588416 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m21:00:07.588760 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m21:00:07.589135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.589456 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m21:00:07.589821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.590143 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.590863 [info ] [Thread-4 (]: 21 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.05s]
[0m21:00:07.591291 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m21:00:07.591774 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m21:00:07.592155 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.592579 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_survey_type
[0m21:00:07.593098 [info ] [Thread-4 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m21:00:07.593474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now model.caspian_vault.dim_survey_type)
[0m21:00:07.593874 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:00:07.594190 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m21:00:07.594623 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.595730 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m21:00:07.596063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m21:00:07.599274 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m21:00:07.599642 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m21:00:07.600027 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m21:00:07.600348 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m21:00:07.600781 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:00:07.601157 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:00:07.601546 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_survey_type
[0m21:00:07.602077 [info ] [Thread-3 (]: 22 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m21:00:07.604909 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m21:00:07.605328 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:00:07.605766 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m21:00:07.606063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:00:07.607286 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m21:00:07.607715 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_source_format
[0m21:00:07.608051 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m21:00:07.609163 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m21:00:07.609647 [info ] [Thread-3 (]: 26 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m21:00:07.609995 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m21:00:07.610360 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m21:00:07.610752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_source_format)
[0m21:00:07.611103 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m21:00:07.611580 [info ] [Thread-2 (]: 23 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.05s]
[0m21:00:07.611916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.612270 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_source_format
[0m21:00:07.612786 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m21:00:07.613194 [info ] [Thread-1 (]: 24 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m21:00:07.615446 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m21:00:07.615843 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_time
[0m21:00:07.616379 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m21:00:07.616915 [info ] [Thread-2 (]: 27 of 33 START sql table model public.dim_time ................................. [RUN]
[0m21:00:07.617321 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.617736 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_well
[0m21:00:07.618071 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_source_format
[0m21:00:07.618560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_time)
[0m21:00:07.618900 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m21:00:07.619320 [info ] [Thread-1 (]: 28 of 33 START sql table model public.dim_well ................................. [RUN]
[0m21:00:07.622007 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m21:00:07.622371 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_time
[0m21:00:07.622703 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m21:00:07.623067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now model.caspian_vault.dim_well)
[0m21:00:07.625208 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m21:00:07.625697 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m21:00:07.626037 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_well
[0m21:00:07.626467 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m21:00:07.628501 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m21:00:07.628882 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_time
[0m21:00:07.629184 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.631897 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m21:00:07.632260 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.007 seconds
[0m21:00:07.632805 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_well
[0m21:00:07.635189 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m21:00:07.638687 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m21:00:07.639082 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m21:00:07.639457 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m21:00:07.639915 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: BEGIN
[0m21:00:07.640528 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m21:00:07.640935 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m21:00:07.641275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.641574 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.641910 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m21:00:07.642241 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: BEGIN
[0m21:00:07.644433 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m21:00:07.644791 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m21:00:07.645128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.645481 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m21:00:07.646001 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:00:07.646426 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m21:00:07.646745 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.647088 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m21:00:07.648140 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m21:00:07.648552 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m21:00:07.648849 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m21:00:07.649310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.649637 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m21:00:07.650803 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m21:00:07.651125 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:00:07.652853 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m21:00:07.653348 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m21:00:07.653658 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m21:00:07.655254 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m21:00:07.657573 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m21:00:07.657916 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:00:07.658300 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.007 seconds
[0m21:00:07.658619 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.013 seconds
[0m21:00:07.658917 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:00:07.659940 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: Close
[0m21:00:07.662301 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m21:00:07.664610 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m21:00:07.665072 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m21:00:07.665580 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc103227b0>]}
[0m21:00:07.665909 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.666236 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m21:00:07.667179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.666873 [info ] [Thread-4 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.07s]
[0m21:00:07.669362 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m21:00:07.671519 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m21:00:07.671857 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:00:07.672361 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_survey_type
[0m21:00:07.672710 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:00:07.673060 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m21:00:07.675167 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m21:00:07.675581 [debug] [Thread-4 (]: Began running node model.caspian_vault.fct_readings
[0m21:00:07.676078 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m21:00:07.676417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.676825 [info ] [Thread-4 (]: 29 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m21:00:07.677221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.678233 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: COMMIT
[0m21:00:07.678570 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.678934 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m21:00:07.679904 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: COMMIT
[0m21:00:07.680266 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m21:00:07.681230 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m21:00:07.681587 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.fct_readings
[0m21:00:07.681927 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m21:00:07.682243 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: COMMIT
[0m21:00:07.682582 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m21:00:07.685010 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m21:00:07.685370 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: COMMIT
[0m21:00:07.685725 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m21:00:07.686273 [debug] [Thread-4 (]: Began executing node model.caspian_vault.fct_readings
[0m21:00:07.689997 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m21:00:07.690345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m21:00:07.690661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m21:00:07.690964 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:00:07.692638 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m21:00:07.694277 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m21:00:07.694641 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m21:00:07.696280 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m21:00:07.696751 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m21:00:07.697207 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m21:00:07.697556 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: BEGIN
[0m21:00:07.698014 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m21:00:07.698357 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m21:00:07.698685 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m21:00:07.699002 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.699337 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m21:00:07.701967 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:00:07.703008 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: Close
[0m21:00:07.703492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc10468d10>]}
[0m21:00:07.703815 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:00:07.704137 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:00:07.704688 [info ] [Thread-2 (]: 27 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.08s]
[0m21:00:07.705034 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m21:00:07.706079 [debug] [Thread-1 (]: On model.caspian_vault.dim_well: Close
[0m21:00:07.707077 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: Close
[0m21:00:07.707542 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_time
[0m21:00:07.707873 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m21:00:07.708370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1045c7d0>]}
[0m21:00:07.708780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc10211d90>]}
[0m21:00:07.709223 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m21:00:07.709741 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.09s]
[0m21:00:07.710269 [info ] [Thread-3 (]: 26 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.10s]
[0m21:00:07.710830 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_well
[0m21:00:07.711269 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_source_format
[0m21:00:07.728935 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.018 seconds
[0m21:00:07.731608 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m21:00:07.731934 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m21:00:07.732450 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.734430 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m21:00:07.734751 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m21:00:07.735190 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.736163 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m21:00:07.736508 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m21:00:07.736781 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m21:00:07.753742 [debug] [Thread-4 (]: SQL status: COMMIT in 0.017 seconds
[0m21:00:07.755536 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m21:00:07.755986 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m21:00:07.756295 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m21:00:07.759289 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:00:07.760312 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: Close
[0m21:00:07.760797 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc10468f80>]}
[0m21:00:07.761295 [info ] [Thread-4 (]: 29 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.08s]
[0m21:00:07.761761 [debug] [Thread-4 (]: Finished running node model.caspian_vault.fct_readings
[0m21:00:07.762497 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m21:00:07.762948 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m21:00:07.763329 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_well_performance
[0m21:00:07.763738 [info ] [Thread-2 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m21:00:07.764198 [info ] [Thread-1 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m21:00:07.764659 [info ] [Thread-3 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m21:00:07.765061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_sensor_analysis)
[0m21:00:07.765434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_survey_summary)
[0m21:00:07.765783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m21:00:07.766121 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m21:00:07.766452 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m21:00:07.766769 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m21:00:07.769046 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.771085 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m21:00:07.774243 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m21:00:07.774949 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m21:00:07.775339 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m21:00:07.777908 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.778279 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_well_performance
[0m21:00:07.780876 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m21:00:07.783547 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m21:00:07.784050 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.784519 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m21:00:07.784841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:07.785377 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m21:00:07.785730 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m21:00:07.786078 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m21:00:07.786433 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m21:00:07.786751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.787100 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:07.789107 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.789453 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.789758 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m21:00:07.790831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.791207 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m21:00:07.791532 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.791888 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m21:00:07.792230 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m21:00:07.792634 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m21:00:07.797202 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.007 seconds
[0m21:00:07.799661 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.799982 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m21:00:07.800484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.802466 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.802777 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.010 seconds
[0m21:00:07.803105 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m21:00:07.805390 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m21:00:07.805762 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.013 seconds
[0m21:00:07.806133 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m21:00:07.806498 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.808804 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m21:00:07.809875 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m21:00:07.810233 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.810556 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m21:00:07.810895 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.812903 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m21:00:07.813301 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m21:00:07.813596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.813927 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m21:00:07.816781 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m21:00:07.817166 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m21:00:07.817525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:00:07.817826 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m21:00:07.819435 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m21:00:07.820425 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m21:00:07.821014 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m21:00:07.821380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:07.821684 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m21:00:07.822011 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m21:00:07.822979 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m21:00:07.823322 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m21:00:07.823695 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m21:00:07.824051 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m21:00:07.825644 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:00:07.826644 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m21:00:07.826944 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m21:00:07.827296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:00:07.828943 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m21:00:07.829398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc102f18e0>]}
[0m21:00:07.831059 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m21:00:07.831552 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m21:00:07.832072 [info ] [Thread-2 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.06s]
[0m21:00:07.832582 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m21:00:07.832915 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m21:00:07.833370 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m21:00:07.833685 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m21:00:07.836110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:00:07.837118 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: Close
[0m21:00:07.837425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:00:07.838459 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m21:00:07.838830 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1045cb00>]}
[0m21:00:07.839726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1045c8f0>]}
[0m21:00:07.839389 [info ] [Thread-3 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.07s]
[0m21:00:07.840296 [info ] [Thread-1 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.07s]
[0m21:00:07.840775 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_well_performance
[0m21:00:07.841217 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m21:00:07.842004 [debug] [Thread-4 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:07.842400 [info ] [Thread-4 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m21:00:07.842759 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m21:00:07.843067 [debug] [Thread-4 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:07.845537 [debug] [Thread-4 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:07.880793 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.881180 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m21:00:07.881485 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:07.885715 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.886064 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.886392 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:00:07.891562 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m21:00:07.922318 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.922780 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp210007921624"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:00:07.925212 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.002 seconds
[0m21:00:07.928440 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.928791 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp210007921624'
        
      order by ordinal_position

  
[0m21:00:07.931173 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.002 seconds
[0m21:00:07.933390 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.933724 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:00:07.935533 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.001 seconds
[0m21:00:07.937690 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.938026 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp210007921624'
        
      order by ordinal_position

  
[0m21:00:07.939843 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.001 seconds
[0m21:00:07.942017 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.942379 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:00:07.944124 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.001 seconds
[0m21:00:07.948927 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.949291 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp210007921624'
        
      order by ordinal_position

  
[0m21:00:07.951077 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.001 seconds
[0m21:00:07.963913 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.964351 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m21:00:07.965066 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:00:07.969002 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.969364 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:00:07.969870 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:00:07.970311 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.970812 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.971173 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp210007921624" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp210007921624" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:00:07.972056 [debug] [Thread-4 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m21:00:07.973009 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m21:00:07.973334 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:07.973616 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m21:00:07.975659 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:00:07.977651 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m21:00:07.978167 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddf042b-6712-4a82-909e-02f76d47c02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc1011fa40>]}
[0m21:00:07.978839 [info ] [Thread-4 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m21:00:07.979343 [debug] [Thread-4 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:07.980680 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:07.981007 [debug] [MainThread]: On master: BEGIN
[0m21:00:07.981312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:07.985319 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:00:07.985644 [debug] [MainThread]: On master: COMMIT
[0m21:00:07.985925 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:07.986190 [debug] [MainThread]: On master: COMMIT
[0m21:00:07.986552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:07.986840 [debug] [MainThread]: On master: Close
[0m21:00:07.987221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:07.987505 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m21:00:07.987747 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m21:00:07.987979 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m21:00:07.988213 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m21:00:07.988582 [info ] [MainThread]: 
[0m21:00:07.988887 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m21:00:07.992505 [debug] [MainThread]: Command end result
[0m21:00:08.017923 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m21:00:08.019464 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m21:00:08.025440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m21:00:08.025784 [info ] [MainThread]: 
[0m21:00:08.026120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:08.026467 [info ] [MainThread]: 
[0m21:00:08.026772 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m21:00:08.027307 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:00:08.028164 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8389764, "process_in_blocks": "0", "process_kernel_time": 0.335123, "process_mem_max_rss": "135540", "process_out_blocks": "3616", "process_user_time": 2.643863}
[0m21:00:08.028644 [debug] [MainThread]: Command `dbt build` succeeded at 21:00:08.028564 after 1.84 seconds
[0m21:00:08.028975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc123cc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc102c8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc10393fe0>]}
[0m21:00:08.029317 [debug] [MainThread]: Flushing usage events
[0m21:00:08.549675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:10.094564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd79f4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd5bc3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd5d90c80>]}


============================== 21:00:10.099431 | c85bddd0-7638-462e-9de5-eeb7be550da4 ==============================
[0m21:00:10.099431 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:00:10.099887 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/logs/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'target_path': '/opt/airflow/dbt_target', 'fail_fast': 'False'}
[0m21:00:10.144055 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m21:00:10.144542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd4e21160>]}
[0m21:00:10.144984 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m21:00:10.145337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd4e21160>]}
[0m21:00:10.263575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd411e060>]}
[0m21:00:10.321463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd5c66780>]}
[0m21:00:10.322276 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:00:10.434669 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m21:00:10.559639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:10.560062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:10.565154 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m21:00:10.615747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd2d07fe0>]}
[0m21:00:10.712966 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m21:00:10.714698 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m21:00:10.732531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd3d526f0>]}
[0m21:00:10.732989 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m21:00:10.733345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd2d52f30>]}
[0m21:00:10.735306 [info ] [MainThread]: 
[0m21:00:10.735666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:10.735950 [info ] [MainThread]: 
[0m21:00:10.736423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:10.737275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m21:00:10.769644 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m21:00:10.769997 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m21:00:10.770286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:10.775578 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m21:00:10.776617 [debug] [ThreadPool]: On list_airflow: Close
[0m21:00:10.780895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m21:00:10.785259 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m21:00:10.785673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_snapshots'
[0m21:00:10.786034 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m21:00:10.788113 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m21:00:10.788440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:10.788729 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m21:00:10.789176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:10.792670 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:00:10.793017 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m21:00:10.793303 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:00:10.793621 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:00:10.793926 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m21:00:10.794294 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:00:10.796189 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m21:00:10.796480 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m21:00:10.798015 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m21:00:10.798976 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m21:00:10.799375 [debug] [ThreadPool]: On list_airflow_public: Close
[0m21:00:10.799630 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m21:00:10.809186 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:10.809529 [debug] [MainThread]: On master: BEGIN
[0m21:00:10.809796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:10.813461 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:00:10.813785 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:10.814111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:10.835945 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m21:00:10.837108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd3535b80>]}
[0m21:00:10.837565 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:10.837973 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:10.838280 [debug] [MainThread]: On master: BEGIN
[0m21:00:10.838703 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:00:10.839008 [debug] [MainThread]: On master: COMMIT
[0m21:00:10.839298 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:10.839564 [debug] [MainThread]: On master: COMMIT
[0m21:00:10.839900 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:10.840183 [debug] [MainThread]: On master: Close
[0m21:00:10.843634 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:10.844110 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m21:00:10.844499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now snapshot.caspian_vault.snap_mart_well_performance)
[0m21:00:10.844797 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:10.850305 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:10.888136 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.888559 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m21:00:10.888851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:10.893196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:00:10.893563 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.893869 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:00:10.899033 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m21:00:10.937815 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.938295 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp210010932343"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:00:10.940808 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m21:00:10.943826 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.944168 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp210010932343'
        
      order by ordinal_position

  
[0m21:00:10.946598 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m21:00:10.948852 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.949184 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:00:10.951073 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m21:00:10.953260 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.953593 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp210010932343'
        
      order by ordinal_position

  
[0m21:00:10.955462 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m21:00:10.957694 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.958030 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:00:10.959853 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m21:00:10.964542 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.964892 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp210010932343'
        
      order by ordinal_position

  
[0m21:00:10.966786 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m21:00:10.979705 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.980120 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m21:00:10.980845 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:00:10.984718 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.985060 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:00:10.985579 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:00:10.986005 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.986521 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.986878 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp210010932343" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp210010932343" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:00:10.987790 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m21:00:10.998168 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m21:00:10.998546 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m21:00:10.998830 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m21:00:11.002421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:00:11.005190 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m21:00:11.006553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85bddd0-7638-462e-9de5-eeb7be550da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd79231a0>]}
[0m21:00:11.007211 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m21:00:11.007718 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m21:00:11.009017 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:11.009356 [debug] [MainThread]: On master: BEGIN
[0m21:00:11.009633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:11.013555 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:00:11.013875 [debug] [MainThread]: On master: COMMIT
[0m21:00:11.014171 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:11.014451 [debug] [MainThread]: On master: COMMIT
[0m21:00:11.014807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:11.015091 [debug] [MainThread]: On master: Close
[0m21:00:11.015486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:11.015752 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m21:00:11.015994 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m21:00:11.016276 [info ] [MainThread]: 
[0m21:00:11.016573 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m21:00:11.017127 [debug] [MainThread]: Command end result
[0m21:00:11.091396 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m21:00:11.092969 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m21:00:11.097858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m21:00:11.098192 [info ] [MainThread]: 
[0m21:00:11.098592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:11.098888 [info ] [MainThread]: 
[0m21:00:11.099203 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:00:11.099727 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:00:11.100598 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0485383, "process_in_blocks": "0", "process_kernel_time": 0.270566, "process_mem_max_rss": "128376", "process_out_blocks": "2768", "process_user_time": 2.017767}
[0m21:00:11.101047 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:00:11.100966 after 1.05 seconds
[0m21:00:11.101409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd6a99cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd6a99af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ddd6a99d60>]}
[0m21:00:11.101740 [debug] [MainThread]: Flushing usage events
[0m21:00:11.525427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:01.857442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4bd14ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4dee7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4c197ce0>]}


============================== 22:00:01.862222 | f5ba160e-f5bc-4bd2-8a05-ea79c7dff00e ==============================
[0m22:00:01.862222 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:00:01.862681 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'log_path': '/opt/airflow/logs/dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m22:00:01.868817 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m22:00:01.869185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5ba160e-f5bc-4bd2-8a05-ea79c7dff00e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4afbfc50>]}
[0m22:00:01.869582 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m22:00:01.869878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5ba160e-f5bc-4bd2-8a05-ea79c7dff00e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4afbfc50>]}
[0m22:00:01.970743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5ba160e-f5bc-4bd2-8a05-ea79c7dff00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4b113e90>]}
[0m22:00:01.989596 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9l4yg2xv'
[0m22:00:01.989946 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:00:02.222223 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:00:02.222926 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:00:02.300450 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:00:02.303756 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:00:02.601211 [info ] [MainThread]: Installed from version 1.3.0
[0m22:00:02.601673 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:00:02.601994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f5ba160e-f5bc-4bd2-8a05-ea79c7dff00e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4aeff6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4ae6b860>]}
[0m22:00:02.602342 [info ] [MainThread]: 
[0m22:00:02.602632 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:00:02.603304 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:00:02.604129 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.788766, "process_in_blocks": "0", "process_kernel_time": 0.211759, "process_mem_max_rss": "108076", "process_out_blocks": "2304", "process_user_time": 1.29453}
[0m22:00:02.604582 [debug] [MainThread]: Command `dbt deps` succeeded at 22:00:02.604506 after 0.79 seconds
[0m22:00:02.604872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4b08bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4aec91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706d4c2664e0>]}
[0m22:00:02.605152 [debug] [MainThread]: Flushing usage events
[0m22:00:03.113899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:04.603058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe94e4ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe94dfbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe962a12b0>]}


============================== 22:00:04.607887 | 64c878ed-9144-42b3-9135-5e8cbc63a26f ==============================
[0m22:00:04.607887 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:00:04.608336 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': '/opt/airflow/dbt_target', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'log_path': '/opt/airflow/logs/dbt', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt build --profile caspian_vault --target dev'}
[0m22:00:04.652294 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m22:00:04.652761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe944bb6b0>]}
[0m22:00:04.653198 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m22:00:04.653541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe935853a0>]}
[0m22:00:04.771651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe935b2cc0>]}
[0m22:00:04.829191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe93585490>]}
[0m22:00:04.830014 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:00:04.941644 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m22:00:05.066531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:05.066947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:05.072080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m22:00:05.122505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe92971280>]}
[0m22:00:05.219351 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m22:00:05.220975 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m22:00:05.248784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe935b3290>]}
[0m22:00:05.249244 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m22:00:05.252669 [info ] [MainThread]: 
[0m22:00:05.253039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:05.253341 [info ] [MainThread]: 
[0m22:00:05.253803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:05.257796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:00:05.258377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:00:05.293403 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:00:05.293782 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:00:05.294109 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:00:05.294437 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:00:05.294733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:05.295006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:05.300473 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m22:00:05.300792 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m22:00:05.301820 [debug] [ThreadPool]: On list_airflow: Close
[0m22:00:05.302798 [debug] [ThreadPool]: On list_airflow: Close
[0m22:00:05.304637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m22:00:05.305106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m22:00:05.309486 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m22:00:05.310780 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m22:00:05.311095 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m22:00:05.311398 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m22:00:05.311667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:05.311934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:05.315668 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.316004 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m22:00:05.316284 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.316599 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:00:05.316899 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m22:00:05.317229 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:00:05.319233 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:05.319508 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m22:00:05.320501 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m22:00:05.322092 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m22:00:05.322510 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m22:00:05.322756 [debug] [ThreadPool]: On list_airflow_public: Close
[0m22:00:05.332221 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:05.332563 [debug] [MainThread]: On master: BEGIN
[0m22:00:05.332824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:05.336611 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.336936 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:05.337272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:05.359008 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m22:00:05.360153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe915c30e0>]}
[0m22:00:05.360605 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:05.361006 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:05.361310 [debug] [MainThread]: On master: BEGIN
[0m22:00:05.361741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:00:05.362031 [debug] [MainThread]: On master: COMMIT
[0m22:00:05.362314 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:05.362570 [debug] [MainThread]: On master: COMMIT
[0m22:00:05.362901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:05.363177 [debug] [MainThread]: On master: Close
[0m22:00:05.366728 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m22:00:05.367179 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m22:00:05.367564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m22:00:05.367859 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m22:00:05.373521 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m22:00:05.374022 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m22:00:05.402832 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m22:00:05.403450 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m22:00:05.403763 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m22:00:05.404035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.408200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.408559 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m22:00:05.408901 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m22:00:05.448017 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.039 seconds
[0m22:00:05.455584 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m22:00:05.455924 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m22:00:05.456467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.458575 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m22:00:05.458886 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m22:00:05.459356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.471049 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m22:00:05.471422 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m22:00:05.471702 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m22:00:05.496298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m22:00:05.501176 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m22:00:05.505319 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m22:00:05.505662 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m22:00:05.509082 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:00:05.510960 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m22:00:05.512297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe9600b680>]}
[0m22:00:05.512827 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.14s]
[0m22:00:05.513318 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m22:00:05.514200 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m22:00:05.514579 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m22:00:05.514967 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m22:00:05.515376 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m22:00:05.515852 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m22:00:05.516275 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m22:00:05.516610 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m22:00:05.516924 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m22:00:05.526904 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m22:00:05.530192 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m22:00:05.530793 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m22:00:05.531170 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m22:00:05.543878 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m22:00:05.545463 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m22:00:05.546062 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m22:00:05.546456 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m22:00:05.546765 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m22:00:05.547091 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m22:00:05.547428 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:00:05.547742 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:00:05.551938 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.552299 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.552644 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m22:00:05.552971 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m22:00:05.553318 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m22:00:05.553657 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m22:00:05.555565 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:05.555872 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:05.558330 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m22:00:05.559432 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m22:00:05.559881 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m22:00:05.560214 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m22:00:05.560816 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m22:00:05.561224 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m22:00:05.561843 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m22:00:05.562295 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m22:00:05.563181 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m22:00:05.563575 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m22:00:05.563995 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m22:00:05.564354 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m22:00:05.564691 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_sat_readings
[0m22:00:05.565056 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m22:00:05.565457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m22:00:05.565849 [info ] [Thread-3 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m22:00:05.566271 [info ] [Thread-4 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m22:00:05.566646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m22:00:05.566975 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m22:00:05.568559 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m22:00:05.568920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m22:00:05.569244 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m22:00:05.620098 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.620598 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m22:00:05.621011 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m22:00:05.623325 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m22:00:05.626513 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.626948 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m22:00:05.629295 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m22:00:05.632133 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.632680 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m22:00:05.633078 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m22:00:05.633605 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m22:00:05.636217 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m22:00:05.636686 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.639273 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.641842 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m22:00:05.642313 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m22:00:05.642745 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m22:00:05.643302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.643685 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.644043 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m22:00:05.644375 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m22:00:05.644831 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m22:00:05.645156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:05.645534 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m22:00:05.645903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.646350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:05.648903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m22:00:05.649240 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.649572 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m22:00:05.650071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.650431 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.650806 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m22:00:05.651211 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.651609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.651930 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m22:00:05.652318 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m22:00:05.652673 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m22:00:05.653106 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m22:00:05.663894 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.014 seconds
[0m22:00:05.667680 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.668016 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.015 seconds
[0m22:00:05.668386 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m22:00:05.670654 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m22:00:05.671052 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m22:00:05.671367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.673399 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.673742 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:00:05.674050 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m22:00:05.676075 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m22:00:05.676483 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m22:00:05.676856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.677179 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.678201 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m22:00:05.679180 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m22:00:05.679541 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.679875 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m22:00:05.680193 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m22:00:05.680515 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m22:00:05.683218 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.030 seconds
[0m22:00:05.685554 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.685877 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m22:00:05.686421 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.688415 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.688774 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.035 seconds
[0m22:00:05.689101 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m22:00:05.691482 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m22:00:05.691881 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m22:00:05.692212 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.693211 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m22:00:05.693575 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:00:05.693883 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.695913 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m22:00:05.696263 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m22:00:05.696593 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m22:00:05.697111 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.698064 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m22:00:05.698389 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m22:00:05.698669 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m22:00:05.699208 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m22:00:05.699551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m22:00:05.701339 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m22:00:05.703974 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m22:00:05.704311 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m22:00:05.704620 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:00:05.705100 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m22:00:05.705572 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m22:00:05.707148 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m22:00:05.708782 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m22:00:05.709127 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m22:00:05.709472 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m22:00:05.709994 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m22:00:05.710466 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m22:00:05.710889 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m22:00:05.711223 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m22:00:05.712946 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:00:05.713993 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m22:00:05.714533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe89426960>]}
[0m22:00:05.714919 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:00:05.715425 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.15s]
[0m22:00:05.716482 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m22:00:05.716794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m22:00:05.717146 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m22:00:05.717639 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m22:00:05.718697 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m22:00:05.719071 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8bd798b0>]}
[0m22:00:05.720093 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: Close
[0m22:00:05.720749 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m22:00:05.721207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8beda540>]}
[0m22:00:05.721709 [info ] [Thread-3 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.15s]
[0m22:00:05.722161 [info ] [Thread-2 (]: 8 of 33 START test not_null_dv_hub_well_hk_well ................................ [RUN]
[0m22:00:05.722667 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8be26c60>]}
[0m22:00:05.723187 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.16s]
[0m22:00:05.723688 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m22:00:05.724030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m22:00:05.724520 [info ] [Thread-4 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.15s]
[0m22:00:05.725029 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m22:00:05.725384 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m22:00:05.725756 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m22:00:05.726312 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m22:00:05.726661 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m22:00:05.727098 [info ] [Thread-3 (]: 9 of 33 START test not_null_dv_hub_well_well_id_bk ............................. [RUN]
[0m22:00:05.732148 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m22:00:05.732558 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m22:00:05.732936 [info ] [Thread-1 (]: 10 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m22:00:05.733432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m22:00:05.733843 [info ] [Thread-4 (]: 11 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m22:00:05.734273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m22:00:05.734588 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m22:00:05.734927 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m22:00:05.735266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m22:00:05.735585 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m22:00:05.737222 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m22:00:05.739974 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m22:00:05.740345 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m22:00:05.744584 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m22:00:05.745232 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m22:00:05.747921 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m22:00:05.748336 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m22:00:05.748739 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m22:00:05.749170 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m22:00:05.750847 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m22:00:05.751196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:05.751592 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m22:00:05.754116 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m22:00:05.754794 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m22:00:05.756308 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m22:00:05.756799 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m22:00:05.757230 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m22:00:05.757644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.757997 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m22:00:05.758337 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m22:00:05.758812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.759164 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:00:05.759519 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m22:00:05.759958 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m22:00:05.760301 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:05.760650 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.761684 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.762902 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m22:00:05.763236 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m22:00:05.763682 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m22:00:05.764034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.764369 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.764673 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m22:00:05.765033 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m22:00:05.765366 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.765807 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:00:05.766568 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.766241 [info ] [Thread-2 (]: 8 of 33 PASS not_null_dv_hub_well_hk_well ...................................... [[32mPASS[0m in 0.04s]
[0m22:00:05.767005 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m22:00:05.768129 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m22:00:05.768499 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.768911 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m22:00:05.769273 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.770407 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m22:00:05.770724 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m22:00:05.771084 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m22:00:05.771609 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m22:00:05.772029 [info ] [Thread-3 (]: 9 of 33 PASS not_null_dv_hub_well_well_id_bk ................................... [[32mPASS[0m in 0.04s]
[0m22:00:05.772393 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.772704 [info ] [Thread-2 (]: 12 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m22:00:05.773212 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m22:00:05.773627 [info ] [Thread-1 (]: 10 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m22:00:05.774744 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m22:00:05.775106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m22:00:05.775486 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m22:00:05.775955 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m22:00:05.776325 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m22:00:05.776638 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m22:00:05.776969 [info ] [Thread-3 (]: 13 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m22:00:05.777349 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m22:00:05.780375 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m22:00:05.780790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m22:00:05.781266 [info ] [Thread-4 (]: 11 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.05s]
[0m22:00:05.781672 [info ] [Thread-1 (]: 14 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m22:00:05.782088 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m22:00:05.782591 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m22:00:05.782896 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m22:00:05.783361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m22:00:05.786040 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m22:00:05.786430 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m22:00:05.788001 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m22:00:05.788359 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m22:00:05.788772 [info ] [Thread-4 (]: 15 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m22:00:05.794394 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m22:00:05.795169 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m22:00:05.795578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m22:00:05.795953 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m22:00:05.797529 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m22:00:05.797965 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m22:00:05.798355 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m22:00:05.798798 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m22:00:05.801466 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m22:00:05.801886 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m22:00:05.802188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:05.803747 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m22:00:05.804175 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m22:00:05.804670 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m22:00:05.805133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.805658 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m22:00:05.808138 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m22:00:05.808654 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m22:00:05.808971 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:00:05.809447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.809861 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m22:00:05.810182 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m22:00:05.810625 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m22:00:05.810959 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.811312 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:05.811939 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:00:05.812312 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m22:00:05.812626 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.812979 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.814132 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m22:00:05.814644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.814946 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m22:00:05.815337 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.815702 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.816025 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m22:00:05.817286 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m22:00:05.817749 [info ] [Thread-2 (]: 12 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m22:00:05.818130 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m22:00:05.818522 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.819062 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m22:00:05.819380 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m22:00:05.819725 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:00:05.820151 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m22:00:05.820738 [info ] [Thread-3 (]: 13 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m22:00:05.821082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.821448 [info ] [Thread-2 (]: 16 of 33 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m22:00:05.821798 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.822232 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m22:00:05.823305 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m22:00:05.823664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m22:00:05.824719 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m22:00:05.825096 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m22:00:05.825514 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m22:00:05.825817 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m22:00:05.826466 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m22:00:05.829335 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m22:00:05.826196 [info ] [Thread-3 (]: 17 of 33 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m22:00:05.829955 [info ] [Thread-1 (]: 14 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.05s]
[0m22:00:05.830395 [info ] [Thread-4 (]: 15 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.03s]
[0m22:00:05.830929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m22:00:05.831420 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m22:00:05.831767 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m22:00:05.832211 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m22:00:05.832541 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m22:00:05.832890 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m22:00:05.834521 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m22:00:05.834891 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m22:00:05.837677 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m22:00:05.838049 [info ] [Thread-1 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m22:00:05.838505 [info ] [Thread-4 (]: 19 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m22:00:05.839031 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m22:00:05.839371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m22:00:05.839742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m22:00:05.840070 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m22:00:05.840427 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m22:00:05.840753 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m22:00:05.841070 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m22:00:05.842623 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m22:00:05.842973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:05.846787 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m22:00:05.849541 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m22:00:05.850174 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m22:00:05.850742 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m22:00:05.851102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.851600 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m22:00:05.851954 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m22:00:05.853539 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m22:00:05.855109 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m22:00:05.855476 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m22:00:05.856085 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.856527 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m22:00:05.856870 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m22:00:05.857211 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m22:00:05.857571 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m22:00:05.857908 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.858242 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m22:00:05.858583 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m22:00:05.858914 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.859303 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:05.859613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.859949 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.861364 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m22:00:05.861708 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.862824 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m22:00:05.863132 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m22:00:05.863557 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m22:00:05.863993 [info ] [Thread-2 (]: 16 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m22:00:05.864392 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.864748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.865276 [info ] [Thread-3 (]: 17 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.03s]
[0m22:00:05.865743 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m22:00:05.866072 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m22:00:05.866433 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m22:00:05.866878 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m22:00:05.867228 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m22:00:05.867626 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:00:05.867990 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.868376 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m22:00:05.868735 [info ] [Thread-2 (]: 20 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m22:00:05.869188 [info ] [Thread-3 (]: 21 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m22:00:05.869574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m22:00:05.869910 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.870269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m22:00:05.870586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.870913 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m22:00:05.871984 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m22:00:05.872333 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m22:00:05.873374 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m22:00:05.877569 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m22:00:05.880284 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m22:00:05.880682 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m22:00:05.881071 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m22:00:05.881809 [info ] [Thread-4 (]: 19 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m22:00:05.882345 [info ] [Thread-1 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m22:00:05.882808 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m22:00:05.883109 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m22:00:05.883444 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m22:00:05.883909 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m22:00:05.884269 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m22:00:05.885902 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m22:00:05.887462 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m22:00:05.887851 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m22:00:05.888201 [info ] [Thread-4 (]: 22 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m22:00:05.888780 [info ] [Thread-1 (]: 23 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m22:00:05.889201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m22:00:05.889573 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m22:00:05.889926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m22:00:05.890299 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m22:00:05.890625 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m22:00:05.890958 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m22:00:05.891290 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m22:00:05.891606 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m22:00:05.894343 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m22:00:05.894679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:05.898458 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m22:00:05.898812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.899586 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m22:00:05.901211 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m22:00:05.901667 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m22:00:05.903293 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m22:00:05.903775 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m22:00:05.904150 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:00:05.904529 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m22:00:05.904836 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m22:00:05.905201 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m22:00:05.905618 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m22:00:05.905926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:05.906265 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m22:00:05.906600 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.906939 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m22:00:05.907385 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.907765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.909038 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.909366 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.910549 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m22:00:05.911665 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m22:00:05.912001 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m22:00:05.912493 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m22:00:05.912841 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.913213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.913575 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m22:00:05.913930 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m22:00:05.914269 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m22:00:05.914642 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:05.915093 [info ] [Thread-3 (]: 21 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m22:00:05.915525 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:00:05.915953 [info ] [Thread-2 (]: 20 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.05s]
[0m22:00:05.917055 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m22:00:05.917528 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m22:00:05.918041 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m22:00:05.918460 [debug] [Thread-3 (]: Began running node test.caspian_vault.test_counts_match
[0m22:00:05.918807 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m22:00:05.919178 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_well
[0m22:00:05.919553 [info ] [Thread-3 (]: 24 of 33 START test test_counts_match .......................................... [RUN]
[0m22:00:05.919926 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:05.920381 [info ] [Thread-2 (]: 25 of 33 START sql table model public.dim_well ................................. [RUN]
[0m22:00:05.920833 [info ] [Thread-4 (]: 22 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.03s]
[0m22:00:05.921213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.test_counts_match)
[0m22:00:05.922334 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m22:00:05.922707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now model.caspian_vault.dim_well)
[0m22:00:05.923150 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m22:00:05.923481 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.test_counts_match
[0m22:00:05.923841 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_well
[0m22:00:05.924139 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m22:00:05.924514 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_survey_type
[0m22:00:05.926827 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m22:00:05.928914 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m22:00:05.929397 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m22:00:05.929848 [info ] [Thread-1 (]: 23 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m22:00:05.930416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now model.caspian_vault.dim_survey_type)
[0m22:00:05.930850 [debug] [Thread-3 (]: Began executing node test.caspian_vault.test_counts_match
[0m22:00:05.931289 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m22:00:05.931619 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m22:00:05.931930 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_well
[0m22:00:05.934935 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m22:00:05.937030 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m22:00:05.939719 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m22:00:05.940441 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_survey_type
[0m22:00:05.940916 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m22:00:05.943387 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m22:00:05.943774 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m22:00:05.944107 [debug] [Thread-3 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m22:00:05.944542 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: BEGIN
[0m22:00:05.944875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.945193 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m22:00:05.945536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:05.945966 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m22:00:05.946409 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:05.949599 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.950033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m22:00:05.950399 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m22:00:05.950764 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m22:00:05.951092 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:05.951460 [debug] [Thread-3 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m22:00:05.951819 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m22:00:05.952170 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m22:00:05.952621 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m22:00:05.954532 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:05.955674 [debug] [Thread-3 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m22:00:05.956083 [debug] [Thread-3 (]: On test.caspian_vault.test_counts_match: Close
[0m22:00:05.956854 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.004 seconds
[0m22:00:05.957174 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.005 seconds
[0m22:00:05.959636 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m22:00:05.956592 [info ] [Thread-3 (]: 24 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m22:00:05.962011 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m22:00:05.962387 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m22:00:05.962838 [debug] [Thread-3 (]: Finished running node test.caspian_vault.test_counts_match
[0m22:00:05.963161 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m22:00:05.963819 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.964177 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_source_format
[0m22:00:05.964567 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_time
[0m22:00:05.964866 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:00:05.966888 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m22:00:05.967340 [info ] [Thread-1 (]: 27 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m22:00:05.967778 [info ] [Thread-3 (]: 28 of 33 START sql table model public.dim_time ................................. [RUN]
[0m22:00:05.969826 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m22:00:05.970176 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m22:00:05.970556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_source_format)
[0m22:00:05.970904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now model.caspian_vault.dim_time)
[0m22:00:05.971237 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m22:00:05.971630 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_source_format
[0m22:00:05.971936 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:05.972359 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_time
[0m22:00:05.974496 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m22:00:05.974847 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:00:05.975860 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m22:00:05.978897 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m22:00:05.979962 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m22:00:05.980353 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m22:00:05.980700 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_source_format
[0m22:00:05.981119 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m22:00:05.981490 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m22:00:05.981819 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_time
[0m22:00:05.984505 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m22:00:05.984859 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: COMMIT
[0m22:00:05.987418 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m22:00:05.987838 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:00:05.988475 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m22:00:05.990163 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m22:00:05.990521 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:00:05.990873 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m22:00:05.991196 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m22:00:05.991687 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m22:00:05.993298 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m22:00:05.993633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:05.993959 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: BEGIN
[0m22:00:05.994297 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m22:00:05.994747 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m22:00:05.995182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:05.995596 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m22:00:05.998562 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:00:05.999628 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: Close
[0m22:00:06.000007 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:00:06.000395 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:06.000752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:00:06.001863 [debug] [Thread-2 (]: On model.caspian_vault.dim_well: Close
[0m22:00:06.002324 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8bd824b0>]}
[0m22:00:06.002679 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m22:00:06.003011 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m22:00:06.003590 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.07s]
[0m22:00:06.004034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8949b110>]}
[0m22:00:06.004398 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m22:00:06.004741 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m22:00:06.005191 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_survey_type
[0m22:00:06.005672 [info ] [Thread-2 (]: 25 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.08s]
[0m22:00:06.006180 [debug] [Thread-4 (]: Began running node model.caspian_vault.fct_readings
[0m22:00:06.006639 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_well
[0m22:00:06.007065 [info ] [Thread-4 (]: 29 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m22:00:06.007540 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m22:00:06.007838 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.fct_readings
[0m22:00:06.010224 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m22:00:06.010729 [debug] [Thread-4 (]: Began executing node model.caspian_vault.fct_readings
[0m22:00:06.013359 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m22:00:06.013693 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m22:00:06.016089 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m22:00:06.016470 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m22:00:06.016902 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m22:00:06.017224 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.011 seconds
[0m22:00:06.017571 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: BEGIN
[0m22:00:06.017868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:00:06.020166 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m22:00:06.020515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:06.023379 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m22:00:06.023741 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m22:00:06.024193 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m22:00:06.024774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.025174 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.027194 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m22:00:06.028261 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: COMMIT
[0m22:00:06.028600 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:00:06.028954 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m22:00:06.029315 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m22:00:06.029645 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m22:00:06.030014 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: COMMIT
[0m22:00:06.030326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.030659 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m22:00:06.031694 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m22:00:06.032088 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m22:00:06.032392 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m22:00:06.033240 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:00:06.034945 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m22:00:06.035271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:00:06.035721 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m22:00:06.037374 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m22:00:06.037713 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m22:00:06.038159 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m22:00:06.038551 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m22:00:06.042884 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:00:06.043904 [debug] [Thread-3 (]: On model.caspian_vault.dim_time: Close
[0m22:00:06.044388 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe92921d30>]}
[0m22:00:06.044864 [info ] [Thread-3 (]: 28 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.07s]
[0m22:00:06.045334 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_time
[0m22:00:06.048297 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.016 seconds
[0m22:00:06.048645 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m22:00:06.051022 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m22:00:06.052034 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: Close
[0m22:00:06.052381 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m22:00:06.052868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe894b4590>]}
[0m22:00:06.053185 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.053680 [info ] [Thread-1 (]: 27 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.08s]
[0m22:00:06.055761 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m22:00:06.056213 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_source_format
[0m22:00:06.056553 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m22:00:06.057131 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.058110 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m22:00:06.058450 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m22:00:06.058728 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m22:00:06.064094 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m22:00:06.065764 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m22:00:06.066200 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m22:00:06.066509 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m22:00:06.070125 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:00:06.071119 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: Close
[0m22:00:06.071593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8bd4ce90>]}
[0m22:00:06.072058 [info ] [Thread-4 (]: 29 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.06s]
[0m22:00:06.072528 [debug] [Thread-4 (]: Finished running node model.caspian_vault.fct_readings
[0m22:00:06.073205 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m22:00:06.073558 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_survey_summary
[0m22:00:06.073910 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_well_performance
[0m22:00:06.074298 [info ] [Thread-2 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m22:00:06.074740 [info ] [Thread-3 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m22:00:06.075155 [info ] [Thread-1 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m22:00:06.075541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_sensor_analysis)
[0m22:00:06.075886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m22:00:06.076220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m22:00:06.076559 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m22:00:06.076872 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m22:00:06.077182 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m22:00:06.079448 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.081534 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m22:00:06.084636 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m22:00:06.085358 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m22:00:06.085684 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m22:00:06.088274 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.088620 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_well_performance
[0m22:00:06.091176 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m22:00:06.093856 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m22:00:06.094312 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.094834 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m22:00:06.095177 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m22:00:06.095598 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m22:00:06.095902 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m22:00:06.096221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:06.096556 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m22:00:06.096865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:06.097303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:06.101139 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:06.101500 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:06.101886 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.102211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:00:06.102580 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m22:00:06.102917 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m22:00:06.103277 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m22:00:06.103620 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m22:00:06.104012 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m22:00:06.111438 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.007 seconds
[0m22:00:06.113928 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.114260 [debug] [Thread-1 (]: SQL status: SELECT 21 in 0.010 seconds
[0m22:00:06.114600 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m22:00:06.116872 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m22:00:06.117282 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m22:00:06.117635 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.117942 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.014 seconds
[0m22:00:06.119990 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.120318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:00:06.122668 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m22:00:06.123025 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m22:00:06.125026 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m22:00:06.125391 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m22:00:06.125781 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m22:00:06.126101 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.127174 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m22:00:06.127551 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.127891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:00:06.128186 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m22:00:06.128489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:00:06.129469 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m22:00:06.132470 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m22:00:06.132802 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:00:06.133127 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m22:00:06.133485 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m22:00:06.135139 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m22:00:06.135501 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m22:00:06.136005 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m22:00:06.136334 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:06.136706 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m22:00:06.137691 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m22:00:06.138015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:00:06.138410 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m22:00:06.140003 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m22:00:06.140348 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m22:00:06.140682 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:00:06.141106 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m22:00:06.142155 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m22:00:06.142501 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m22:00:06.142847 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:00:06.143355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8bd4d040>]}
[0m22:00:06.144979 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m22:00:06.145335 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:00:06.145817 [info ] [Thread-2 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.07s]
[0m22:00:06.146338 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m22:00:06.147340 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: Close
[0m22:00:06.147784 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m22:00:06.148103 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m22:00:06.148662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8bd4d250>]}
[0m22:00:06.149187 [info ] [Thread-1 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.07s]
[0m22:00:06.149643 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_well_performance
[0m22:00:06.150177 [debug] [Thread-4 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:06.150619 [info ] [Thread-4 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m22:00:06.150978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m22:00:06.151307 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:00:06.151646 [debug] [Thread-4 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:06.152674 [debug] [Thread-3 (]: On model.caspian_vault.mart_survey_summary: Close
[0m22:00:06.155080 [debug] [Thread-4 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:06.160716 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe8bd448f0>]}
[0m22:00:06.166326 [info ] [Thread-3 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.08s]
[0m22:00:06.191427 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.191937 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m22:00:06.192305 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m22:00:06.192760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:06.197041 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m22:00:06.197387 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.197688 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m22:00:06.202889 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m22:00:06.233357 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.233800 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp220006232664"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m22:00:06.236157 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.002 seconds
[0m22:00:06.239551 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.239899 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp220006232664'
        
      order by ordinal_position

  
[0m22:00:06.242283 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.002 seconds
[0m22:00:06.244487 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.244826 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m22:00:06.246649 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:00:06.248813 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.249144 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp220006232664'
        
      order by ordinal_position

  
[0m22:00:06.250968 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.001 seconds
[0m22:00:06.253141 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.253492 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m22:00:06.255262 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.001 seconds
[0m22:00:06.260027 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.260397 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp220006232664'
        
      order by ordinal_position

  
[0m22:00:06.262217 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.001 seconds
[0m22:00:06.275052 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.275487 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m22:00:06.276210 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:00:06.280153 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.280514 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m22:00:06.281018 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:00:06.281460 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.281967 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.282348 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp220006232664" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp220006232664" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m22:00:06.283237 [debug] [Thread-4 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m22:00:06.284199 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m22:00:06.284530 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:06.284808 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m22:00:06.293472 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m22:00:06.295515 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m22:00:06.296043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c878ed-9144-42b3-9135-5e8cbc63a26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe893a0b30>]}
[0m22:00:06.296706 [info ] [Thread-4 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.15s]
[0m22:00:06.297186 [debug] [Thread-4 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:06.298646 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:06.298973 [debug] [MainThread]: On master: BEGIN
[0m22:00:06.299265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:06.303326 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:00:06.303665 [debug] [MainThread]: On master: COMMIT
[0m22:00:06.303945 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:06.304210 [debug] [MainThread]: On master: COMMIT
[0m22:00:06.304571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:06.304854 [debug] [MainThread]: On master: Close
[0m22:00:06.305229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:06.305525 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m22:00:06.305763 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m22:00:06.305994 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m22:00:06.306220 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m22:00:06.306580 [info ] [MainThread]: 
[0m22:00:06.306883 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m22:00:06.310458 [debug] [MainThread]: Command end result
[0m22:00:06.335866 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m22:00:06.337371 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m22:00:06.343347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m22:00:06.343692 [info ] [MainThread]: 
[0m22:00:06.344029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:06.344341 [info ] [MainThread]: 
[0m22:00:06.344640 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m22:00:06.345158 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:00:06.346035 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.785129, "process_in_blocks": "0", "process_kernel_time": 0.338928, "process_mem_max_rss": "134768", "process_out_blocks": "3624", "process_user_time": 2.623928}
[0m22:00:06.346526 [debug] [MainThread]: Command `dbt build` succeeded at 22:00:06.346444 after 1.79 seconds
[0m22:00:06.346857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe94f262a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe91942ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe92d131a0>]}
[0m22:00:06.347185 [debug] [MainThread]: Flushing usage events
[0m22:00:06.871395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:08.420336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5bfa68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5b83be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5b5b9310>]}


============================== 22:00:08.425201 | 83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad ==============================
[0m22:00:08.425201 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:00:08.425661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/opt/airflow/logs/dbt', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'target_path': '/opt/airflow/dbt_target', 'warn_error': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'version_check': 'True', 'use_colors': 'True'}
[0m22:00:08.469718 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m22:00:08.470173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a7137a0>]}
[0m22:00:08.470632 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m22:00:08.470977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a736ba0>]}
[0m22:00:08.589949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5aa0e1e0>]}
[0m22:00:08.648066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5b5bbe60>]}
[0m22:00:08.648882 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:00:08.761303 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m22:00:08.886624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:08.887041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:08.892182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m22:00:08.942835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59b0e1b0>]}
[0m22:00:09.040225 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m22:00:09.041907 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m22:00:09.059690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59330d40>]}
[0m22:00:09.060143 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m22:00:09.060499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59f72420>]}
[0m22:00:09.062425 [info ] [MainThread]: 
[0m22:00:09.062787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:09.063082 [info ] [MainThread]: 
[0m22:00:09.063565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:09.064403 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:00:09.096790 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:00:09.097144 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:00:09.097434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:09.102750 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m22:00:09.103773 [debug] [ThreadPool]: On list_airflow: Close
[0m22:00:09.107980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m22:00:09.112291 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m22:00:09.112698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m22:00:09.113061 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m22:00:09.115182 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m22:00:09.115520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:09.115812 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m22:00:09.116267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:09.119974 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:00:09.120292 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:00:09.120606 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m22:00:09.120913 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m22:00:09.121211 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:00:09.121543 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:00:09.123892 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:09.124895 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m22:00:09.125178 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.003 seconds
[0m22:00:09.126732 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m22:00:09.127044 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m22:00:09.127312 [debug] [ThreadPool]: On list_airflow_public: Close
[0m22:00:09.136994 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:09.137339 [debug] [MainThread]: On master: BEGIN
[0m22:00:09.137608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:09.141183 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:00:09.141517 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:09.141843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:09.163739 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m22:00:09.164909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59fd14f0>]}
[0m22:00:09.165369 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:09.165783 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:09.166075 [debug] [MainThread]: On master: BEGIN
[0m22:00:09.166517 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:00:09.166813 [debug] [MainThread]: On master: COMMIT
[0m22:00:09.167081 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:09.167361 [debug] [MainThread]: On master: COMMIT
[0m22:00:09.167701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:09.167984 [debug] [MainThread]: On master: Close
[0m22:00:09.171371 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:09.171822 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m22:00:09.172192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now snapshot.caspian_vault.snap_mart_well_performance)
[0m22:00:09.172504 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:09.177981 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:09.215744 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.216146 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m22:00:09.216462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:09.220797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m22:00:09.221141 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.221456 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m22:00:09.226715 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m22:00:09.265281 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.265738 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp220009259874"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m22:00:09.268214 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m22:00:09.271194 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.271557 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp220009259874'
        
      order by ordinal_position

  
[0m22:00:09.273996 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m22:00:09.276190 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.276542 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m22:00:09.278415 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:00:09.280567 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.280905 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp220009259874'
        
      order by ordinal_position

  
[0m22:00:09.282768 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m22:00:09.285009 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.285366 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m22:00:09.287195 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:00:09.291890 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.292236 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp220009259874'
        
      order by ordinal_position

  
[0m22:00:09.294118 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m22:00:09.307035 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.307465 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m22:00:09.308180 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:00:09.311996 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.312353 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m22:00:09.312859 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:00:09.313308 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.313823 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.314155 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp220009259874" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp220009259874" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m22:00:09.315055 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m22:00:09.325438 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m22:00:09.325803 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m22:00:09.326099 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m22:00:09.328640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:00:09.331423 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m22:00:09.332747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83b05f92-8cd0-4b18-9b1a-e84e7e9ce3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5d38edb0>]}
[0m22:00:09.333421 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m22:00:09.333914 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m22:00:09.335139 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:09.335482 [debug] [MainThread]: On master: BEGIN
[0m22:00:09.335761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:09.339725 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:00:09.340052 [debug] [MainThread]: On master: COMMIT
[0m22:00:09.340354 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:09.340615 [debug] [MainThread]: On master: COMMIT
[0m22:00:09.340955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:09.341234 [debug] [MainThread]: On master: Close
[0m22:00:09.341633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:09.341902 [debug] [MainThread]: Connection 'list_airflow_snapshots' was properly closed.
[0m22:00:09.342143 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m22:00:09.342435 [info ] [MainThread]: 
[0m22:00:09.342731 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m22:00:09.343304 [debug] [MainThread]: Command end result
[0m22:00:09.416798 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m22:00:09.418394 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m22:00:09.423268 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m22:00:09.423606 [info ] [MainThread]: 
[0m22:00:09.423976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:09.424269 [info ] [MainThread]: 
[0m22:00:09.424579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:00:09.425064 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:00:09.425953 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0481743, "process_in_blocks": "0", "process_kernel_time": 0.283477, "process_mem_max_rss": "128240", "process_out_blocks": "2760", "process_user_time": 2.003304}
[0m22:00:09.426427 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:00:09.426344 after 1.05 seconds
[0m22:00:09.426762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a9c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5aacc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f579d2c90>]}
[0m22:00:09.427091 [debug] [MainThread]: Flushing usage events
[0m22:00:09.854578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:02.001864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf7d70a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf804d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf543ef90>]}


============================== 23:00:02.006764 | 8e5aa693-c609-45ef-bec7-0ac60713cb5f ==============================
[0m23:00:02.006764 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:00:02.007210 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/opt/airflow/logs/dbt', 'debug': 'False', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m23:00:02.013560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m23:00:02.013937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e5aa693-c609-45ef-bec7-0ac60713cb5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf4ffba40>]}
[0m23:00:02.014345 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m23:00:02.014659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e5aa693-c609-45ef-bec7-0ac60713cb5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf4ffba40>]}
[0m23:00:02.118378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e5aa693-c609-45ef-bec7-0ac60713cb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf64285f0>]}
[0m23:00:02.137568 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mt29rbcf'
[0m23:00:02.137934 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:00:02.433377 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:00:02.434084 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:00:02.582056 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:00:02.585473 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:00:02.825930 [info ] [MainThread]: Installed from version 1.3.0
[0m23:00:02.826380 [info ] [MainThread]: Updated version available: 1.3.3
[0m23:00:02.826706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8e5aa693-c609-45ef-bec7-0ac60713cb5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf504ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf4f50a40>]}
[0m23:00:02.827045 [info ] [MainThread]: 
[0m23:00:02.827353 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:00:02.828031 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:00:02.828897 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86970633, "process_in_blocks": "0", "process_kernel_time": 0.21367, "process_mem_max_rss": "107972", "process_out_blocks": "2312", "process_user_time": 1.312976}
[0m23:00:02.829368 [debug] [MainThread]: Command `dbt deps` succeeded at 23:00:02.829282 after 0.87 seconds
[0m23:00:02.829672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf5144170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf64285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dcf4ec53d0>]}
[0m23:00:02.829968 [debug] [MainThread]: Flushing usage events
[0m23:00:03.335693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:04.835087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a030afcda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02fe3c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a030a33920>]}


============================== 23:00:04.840147 | 62fb96cd-711e-49b5-99e2-51c928c35c07 ==============================
[0m23:00:04.840147 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:00:04.841346 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'no_print': 'None', 'target_path': '/opt/airflow/dbt_target', 'use_colors': 'True', 'log_path': '/opt/airflow/logs/dbt', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'printer_width': '80'}
[0m23:00:04.885700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m23:00:04.886165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02fa3b410>]}
[0m23:00:04.886631 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m23:00:04.886961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02f9d7260>]}
[0m23:00:05.006100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a030e04920>]}
[0m23:00:05.064142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a030921340>]}
[0m23:00:05.064973 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:05.178286 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m23:00:05.304137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:05.304575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:05.309736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m23:00:05.360963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02ed17d70>]}
[0m23:00:05.458606 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m23:00:05.460244 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m23:00:05.488346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0308ad820>]}
[0m23:00:05.488807 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m23:00:05.492286 [info ] [MainThread]: 
[0m23:00:05.492655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:05.492950 [info ] [MainThread]: 
[0m23:00:05.493437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:05.497484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:00:05.504338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:00:05.533344 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:00:05.533675 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:00:05.534010 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:00:05.534324 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:00:05.534622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:05.534897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:05.540378 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m23:00:05.540688 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m23:00:05.541746 [debug] [ThreadPool]: On list_airflow: Close
[0m23:00:05.542711 [debug] [ThreadPool]: On list_airflow: Close
[0m23:00:05.544556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m23:00:05.545077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m23:00:05.549271 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m23:00:05.550631 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:00:05.550945 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m23:00:05.551241 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:00:05.551529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:05.551802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:05.555461 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:00:05.555807 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m23:00:05.556071 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:00:05.556398 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:00:05.556696 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:00:05.557048 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:00:05.558945 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:05.559218 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m23:00:05.560221 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m23:00:05.561861 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:00:05.562265 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m23:00:05.562523 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:00:05.572025 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.572381 [debug] [MainThread]: On master: BEGIN
[0m23:00:05.572655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:05.576361 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:00:05.576677 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.577004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:05.599056 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m23:00:05.600220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02dd14ce0>]}
[0m23:00:05.600673 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:05.601078 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.601390 [debug] [MainThread]: On master: BEGIN
[0m23:00:05.601816 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:00:05.602118 [debug] [MainThread]: On master: COMMIT
[0m23:00:05.602412 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.602668 [debug] [MainThread]: On master: COMMIT
[0m23:00:05.603002 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:05.603301 [debug] [MainThread]: On master: Close
[0m23:00:05.606784 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m23:00:05.607259 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m23:00:05.607637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m23:00:05.607933 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m23:00:05.613763 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m23:00:05.614300 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m23:00:05.643524 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m23:00:05.644112 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m23:00:05.644442 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m23:00:05.644723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:05.648817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:05.649157 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m23:00:05.649529 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m23:00:05.678392 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.028 seconds
[0m23:00:05.685844 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m23:00:05.686193 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m23:00:05.686778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.688890 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m23:00:05.689216 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m23:00:05.689693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.701387 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m23:00:05.701742 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m23:00:05.702027 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m23:00:05.731569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m23:00:05.736558 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m23:00:05.740723 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m23:00:05.741062 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m23:00:05.744738 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:05.746681 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m23:00:05.748020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a03243ad80>]}
[0m23:00:05.748599 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.14s]
[0m23:00:05.749081 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m23:00:05.749961 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m23:00:05.750381 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m23:00:05.750740 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m23:00:05.751126 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m23:00:05.751591 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m23:00:05.751990 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m23:00:05.752334 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m23:00:05.752650 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m23:00:05.762759 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m23:00:05.766052 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m23:00:05.766655 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m23:00:05.766990 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m23:00:05.779886 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m23:00:05.781488 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m23:00:05.782108 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m23:00:05.782513 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m23:00:05.782824 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m23:00:05.783151 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m23:00:05.783490 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:05.783804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:05.788234 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:05.788587 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:05.788934 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m23:00:05.789275 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m23:00:05.789611 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m23:00:05.789953 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m23:00:05.791922 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:05.792216 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:05.794792 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m23:00:05.795880 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m23:00:05.796333 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m23:00:05.796640 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m23:00:05.797190 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.05s]
[0m23:00:05.797585 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.05s]
[0m23:00:05.798174 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m23:00:05.798617 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m23:00:05.799451 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m23:00:05.799858 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m23:00:05.800213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m23:00:05.800535 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m23:00:05.851816 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m23:00:05.852761 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.853141 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m23:00:05.853578 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m23:00:05.854058 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m23:00:05.854622 [info ] [Thread-4 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m23:00:05.855123 [info ] [Thread-3 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m23:00:05.855575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m23:00:05.855901 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m23:00:05.856277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m23:00:05.856632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m23:00:05.856971 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m23:00:05.859753 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.860120 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m23:00:05.860460 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m23:00:05.862666 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m23:00:05.865813 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.868106 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m23:00:05.868496 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.869242 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m23:00:05.869628 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m23:00:05.869979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:05.870305 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m23:00:05.870634 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m23:00:05.873302 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.876056 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m23:00:05.878691 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m23:00:05.879363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:05.879792 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.880295 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m23:00:05.880636 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.880997 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m23:00:05.881369 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m23:00:05.881701 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m23:00:05.882043 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m23:00:05.882682 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:05.883035 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m23:00:05.883362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:05.883833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:05.887328 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:05.887752 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.888104 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:05.888456 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:05.888795 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m23:00:05.889146 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m23:00:05.889505 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m23:00:05.889891 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m23:00:05.890256 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m23:00:05.898356 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.015 seconds
[0m23:00:05.901970 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.902323 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m23:00:05.902833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.904823 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.905143 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m23:00:05.905506 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.015 seconds
[0m23:00:05.905868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.908098 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m23:00:05.909130 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m23:00:05.909494 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m23:00:05.909834 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.910209 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m23:00:05.910564 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.912610 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m23:00:05.912933 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m23:00:05.913414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.914376 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m23:00:05.914689 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m23:00:05.914968 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m23:00:05.915882 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.026 seconds
[0m23:00:05.918160 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.918508 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m23:00:05.919022 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.921009 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.921345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m23:00:05.921693 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m23:00:05.922004 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.031 seconds
[0m23:00:05.923720 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m23:00:05.926077 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m23:00:05.926430 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:00:05.926909 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m23:00:05.927265 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m23:00:05.928271 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m23:00:05.928622 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m23:00:05.928982 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m23:00:05.929332 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:05.929642 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.931359 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m23:00:05.934393 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m23:00:05.934713 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:00:05.935029 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m23:00:05.935513 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m23:00:05.935860 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m23:00:05.936901 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m23:00:05.937301 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m23:00:05.937904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c2d2a50>]}
[0m23:00:05.938268 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:05.938766 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.14s]
[0m23:00:05.939792 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m23:00:05.940125 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:05.940604 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m23:00:05.940950 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m23:00:05.942627 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m23:00:05.942970 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:00:05.943577 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m23:00:05.943934 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m23:00:05.944410 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m23:00:05.945434 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m23:00:05.945820 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m23:00:05.946178 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m23:00:05.946608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m23:00:05.946985 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c25ae70>]}
[0m23:00:05.947395 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m23:00:05.947878 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.09s]
[0m23:00:05.948222 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:05.953102 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m23:00:05.953514 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m23:00:05.953946 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m23:00:05.955669 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m23:00:05.956794 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m23:00:05.957164 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m23:00:05.957851 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m23:00:05.958170 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m23:00:05.958607 [info ] [Thread-2 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m23:00:05.959073 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c2a6b10>]}
[0m23:00:05.959461 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m23:00:05.961046 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m23:00:05.961430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m23:00:05.961922 [info ] [Thread-4 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.10s]
[0m23:00:05.962432 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m23:00:05.962833 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m23:00:05.963271 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m23:00:05.965944 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m23:00:05.966324 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m23:00:05.966690 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m23:00:05.967191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:05.967705 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m23:00:05.968023 [info ] [Thread-4 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m23:00:05.968363 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m23:00:05.970056 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m23:00:05.970505 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m23:00:05.971558 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m23:00:05.971966 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m23:00:05.972468 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m23:00:05.972819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:05.977212 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m23:00:05.977644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c24a540>]}
[0m23:00:05.977993 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m23:00:05.978339 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m23:00:05.978921 [info ] [Thread-3 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.12s]
[0m23:00:05.979302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:05.979687 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m23:00:05.980005 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m23:00:05.980480 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m23:00:05.982226 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m23:00:05.982668 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m23:00:05.982991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:05.983658 [info ] [Thread-3 (]: 11 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m23:00:05.984975 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m23:00:05.985359 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:05.985704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m23:00:05.986057 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m23:00:05.986463 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m23:00:05.986770 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m23:00:05.987106 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m23:00:05.987456 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m23:00:05.987792 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m23:00:05.991760 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m23:00:05.992215 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.05s]
[0m23:00:05.992598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:05.993173 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m23:00:05.993551 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:00:05.994024 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m23:00:05.994448 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m23:00:05.995529 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m23:00:05.995885 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m23:00:05.997473 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m23:00:05.997925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m23:00:05.998241 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m23:00:05.998584 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:05.999027 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m23:00:05.999469 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m23:00:05.999835 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m23:00:06.000266 [info ] [Thread-2 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m23:00:06.002962 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m23:00:06.003343 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m23:00:06.003702 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:00:06.004166 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m23:00:06.004584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:06.004993 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m23:00:06.005374 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m23:00:06.005720 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:00:06.007400 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m23:00:06.007778 [info ] [Thread-2 (]: 13 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m23:00:06.008953 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m23:00:06.009453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m23:00:06.009806 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.010217 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m23:00:06.010612 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m23:00:06.010919 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m23:00:06.011221 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m23:00:06.013993 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m23:00:06.014366 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m23:00:06.014760 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.015190 [info ] [Thread-4 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m23:00:06.015650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:06.016168 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m23:00:06.016472 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m23:00:06.016910 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:00:06.017305 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m23:00:06.019019 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m23:00:06.020130 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m23:00:06.020548 [info ] [Thread-4 (]: 14 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m23:00:06.020892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.021441 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m23:00:06.021760 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m23:00:06.022144 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m23:00:06.022485 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m23:00:06.022813 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m23:00:06.023208 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m23:00:06.023683 [info ] [Thread-3 (]: 11 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m23:00:06.024047 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.026751 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m23:00:06.027109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:06.027562 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m23:00:06.028186 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m23:00:06.028561 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:00:06.028922 [info ] [Thread-3 (]: 15 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m23:00:06.029275 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m23:00:06.030397 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m23:00:06.030758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m23:00:06.032426 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m23:00:06.032859 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m23:00:06.033168 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m23:00:06.033506 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:06.036296 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m23:00:06.037176 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m23:00:06.037531 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m23:00:06.036872 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m23:00:06.038057 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:00:06.038428 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m23:00:06.038823 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m23:00:06.039271 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m23:00:06.039653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:06.041233 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m23:00:06.041642 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m23:00:06.041942 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:06.042520 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m23:00:06.043693 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m23:00:06.044074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m23:00:06.044521 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m23:00:06.044863 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m23:00:06.045167 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m23:00:06.045542 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m23:00:06.045869 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:06.046387 [info ] [Thread-2 (]: 13 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m23:00:06.050390 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m23:00:06.050756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:06.051105 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m23:00:06.051588 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m23:00:06.052156 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.052547 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m23:00:06.052939 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m23:00:06.054699 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m23:00:06.055040 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:06.055444 [info ] [Thread-2 (]: 17 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m23:00:06.055794 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.057022 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m23:00:06.057440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m23:00:06.057821 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m23:00:06.058151 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m23:00:06.058552 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m23:00:06.058863 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m23:00:06.059195 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m23:00:06.059543 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.065493 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m23:00:06.065886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:06.066316 [info ] [Thread-4 (]: 14 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m23:00:06.067075 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m23:00:06.067478 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m23:00:06.067862 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m23:00:06.068202 [info ] [Thread-4 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m23:00:06.069922 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m23:00:06.070278 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:00:06.070670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m23:00:06.071000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.072207 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m23:00:06.072616 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m23:00:06.072958 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m23:00:06.073328 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m23:00:06.077224 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m23:00:06.077625 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m23:00:06.077924 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m23:00:06.078292 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.078720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:06.079122 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m23:00:06.079601 [info ] [Thread-3 (]: 15 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.05s]
[0m23:00:06.081361 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m23:00:06.081712 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:06.082159 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m23:00:06.083358 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m23:00:06.083857 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m23:00:06.084204 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m23:00:06.084531 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:06.084966 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m23:00:06.085292 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m23:00:06.085642 [info ] [Thread-3 (]: 19 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m23:00:06.086007 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m23:00:06.086340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:06.086738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m23:00:06.087154 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m23:00:06.087564 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.088011 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m23:00:06.088467 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m23:00:06.091242 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m23:00:06.091649 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:00:06.092039 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m23:00:06.092420 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:06.093699 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m23:00:06.094111 [info ] [Thread-1 (]: 20 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m23:00:06.094556 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m23:00:06.094891 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m23:00:06.095326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m23:00:06.095654 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m23:00:06.097216 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m23:00:06.097612 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.097974 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m23:00:06.098551 [info ] [Thread-2 (]: 17 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m23:00:06.099058 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m23:00:06.101728 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m23:00:06.102110 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:00:06.102548 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m23:00:06.102877 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m23:00:06.104066 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m23:00:06.104485 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m23:00:06.104787 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m23:00:06.105166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:06.105564 [info ] [Thread-2 (]: 21 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m23:00:06.105886 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m23:00:06.108687 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m23:00:06.109173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m23:00:06.109709 [info ] [Thread-4 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m23:00:06.110156 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m23:00:06.110713 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m23:00:06.111121 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m23:00:06.113748 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m23:00:06.114171 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m23:00:06.114555 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:06.114871 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m23:00:06.115332 [info ] [Thread-4 (]: 22 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m23:00:06.115696 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m23:00:06.116055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:06.116387 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m23:00:06.116738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m23:00:06.117082 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:00:06.118763 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m23:00:06.119116 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m23:00:06.121899 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m23:00:06.122350 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:00:06.122701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:00:06.123173 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m23:00:06.124407 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m23:00:06.124771 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m23:00:06.125093 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m23:00:06.125463 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m23:00:06.125862 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.126203 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m23:00:06.127723 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m23:00:06.128068 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:06.128636 [info ] [Thread-3 (]: 19 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m23:00:06.129341 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m23:00:06.129698 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m23:00:06.130085 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m23:00:06.130436 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:06.130827 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m23:00:06.131165 [info ] [Thread-3 (]: 23 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m23:00:06.132296 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m23:00:06.132674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:06.132996 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.133374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m23:00:06.133840 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m23:00:06.134180 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m23:00:06.134554 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m23:00:06.134941 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.135378 [info ] [Thread-1 (]: 20 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m23:00:06.139380 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m23:00:06.139972 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m23:00:06.140339 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:00:06.140761 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m23:00:06.141141 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:00:06.141499 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m23:00:06.141840 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m23:00:06.142178 [info ] [Thread-1 (]: 24 of 33 START test test_counts_match .......................................... [RUN]
[0m23:00:06.143319 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m23:00:06.144963 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m23:00:06.145342 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.145702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m23:00:06.146123 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m23:00:06.146644 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m23:00:06.146951 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m23:00:06.147440 [info ] [Thread-2 (]: 21 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m23:00:06.147784 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:00:06.148089 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m23:00:06.150312 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m23:00:06.150775 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m23:00:06.151848 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m23:00:06.152191 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:06.152661 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_survey_type
[0m23:00:06.153261 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m23:00:06.153719 [info ] [Thread-2 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m23:00:06.155334 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m23:00:06.155651 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m23:00:06.156018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now model.caspian_vault.dim_survey_type)
[0m23:00:06.156543 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:06.156972 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m23:00:06.157434 [info ] [Thread-4 (]: 22 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m23:00:06.157866 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m23:00:06.158177 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m23:00:06.161374 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m23:00:06.161848 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m23:00:06.162169 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m23:00:06.162542 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:00:06.162990 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_well
[0m23:00:06.163388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:06.163754 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_survey_type
[0m23:00:06.164231 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_well ................................. [RUN]
[0m23:00:06.167090 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m23:00:06.167469 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:00:06.167872 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now model.caspian_vault.dim_well)
[0m23:00:06.168209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.169460 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m23:00:06.169823 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_well
[0m23:00:06.170201 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m23:00:06.170558 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m23:00:06.172696 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m23:00:06.173032 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m23:00:06.173398 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m23:00:06.173749 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m23:00:06.174428 [info ] [Thread-3 (]: 23 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m23:00:06.174807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:06.175197 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_well
[0m23:00:06.175653 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m23:00:06.178431 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m23:00:06.178776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:00:06.180161 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m23:00:06.180527 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:06.181024 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m23:00:06.181344 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m23:00:06.181645 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m23:00:06.181990 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: BEGIN
[0m23:00:06.182342 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m23:00:06.182729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:06.183154 [info ] [Thread-1 (]: 24 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m23:00:06.183839 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m23:00:06.184408 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_source_format
[0m23:00:06.184728 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_time
[0m23:00:06.185148 [info ] [Thread-3 (]: 27 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m23:00:06.185619 [info ] [Thread-1 (]: 28 of 33 START sql table model public.dim_time ................................. [RUN]
[0m23:00:06.186019 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_source_format)
[0m23:00:06.186517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now model.caspian_vault.dim_time)
[0m23:00:06.186896 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_source_format
[0m23:00:06.187277 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:00:06.187614 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_time
[0m23:00:06.187927 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.190082 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m23:00:06.192547 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m23:00:06.194590 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m23:00:06.194952 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m23:00:06.195385 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m23:00:06.195881 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m23:00:06.196343 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_source_format
[0m23:00:06.196729 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_time
[0m23:00:06.197091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.199734 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m23:00:06.203219 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m23:00:06.203608 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.007 seconds
[0m23:00:06.205662 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m23:00:06.208169 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m23:00:06.208609 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m23:00:06.208978 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m23:00:06.209312 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m23:00:06.209665 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m23:00:06.209996 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: BEGIN
[0m23:00:06.210329 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m23:00:06.210747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:06.211089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:06.211406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:06.211740 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:06.213005 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m23:00:06.215130 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m23:00:06.215531 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m23:00:06.215927 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m23:00:06.216259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.216593 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:00:06.216945 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m23:00:06.217340 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m23:00:06.217688 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.217993 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m23:00:06.218402 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m23:00:06.219409 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m23:00:06.219758 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m23:00:06.220141 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m23:00:06.220532 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m23:00:06.220952 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:06.222710 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m23:00:06.223021 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:06.223494 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m23:00:06.225107 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m23:00:06.225477 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m23:00:06.225932 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m23:00:06.226316 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m23:00:06.226607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:00:06.228964 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m23:00:06.229298 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m23:00:06.229780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.230112 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:00:06.232157 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m23:00:06.232507 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m23:00:06.233522 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: Close
[0m23:00:06.233861 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m23:00:06.234867 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: Close
[0m23:00:06.235418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c14a4b0>]}
[0m23:00:06.235812 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.015 seconds
[0m23:00:06.236152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:06.236573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c135b80>]}
[0m23:00:06.237076 [info ] [Thread-2 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.08s]
[0m23:00:06.239458 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m23:00:06.240475 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m23:00:06.240985 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.07s]
[0m23:00:06.241519 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_survey_type
[0m23:00:06.241853 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m23:00:06.242198 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m23:00:06.242653 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_well
[0m23:00:06.243020 [debug] [Thread-2 (]: Began running node model.caspian_vault.fct_readings
[0m23:00:06.243466 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m23:00:06.243803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.244282 [info ] [Thread-2 (]: 29 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m23:00:06.246437 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m23:00:06.246813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m23:00:06.247117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:06.247476 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m23:00:06.247815 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.fct_readings
[0m23:00:06.250445 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m23:00:06.252783 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m23:00:06.253167 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:00:06.253693 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m23:00:06.254769 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m23:00:06.255159 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m23:00:06.255486 [debug] [Thread-2 (]: Began executing node model.caspian_vault.fct_readings
[0m23:00:06.255840 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m23:00:06.258439 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m23:00:06.258802 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m23:00:06.259104 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:06.260284 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: Close
[0m23:00:06.260684 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m23:00:06.261021 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:06.261371 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: BEGIN
[0m23:00:06.261754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0257057f0>]}
[0m23:00:06.263426 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m23:00:06.263762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:06.264338 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.08s]
[0m23:00:06.264847 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m23:00:06.265415 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_time
[0m23:00:06.265742 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m23:00:06.268233 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:00:06.269232 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: Close
[0m23:00:06.269728 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c1efb60>]}
[0m23:00:06.270053 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:06.270559 [info ] [Thread-3 (]: 27 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.08s]
[0m23:00:06.270925 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m23:00:06.271378 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_source_format
[0m23:00:06.271719 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m23:00:06.287938 [debug] [Thread-2 (]: SQL status: SELECT 9980 in 0.016 seconds
[0m23:00:06.290518 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m23:00:06.290844 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m23:00:06.291380 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.293412 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m23:00:06.293739 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m23:00:06.294212 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.295182 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: COMMIT
[0m23:00:06.295521 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m23:00:06.295799 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: COMMIT
[0m23:00:06.306216 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:00:06.307965 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m23:00:06.308436 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m23:00:06.308730 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m23:00:06.311917 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:06.312949 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: Close
[0m23:00:06.313445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c221190>]}
[0m23:00:06.313934 [info ] [Thread-2 (]: 29 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.07s]
[0m23:00:06.314399 [debug] [Thread-2 (]: Finished running node model.caspian_vault.fct_readings
[0m23:00:06.315117 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m23:00:06.315492 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m23:00:06.315927 [info ] [Thread-4 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m23:00:06.316357 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_well_performance
[0m23:00:06.316750 [info ] [Thread-1 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m23:00:06.317167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_sensor_analysis)
[0m23:00:06.317600 [info ] [Thread-3 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m23:00:06.317983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m23:00:06.318325 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m23:00:06.318667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m23:00:06.318997 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m23:00:06.321301 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.321656 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m23:00:06.323626 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m23:00:06.326928 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m23:00:06.327483 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m23:00:06.330133 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.330506 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_well_performance
[0m23:00:06.330862 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m23:00:06.333543 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m23:00:06.336137 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m23:00:06.336551 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.337141 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m23:00:06.337511 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:06.337899 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m23:00:06.338362 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m23:00:06.338710 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m23:00:06.339057 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m23:00:06.339397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:06.339713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:06.341993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:06.342344 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.342651 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m23:00:06.343360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:06.343732 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m23:00:06.344041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:06.344402 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m23:00:06.344738 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m23:00:06.345114 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m23:00:06.350210 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.007 seconds
[0m23:00:06.352723 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.353051 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m23:00:06.353469 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.008 seconds
[0m23:00:06.353806 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.356075 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m23:00:06.358111 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.358486 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m23:00:06.358792 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.013 seconds
[0m23:00:06.359136 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m23:00:06.361556 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m23:00:06.361889 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:00:06.362283 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m23:00:06.364304 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m23:00:06.364619 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:00:06.365010 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m23:00:06.365343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.366349 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m23:00:06.369287 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m23:00:06.369621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:00:06.369955 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.370306 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m23:00:06.371302 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m23:00:06.371634 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m23:00:06.372009 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m23:00:06.372334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:06.372699 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m23:00:06.373755 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m23:00:06.374147 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m23:00:06.374459 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m23:00:06.374773 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:06.376384 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m23:00:06.376845 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m23:00:06.377160 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:06.377546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:06.377851 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m23:00:06.379452 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m23:00:06.381062 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m23:00:06.381683 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m23:00:06.382146 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m23:00:06.382502 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m23:00:06.382836 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m23:00:06.383417 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:00:06.384440 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m23:00:06.384938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c1d93d0>]}
[0m23:00:06.385740 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:06.385460 [info ] [Thread-4 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.07s]
[0m23:00:06.386876 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: Close
[0m23:00:06.387209 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:00:06.387651 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m23:00:06.388691 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m23:00:06.389059 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c2214f0>]}
[0m23:00:06.390059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c2213a0>]}
[0m23:00:06.389735 [info ] [Thread-3 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.07s]
[0m23:00:06.390652 [info ] [Thread-1 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.07s]
[0m23:00:06.391125 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_well_performance
[0m23:00:06.391566 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m23:00:06.392189 [debug] [Thread-2 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:06.392637 [info ] [Thread-2 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m23:00:06.393007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m23:00:06.393329 [debug] [Thread-2 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:06.395753 [debug] [Thread-2 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:06.430995 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.431414 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m23:00:06.431710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:06.435985 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:06.436342 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.436653 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:00:06.441938 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.005 seconds
[0m23:00:06.472615 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.473063 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp230006471903"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m23:00:06.475540 [debug] [Thread-2 (]: SQL status: SELECT 42 in 0.002 seconds
[0m23:00:06.478783 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.479127 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp230006471903'
        
      order by ordinal_position

  
[0m23:00:06.481570 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m23:00:06.483806 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.484143 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:00:06.485979 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.001 seconds
[0m23:00:06.488171 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.488524 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp230006471903'
        
      order by ordinal_position

  
[0m23:00:06.490365 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.001 seconds
[0m23:00:06.492570 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.492906 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:00:06.494711 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.001 seconds
[0m23:00:06.499543 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.499892 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp230006471903'
        
      order by ordinal_position

  
[0m23:00:06.501732 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m23:00:06.514639 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.515064 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m23:00:06.515745 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:00:06.519587 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.519926 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:00:06.520396 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:00:06.520820 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.521353 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.521703 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp230006471903" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp230006471903" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:00:06.522561 [debug] [Thread-2 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m23:00:06.523518 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m23:00:06.523839 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:06.524121 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m23:00:06.527002 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:06.529004 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m23:00:06.529547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fb96cd-711e-49b5-99e2-51c928c35c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0257aa2d0>]}
[0m23:00:06.530195 [info ] [Thread-2 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m23:00:06.530705 [debug] [Thread-2 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:06.532127 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:06.532480 [debug] [MainThread]: On master: BEGIN
[0m23:00:06.532797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:06.536695 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:00:06.537021 [debug] [MainThread]: On master: COMMIT
[0m23:00:06.537323 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:06.537597 [debug] [MainThread]: On master: COMMIT
[0m23:00:06.537945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:06.538232 [debug] [MainThread]: On master: Close
[0m23:00:06.538638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:06.538913 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m23:00:06.539160 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m23:00:06.539421 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m23:00:06.539657 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m23:00:06.540001 [info ] [MainThread]: 
[0m23:00:06.540323 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m23:00:06.543943 [debug] [MainThread]: Command end result
[0m23:00:06.569730 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m23:00:06.571273 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m23:00:06.577216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m23:00:06.577584 [info ] [MainThread]: 
[0m23:00:06.577929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:06.578228 [info ] [MainThread]: 
[0m23:00:06.578560 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m23:00:06.579092 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:00:06.579956 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.787734, "process_in_blocks": "0", "process_kernel_time": 0.330883, "process_mem_max_rss": "134460", "process_out_blocks": "3616", "process_user_time": 2.651069}
[0m23:00:06.580449 [debug] [MainThread]: Command `dbt build` succeeded at 23:00:06.580365 after 1.79 seconds
[0m23:00:06.580785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a030867ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c398860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a02c159fd0>]}
[0m23:00:06.581123 [debug] [MainThread]: Flushing usage events
[0m23:00:07.084521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:08.649370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec04d57a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec066ee240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec046559d0>]}


============================== 23:00:08.654171 | fb38905d-4c11-439d-9b59-bc2d71c989ff ==============================
[0m23:00:08.654171 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:00:08.654625 [debug] [MainThread]: running dbt with arguments {'target_path': '/opt/airflow/dbt_target', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/opt/airflow/logs/dbt', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev'}
[0m23:00:08.698758 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m23:00:08.699224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec03a0c500>]}
[0m23:00:08.699685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m23:00:08.700019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec03a0c500>]}
[0m23:00:08.818557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec04bb4320>]}
[0m23:00:08.876334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec03bb3e60>]}
[0m23:00:08.877141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:08.987647 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m23:00:09.112539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:09.112955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:09.118069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m23:00:09.168742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec02b03140>]}
[0m23:00:09.266362 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m23:00:09.267962 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m23:00:09.285781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec01b42bd0>]}
[0m23:00:09.286237 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m23:00:09.286587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec0232f740>]}
[0m23:00:09.288515 [info ] [MainThread]: 
[0m23:00:09.288881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:09.289176 [info ] [MainThread]: 
[0m23:00:09.289663 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:09.290488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:00:09.323104 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:00:09.323473 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:00:09.323745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:09.328957 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m23:00:09.329991 [debug] [ThreadPool]: On list_airflow: Close
[0m23:00:09.334151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m23:00:09.338476 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:00:09.338899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_snapshots'
[0m23:00:09.339265 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:00:09.341353 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m23:00:09.341660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:09.341948 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m23:00:09.342402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:09.345739 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:00:09.346076 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:00:09.346360 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:00:09.346673 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:00:09.346976 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m23:00:09.347333 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:00:09.349295 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m23:00:09.349576 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:00:09.351100 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:00:09.352054 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m23:00:09.352470 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:00:09.352731 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m23:00:09.362171 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.362521 [debug] [MainThread]: On master: BEGIN
[0m23:00:09.362782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:09.366476 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:00:09.366795 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.367120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:09.389056 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m23:00:09.390236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec05f7e6f0>]}
[0m23:00:09.390698 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:09.391105 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.391420 [debug] [MainThread]: On master: BEGIN
[0m23:00:09.391839 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:00:09.392139 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.392440 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.392700 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.393036 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:09.393343 [debug] [MainThread]: On master: Close
[0m23:00:09.396870 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:09.397338 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m23:00:09.397713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now snapshot.caspian_vault.snap_mart_well_performance)
[0m23:00:09.398015 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:09.403535 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:09.440984 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.441394 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m23:00:09.441685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:09.445892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:00:09.446234 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.446556 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:00:09.451802 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m23:00:09.490286 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.490749 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp230009484854"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m23:00:09.493368 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m23:00:09.496331 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.496680 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp230009484854'
        
      order by ordinal_position

  
[0m23:00:09.499124 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m23:00:09.501345 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.501681 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:00:09.503553 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m23:00:09.505716 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.506049 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp230009484854'
        
      order by ordinal_position

  
[0m23:00:09.507927 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m23:00:09.510174 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.510528 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:00:09.512360 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m23:00:09.517022 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.517382 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp230009484854'
        
      order by ordinal_position

  
[0m23:00:09.519240 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m23:00:09.532015 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.532451 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m23:00:09.533160 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:00:09.537013 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.537376 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:00:09.537902 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:00:09.538349 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.538854 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.539212 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp230009484854" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp230009484854" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:00:09.540096 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m23:00:09.550496 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m23:00:09.550861 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m23:00:09.551147 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m23:00:09.553515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:09.556306 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m23:00:09.557665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb38905d-4c11-439d-9b59-bc2d71c989ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec061d3260>]}
[0m23:00:09.558343 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m23:00:09.558846 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m23:00:09.560088 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.560431 [debug] [MainThread]: On master: BEGIN
[0m23:00:09.560705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:09.564804 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:00:09.565127 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.565425 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.565686 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.566024 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:09.566317 [debug] [MainThread]: On master: Close
[0m23:00:09.566691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:09.566955 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m23:00:09.567192 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m23:00:09.567486 [info ] [MainThread]: 
[0m23:00:09.567782 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:00:09.568366 [debug] [MainThread]: Command end result
[0m23:00:09.641485 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m23:00:09.643032 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m23:00:09.647914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m23:00:09.648244 [info ] [MainThread]: 
[0m23:00:09.648642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:09.648925 [info ] [MainThread]: 
[0m23:00:09.649223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:00:09.649729 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:00:09.650600 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0437114, "process_in_blocks": "0", "process_kernel_time": 0.291328, "process_mem_max_rss": "128284", "process_out_blocks": "2760", "process_user_time": 2.003378}
[0m23:00:09.651052 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:00:09.650971 after 1.04 seconds
[0m23:00:09.651406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec03a0ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec04b615b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ec066a34d0>]}
[0m23:00:09.651744 [debug] [MainThread]: Flushing usage events
[0m23:00:10.074468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:01.959295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc3290e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc32f8fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc33e48f20>]}


============================== 00:00:01.964232 | aa66cfc9-5b8d-4d16-b890-e73836021939 ==============================
[0m00:00:01.964232 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:00:01.964701 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'log_path': '/opt/airflow/logs/dbt', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev'}
[0m00:00:01.970960 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m00:00:01.971351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa66cfc9-5b8d-4d16-b890-e73836021939', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc31dd08f0>]}
[0m00:00:01.971747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m00:00:01.972057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa66cfc9-5b8d-4d16-b890-e73836021939', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc32febc20>]}
[0m00:00:02.074376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa66cfc9-5b8d-4d16-b890-e73836021939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc31b33e60>]}
[0m00:00:02.093570 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-az8vj6zt'
[0m00:00:02.093922 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:00:02.340922 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:00:02.341639 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:00:02.371907 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:00:02.375121 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:00:02.611833 [info ] [MainThread]: Installed from version 1.3.0
[0m00:00:02.612273 [info ] [MainThread]: Updated version available: 1.3.3
[0m00:00:02.612605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aa66cfc9-5b8d-4d16-b890-e73836021939', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc32ea9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc31a185f0>]}
[0m00:00:02.612946 [info ] [MainThread]: 
[0m00:00:02.613233 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:00:02.613907 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:00:02.614753 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.697985, "process_in_blocks": "0", "process_kernel_time": 0.221419, "process_mem_max_rss": "108044", "process_out_blocks": "2304", "process_user_time": 1.316545}
[0m00:00:02.615183 [debug] [MainThread]: Command `dbt deps` succeeded at 00:00:02.615108 after 0.70 seconds
[0m00:00:02.615506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc327a2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc318c62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bc32ea9d30>]}
[0m00:00:02.615793 [debug] [MainThread]: Flushing usage events
[0m00:00:03.103778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:04.597930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ae78af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682b075cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ae788b90>]}


============================== 00:00:04.602901 | 680489bc-2c16-4e9d-a167-02a94b191b1b ==============================
[0m00:00:04.602901 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:00:04.603357 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'target_path': '/opt/airflow/dbt_target', 'partial_parse': 'True', 'log_path': '/opt/airflow/logs/dbt', 'debug': 'False', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'log_cache_events': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None'}
[0m00:00:04.647766 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m00:00:04.648230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682adba62d0>]}
[0m00:00:04.648701 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m00:00:04.649036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ada7dbe0>]}
[0m00:00:04.768571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682b03bf080>]}
[0m00:00:04.826915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ade180e0>]}
[0m00:00:04.827730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:00:04.940895 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m00:00:05.066853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:05.067302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:05.072490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m00:00:05.123497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ad15e810>]}
[0m00:00:05.221077 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m00:00:05.222746 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m00:00:05.250790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ac118710>]}
[0m00:00:05.251266 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m00:00:05.254705 [info ] [MainThread]: 
[0m00:00:05.255068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:05.255377 [info ] [MainThread]: 
[0m00:00:05.255848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:05.259935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:00:05.260479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:00:05.295460 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:00:05.295841 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:00:05.296173 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:00:05.296503 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:00:05.296806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.297085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.302593 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m00:00:05.302932 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m00:00:05.303947 [debug] [ThreadPool]: On list_airflow: Close
[0m00:00:05.304933 [debug] [ThreadPool]: On list_airflow: Close
[0m00:00:05.306833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m00:00:05.307331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m00:00:05.311648 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:00:05.313039 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m00:00:05.313375 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:00:05.313668 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m00:00:05.313947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:05.314215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:05.317874 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:05.318220 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:00:05.318502 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:05.318816 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:00:05.319114 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m00:00:05.319476 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:00:05.321382 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m00:00:05.323039 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:00:05.323342 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m00:00:05.324284 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m00:00:05.324543 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:00:05.324910 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m00:00:05.334394 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:05.334719 [debug] [MainThread]: On master: BEGIN
[0m00:00:05.334985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:05.338608 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:05.338923 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:05.339268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:05.361450 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m00:00:05.362608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682abdb7f20>]}
[0m00:00:05.363048 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:05.363475 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:05.363763 [debug] [MainThread]: On master: BEGIN
[0m00:00:05.364187 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:05.364502 [debug] [MainThread]: On master: COMMIT
[0m00:00:05.364769 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:05.365019 [debug] [MainThread]: On master: COMMIT
[0m00:00:05.365369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:05.365652 [debug] [MainThread]: On master: Close
[0m00:00:05.369145 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m00:00:05.369604 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m00:00:05.369962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.stg_readings)
[0m00:00:05.370268 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m00:00:05.375979 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m00:00:05.376501 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m00:00:05.405415 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m00:00:05.406004 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m00:00:05.406338 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m00:00:05.406620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.410748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:00:05.411087 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m00:00:05.411448 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m00:00:05.441262 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.029 seconds
[0m00:00:05.448708 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m00:00:05.449056 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m00:00:05.449627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.451743 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m00:00:05.452060 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m00:00:05.452526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.464141 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m00:00:05.464521 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m00:00:05.464815 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m00:00:05.494273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m00:00:05.499218 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m00:00:05.503356 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m00:00:05.503692 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m00:00:05.506971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:00:05.508870 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m00:00:05.510208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682b068acf0>]}
[0m00:00:05.510764 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.14s]
[0m00:00:05.511272 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m00:00:05.512164 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m00:00:05.512586 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m00:00:05.512938 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m00:00:05.513332 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m00:00:05.513801 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m00:00:05.514203 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m00:00:05.514547 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m00:00:05.514866 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m00:00:05.525141 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m00:00:05.528509 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m00:00:05.529124 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m00:00:05.529467 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m00:00:05.542166 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m00:00:05.543797 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m00:00:05.544422 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m00:00:05.544807 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m00:00:05.545126 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m00:00:05.545476 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m00:00:05.545803 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:00:05.546120 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:00:05.550067 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m00:00:05.550467 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m00:00:05.550779 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.551130 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m00:00:05.551481 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m00:00:05.551854 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m00:00:05.553162 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.553487 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.555955 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m00:00:05.557045 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m00:00:05.557505 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m00:00:05.557838 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m00:00:05.558383 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m00:00:05.558764 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m00:00:05.559367 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m00:00:05.559794 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m00:00:05.560653 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m00:00:05.561007 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m00:00:05.561384 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m00:00:05.562040 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_sat_readings
[0m00:00:05.561777 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m00:00:05.562541 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m00:00:05.562976 [info ] [Thread-3 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m00:00:05.563399 [info ] [Thread-4 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m00:00:05.563772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m00:00:05.564120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.dv_hub_well)
[0m00:00:05.565758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m00:00:05.566117 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m00:00:05.566463 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m00:00:05.566781 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m00:00:05.567101 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m00:00:05.567434 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m00:00:05.616583 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.618941 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m00:00:05.622068 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.624454 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m00:00:05.625178 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m00:00:05.625621 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m00:00:05.628391 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.628737 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m00:00:05.629118 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m00:00:05.631755 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.634491 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m00:00:05.637119 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m00:00:05.637512 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.638145 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.638637 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m00:00:05.638960 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m00:00:05.639338 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m00:00:05.639670 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m00:00:05.640007 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m00:00:05.640336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.640650 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:05.640975 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m00:00:05.641300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:05.641825 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:05.645758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.646103 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.646490 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.646883 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.647265 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.647613 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m00:00:05.647942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m00:00:05.648316 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m00:00:05.648662 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m00:00:05.649049 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m00:00:05.649461 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m00:00:05.649834 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m00:00:05.665232 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.016 seconds
[0m00:00:05.668798 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.669115 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.019 seconds
[0m00:00:05.669471 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m00:00:05.671723 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m00:00:05.672125 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m00:00:05.672448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.674487 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.674797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:05.675133 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m00:00:05.677216 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m00:00:05.677624 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m00:00:05.677979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.678327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.679327 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m00:00:05.680304 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m00:00:05.680653 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.681003 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.032 seconds
[0m00:00:05.681331 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m00:00:05.681657 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m00:00:05.684004 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.684367 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.034 seconds
[0m00:00:05.684688 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m00:00:05.685060 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m00:00:05.687454 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m00:00:05.687927 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m00:00:05.688264 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.690365 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.690674 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:05.691011 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m00:00:05.693038 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m00:00:05.693438 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m00:00:05.693744 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.694794 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m00:00:05.695138 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:05.695472 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.696449 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m00:00:05.696782 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m00:00:05.697109 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m00:00:05.697484 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m00:00:05.704846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m00:00:05.706649 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m00:00:05.706977 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m00:00:05.707316 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m00:00:05.707659 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m00:00:05.708158 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m00:00:05.710885 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m00:00:05.712516 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m00:00:05.714279 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m00:00:05.714638 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m00:00:05.715110 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m00:00:05.715595 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m00:00:05.716064 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m00:00:05.716468 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m00:00:05.716806 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m00:00:05.717146 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m00:00:05.718497 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:00:05.719570 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m00:00:05.720093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682aa35d8e0>]}
[0m00:00:05.720469 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:00:05.721259 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:00:05.721582 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:00:05.720971 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.16s]
[0m00:00:05.722686 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m00:00:05.723705 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: Close
[0m00:00:05.724706 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m00:00:05.725161 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m00:00:05.725707 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682aa4ce5a0>]}
[0m00:00:05.726137 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a823ff20>]}
[0m00:00:05.726718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682aa3adf70>]}
[0m00:00:05.727212 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m00:00:05.727689 [info ] [Thread-3 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.16s]
[0m00:00:05.728214 [info ] [Thread-4 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.16s]
[0m00:00:05.728771 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.16s]
[0m00:00:05.729168 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m00:00:05.729651 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m00:00:05.730080 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m00:00:05.730526 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m00:00:05.730872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m00:00:05.731227 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m00:00:05.731755 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m00:00:05.732324 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m00:00:05.732701 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m00:00:05.733091 [info ] [Thread-3 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m00:00:05.733465 [info ] [Thread-4 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m00:00:05.733822 [info ] [Thread-2 (]: 11 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m00:00:05.738831 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m00:00:05.739223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m00:00:05.739596 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m00:00:05.739948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m00:00:05.740366 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m00:00:05.740779 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m00:00:05.741170 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m00:00:05.741493 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m00:00:05.744311 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m00:00:05.748651 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m00:00:05.750267 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m00:00:05.752995 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m00:00:05.753728 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m00:00:05.754290 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m00:00:05.755837 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m00:00:05.756201 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m00:00:05.756604 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m00:00:05.759192 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m00:00:05.760821 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m00:00:05.761202 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m00:00:05.761662 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m00:00:05.762111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.762554 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m00:00:05.762871 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m00:00:05.763235 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m00:00:05.763696 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m00:00:05.764045 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:05.764431 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m00:00:05.764758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:05.765171 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:05.767139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.767492 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m00:00:05.767796 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.768410 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m00:00:05.768819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.769127 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m00:00:05.769500 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.769838 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.771138 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m00:00:05.771523 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.771886 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m00:00:05.772258 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m00:00:05.772693 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m00:00:05.773015 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.773357 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.773690 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:00:05.774537 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:00:05.774261 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.04s]
[0m00:00:05.775705 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m00:00:05.776847 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m00:00:05.777215 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.777659 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m00:00:05.778074 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m00:00:05.779114 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m00:00:05.779463 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m00:00:05.779836 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m00:00:05.780390 [info ] [Thread-3 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m00:00:05.780808 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m00:00:05.781122 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m00:00:05.781586 [info ] [Thread-2 (]: 11 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m00:00:05.782067 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m00:00:05.782462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m00:00:05.782874 [info ] [Thread-4 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m00:00:05.783360 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m00:00:05.783704 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m00:00:05.784058 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m00:00:05.784508 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m00:00:05.784859 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m00:00:05.785224 [info ] [Thread-3 (]: 13 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m00:00:05.788155 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m00:00:05.788558 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m00:00:05.789004 [info ] [Thread-2 (]: 14 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m00:00:05.789402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m00:00:05.789822 [info ] [Thread-4 (]: 15 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m00:00:05.790235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m00:00:05.790592 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m00:00:05.790939 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m00:00:05.791292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m00:00:05.791618 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m00:00:05.793213 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m00:00:05.795933 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m00:00:05.796303 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m00:00:05.802277 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m00:00:05.805150 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m00:00:05.805737 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m00:00:05.806081 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m00:00:05.806575 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m00:00:05.806880 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m00:00:05.808514 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m00:00:05.808916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.809294 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m00:00:05.810877 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m00:00:05.811536 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m00:00:05.814016 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m00:00:05.814504 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m00:00:05.815089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:05.815429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:05.815775 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m00:00:05.816175 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m00:00:05.816518 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m00:00:05.816946 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m00:00:05.817310 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m00:00:05.817680 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.818013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:05.818337 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:05.819149 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:00:05.820337 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m00:00:05.820796 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m00:00:05.821121 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:05.821563 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m00:00:05.822067 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m00:00:05.822504 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.822891 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.823256 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.823730 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m00:00:05.824124 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m00:00:05.824498 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m00:00:05.824901 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m00:00:05.825206 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.825636 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.826006 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:00:05.826368 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m00:00:05.827476 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m00:00:05.827953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m00:00:05.828338 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m00:00:05.828707 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.829014 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.831826 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m00:00:05.832151 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m00:00:05.833242 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m00:00:05.834339 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m00:00:05.834944 [info ] [Thread-3 (]: 13 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.05s]
[0m00:00:05.835359 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m00:00:05.835906 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m00:00:05.836197 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m00:00:05.837852 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m00:00:05.838165 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m00:00:05.838549 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m00:00:05.839173 [info ] [Thread-2 (]: 14 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.05s]
[0m00:00:05.839796 [info ] [Thread-4 (]: 15 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.05s]
[0m00:00:05.840544 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m00:00:05.840062 [info ] [Thread-3 (]: 17 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m00:00:05.841098 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m00:00:05.841574 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m00:00:05.841909 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m00:00:05.842278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m00:00:05.842663 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m00:00:05.843062 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m00:00:05.843424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.843754 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m00:00:05.844084 [info ] [Thread-2 (]: 18 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m00:00:05.844449 [info ] [Thread-4 (]: 19 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m00:00:05.847332 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m00:00:05.847707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m00:00:05.848111 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m00:00:05.848474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.848903 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m00:00:05.849297 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m00:00:05.849674 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m00:00:05.849987 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m00:00:05.852674 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m00:00:05.856694 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m00:00:05.858312 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m00:00:05.858669 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.859338 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m00:00:05.859764 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m00:00:05.861384 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m00:00:05.861738 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m00:00:05.862099 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.863688 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m00:00:05.864164 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m00:00:05.864544 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m00:00:05.865682 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m00:00:05.866111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:05.866536 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m00:00:05.866859 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m00:00:05.867373 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m00:00:05.867671 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m00:00:05.868013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:05.868344 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:05.868922 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m00:00:05.869532 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m00:00:05.869881 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m00:00:05.870259 [info ] [Thread-1 (]: 20 of 33 START test test_counts_match .......................................... [RUN]
[0m00:00:05.870643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m00:00:05.870963 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.871314 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m00:00:05.871641 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m00:00:05.874846 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m00:00:05.875240 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m00:00:05.875625 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.875976 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m00:00:05.876446 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m00:00:05.876819 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m00:00:05.877190 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m00:00:05.877543 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.879135 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m00:00:05.879481 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.879826 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.881108 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m00:00:05.881599 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:00:05.881937 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m00:00:05.883035 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m00:00:05.883357 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m00:00:05.883712 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.884009 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m00:00:05.884431 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m00:00:05.885464 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m00:00:05.885899 [info ] [Thread-3 (]: 17 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m00:00:05.886275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.886801 [info ] [Thread-2 (]: 18 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m00:00:05.887321 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m00:00:05.887621 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m00:00:05.888184 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m00:00:05.888565 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m00:00:05.889021 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m00:00:05.889445 [info ] [Thread-4 (]: 19 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m00:00:05.889857 [info ] [Thread-3 (]: 21 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m00:00:05.890203 [info ] [Thread-2 (]: 22 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m00:00:05.890668 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m00:00:05.891008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m00:00:05.891403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m00:00:05.891728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.892101 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m00:00:05.892474 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m00:00:05.892795 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m00:00:05.893124 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m00:00:05.893477 [info ] [Thread-4 (]: 23 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m00:00:05.896396 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m00:00:05.899167 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m00:00:05.899563 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m00:00:05.899941 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m00:00:05.900513 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m00:00:05.900944 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m00:00:05.901269 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m00:00:05.902805 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m00:00:05.904351 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m00:00:05.904683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:00:05.908639 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m00:00:05.909300 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m00:00:05.910433 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m00:00:05.910887 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m00:00:05.911240 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m00:00:05.911647 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m00:00:05.912002 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m00:00:05.912342 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m00:00:05.912640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:05.914221 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m00:00:05.914571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:05.915136 [info ] [Thread-1 (]: 20 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m00:00:05.915813 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m00:00:05.916312 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m00:00:05.916674 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m00:00:05.917055 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m00:00:05.917454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:05.917905 [info ] [Thread-1 (]: 24 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m00:00:05.918453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m00:00:05.918804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:05.919198 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m00:00:05.919536 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.919884 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m00:00:05.922585 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m00:00:05.922979 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m00:00:05.923324 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:05.923671 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.924096 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.924479 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m00:00:05.924813 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m00:00:05.926496 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m00:00:05.926881 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:00:05.928317 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.928639 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:00:05.929922 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m00:00:05.930282 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m00:00:05.930617 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.931652 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m00:00:05.932040 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m00:00:05.932342 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m00:00:05.933404 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m00:00:05.933786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.934149 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m00:00:05.934680 [info ] [Thread-3 (]: 21 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m00:00:05.935210 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m00:00:05.935675 [info ] [Thread-2 (]: 22 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m00:00:05.936183 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m00:00:05.936694 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m00:00:05.937103 [info ] [Thread-4 (]: 23 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m00:00:05.937568 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m00:00:05.938016 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_source_format
[0m00:00:05.938545 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m00:00:05.938849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:05.939280 [info ] [Thread-3 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m00:00:05.939713 [info ] [Thread-2 (]: 26 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m00:00:05.940096 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_time
[0m00:00:05.940456 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m00:00:05.940798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now model.caspian_vault.dim_survey_type)
[0m00:00:05.941138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now model.caspian_vault.dim_source_format)
[0m00:00:05.941549 [info ] [Thread-4 (]: 27 of 33 START sql table model public.dim_time ................................. [RUN]
[0m00:00:05.941904 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:00:05.942236 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m00:00:05.942558 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_source_format
[0m00:00:05.942888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_time)
[0m00:00:05.945052 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m00:00:05.945455 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:05.947393 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m00:00:05.947750 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_time
[0m00:00:05.948936 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m00:00:05.951116 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m00:00:05.951489 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m00:00:05.951860 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_source_format
[0m00:00:05.954701 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m00:00:05.955025 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m00:00:05.957564 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m00:00:05.958010 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_time
[0m00:00:05.958621 [info ] [Thread-1 (]: 24 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m00:00:05.961322 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m00:00:05.961728 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m00:00:05.962215 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m00:00:05.962589 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m00:00:05.963022 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m00:00:05.963419 [debug] [Thread-1 (]: Began running node model.caspian_vault.fct_readings
[0m00:00:05.963741 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m00:00:05.964193 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m00:00:05.964516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:05.964916 [info ] [Thread-1 (]: 28 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m00:00:05.965284 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: BEGIN
[0m00:00:05.965600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:05.966040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now model.caspian_vault.fct_readings)
[0m00:00:05.966359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:05.966825 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.fct_readings
[0m00:00:05.969218 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m00:00:05.969727 [debug] [Thread-1 (]: Began executing node model.caspian_vault.fct_readings
[0m00:00:05.970067 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:05.972743 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m00:00:05.973164 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m00:00:05.973508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m00:00:05.973872 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m00:00:05.974314 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m00:00:05.974690 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m00:00:05.975035 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m00:00:05.975380 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m00:00:05.975775 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m00:00:05.976113 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: BEGIN
[0m00:00:05.976464 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m00:00:05.976837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:05.979406 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:00:05.982739 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m00:00:05.983139 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m00:00:05.983476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m00:00:05.983879 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m00:00:05.984207 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m00:00:05.984561 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:05.986631 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m00:00:05.986953 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m00:00:05.987308 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m00:00:05.989664 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m00:00:05.990061 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m00:00:05.990431 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.990767 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.991751 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m00:00:05.992086 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.015 seconds
[0m00:00:05.994121 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m00:00:05.994484 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m00:00:05.996782 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m00:00:05.997135 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m00:00:05.997478 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m00:00:05.997809 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m00:00:05.998348 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.998666 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:05.999678 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m00:00:06.001754 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m00:00:06.002121 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m00:00:06.002440 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.018 seconds
[0m00:00:06.002784 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m00:00:06.003105 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m00:00:06.005478 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m00:00:06.005808 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m00:00:06.006231 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m00:00:06.006598 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.008219 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m00:00:06.009321 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m00:00:06.009697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:06.010199 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m00:00:06.010522 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m00:00:06.010858 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m00:00:06.012876 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m00:00:06.013226 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m00:00:06.015774 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m00:00:06.016116 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m00:00:06.016465 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m00:00:06.016972 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m00:00:06.017400 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m00:00:06.017705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.018719 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m00:00:06.019028 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m00:00:06.019319 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m00:00:06.019647 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:00:06.020641 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m00:00:06.021145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a81761b0>]}
[0m00:00:06.021503 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m00:00:06.022352 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:00:06.023981 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m00:00:06.021989 [info ] [Thread-3 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.08s]
[0m00:00:06.025120 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: Close
[0m00:00:06.025453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:00:06.025940 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m00:00:06.026411 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m00:00:06.028097 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m00:00:06.028501 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682aa368c20>]}
[0m00:00:06.028858 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m00:00:06.029221 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_well
[0m00:00:06.029742 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m00:00:06.030232 [info ] [Thread-4 (]: 27 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.09s]
[0m00:00:06.030738 [info ] [Thread-3 (]: 29 of 33 START sql table model public.dim_well ................................. [RUN]
[0m00:00:06.031096 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m00:00:06.031556 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_time
[0m00:00:06.031890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.dim_well)
[0m00:00:06.032455 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_well
[0m00:00:06.034626 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m00:00:06.034964 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:00:06.036044 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: Close
[0m00:00:06.036414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:00:06.036880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a813c170>]}
[0m00:00:06.037970 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: Close
[0m00:00:06.038310 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_well
[0m00:00:06.038809 [info ] [Thread-2 (]: 26 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.10s]
[0m00:00:06.041546 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m00:00:06.041947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a8183f80>]}
[0m00:00:06.042428 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_source_format
[0m00:00:06.042980 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.08s]
[0m00:00:06.043594 [debug] [Thread-1 (]: Finished running node model.caspian_vault.fct_readings
[0m00:00:06.044152 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m00:00:06.044530 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m00:00:06.044885 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: BEGIN
[0m00:00:06.045192 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_survey_summary
[0m00:00:06.045514 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_well_performance
[0m00:00:06.045914 [info ] [Thread-4 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m00:00:06.046287 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:06.046666 [info ] [Thread-2 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m00:00:06.047075 [info ] [Thread-1 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m00:00:06.047466 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_sensor_analysis)
[0m00:00:06.047925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_survey_summary)
[0m00:00:06.048291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now model.caspian_vault.mart_well_performance)
[0m00:00:06.048658 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m00:00:06.049018 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m00:00:06.049353 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m00:00:06.051454 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.053584 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m00:00:06.053974 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m00:00:06.055925 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m00:00:06.056530 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m00:00:06.056880 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m00:00:06.057237 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m00:00:06.057664 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m00:00:06.060357 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.060681 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_well_performance
[0m00:00:06.064239 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m00:00:06.067001 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m00:00:06.067532 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.067997 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m00:00:06.068344 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:06.068679 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m00:00:06.069051 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.004 seconds
[0m00:00:06.069510 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m00:00:06.069836 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m00:00:06.072230 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m00:00:06.072601 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m00:00:06.072959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:06.073294 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:06.073643 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m00:00:06.073969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:06.074414 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.074927 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m00:00:06.075255 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.077362 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m00:00:06.077736 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m00:00:06.078054 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:00:06.078504 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m00:00:06.078837 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.079150 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m00:00:06.079495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:06.080528 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m00:00:06.080930 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m00:00:06.081280 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m00:00:06.081646 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m00:00:06.081997 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m00:00:06.084918 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.009 seconds
[0m00:00:06.087392 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.087708 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m00:00:06.088042 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m00:00:06.089664 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m00:00:06.090179 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m00:00:06.090524 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:06.090824 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m00:00:06.092844 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.093239 [debug] [Thread-1 (]: SQL status: SELECT 21 in 0.011 seconds
[0m00:00:06.093567 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.013 seconds
[0m00:00:06.093907 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m00:00:06.096225 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m00:00:06.098595 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m00:00:06.098981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m00:00:06.099339 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.099653 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m00:00:06.100000 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m00:00:06.101022 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: Close
[0m00:00:06.102009 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m00:00:06.102510 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.102865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.103308 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a8150050>]}
[0m00:00:06.103621 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m00:00:06.103924 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:06.106889 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m00:00:06.107432 [info ] [Thread-3 (]: 29 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.07s]
[0m00:00:06.109512 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m00:00:06.109840 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m00:00:06.110171 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m00:00:06.110645 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_well
[0m00:00:06.110973 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m00:00:06.112636 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m00:00:06.113150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:06.113645 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m00:00:06.114642 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m00:00:06.114946 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:06.115293 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m00:00:06.115631 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m00:00:06.116596 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m00:00:06.116973 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m00:00:06.117313 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m00:00:06.117678 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m00:00:06.119093 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:00:06.120079 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m00:00:06.120391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:00:06.120750 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m00:00:06.122417 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m00:00:06.122813 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a82522d0>]}
[0m00:00:06.124497 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m00:00:06.124972 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m00:00:06.125470 [info ] [Thread-4 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.08s]
[0m00:00:06.125965 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m00:00:06.126310 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m00:00:06.126749 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m00:00:06.127070 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m00:00:06.129451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:00:06.130474 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: Close
[0m00:00:06.130774 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:00:06.131798 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: Close
[0m00:00:06.132170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76829370a990>]}
[0m00:00:06.132646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76829371bd70>]}
[0m00:00:06.133099 [info ] [Thread-1 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.08s]
[0m00:00:06.133630 [info ] [Thread-2 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.08s]
[0m00:00:06.134100 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_well_performance
[0m00:00:06.134540 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m00:00:06.135054 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:06.135602 [info ] [Thread-3 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m00:00:06.135992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now snapshot.caspian_vault.snap_mart_well_performance)
[0m00:00:06.136326 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:06.138753 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:06.173665 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.174057 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m00:00:06.174371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:06.178501 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m00:00:06.178851 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.179156 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:00:06.184331 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m00:00:06.215340 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.215786 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp000006214634"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m00:00:06.218092 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.002 seconds
[0m00:00:06.221749 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.222096 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp000006214634'
        
      order by ordinal_position

  
[0m00:00:06.224479 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m00:00:06.226746 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.227078 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:00:06.228953 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.002 seconds
[0m00:00:06.231163 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.231511 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp000006214634'
        
      order by ordinal_position

  
[0m00:00:06.233308 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m00:00:06.235502 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.235841 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:00:06.237610 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m00:00:06.242399 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.242746 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp000006214634'
        
      order by ordinal_position

  
[0m00:00:06.244541 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m00:00:06.257523 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.257941 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m00:00:06.258604 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m00:00:06.262477 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.262820 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m00:00:06.263306 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m00:00:06.263726 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.264211 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.264579 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp000006214634" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp000006214634" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m00:00:06.265446 [debug] [Thread-3 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m00:00:06.266428 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m00:00:06.266740 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:06.267017 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m00:00:06.269666 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m00:00:06.271685 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m00:00:06.272218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680489bc-2c16-4e9d-a167-02a94b191b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a81e44a0>]}
[0m00:00:06.272884 [info ] [Thread-3 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m00:00:06.273382 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:06.274806 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.275146 [debug] [MainThread]: On master: BEGIN
[0m00:00:06.275467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:06.279448 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:06.279771 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.280055 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.280339 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.280688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:06.280972 [debug] [MainThread]: On master: Close
[0m00:00:06.281360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:06.281630 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m00:00:06.281880 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m00:00:06.282115 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m00:00:06.282362 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m00:00:06.282707 [info ] [MainThread]: 
[0m00:00:06.283016 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m00:00:06.286593 [debug] [MainThread]: Command end result
[0m00:00:06.312285 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m00:00:06.313823 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m00:00:06.319771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m00:00:06.320125 [info ] [MainThread]: 
[0m00:00:06.320491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:06.320809 [info ] [MainThread]: 
[0m00:00:06.321114 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m00:00:06.321667 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:00:06.322552 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7670205, "process_in_blocks": "0", "process_kernel_time": 0.322354, "process_mem_max_rss": "135376", "process_out_blocks": "3624", "process_user_time": 2.650917}
[0m00:00:06.323022 [debug] [MainThread]: Command `dbt build` succeeded at 00:00:06.322942 after 1.77 seconds
[0m00:00:06.323377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ae848770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682a822abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7682ae11e600>]}
[0m00:00:06.323713 [debug] [MainThread]: Flushing usage events
[0m00:00:06.823820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:08.369561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b289f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b28c572c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b28647ce0>]}


============================== 00:00:08.374425 | 402dd02d-5fbc-424c-88a9-c6cf52e585cf ==============================
[0m00:00:08.374425 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:00:08.374865 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'target_path': '/opt/airflow/dbt_target', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'log_path': '/opt/airflow/logs/dbt', 'fail_fast': 'False'}
[0m00:00:08.418816 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m00:00:08.419305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b27606ba0>]}
[0m00:00:08.419756 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m00:00:08.420088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b276bbf80>]}
[0m00:00:08.538064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b26d73d10>]}
[0m00:00:08.595636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b289f5be0>]}
[0m00:00:08.596444 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:00:08.708287 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m00:00:08.832935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:08.833371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:08.838475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m00:00:08.888936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b2690a5d0>]}
[0m00:00:08.986365 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m00:00:08.987990 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m00:00:09.005823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b25952c30>]}
[0m00:00:09.006299 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m00:00:09.006633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b28865970>]}
[0m00:00:09.008575 [info ] [MainThread]: 
[0m00:00:09.008935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:09.009217 [info ] [MainThread]: 
[0m00:00:09.009705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:09.010547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:00:09.042919 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:00:09.043286 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:00:09.043568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:09.048881 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m00:00:09.049911 [debug] [ThreadPool]: On list_airflow: Close
[0m00:00:09.054093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m00:00:09.058416 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:00:09.058819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_snapshots'
[0m00:00:09.059182 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:00:09.061307 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m00:00:09.061615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:09.061906 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m00:00:09.062367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:09.065762 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:09.066102 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:00:09.066380 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:09.066695 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:00:09.066997 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m00:00:09.067346 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:00:09.069282 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m00:00:09.069555 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m00:00:09.071094 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:00:09.072065 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m00:00:09.072474 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:00:09.072762 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m00:00:09.082199 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:09.082549 [debug] [MainThread]: On master: BEGIN
[0m00:00:09.082813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:09.086517 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:09.086833 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:09.087165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:09.109437 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m00:00:09.110640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b261362a0>]}
[0m00:00:09.111074 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:09.111497 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:09.111796 [debug] [MainThread]: On master: BEGIN
[0m00:00:09.112214 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:09.112531 [debug] [MainThread]: On master: COMMIT
[0m00:00:09.112793 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:09.113041 [debug] [MainThread]: On master: COMMIT
[0m00:00:09.113385 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:09.113664 [debug] [MainThread]: On master: Close
[0m00:00:09.117134 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:09.117604 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m00:00:09.117975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now snapshot.caspian_vault.snap_mart_well_performance)
[0m00:00:09.118292 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:09.123790 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:09.161495 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.161909 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m00:00:09.162199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:09.166510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:00:09.166861 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.167167 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:00:09.172472 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m00:00:09.210917 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.211396 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp000009205503"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m00:00:09.213830 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m00:00:09.216868 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.217212 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp000009205503'
        
      order by ordinal_position

  
[0m00:00:09.219651 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m00:00:09.221881 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.222222 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:00:09.224071 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m00:00:09.226235 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.226590 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp000009205503'
        
      order by ordinal_position

  
[0m00:00:09.228395 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m00:00:09.230647 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.230981 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:00:09.232732 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m00:00:09.237400 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.237742 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp000009205503'
        
      order by ordinal_position

  
[0m00:00:09.239529 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m00:00:09.252389 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.252810 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m00:00:09.253493 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m00:00:09.257313 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.257653 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m00:00:09.258160 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m00:00:09.258611 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.259119 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.259489 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp000009205503" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp000009205503" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m00:00:09.260364 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m00:00:09.270735 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m00:00:09.271091 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m00:00:09.271408 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m00:00:09.275174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:00:09.277957 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m00:00:09.279308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '402dd02d-5fbc-424c-88a9-c6cf52e585cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b2a1bb1a0>]}
[0m00:00:09.279959 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m00:00:09.280474 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m00:00:09.281755 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:09.282077 [debug] [MainThread]: On master: BEGIN
[0m00:00:09.282369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:09.286336 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:09.286662 [debug] [MainThread]: On master: COMMIT
[0m00:00:09.286941 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:09.287197 [debug] [MainThread]: On master: COMMIT
[0m00:00:09.287555 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:09.287832 [debug] [MainThread]: On master: Close
[0m00:00:09.288204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:09.288497 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m00:00:09.288739 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m00:00:09.289013 [info ] [MainThread]: 
[0m00:00:09.289320 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:00:09.289871 [debug] [MainThread]: Command end result
[0m00:00:09.368411 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m00:00:09.370005 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m00:00:09.374897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m00:00:09.375227 [info ] [MainThread]: 
[0m00:00:09.375618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:09.375910 [info ] [MainThread]: 
[0m00:00:09.376209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:00:09.376717 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:00:09.377581 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0500661, "process_in_blocks": "0", "process_kernel_time": 0.305769, "process_mem_max_rss": "128968", "process_out_blocks": "2760", "process_user_time": 1.984504}
[0m00:00:09.378046 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:00:09.377964 after 1.05 seconds
[0m00:00:09.378403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b282d6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b2932fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748b247d2c00>]}
[0m00:00:09.378738 [debug] [MainThread]: Flushing usage events
[0m00:00:09.802336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:02.035205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d1a16a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d05384a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d102bbf0>]}


============================== 01:00:02.040182 | 66838a71-df7f-43ff-9fd0-559cb74e896d ==============================
[0m01:00:02.040182 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:00:02.040646 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/opt/airflow/logs/dbt'}
[0m01:00:02.046869 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m01:00:02.047241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66838a71-df7f-43ff-9fd0-559cb74e896d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d02c9be0>]}
[0m01:00:02.047642 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m01:00:02.047945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66838a71-df7f-43ff-9fd0-559cb74e896d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d02c9be0>]}
[0m01:00:02.149593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66838a71-df7f-43ff-9fd0-559cb74e896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d05d7d10>]}
[0m01:00:02.168760 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vmiu4tf0'
[0m01:00:02.169112 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:00:02.313851 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:00:02.314530 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:00:02.345731 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:00:02.348993 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:00:02.614818 [info ] [MainThread]: Installed from version 1.3.0
[0m01:00:02.615263 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:00:02.615592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '66838a71-df7f-43ff-9fd0-559cb74e896d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d00ae480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d00ae3f0>]}
[0m01:00:02.615926 [info ] [MainThread]: 
[0m01:00:02.616206 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:00:02.616873 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:00:02.617819 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6250965, "process_in_blocks": "0", "process_kernel_time": 0.220714, "process_mem_max_rss": "108236", "process_out_blocks": "2304", "process_user_time": 1.299321}
[0m01:00:02.618279 [debug] [MainThread]: Command `dbt deps` succeeded at 01:00:02.618175 after 0.63 seconds
[0m01:00:02.618591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d14a2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d0029bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d1112ab0>]}
[0m01:00:02.618871 [debug] [MainThread]: Flushing usage events
[0m01:00:03.211424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:04.709272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62c19c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62c096b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62c596c00>]}


============================== 01:00:04.714079 | 2eb25288-bdd0-4ec3-9135-2894fd9a9012 ==============================
[0m01:00:04.714079 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:00:04.714532 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'target_path': '/opt/airflow/dbt_target', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/logs/dbt'}
[0m01:00:04.758825 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m01:00:04.759301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62bde2f30>]}
[0m01:00:04.759761 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m01:00:04.760087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62a7ebf20>]}
[0m01:00:04.877856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62b58c260>]}
[0m01:00:04.935612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b629f3b3e0>]}
[0m01:00:04.936404 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:00:05.047346 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m01:00:05.171688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:05.172099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:05.177195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m01:00:05.227583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b629b96840>]}
[0m01:00:05.324613 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m01:00:05.326218 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m01:00:05.353997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b628733b30>]}
[0m01:00:05.354478 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m01:00:05.357922 [info ] [MainThread]: 
[0m01:00:05.358303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:05.358589 [info ] [MainThread]: 
[0m01:00:05.359044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:05.363033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:00:05.363576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:00:05.398791 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:00:05.399147 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:00:05.399499 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:00:05.399804 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:00:05.400100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:05.400394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:05.405672 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m01:00:05.405972 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m01:00:05.407049 [debug] [ThreadPool]: On list_airflow: Close
[0m01:00:05.407990 [debug] [ThreadPool]: On list_airflow: Close
[0m01:00:05.409832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m01:00:05.410321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m01:00:05.414539 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m01:00:05.415910 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:00:05.416228 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m01:00:05.416535 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:00:05.416815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:05.417093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:05.420759 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.421101 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m01:00:05.421387 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.421708 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:05.422016 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:00:05.422372 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:00:05.424270 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:05.424526 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m01:00:05.425567 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m01:00:05.427076 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:00:05.427512 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m01:00:05.427761 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:00:05.437099 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:05.437436 [debug] [MainThread]: On master: BEGIN
[0m01:00:05.437694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:05.441369 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.441689 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:05.442014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:05.464103 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m01:00:05.465356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62cfd6390>]}
[0m01:00:05.465786 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:05.466184 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:05.466505 [debug] [MainThread]: On master: BEGIN
[0m01:00:05.466934 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:05.467225 [debug] [MainThread]: On master: COMMIT
[0m01:00:05.467507 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:05.467755 [debug] [MainThread]: On master: COMMIT
[0m01:00:05.468084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:05.468380 [debug] [MainThread]: On master: Close
[0m01:00:05.471750 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m01:00:05.472202 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m01:00:05.472582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m01:00:05.472882 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m01:00:05.478713 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m01:00:05.479217 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m01:00:05.508228 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m01:00:05.508815 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m01:00:05.509142 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m01:00:05.509429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.513502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.513832 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m01:00:05.514169 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m01:00:05.541458 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.027 seconds
[0m01:00:05.548958 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m01:00:05.549322 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m01:00:05.549865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.551893 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m01:00:05.552209 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m01:00:05.552688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.564417 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m01:00:05.564771 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m01:00:05.565051 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m01:00:05.575832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m01:00:05.580466 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m01:00:05.584579 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m01:00:05.584909 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m01:00:05.589029 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:00:05.590894 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m01:00:05.592218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62d22ad20>]}
[0m01:00:05.592775 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.12s]
[0m01:00:05.593263 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m01:00:05.594114 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m01:00:05.594532 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m01:00:05.594912 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m01:00:05.595298 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m01:00:05.595769 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m01:00:05.596195 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m01:00:05.596550 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m01:00:05.596871 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m01:00:05.606866 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m01:00:05.610179 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m01:00:05.610796 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m01:00:05.611118 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m01:00:05.623860 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m01:00:05.625438 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m01:00:05.626044 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m01:00:05.626407 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m01:00:05.626735 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m01:00:05.627062 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m01:00:05.627388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:00:05.627693 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:00:05.631582 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.631954 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.632288 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m01:00:05.632615 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m01:00:05.632947 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m01:00:05.633292 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m01:00:05.635106 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.635424 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:05.638003 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m01:00:05.639082 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m01:00:05.639543 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m01:00:05.639858 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m01:00:05.640430 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m01:00:05.640813 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.05s]
[0m01:00:05.641413 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m01:00:05.641842 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m01:00:05.642704 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m01:00:05.643050 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m01:00:05.643402 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m01:00:05.643717 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m01:00:05.644099 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m01:00:05.644559 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m01:00:05.645000 [info ] [Thread-4 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m01:00:05.645444 [info ] [Thread-3 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m01:00:05.645820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m01:00:05.646169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m01:00:05.647807 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m01:00:05.648175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m01:00:05.648525 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m01:00:05.648850 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m01:00:05.649184 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m01:00:05.649519 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m01:00:05.701405 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.703769 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m01:00:05.706895 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.709206 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m01:00:05.710112 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m01:00:05.710612 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m01:00:05.713211 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.713603 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m01:00:05.713922 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m01:00:05.716484 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m01:00:05.719164 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.721832 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m01:00:05.722263 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.722954 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m01:00:05.723388 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.723701 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m01:00:05.724067 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m01:00:05.724404 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m01:00:05.724744 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m01:00:05.725058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:05.725364 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:05.725680 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m01:00:05.725988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.726523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:05.730536 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.730883 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.731307 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.731669 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.731987 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m01:00:05.732314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:05.732679 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m01:00:05.733021 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m01:00:05.733386 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m01:00:05.733735 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.734121 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m01:00:05.734526 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m01:00:05.752487 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.018 seconds
[0m01:00:05.752815 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.018 seconds
[0m01:00:05.756488 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.758749 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m01:00:05.759107 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m01:00:05.759468 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m01:00:05.760021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.760374 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:05.762341 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.762694 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.029 seconds
[0m01:00:05.764763 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m01:00:05.765126 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.031 seconds
[0m01:00:05.765471 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m01:00:05.767771 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.768117 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m01:00:05.770455 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m01:00:05.770858 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m01:00:05.771225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.771575 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.771879 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m01:00:05.773031 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m01:00:05.773398 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:05.774355 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m01:00:05.774750 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.775099 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.777120 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.777510 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m01:00:05.777858 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m01:00:05.779869 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m01:00:05.780221 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m01:00:05.780568 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m01:00:05.780940 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m01:00:05.781437 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.781762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:05.782727 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m01:00:05.783716 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m01:00:05.784063 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.784410 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m01:00:05.784728 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m01:00:05.785035 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m01:00:05.787351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:00:05.787683 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m01:00:05.789454 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m01:00:05.789823 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m01:00:05.790135 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m01:00:05.792742 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m01:00:05.793231 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m01:00:05.794820 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m01:00:05.796520 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m01:00:05.797003 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m01:00:05.797354 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m01:00:05.797811 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m01:00:05.798289 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m01:00:05.798623 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m01:00:05.799002 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m01:00:05.799348 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m01:00:05.801182 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:00:05.802212 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m01:00:05.802749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b627082120>]}
[0m01:00:05.803550 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:00:05.803272 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.16s]
[0m01:00:05.803976 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:00:05.804370 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:00:05.805371 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m01:00:05.805826 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m01:00:05.806820 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m01:00:05.807826 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m01:00:05.808337 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b628f05f70>]}
[0m01:00:05.809056 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b627071820>]}
[0m01:00:05.809512 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m01:00:05.810030 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.16s]
[0m01:00:05.810467 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b627073650>]}
[0m01:00:05.810980 [info ] [Thread-4 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.16s]
[0m01:00:05.811367 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m01:00:05.811835 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m01:00:05.812313 [info ] [Thread-3 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.16s]
[0m01:00:05.812809 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m01:00:05.813152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m01:00:05.813528 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m01:00:05.814073 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m01:00:05.814444 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m01:00:05.814817 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m01:00:05.815236 [info ] [Thread-2 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m01:00:05.815628 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m01:00:05.816010 [info ] [Thread-4 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m01:00:05.821062 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m01:00:05.821460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m01:00:05.821798 [info ] [Thread-3 (]: 11 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m01:00:05.822175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m01:00:05.822598 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m01:00:05.822953 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m01:00:05.823317 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m01:00:05.823632 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m01:00:05.826415 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m01:00:05.826767 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m01:00:05.828345 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m01:00:05.832646 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m01:00:05.835399 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m01:00:05.835895 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m01:00:05.836616 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m01:00:05.836932 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m01:00:05.838537 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m01:00:05.838892 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m01:00:05.839220 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m01:00:05.841836 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m01:00:05.843461 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m01:00:05.843895 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m01:00:05.844203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.844796 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m01:00:05.845173 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m01:00:05.845565 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m01:00:05.845970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:05.846342 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m01:00:05.846709 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m01:00:05.847152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:05.847499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:05.849734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:05.850061 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m01:00:05.850426 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.850745 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.851183 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m01:00:05.851540 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.851927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.852239 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.852624 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m01:00:05.852949 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.854160 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m01:00:05.854586 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:05.854932 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m01:00:05.855234 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.855687 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.855986 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m01:00:05.856317 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.857402 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m01:00:05.858583 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m01:00:05.859040 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.05s]
[0m01:00:05.859432 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:05.860011 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m01:00:05.860317 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m01:00:05.860633 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m01:00:05.861713 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m01:00:05.862096 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m01:00:05.862745 [info ] [Thread-2 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m01:00:05.863299 [info ] [Thread-4 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m01:00:05.863709 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m01:00:05.864054 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m01:00:05.864519 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m01:00:05.864976 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m01:00:05.865337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m01:00:05.865744 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m01:00:05.866143 [info ] [Thread-3 (]: 11 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m01:00:05.866606 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m01:00:05.867047 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m01:00:05.867390 [info ] [Thread-2 (]: 13 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m01:00:05.867867 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m01:00:05.868197 [info ] [Thread-4 (]: 14 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m01:00:05.871289 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m01:00:05.871671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m01:00:05.872052 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m01:00:05.872464 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m01:00:05.872873 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m01:00:05.873221 [info ] [Thread-3 (]: 15 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m01:00:05.873626 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m01:00:05.873961 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m01:00:05.876621 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m01:00:05.876997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m01:00:05.879657 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m01:00:05.881233 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m01:00:05.881686 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m01:00:05.882116 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m01:00:05.885016 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m01:00:05.885489 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m01:00:05.887019 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m01:00:05.887467 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m01:00:05.889087 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m01:00:05.889481 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m01:00:05.889882 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m01:00:05.890302 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m01:00:05.892926 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m01:00:05.893330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.893736 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m01:00:05.894095 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m01:00:05.894737 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m01:00:05.895094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:05.895482 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m01:00:05.895824 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m01:00:05.896267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:05.896578 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:05.898287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.898618 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m01:00:05.898921 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.899528 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:05.899862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.900237 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m01:00:05.901495 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m01:00:05.901823 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:05.902161 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:05.902544 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:05.902939 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m01:00:05.903239 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m01:00:05.903601 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m01:00:05.904023 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.904863 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.905215 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.904552 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m01:00:05.906513 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m01:00:05.906855 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.907323 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m01:00:05.907625 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:05.908741 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m01:00:05.909127 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m01:00:05.909418 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m01:00:05.910548 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m01:00:05.910948 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m01:00:05.911271 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m01:00:05.911764 [info ] [Thread-2 (]: 13 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m01:00:05.912162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m01:00:05.912518 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m01:00:05.912990 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m01:00:05.913391 [info ] [Thread-4 (]: 14 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m01:00:05.913750 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m01:00:05.914146 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m01:00:05.914568 [info ] [Thread-3 (]: 15 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m01:00:05.915109 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m01:00:05.918105 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m01:00:05.918499 [info ] [Thread-2 (]: 17 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m01:00:05.918970 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m01:00:05.919342 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m01:00:05.919792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m01:00:05.920190 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m01:00:05.920599 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m01:00:05.920916 [info ] [Thread-4 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m01:00:05.921278 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m01:00:05.921606 [info ] [Thread-3 (]: 19 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m01:00:05.923222 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m01:00:05.923603 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m01:00:05.929642 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m01:00:05.930014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m01:00:05.930437 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m01:00:05.930843 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m01:00:05.931235 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m01:00:05.931614 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m01:00:05.935441 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m01:00:05.935798 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m01:00:05.938402 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m01:00:05.940004 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m01:00:05.940446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.941018 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m01:00:05.941562 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m01:00:05.941963 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m01:00:05.943567 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m01:00:05.945120 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m01:00:05.945523 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m01:00:05.945854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.946429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:05.946767 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m01:00:05.947196 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m01:00:05.947536 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m01:00:05.947993 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m01:00:05.948339 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m01:00:05.948703 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.949067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:05.949414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:05.950219 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m01:00:05.951414 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m01:00:05.951869 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m01:00:05.952198 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:05.953038 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m01:00:05.952741 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m01:00:05.953614 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.954016 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.954372 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:05.954820 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m01:00:05.955219 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m01:00:05.955569 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m01:00:05.955927 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m01:00:05.956319 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.956669 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.957024 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:05.957373 [info ] [Thread-1 (]: 20 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m01:00:05.958475 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m01:00:05.958955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m01:00:05.959334 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m01:00:05.959624 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m01:00:05.959968 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.960300 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:05.964308 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m01:00:05.965478 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m01:00:05.965931 [info ] [Thread-2 (]: 17 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.05s]
[0m01:00:05.967041 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m01:00:05.967680 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m01:00:05.968087 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m01:00:05.968487 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m01:00:05.968839 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m01:00:05.969119 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m01:00:05.970780 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m01:00:05.971215 [info ] [Thread-4 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.05s]
[0m01:00:05.971605 [info ] [Thread-2 (]: 21 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m01:00:05.972234 [info ] [Thread-3 (]: 19 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m01:00:05.972815 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m01:00:05.973201 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m01:00:05.973538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m01:00:05.973990 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m01:00:05.974342 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m01:00:05.974680 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m01:00:05.975001 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m01:00:05.975356 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m01:00:05.975703 [info ] [Thread-4 (]: 22 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m01:00:05.976037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.978732 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m01:00:05.979101 [info ] [Thread-3 (]: 23 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m01:00:05.979488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m01:00:05.980024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m01:00:05.980414 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m01:00:05.980742 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m01:00:05.981066 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m01:00:05.982663 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m01:00:05.985438 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m01:00:05.989308 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m01:00:05.989670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:00:05.990284 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m01:00:05.990766 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m01:00:05.991157 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m01:00:05.991490 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m01:00:05.991797 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m01:00:05.992125 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m01:00:05.993724 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m01:00:05.995348 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m01:00:05.995686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:05.996346 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m01:00:05.996836 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m01:00:05.997161 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m01:00:05.997551 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m01:00:05.997854 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:05.998202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:05.998551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:05.999684 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m01:00:06.000255 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:06.000668 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m01:00:06.001007 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m01:00:06.001345 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m01:00:06.001896 [info ] [Thread-1 (]: 20 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m01:00:06.002371 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m01:00:06.002703 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m01:00:06.003063 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:00:06.003428 [info ] [Thread-1 (]: 24 of 33 START test test_counts_match .......................................... [RUN]
[0m01:00:06.004652 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m01:00:06.005017 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:06.005398 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m01:00:06.005753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m01:00:06.006163 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m01:00:06.006524 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m01:00:06.006834 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m01:00:06.007182 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m01:00:06.007560 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:06.007965 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m01:00:06.008404 [info ] [Thread-2 (]: 21 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.03s]
[0m01:00:06.010682 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m01:00:06.011287 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m01:00:06.011717 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_survey_type
[0m01:00:06.012494 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m01:00:06.012833 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:06.014443 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m01:00:06.014785 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:00:06.012217 [info ] [Thread-2 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m01:00:06.015962 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m01:00:06.017124 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m01:00:06.017531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now model.caspian_vault.dim_survey_type)
[0m01:00:06.017866 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m01:00:06.018313 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m01:00:06.018618 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m01:00:06.018908 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m01:00:06.019242 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m01:00:06.022651 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m01:00:06.023092 [info ] [Thread-4 (]: 22 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m01:00:06.023518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:06.023920 [info ] [Thread-3 (]: 23 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m01:00:06.024491 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m01:00:06.024877 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_survey_type
[0m01:00:06.025418 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m01:00:06.025805 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_well
[0m01:00:06.028581 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m01:00:06.029142 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_well ................................. [RUN]
[0m01:00:06.029514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:00:06.029967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now model.caspian_vault.dim_well)
[0m01:00:06.030340 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m01:00:06.030717 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m01:00:06.031028 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_well
[0m01:00:06.031389 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m01:00:06.031729 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m01:00:06.033798 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m01:00:06.034198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:06.034756 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_well
[0m01:00:06.037380 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m01:00:06.037719 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:00:06.038962 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m01:00:06.039336 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:06.039762 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m01:00:06.040104 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m01:00:06.040407 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m01:00:06.040744 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: BEGIN
[0m01:00:06.041072 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m01:00:06.041451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:06.041857 [info ] [Thread-1 (]: 24 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m01:00:06.042513 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m01:00:06.043041 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_source_format
[0m01:00:06.043372 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_time
[0m01:00:06.043884 [info ] [Thread-3 (]: 27 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m01:00:06.044327 [info ] [Thread-1 (]: 28 of 33 START sql table model public.dim_time ................................. [RUN]
[0m01:00:06.044703 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_source_format)
[0m01:00:06.045041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now model.caspian_vault.dim_time)
[0m01:00:06.045379 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_source_format
[0m01:00:06.045724 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_time
[0m01:00:06.046038 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:06.046406 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.004 seconds
[0m01:00:06.048450 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m01:00:06.050453 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m01:00:06.050808 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m01:00:06.053184 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m01:00:06.053749 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m01:00:06.054191 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_source_format
[0m01:00:06.054526 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_time
[0m01:00:06.054837 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m01:00:06.057516 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m01:00:06.060999 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m01:00:06.061354 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.006 seconds
[0m01:00:06.061915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.064201 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m01:00:06.066312 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m01:00:06.066770 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m01:00:06.067087 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m01:00:06.067443 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m01:00:06.067793 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m01:00:06.068117 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: BEGIN
[0m01:00:06.068510 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m01:00:06.068839 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.069204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:06.069545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.069833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:06.071890 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m01:00:06.073025 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m01:00:06.073496 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m01:00:06.073863 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m01:00:06.074279 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m01:00:06.074622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.075705 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m01:00:06.076075 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m01:00:06.076413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m01:00:06.076717 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m01:00:06.077062 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:06.077438 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m01:00:06.077763 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m01:00:06.079514 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m01:00:06.079872 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m01:00:06.080167 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:06.080520 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m01:00:06.081005 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m01:00:06.081351 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m01:00:06.082952 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m01:00:06.083352 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m01:00:06.083852 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m01:00:06.084217 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m01:00:06.086297 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:00:06.087335 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: Close
[0m01:00:06.087825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6270ae750>]}
[0m01:00:06.088630 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:00:06.088352 [info ] [Thread-2 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.07s]
[0m01:00:06.089730 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: Close
[0m01:00:06.090182 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_survey_type
[0m01:00:06.090504 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m01:00:06.090970 [debug] [Thread-2 (]: Began running node model.caspian_vault.fct_readings
[0m01:00:06.091391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b624622ab0>]}
[0m01:00:06.093829 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m01:00:06.094272 [info ] [Thread-2 (]: 29 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m01:00:06.094777 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.06s]
[0m01:00:06.095146 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m01:00:06.095508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.fct_readings)
[0m01:00:06.095943 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_well
[0m01:00:06.096326 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.fct_readings
[0m01:00:06.096631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.099091 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m01:00:06.099455 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.016 seconds
[0m01:00:06.101548 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m01:00:06.103882 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m01:00:06.104295 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m01:00:06.104609 [debug] [Thread-2 (]: Began executing node model.caspian_vault.fct_readings
[0m01:00:06.104957 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m01:00:06.108713 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m01:00:06.109095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m01:00:06.110192 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m01:00:06.110626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:06.110934 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m01:00:06.111272 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m01:00:06.113299 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m01:00:06.113634 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m01:00:06.113949 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: BEGIN
[0m01:00:06.114297 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m01:00:06.114674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:06.115147 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.116129 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m01:00:06.116453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:06.116788 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m01:00:06.118416 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m01:00:06.118787 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m01:00:06.119101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:06.119588 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m01:00:06.119979 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m01:00:06.120318 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m01:00:06.120651 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m01:00:06.121238 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:06.122838 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m01:00:06.123200 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:00:06.123665 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m01:00:06.124666 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: Close
[0m01:00:06.124994 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m01:00:06.125502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b627078f80>]}
[0m01:00:06.125978 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.08s]
[0m01:00:06.126437 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_time
[0m01:00:06.128662 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:00:06.129686 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: Close
[0m01:00:06.130118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6247e8680>]}
[0m01:00:06.130592 [info ] [Thread-3 (]: 27 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.09s]
[0m01:00:06.131029 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_source_format
[0m01:00:06.136745 [debug] [Thread-2 (]: SQL status: SELECT 9980 in 0.016 seconds
[0m01:00:06.139181 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m01:00:06.139523 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m01:00:06.140025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.141981 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m01:00:06.142317 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m01:00:06.142774 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.143726 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: COMMIT
[0m01:00:06.144038 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m01:00:06.144337 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: COMMIT
[0m01:00:06.155067 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m01:00:06.156803 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m01:00:06.157242 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m01:00:06.157552 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m01:00:06.161840 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:00:06.162852 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: Close
[0m01:00:06.163333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b627079130>]}
[0m01:00:06.163808 [info ] [Thread-2 (]: 29 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.07s]
[0m01:00:06.164265 [debug] [Thread-2 (]: Finished running node model.caspian_vault.fct_readings
[0m01:00:06.164812 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m01:00:06.165228 [info ] [Thread-4 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m01:00:06.165651 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.mart_sensor_analysis)
[0m01:00:06.166058 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m01:00:06.166446 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_well_performance
[0m01:00:06.166812 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m01:00:06.167258 [info ] [Thread-1 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m01:00:06.167680 [info ] [Thread-3 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m01:00:06.169938 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.170326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m01:00:06.170734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m01:00:06.171132 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m01:00:06.171512 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m01:00:06.171814 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m01:00:06.173819 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m01:00:06.177023 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m01:00:06.179611 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.180227 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m01:00:06.182853 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m01:00:06.183340 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_well_performance
[0m01:00:06.183732 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.186288 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m01:00:06.186660 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m01:00:06.186987 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m01:00:06.187434 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:06.187799 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m01:00:06.188107 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m01:00:06.188549 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m01:00:06.188875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:06.189196 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:06.192232 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m01:00:06.192573 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.192954 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m01:00:06.193285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:06.193688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:06.194035 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m01:00:06.194386 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m01:00:06.194722 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m01:00:06.195058 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m01:00:06.200684 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.007 seconds
[0m01:00:06.203119 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.203460 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m01:00:06.203769 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.008 seconds
[0m01:00:06.206065 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m01:00:06.206426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:06.206735 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m01:00:06.208738 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.209063 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m01:00:06.209457 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m01:00:06.211779 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m01:00:06.212112 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:00:06.212522 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m01:00:06.212867 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.214838 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m01:00:06.215899 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m01:00:06.216220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:06.216568 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m01:00:06.216907 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.219788 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m01:00:06.220182 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m01:00:06.220531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.220840 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m01:00:06.221885 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m01:00:06.222285 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m01:00:06.222615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:06.222909 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m01:00:06.223976 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m01:00:06.224303 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m01:00:06.224685 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m01:00:06.226301 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m01:00:06.226646 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m01:00:06.226934 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:06.227406 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m01:00:06.229023 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m01:00:06.229350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:06.229671 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m01:00:06.230124 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m01:00:06.231715 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m01:00:06.232114 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m01:00:06.232635 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m01:00:06.233014 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m01:00:06.233978 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:00:06.234976 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m01:00:06.235481 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6246d65a0>]}
[0m01:00:06.236268 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:00:06.235983 [info ] [Thread-4 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.07s]
[0m01:00:06.236730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:00:06.237723 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: Close
[0m01:00:06.238165 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m01:00:06.239162 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m01:00:06.239673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6287e3410>]}
[0m01:00:06.240208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6270709b0>]}
[0m01:00:06.240694 [info ] [Thread-3 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.07s]
[0m01:00:06.241216 [info ] [Thread-1 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.07s]
[0m01:00:06.241710 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_well_performance
[0m01:00:06.242139 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m01:00:06.242675 [debug] [Thread-2 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:06.243161 [info ] [Thread-2 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m01:00:06.243530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m01:00:06.243831 [debug] [Thread-2 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:06.246236 [debug] [Thread-2 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:06.281393 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.281781 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m01:00:06.282081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:06.286311 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:06.286661 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.286966 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:06.292195 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.005 seconds
[0m01:00:06.322726 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.323178 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp010006322021"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m01:00:06.325654 [debug] [Thread-2 (]: SQL status: SELECT 42 in 0.002 seconds
[0m01:00:06.328918 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.329279 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp010006322021'
        
      order by ordinal_position

  
[0m01:00:06.331669 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m01:00:06.333857 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.334188 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:06.336010 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.001 seconds
[0m01:00:06.338181 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.338529 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp010006322021'
        
      order by ordinal_position

  
[0m01:00:06.340326 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.001 seconds
[0m01:00:06.342481 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.342813 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:06.344556 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.001 seconds
[0m01:00:06.349314 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.349658 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp010006322021'
        
      order by ordinal_position

  
[0m01:00:06.351534 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.002 seconds
[0m01:00:06.364326 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.364740 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m01:00:06.365422 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m01:00:06.369222 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.369582 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m01:00:06.370082 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.000 seconds
[0m01:00:06.370520 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.371014 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.371362 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp010006322021" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp010006322021" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m01:00:06.372260 [debug] [Thread-2 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m01:00:06.373208 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m01:00:06.373539 [debug] [Thread-2 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:06.373812 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m01:00:06.375991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:06.377952 [debug] [Thread-2 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m01:00:06.378496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb25288-bdd0-4ec3-9135-2894fd9a9012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b624718770>]}
[0m01:00:06.379151 [info ] [Thread-2 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.13s]
[0m01:00:06.379641 [debug] [Thread-2 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:06.380914 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:06.381236 [debug] [MainThread]: On master: BEGIN
[0m01:00:06.381534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:06.385226 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:00:06.385572 [debug] [MainThread]: On master: COMMIT
[0m01:00:06.385858 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:06.386120 [debug] [MainThread]: On master: COMMIT
[0m01:00:06.386476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:06.386761 [debug] [MainThread]: On master: Close
[0m01:00:06.387136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:06.387437 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m01:00:06.387682 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m01:00:06.387912 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m01:00:06.388135 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m01:00:06.388499 [info ] [MainThread]: 
[0m01:00:06.388801 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m01:00:06.392384 [debug] [MainThread]: Command end result
[0m01:00:06.418087 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m01:00:06.419593 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m01:00:06.425528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m01:00:06.425865 [info ] [MainThread]: 
[0m01:00:06.426204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:06.426528 [info ] [MainThread]: 
[0m01:00:06.426825 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m01:00:06.427367 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:00:06.428230 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7611624, "process_in_blocks": "0", "process_kernel_time": 0.346405, "process_mem_max_rss": "135524", "process_out_blocks": "3624", "process_user_time": 2.618065}
[0m01:00:06.428717 [debug] [MainThread]: Command `dbt build` succeeded at 01:00:06.428637 after 1.76 seconds
[0m01:00:06.429041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62a914b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62b5282f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b62b5282c0>]}
[0m01:00:06.429395 [debug] [MainThread]: Flushing usage events
[0m01:00:06.956160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:08.504261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0b215bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0b215a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0a76fb00>]}


============================== 01:00:08.509094 | 9be60f9a-60b8-491a-808b-8206935d596f ==============================
[0m01:00:08.509094 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:00:08.509553 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'warn_error': 'None', 'log_path': '/opt/airflow/logs/dbt', 'printer_width': '80', 'quiet': 'False', 'target_path': '/opt/airflow/dbt_target', 'log_format': 'default', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True'}
[0m01:00:08.553657 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m01:00:08.554121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0a465c40>]}
[0m01:00:08.554582 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m01:00:08.554913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0a465c40>]}
[0m01:00:08.673619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0cf9f1d0>]}
[0m01:00:08.731724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0a33f170>]}
[0m01:00:08.732570 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:00:08.844309 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m01:00:08.970058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:08.970506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:08.975657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m01:00:09.026191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e09740980>]}
[0m01:00:09.122764 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m01:00:09.124402 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m01:00:09.142183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e093f83e0>]}
[0m01:00:09.142648 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m01:00:09.142977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e09740620>]}
[0m01:00:09.144885 [info ] [MainThread]: 
[0m01:00:09.145271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:09.145569 [info ] [MainThread]: 
[0m01:00:09.146029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:09.146898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:00:09.179371 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:00:09.179724 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:00:09.179999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:09.185347 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m01:00:09.186371 [debug] [ThreadPool]: On list_airflow: Close
[0m01:00:09.190566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m01:00:09.191103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m01:00:09.195342 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m01:00:09.197449 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:00:09.197768 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m01:00:09.198061 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:00:09.198419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:09.198694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:09.202492 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:00:09.202791 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:00:09.203110 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m01:00:09.203415 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:00:09.203721 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:09.204033 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:00:09.206381 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m01:00:09.206645 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:00:09.208214 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:00:09.209151 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m01:00:09.209550 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:00:09.209830 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m01:00:09.219206 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:09.219549 [debug] [MainThread]: On master: BEGIN
[0m01:00:09.219814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:09.223448 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:00:09.223774 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:09.224097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:09.246089 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m01:00:09.247275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0a61b4d0>]}
[0m01:00:09.247712 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:09.248126 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:09.248434 [debug] [MainThread]: On master: BEGIN
[0m01:00:09.248858 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:09.249161 [debug] [MainThread]: On master: COMMIT
[0m01:00:09.249452 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:09.249700 [debug] [MainThread]: On master: COMMIT
[0m01:00:09.250030 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:09.250331 [debug] [MainThread]: On master: Close
[0m01:00:09.253704 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:09.254147 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m01:00:09.254524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now snapshot.caspian_vault.snap_mart_well_performance)
[0m01:00:09.254830 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:09.260268 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:09.297930 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.298343 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m01:00:09.298635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:09.302720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:00:09.303062 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.303381 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:09.308661 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m01:00:09.347358 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.347822 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp010009341923"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m01:00:09.350334 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m01:00:09.353270 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.353616 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp010009341923'
        
      order by ordinal_position

  
[0m01:00:09.356028 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m01:00:09.358242 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.358603 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:09.360469 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m01:00:09.362628 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.362961 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp010009341923'
        
      order by ordinal_position

  
[0m01:00:09.364840 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m01:00:09.367057 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.367406 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:09.369230 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m01:00:09.373903 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.374242 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp010009341923'
        
      order by ordinal_position

  
[0m01:00:09.376126 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m01:00:09.389114 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.389549 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m01:00:09.390267 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m01:00:09.394099 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.394452 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m01:00:09.394961 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m01:00:09.395404 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.395911 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.396283 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp010009341923" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp010009341923" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m01:00:09.397209 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m01:00:09.407751 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m01:00:09.408113 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m01:00:09.408429 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m01:00:09.410499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:09.413277 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m01:00:09.414630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9be60f9a-60b8-491a-808b-8206935d596f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0cd9ec60>]}
[0m01:00:09.415306 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m01:00:09.415804 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m01:00:09.417095 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:09.417441 [debug] [MainThread]: On master: BEGIN
[0m01:00:09.417723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:09.421922 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:00:09.422274 [debug] [MainThread]: On master: COMMIT
[0m01:00:09.422564 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:09.422823 [debug] [MainThread]: On master: COMMIT
[0m01:00:09.423156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:09.423451 [debug] [MainThread]: On master: Close
[0m01:00:09.423824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:09.424093 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m01:00:09.424353 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m01:00:09.424619 [info ] [MainThread]: 
[0m01:00:09.424909 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m01:00:09.425486 [debug] [MainThread]: Command end result
[0m01:00:09.503053 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m01:00:09.504659 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m01:00:09.509595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m01:00:09.509934 [info ] [MainThread]: 
[0m01:00:09.510320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:09.510607 [info ] [MainThread]: 
[0m01:00:09.510920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:00:09.511426 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:00:09.512288 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0502764, "process_in_blocks": "0", "process_kernel_time": 0.304599, "process_mem_max_rss": "128464", "process_out_blocks": "2760", "process_user_time": 1.985392}
[0m01:00:09.512749 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:00:09.512667 after 1.05 seconds
[0m01:00:09.513088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e0b0575f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e06d96ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727e06d96f00>]}
[0m01:00:09.513451 [debug] [MainThread]: Flushing usage events
[0m01:00:09.916143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:02.500283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a6609e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a67e603b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a65e872f0>]}


============================== 02:00:02.505110 | 6c72e469-11ed-45ab-a84e-ff85778b5ca8 ==============================
[0m02:00:02.505110 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:00:02.505567 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'empty': 'None', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/opt/airflow/logs/dbt', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:00:02.511705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m02:00:02.512078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c72e469-11ed-45ab-a84e-ff85778b5ca8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a6609f9e0>]}
[0m02:00:02.512475 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m02:00:02.512777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c72e469-11ed-45ab-a84e-ff85778b5ca8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a6609f9e0>]}
[0m02:00:02.614119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c72e469-11ed-45ab-a84e-ff85778b5ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a653ec320>]}
[0m02:00:02.633193 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sx2v7td8'
[0m02:00:02.633576 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:00:02.771601 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:00:02.772299 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:00:02.802647 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:00:02.805826 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:00:03.040978 [info ] [MainThread]: Installed from version 1.3.0
[0m02:00:03.041426 [info ] [MainThread]: Updated version available: 1.3.3
[0m02:00:03.041754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c72e469-11ed-45ab-a84e-ff85778b5ca8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a65463a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a6502cfb0>]}
[0m02:00:03.042099 [info ] [MainThread]: 
[0m02:00:03.042411 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:00:03.043066 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:00:03.043921 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5860227, "process_in_blocks": "0", "process_kernel_time": 0.206408, "process_mem_max_rss": "107896", "process_out_blocks": "2304", "process_user_time": 1.305262}
[0m02:00:03.044375 [debug] [MainThread]: Command `dbt deps` succeeded at 02:00:03.044294 after 0.59 seconds
[0m02:00:03.044683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a651fe540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a65139af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775a66051cd0>]}
[0m02:00:03.044972 [debug] [MainThread]: Flushing usage events
[0m02:00:03.555487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:05.043507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5cb52030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5cb52a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5cb29190>]}


============================== 02:00:05.048424 | 0aa80d5d-3df6-424f-8931-3da98d3506b6 ==============================
[0m02:00:05.048424 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:00:05.048865 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'log_path': '/opt/airflow/logs/dbt', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'target_path': '/opt/airflow/dbt_target', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m02:00:05.093043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m02:00:05.093540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5b5a58e0>]}
[0m02:00:05.093982 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m02:00:05.094325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5b5a72f0>]}
[0m02:00:05.212770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5b5a5b80>]}
[0m02:00:05.270709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5c9b8110>]}
[0m02:00:05.271544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:00:05.384640 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m02:00:05.510043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:05.510491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:05.515635 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m02:00:05.566259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5a96e420>]}
[0m02:00:05.663415 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m02:00:05.665052 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m02:00:05.692841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c59d18050>]}
[0m02:00:05.693323 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m02:00:05.696761 [info ] [MainThread]: 
[0m02:00:05.697121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:05.697428 [info ] [MainThread]: 
[0m02:00:05.697890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:05.701917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:00:05.708776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:00:05.737191 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:00:05.737552 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:00:05.737894 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:00:05.738197 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:00:05.738513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:05.738793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:05.744193 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m02:00:05.744511 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m02:00:05.745564 [debug] [ThreadPool]: On list_airflow: Close
[0m02:00:05.746511 [debug] [ThreadPool]: On list_airflow: Close
[0m02:00:05.748346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m02:00:05.748815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m02:00:05.752970 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m02:00:05.754333 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m02:00:05.754646 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m02:00:05.754933 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m02:00:05.755203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:05.755492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:05.759233 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:00:05.759539 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:00:05.759842 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m02:00:05.760127 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m02:00:05.760434 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m02:00:05.760737 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:00:05.763040 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:05.763306 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m02:00:05.764270 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m02:00:05.765867 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m02:00:05.766265 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m02:00:05.766543 [debug] [ThreadPool]: On list_airflow_public: Close
[0m02:00:05.775955 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:05.776302 [debug] [MainThread]: On master: BEGIN
[0m02:00:05.776583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:05.780192 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:00:05.780533 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:05.780872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:05.803140 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m02:00:05.804319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c595c7980>]}
[0m02:00:05.804755 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:05.805160 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:05.805467 [debug] [MainThread]: On master: BEGIN
[0m02:00:05.805884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:00:05.806176 [debug] [MainThread]: On master: COMMIT
[0m02:00:05.806462 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:05.806711 [debug] [MainThread]: On master: COMMIT
[0m02:00:05.807041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:00:05.807339 [debug] [MainThread]: On master: Close
[0m02:00:05.810878 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m02:00:05.811345 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m02:00:05.811718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m02:00:05.812019 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m02:00:05.817768 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m02:00:05.818301 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m02:00:05.847275 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m02:00:05.847864 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m02:00:05.848179 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m02:00:05.848483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:05.852617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:00:05.852946 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m02:00:05.853309 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m02:00:05.883724 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.030 seconds
[0m02:00:05.891156 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m02:00:05.891523 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m02:00:05.892086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:05.894201 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m02:00:05.894541 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m02:00:05.894997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:05.906609 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m02:00:05.906968 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m02:00:05.907262 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m02:00:05.940782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m02:00:05.945826 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m02:00:05.949927 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m02:00:05.950275 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m02:00:05.953480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:00:05.955375 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m02:00:05.956718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53db2b10>]}
[0m02:00:05.957270 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.14s]
[0m02:00:05.957751 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m02:00:05.958602 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m02:00:05.959004 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m02:00:05.959394 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m02:00:05.959789 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m02:00:05.960238 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m02:00:05.960666 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m02:00:05.961000 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m02:00:05.961343 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m02:00:05.971352 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m02:00:05.974684 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m02:00:05.975291 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m02:00:05.975613 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m02:00:05.988205 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m02:00:05.989840 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m02:00:05.990461 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m02:00:05.990874 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m02:00:05.991198 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m02:00:05.991546 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m02:00:05.991870 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:00:05.992174 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:00:05.996439 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:00:05.996793 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:05.997137 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m02:00:05.997478 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m02:00:05.997810 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m02:00:05.998151 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m02:00:06.000112 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:06.000436 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:06.003013 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m02:00:06.004092 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m02:00:06.004551 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m02:00:06.004892 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m02:00:06.005438 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m02:00:06.005896 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.05s]
[0m02:00:06.006390 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m02:00:06.006817 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m02:00:06.007664 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m02:00:06.008036 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m02:00:06.008420 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m02:00:06.008753 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m02:00:06.009163 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m02:00:06.009632 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m02:00:06.010056 [info ] [Thread-4 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m02:00:06.010488 [info ] [Thread-3 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m02:00:06.010866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m02:00:06.011224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m02:00:06.012871 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m02:00:06.013232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m02:00:06.013580 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m02:00:06.013902 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m02:00:06.014227 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m02:00:06.014557 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m02:00:06.066623 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.069014 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m02:00:06.072124 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.074516 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m02:00:06.075323 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m02:00:06.075653 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m02:00:06.078488 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m02:00:06.078847 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m02:00:06.079232 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m02:00:06.081851 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.084617 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.085046 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m02:00:06.087640 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m02:00:06.088321 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.088648 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m02:00:06.089013 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.089437 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m02:00:06.089791 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.090150 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m02:00:06.090492 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m02:00:06.090808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.091244 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m02:00:06.091580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.092028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.094518 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.094846 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m02:00:06.095196 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m02:00:06.095579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.095942 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:00:06.096365 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.096687 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.097038 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.097394 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m02:00:06.097736 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m02:00:06.099079 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m02:00:06.099522 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m02:00:06.115351 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.019 seconds
[0m02:00:06.118989 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m02:00:06.119330 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.020 seconds
[0m02:00:06.119686 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m02:00:06.121964 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.122368 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m02:00:06.122702 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.124732 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m02:00:06.125065 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m02:00:06.125374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:00:06.127508 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.127825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:00:06.128167 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m02:00:06.129188 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m02:00:06.129595 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m02:00:06.129896 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m02:00:06.130179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.131202 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m02:00:06.131564 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.032 seconds
[0m02:00:06.131874 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.134199 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.134555 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m02:00:06.134895 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.035 seconds
[0m02:00:06.135207 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m02:00:06.137598 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m02:00:06.138056 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m02:00:06.138384 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.140451 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.140789 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:00:06.141110 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m02:00:06.143145 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m02:00:06.143553 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m02:00:06.143880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.144891 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m02:00:06.145222 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.145528 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.145846 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m02:00:06.146818 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m02:00:06.147204 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m02:00:06.147509 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m02:00:06.175569 [debug] [Thread-2 (]: SQL status: COMMIT in 0.045 seconds
[0m02:00:06.177619 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m02:00:06.178092 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m02:00:06.178421 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m02:00:06.186072 [debug] [Thread-3 (]: SQL status: COMMIT in 0.038 seconds
[0m02:00:06.186519 [debug] [Thread-4 (]: SQL status: COMMIT in 0.039 seconds
[0m02:00:06.186866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m02:00:06.189820 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m02:00:06.190199 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.011 seconds
[0m02:00:06.191855 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m02:00:06.193614 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m02:00:06.194106 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m02:00:06.195302 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m02:00:06.195775 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m02:00:06.196293 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m02:00:06.196652 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m02:00:06.197037 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m02:00:06.197510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53d70d70>]}
[0m02:00:06.197875 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m02:00:06.198539 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.19s]
[0m02:00:06.199095 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m02:00:06.199686 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m02:00:06.199990 [info ] [Thread-2 (]: 8 of 33 START test not_null_dv_hub_well_hk_well ................................ [RUN]
[0m02:00:06.200338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m02:00:06.200632 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m02:00:06.205567 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m02:00:06.205922 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m02:00:06.206255 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m02:00:06.206653 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m02:00:06.207714 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m02:00:06.208747 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m02:00:06.209108 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m02:00:06.210090 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m02:00:06.210583 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5140fe90>]}
[0m02:00:06.210974 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53d8be90>]}
[0m02:00:06.212597 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m02:00:06.213150 [info ] [Thread-3 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.20s]
[0m02:00:06.213571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c595b3380>]}
[0m02:00:06.214053 [info ] [Thread-4 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.20s]
[0m02:00:06.214635 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m02:00:06.215136 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.20s]
[0m02:00:06.215532 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m02:00:06.215970 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m02:00:06.216327 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m02:00:06.216922 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m02:00:06.217272 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m02:00:06.217623 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m02:00:06.217967 [info ] [Thread-3 (]: 9 of 33 START test not_null_dv_hub_well_well_id_bk ............................. [RUN]
[0m02:00:06.218519 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m02:00:06.218973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.219317 [info ] [Thread-4 (]: 10 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m02:00:06.219687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m02:00:06.220035 [info ] [Thread-1 (]: 11 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m02:00:06.220533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m02:00:06.220859 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m02:00:06.221212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m02:00:06.221579 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m02:00:06.224304 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m02:00:06.224706 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m02:00:06.225028 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.229410 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m02:00:06.232142 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m02:00:06.232557 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m02:00:06.232905 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m02:00:06.233500 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m02:00:06.233821 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.235460 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m02:00:06.235818 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m02:00:06.238527 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m02:00:06.240206 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m02:00:06.240764 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m02:00:06.241243 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:06.241645 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m02:00:06.242039 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m02:00:06.242364 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m02:00:06.243546 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m02:00:06.243893 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m02:00:06.244222 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m02:00:06.244556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.244916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.245214 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m02:00:06.245545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.246372 [info ] [Thread-2 (]: 8 of 33 PASS not_null_dv_hub_well_hk_well ...................................... [[32mPASS[0m in 0.05s]
[0m02:00:06.246877 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m02:00:06.247260 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m02:00:06.247647 [info ] [Thread-2 (]: 12 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m02:00:06.247992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m02:00:06.248311 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m02:00:06.251015 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m02:00:06.251604 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m02:00:06.251950 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m02:00:06.252338 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m02:00:06.252658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:00:06.253044 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m02:00:06.253385 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m02:00:06.253736 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.254084 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m02:00:06.254444 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:00:06.256041 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m02:00:06.256476 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.256899 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:00:06.258153 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m02:00:06.258592 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.258956 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:06.260079 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m02:00:06.260447 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m02:00:06.260761 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m02:00:06.261821 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m02:00:06.262221 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m02:00:06.262545 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m02:00:06.263483 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m02:00:06.263780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.263135 [info ] [Thread-3 (]: 9 of 33 PASS not_null_dv_hub_well_well_id_bk ................................... [[32mPASS[0m in 0.04s]
[0m02:00:06.264444 [info ] [Thread-1 (]: 11 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m02:00:06.264940 [info ] [Thread-4 (]: 10 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m02:00:06.265562 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m02:00:06.266059 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m02:00:06.266550 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m02:00:06.266920 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m02:00:06.267347 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m02:00:06.267738 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m02:00:06.268219 [info ] [Thread-3 (]: 13 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m02:00:06.268678 [info ] [Thread-1 (]: 14 of 33 START test test_counts_match .......................................... [RUN]
[0m02:00:06.269026 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.269383 [info ] [Thread-4 (]: 15 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m02:00:06.269766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m02:00:06.270123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m02:00:06.270481 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m02:00:06.270820 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m02:00:06.271156 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m02:00:06.271494 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m02:00:06.271824 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.272152 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m02:00:06.275002 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m02:00:06.277120 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m02:00:06.279858 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m02:00:06.280303 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:00:06.280818 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m02:00:06.281281 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m02:00:06.282379 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m02:00:06.284007 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m02:00:06.284476 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m02:00:06.285993 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m02:00:06.286458 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m02:00:06.287980 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m02:00:06.288702 [info ] [Thread-2 (]: 12 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m02:00:06.289190 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m02:00:06.289543 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m02:00:06.289986 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m02:00:06.290336 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m02:00:06.290691 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m02:00:06.291018 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m02:00:06.291392 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m02:00:06.291742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.292050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.292377 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m02:00:06.292701 [info ] [Thread-2 (]: 16 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m02:00:06.293235 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.293614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m02:00:06.294092 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m02:00:06.297915 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m02:00:06.298483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m02:00:06.298830 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.299236 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m02:00:06.299566 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m02:00:06.299887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:00:06.300261 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m02:00:06.301784 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m02:00:06.302143 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.302496 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m02:00:06.302835 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.303361 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m02:00:06.303860 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m02:00:06.304196 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:00:06.304519 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.304832 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m02:00:06.305945 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m02:00:06.306325 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:06.307340 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m02:00:06.307676 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.308770 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m02:00:06.309092 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m02:00:06.309568 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m02:00:06.309993 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m02:00:06.310504 [info ] [Thread-4 (]: 15 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m02:00:06.310979 [info ] [Thread-3 (]: 13 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m02:00:06.311534 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m02:00:06.311986 [info ] [Thread-1 (]: 14 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m02:00:06.312516 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m02:00:06.312910 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m02:00:06.313481 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m02:00:06.313798 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.314188 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m02:00:06.314568 [info ] [Thread-4 (]: 17 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m02:00:06.314997 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m02:00:06.315474 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m02:00:06.315815 [info ] [Thread-3 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m02:00:06.316211 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m02:00:06.316578 [info ] [Thread-1 (]: 19 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m02:00:06.316940 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.317298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m02:00:06.317634 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m02:00:06.317986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m02:00:06.318385 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m02:00:06.321290 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m02:00:06.321636 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:00:06.321972 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m02:00:06.327885 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m02:00:06.329108 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m02:00:06.333023 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m02:00:06.333641 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m02:00:06.333990 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m02:00:06.334401 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m02:00:06.335978 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m02:00:06.337588 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m02:00:06.337921 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m02:00:06.338499 [info ] [Thread-2 (]: 16 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m02:00:06.340346 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m02:00:06.340713 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m02:00:06.341214 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m02:00:06.341630 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m02:00:06.342037 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m02:00:06.342441 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m02:00:06.342831 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m02:00:06.343139 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m02:00:06.343548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.343903 [info ] [Thread-2 (]: 20 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m02:00:06.344268 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m02:00:06.344583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.345035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m02:00:06.345379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.345838 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m02:00:06.348715 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m02:00:06.349266 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.349627 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.350014 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m02:00:06.350420 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m02:00:06.350742 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m02:00:06.351070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.351444 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.354024 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m02:00:06.354407 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.354777 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m02:00:06.355392 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.355798 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m02:00:06.356142 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.356548 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.356893 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m02:00:06.358031 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m02:00:06.358371 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:06.359435 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m02:00:06.359768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.360865 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m02:00:06.361214 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m02:00:06.361696 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m02:00:06.362115 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m02:00:06.362673 [info ] [Thread-4 (]: 17 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.05s]
[0m02:00:06.363177 [info ] [Thread-3 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.05s]
[0m02:00:06.363688 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m02:00:06.364097 [info ] [Thread-1 (]: 19 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.05s]
[0m02:00:06.364595 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m02:00:06.365005 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m02:00:06.365408 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.365877 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m02:00:06.366229 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m02:00:06.366620 [info ] [Thread-4 (]: 21 of 33 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m02:00:06.366995 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m02:00:06.367367 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m02:00:06.367724 [info ] [Thread-3 (]: 22 of 33 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m02:00:06.368093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m02:00:06.368457 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:00:06.368812 [info ] [Thread-1 (]: 23 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m02:00:06.369170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m02:00:06.369508 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m02:00:06.369901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m02:00:06.370224 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m02:00:06.370551 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.373379 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m02:00:06.373739 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m02:00:06.376386 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m02:00:06.377520 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m02:00:06.381451 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m02:00:06.381941 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m02:00:06.382519 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m02:00:06.384126 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m02:00:06.384546 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m02:00:06.384916 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m02:00:06.385456 [info ] [Thread-2 (]: 20 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m02:00:06.387055 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m02:00:06.388678 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m02:00:06.389099 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m02:00:06.389538 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m02:00:06.390194 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m02:00:06.390515 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m02:00:06.390878 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m02:00:06.391240 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m02:00:06.391714 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m02:00:06.392032 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.392362 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m02:00:06.392691 [info ] [Thread-2 (]: 24 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m02:00:06.393027 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.393457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.393789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m02:00:06.394362 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m02:00:06.397093 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m02:00:06.397636 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.397973 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.398323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.398680 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m02:00:06.399047 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m02:00:06.399403 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m02:00:06.399731 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m02:00:06.400084 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.400455 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.402023 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m02:00:06.402406 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:00:06.403050 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m02:00:06.403381 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.403682 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.404007 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m02:00:06.404322 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:06.405455 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m02:00:06.406521 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m02:00:06.406857 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.407911 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m02:00:06.408364 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m02:00:06.408741 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m02:00:06.409162 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m02:00:06.409728 [info ] [Thread-3 (]: 22 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.04s]
[0m02:00:06.410299 [info ] [Thread-4 (]: 21 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m02:00:06.411195 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m02:00:06.410813 [info ] [Thread-1 (]: 23 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m02:00:06.411774 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m02:00:06.412184 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_well
[0m02:00:06.412559 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.413024 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m02:00:06.413393 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_source_format
[0m02:00:06.413848 [info ] [Thread-3 (]: 25 of 33 START sql table model public.dim_well ................................. [RUN]
[0m02:00:06.414218 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m02:00:06.414598 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_time
[0m02:00:06.415020 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m02:00:06.415429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now model.caspian_vault.dim_well)
[0m02:00:06.415775 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:00:06.416187 [info ] [Thread-1 (]: 27 of 33 START sql table model public.dim_time ................................. [RUN]
[0m02:00:06.416574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now model.caspian_vault.dim_source_format)
[0m02:00:06.416908 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_well
[0m02:00:06.417306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now model.caspian_vault.dim_time)
[0m02:00:06.417638 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_source_format
[0m02:00:06.421066 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m02:00:06.421417 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:00:06.421745 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_time
[0m02:00:06.423682 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m02:00:06.424913 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m02:00:06.426979 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m02:00:06.427398 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_well
[0m02:00:06.427888 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_source_format
[0m02:00:06.428310 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m02:00:06.430994 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m02:00:06.433620 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m02:00:06.433985 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_time
[0m02:00:06.434507 [info ] [Thread-2 (]: 24 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m02:00:06.437197 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m02:00:06.437578 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m02:00:06.438067 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m02:00:06.438436 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m02:00:06.438871 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: BEGIN
[0m02:00:06.439282 [debug] [Thread-2 (]: Began running node model.caspian_vault.fct_readings
[0m02:00:06.439659 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m02:00:06.440079 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m02:00:06.440424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.440836 [info ] [Thread-2 (]: 28 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m02:00:06.441195 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: BEGIN
[0m02:00:06.441531 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.441979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now model.caspian_vault.fct_readings)
[0m02:00:06.442328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.442798 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.fct_readings
[0m02:00:06.445288 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m02:00:06.445795 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.446118 [debug] [Thread-2 (]: Began executing node model.caspian_vault.fct_readings
[0m02:00:06.446508 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m02:00:06.446903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.449426 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m02:00:06.449758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:00:06.450131 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m02:00:06.450511 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m02:00:06.450953 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m02:00:06.451374 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m02:00:06.451747 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m02:00:06.452087 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m02:00:06.452545 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: BEGIN
[0m02:00:06.452832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.455622 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.004 seconds
[0m02:00:06.458976 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m02:00:06.459377 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m02:00:06.459737 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m02:00:06.460108 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m02:00:06.460416 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.460761 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m02:00:06.462792 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m02:00:06.463200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m02:00:06.463552 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m02:00:06.465821 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m02:00:06.466222 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m02:00:06.466543 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.467575 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m02:00:06.467886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.468215 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m02:00:06.468549 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.016 seconds
[0m02:00:06.470598 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m02:00:06.470940 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m02:00:06.473322 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m02:00:06.473676 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m02:00:06.474065 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m02:00:06.474598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.474926 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.475895 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m02:00:06.477935 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m02:00:06.478296 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m02:00:06.478635 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m02:00:06.478959 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m02:00:06.479451 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.480408 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m02:00:06.480741 [debug] [Thread-2 (]: SQL status: SELECT 9980 in 0.018 seconds
[0m02:00:06.481099 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m02:00:06.483455 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m02:00:06.483830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m02:00:06.484146 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m02:00:06.484493 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m02:00:06.486230 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m02:00:06.486859 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m02:00:06.487178 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.487529 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m02:00:06.489579 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m02:00:06.489978 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m02:00:06.490449 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.491406 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: COMMIT
[0m02:00:06.491718 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m02:00:06.491993 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: COMMIT
[0m02:00:06.496055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m02:00:06.497722 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m02:00:06.498041 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m02:00:06.498349 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m02:00:06.498678 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m02:00:06.500132 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m02:00:06.501735 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m02:00:06.502785 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: Close
[0m02:00:06.504382 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m02:00:06.504748 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m02:00:06.505228 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m02:00:06.505745 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m02:00:06.506189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c51437950>]}
[0m02:00:06.506606 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m02:00:06.506962 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m02:00:06.507551 [info ] [Thread-3 (]: 25 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.09s]
[0m02:00:06.508211 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_well
[0m02:00:06.508584 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:00:06.508986 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m02:00:06.510093 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: Close
[0m02:00:06.510519 [info ] [Thread-3 (]: 29 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m02:00:06.510949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.dim_survey_type)
[0m02:00:06.511375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c513205f0>]}
[0m02:00:06.511690 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m02:00:06.512160 [info ] [Thread-1 (]: 27 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.09s]
[0m02:00:06.514394 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m02:00:06.514754 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m02:00:06.515234 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_time
[0m02:00:06.515551 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m02:00:06.516662 [debug] [Thread-2 (]: On model.caspian_vault.fct_readings: Close
[0m02:00:06.517188 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m02:00:06.518178 [debug] [Thread-4 (]: On model.caspian_vault.dim_source_format: Close
[0m02:00:06.521082 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m02:00:06.521498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5134fec0>]}
[0m02:00:06.521976 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c51303560>]}
[0m02:00:06.522614 [info ] [Thread-2 (]: 28 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.08s]
[0m02:00:06.523220 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.11s]
[0m02:00:06.523648 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m02:00:06.524093 [debug] [Thread-2 (]: Finished running node model.caspian_vault.fct_readings
[0m02:00:06.524633 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_source_format
[0m02:00:06.524970 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m02:00:06.525611 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m02:00:06.525945 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.526258 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_survey_summary
[0m02:00:06.526571 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_well_performance
[0m02:00:06.526968 [info ] [Thread-1 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m02:00:06.527516 [info ] [Thread-2 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m02:00:06.527940 [info ] [Thread-4 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m02:00:06.528346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_sensor_analysis)
[0m02:00:06.528703 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now model.caspian_vault.mart_survey_summary)
[0m02:00:06.529044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m02:00:06.529418 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m02:00:06.529759 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m02:00:06.530081 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m02:00:06.532162 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.534177 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m02:00:06.534544 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m02:00:06.536525 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m02:00:06.537132 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m02:00:06.537478 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m02:00:06.537821 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m02:00:06.540534 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.540913 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m02:00:06.543487 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m02:00:06.543816 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_well_performance
[0m02:00:06.544456 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.547967 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m02:00:06.548394 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m02:00:06.548770 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m02:00:06.549209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:06.549535 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.005 seconds
[0m02:00:06.549877 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m02:00:06.550295 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m02:00:06.552758 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m02:00:06.553102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:00:06.553457 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m02:00:06.553812 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m02:00:06.554292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:00:06.554597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.555133 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.555456 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.555827 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m02:00:06.557902 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m02:00:06.558402 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m02:00:06.558765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:00:06.559101 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:00:06.559503 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m02:00:06.559815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.560147 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m02:00:06.560499 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m02:00:06.561584 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m02:00:06.561935 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m02:00:06.562345 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m02:00:06.562714 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m02:00:06.565120 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m02:00:06.566720 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m02:00:06.567054 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.009 seconds
[0m02:00:06.567538 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m02:00:06.569852 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.570205 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m02:00:06.570560 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m02:00:06.571127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.571491 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.009 seconds
[0m02:00:06.573526 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.573891 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:00:06.574195 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.012 seconds
[0m02:00:06.576584 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m02:00:06.576944 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m02:00:06.577966 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m02:00:06.580265 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m02:00:06.580628 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m02:00:06.581073 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m02:00:06.581511 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53d71010>]}
[0m02:00:06.581896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.582842 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.583157 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.584133 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m02:00:06.582495 [info ] [Thread-3 (]: 29 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.07s]
[0m02:00:06.586352 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m02:00:06.589347 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m02:00:06.589708 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.590161 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m02:00:06.590506 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m02:00:06.590850 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m02:00:06.591190 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m02:00:06.591867 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:06.592210 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:00:06.593280 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m02:00:06.593606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:00:06.594565 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m02:00:06.594915 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m02:00:06.596559 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m02:00:06.596910 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m02:00:06.597233 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m02:00:06.597702 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m02:00:06.598025 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m02:00:06.598397 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m02:00:06.600568 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m02:00:06.602174 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m02:00:06.602506 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m02:00:06.602840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:00:06.603278 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m02:00:06.604957 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m02:00:06.605985 [debug] [Thread-1 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m02:00:06.606331 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m02:00:06.606795 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m02:00:06.607316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53e4ee40>]}
[0m02:00:06.607663 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m02:00:06.608153 [info ] [Thread-1 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.08s]
[0m02:00:06.608694 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m02:00:06.609347 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:00:06.610327 [debug] [Thread-4 (]: On model.caspian_vault.mart_well_performance: Close
[0m02:00:06.610627 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:00:06.611675 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: Close
[0m02:00:06.612058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c513f1df0>]}
[0m02:00:06.612970 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c513f3770>]}
[0m02:00:06.612638 [info ] [Thread-4 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.08s]
[0m02:00:06.613546 [info ] [Thread-2 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.08s]
[0m02:00:06.614027 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_well_performance
[0m02:00:06.614464 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m02:00:06.615027 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:06.615534 [info ] [Thread-3 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m02:00:06.615905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now snapshot.caspian_vault.snap_mart_well_performance)
[0m02:00:06.616218 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:06.618674 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:06.653388 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.653787 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m02:00:06.654082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:00:06.658397 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:00:06.658739 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.659042 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m02:00:06.664211 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m02:00:06.694416 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.694866 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp020006693721"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m02:00:06.697274 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.002 seconds
[0m02:00:06.700664 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.701002 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp020006693721'
        
      order by ordinal_position

  
[0m02:00:06.703400 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m02:00:06.705614 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.705947 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m02:00:06.707759 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m02:00:06.709948 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.710302 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp020006693721'
        
      order by ordinal_position

  
[0m02:00:06.712118 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m02:00:06.714310 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.714645 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m02:00:06.716489 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.002 seconds
[0m02:00:06.721290 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.721645 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp020006693721'
        
      order by ordinal_position

  
[0m02:00:06.723520 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m02:00:06.736364 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.736798 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m02:00:06.737552 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m02:00:06.741379 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.741727 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m02:00:06.742238 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m02:00:06.742676 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.743190 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.743565 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp020006693721" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp020006693721" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m02:00:06.744471 [debug] [Thread-3 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m02:00:06.745441 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m02:00:06.745756 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:06.746034 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m02:00:06.748576 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m02:00:06.750607 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m02:00:06.751123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa80d5d-3df6-424f-8931-3da98d3506b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5137a270>]}
[0m02:00:06.751784 [info ] [Thread-3 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m02:00:06.752275 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:06.753649 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:06.753972 [debug] [MainThread]: On master: BEGIN
[0m02:00:06.754269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:06.758171 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:00:06.758513 [debug] [MainThread]: On master: COMMIT
[0m02:00:06.758798 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:06.759061 [debug] [MainThread]: On master: COMMIT
[0m02:00:06.759423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:00:06.759716 [debug] [MainThread]: On master: Close
[0m02:00:06.760093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:06.760389 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m02:00:06.760636 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m02:00:06.760871 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m02:00:06.761103 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m02:00:06.761472 [info ] [MainThread]: 
[0m02:00:06.761779 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m02:00:06.765406 [debug] [MainThread]: Command end result
[0m02:00:06.791099 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m02:00:06.792581 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m02:00:06.798525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m02:00:06.798866 [info ] [MainThread]: 
[0m02:00:06.799205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:06.799524 [info ] [MainThread]: 
[0m02:00:06.799818 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m02:00:06.800358 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:00:06.801215 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7996495, "process_in_blocks": "0", "process_kernel_time": 0.352551, "process_mem_max_rss": "134972", "process_out_blocks": "3616", "process_user_time": 2.61168}
[0m02:00:06.801701 [debug] [MainThread]: Command `dbt build` succeeded at 02:00:06.801622 after 1.80 seconds
[0m02:00:06.802030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5c1964b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5ca09880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5ca08d70>]}
[0m02:00:06.802381 [debug] [MainThread]: Flushing usage events
[0m02:00:07.326648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:08.888093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bf206b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037c0252fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037c1966000>]}


============================== 02:00:08.892993 | fb829781-a842-4937-bdf6-835bfcbe5cfa ==============================
[0m02:00:08.892993 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:00:08.893456 [debug] [MainThread]: running dbt with arguments {'target_path': '/opt/airflow/dbt_target', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'use_colors': 'True', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/opt/airflow/logs/dbt', 'quiet': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles'}
[0m02:00:08.937911 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m02:00:08.938396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037be947f20>]}
[0m02:00:08.938847 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m02:00:08.939184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bf0b6ae0>]}
[0m02:00:09.059106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bf185970>]}
[0m02:00:09.118262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037c14ea660>]}
[0m02:00:09.119054 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:00:09.230117 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m02:00:09.356938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:09.357372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:09.362585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m02:00:09.414000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037be576270>]}
[0m02:00:09.512578 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m02:00:09.514227 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m02:00:09.532056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bd576840>]}
[0m02:00:09.532521 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m02:00:09.532860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bddec0e0>]}
[0m02:00:09.534793 [info ] [MainThread]: 
[0m02:00:09.535158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:09.535476 [info ] [MainThread]: 
[0m02:00:09.535940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:09.536800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:00:09.569216 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:00:09.569586 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:00:09.569861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:09.575167 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m02:00:09.576190 [debug] [ThreadPool]: On list_airflow: Close
[0m02:00:09.580419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m02:00:09.580960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m02:00:09.585206 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m02:00:09.587337 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m02:00:09.587659 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m02:00:09.587952 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m02:00:09.588304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:09.588581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:09.592393 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:00:09.592737 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m02:00:09.593017 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:00:09.593346 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m02:00:09.593658 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m02:00:09.594008 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:00:09.595938 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m02:00:09.596931 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m02:00:09.597271 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.003 seconds
[0m02:00:09.597531 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m02:00:09.599028 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m02:00:09.599529 [debug] [ThreadPool]: On list_airflow_public: Close
[0m02:00:09.608963 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:09.609313 [debug] [MainThread]: On master: BEGIN
[0m02:00:09.609582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:09.613215 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:00:09.613548 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:09.613877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:09.635661 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m02:00:09.636911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bdd5bf20>]}
[0m02:00:09.637354 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:09.637765 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:09.638056 [debug] [MainThread]: On master: BEGIN
[0m02:00:09.638500 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:00:09.638805 [debug] [MainThread]: On master: COMMIT
[0m02:00:09.639076 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:09.639352 [debug] [MainThread]: On master: COMMIT
[0m02:00:09.639694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:00:09.639981 [debug] [MainThread]: On master: Close
[0m02:00:09.643417 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:09.643878 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m02:00:09.644272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now snapshot.caspian_vault.snap_mart_well_performance)
[0m02:00:09.644581 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:09.650043 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:09.687956 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.688386 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m02:00:09.688683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:09.693030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:00:09.693390 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.693691 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m02:00:09.698855 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m02:00:09.737701 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.738151 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp020009732231"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m02:00:09.740517 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m02:00:09.743507 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.743845 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp020009732231'
        
      order by ordinal_position

  
[0m02:00:09.746300 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m02:00:09.748522 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.748855 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m02:00:09.750718 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m02:00:09.752878 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.753207 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp020009732231'
        
      order by ordinal_position

  
[0m02:00:09.755095 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m02:00:09.757340 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.757671 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m02:00:09.759497 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m02:00:09.764191 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.764559 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp020009732231'
        
      order by ordinal_position

  
[0m02:00:09.766446 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m02:00:09.779394 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.779806 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m02:00:09.780530 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m02:00:09.784388 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.784729 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m02:00:09.785265 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m02:00:09.785701 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.786212 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.786594 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp020009732231" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp020009732231" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m02:00:09.787509 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m02:00:09.797969 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m02:00:09.798350 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m02:00:09.798647 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m02:00:09.800617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:00:09.803406 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m02:00:09.804750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb829781-a842-4937-bdf6-835bfcbe5cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037c1d86b10>]}
[0m02:00:09.805424 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m02:00:09.805932 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m02:00:09.807220 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:09.807548 [debug] [MainThread]: On master: BEGIN
[0m02:00:09.807820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:09.811709 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:00:09.812030 [debug] [MainThread]: On master: COMMIT
[0m02:00:09.812329 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:09.812595 [debug] [MainThread]: On master: COMMIT
[0m02:00:09.812929 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:00:09.813212 [debug] [MainThread]: On master: Close
[0m02:00:09.813611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:09.813886 [debug] [MainThread]: Connection 'list_airflow_snapshots' was properly closed.
[0m02:00:09.814129 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m02:00:09.814419 [info ] [MainThread]: 
[0m02:00:09.814719 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:00:09.815290 [debug] [MainThread]: Command end result
[0m02:00:09.890332 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m02:00:09.891857 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m02:00:09.896783 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m02:00:09.897114 [info ] [MainThread]: 
[0m02:00:09.897508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:09.897797 [info ] [MainThread]: 
[0m02:00:09.898102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:00:09.898615 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:00:09.899492 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0544207, "process_in_blocks": "0", "process_kernel_time": 0.252124, "process_mem_max_rss": "128292", "process_out_blocks": "2768", "process_user_time": 2.061018}
[0m02:00:09.899947 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:00:09.899867 after 1.06 seconds
[0m02:00:09.900297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037c0f25ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bc212b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037bc212e70>]}
[0m02:00:09.900632 [debug] [MainThread]: Flushing usage events
[0m02:00:10.301906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:02.529789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961c08f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961d566030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961c131070>]}


============================== 03:00:02.534767 | d30bed41-93d5-436d-84db-a8c736406ac7 ==============================
[0m03:00:02.534767 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:00:02.535214 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/opt/airflow/logs/dbt', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None'}
[0m03:00:02.541435 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m03:00:02.541809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd30bed41-93d5-436d-84db-a8c736406ac7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961c3806e0>]}
[0m03:00:02.542196 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m03:00:02.542516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd30bed41-93d5-436d-84db-a8c736406ac7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961c08f560>]}
[0m03:00:02.643822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd30bed41-93d5-436d-84db-a8c736406ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961b2a6180>]}
[0m03:00:02.662867 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gc2l7n69'
[0m03:00:02.663224 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:00:02.882091 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:00:02.882776 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:00:02.911914 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:00:02.915121 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:00:03.154151 [info ] [MainThread]: Installed from version 1.3.0
[0m03:00:03.154618 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:00:03.154943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd30bed41-93d5-436d-84db-a8c736406ac7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961b58dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961c6b60f0>]}
[0m03:00:03.155299 [info ] [MainThread]: 
[0m03:00:03.155591 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:00:03.156236 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:00:03.157093 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66948694, "process_in_blocks": "0", "process_kernel_time": 0.192493, "process_mem_max_rss": "108012", "process_out_blocks": "2304", "process_user_time": 1.317535}
[0m03:00:03.157555 [debug] [MainThread]: Command `dbt deps` succeeded at 03:00:03.157478 after 0.67 seconds
[0m03:00:03.157849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961b58dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961b50b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72961b50bb60>]}
[0m03:00:03.158136 [debug] [MainThread]: Flushing usage events
[0m03:00:03.661367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:05.146479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b492296900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b491e89820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b491c7fbc0>]}


============================== 03:00:05.151356 | bdcb77c7-a756-439b-8f2c-f074d0962eb5 ==============================
[0m03:00:05.151356 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:00:05.151795 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': '/opt/airflow/dbt_target', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'log_path': '/opt/airflow/logs/dbt', 'empty': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False'}
[0m03:00:05.196070 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m03:00:05.196559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490a2b020>]}
[0m03:00:05.196995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m03:00:05.197345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b49047ba10>]}
[0m03:00:05.315760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b4904c7140>]}
[0m03:00:05.373576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490d03e00>]}
[0m03:00:05.374391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:00:05.486882 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m03:00:05.612136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:05.612574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:05.617709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m03:00:05.668282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490532480>]}
[0m03:00:05.765234 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m03:00:05.766888 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m03:00:05.794468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490976360>]}
[0m03:00:05.794922 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m03:00:05.798363 [info ] [MainThread]: 
[0m03:00:05.798722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:00:05.799004 [info ] [MainThread]: 
[0m03:00:05.799477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:05.803490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:00:05.810332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:00:05.838880 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:00:05.839219 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:00:05.839580 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:00:05.839884 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:00:05.840181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:05.840475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:05.845737 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m03:00:05.846042 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m03:00:05.847078 [debug] [ThreadPool]: On list_airflow: Close
[0m03:00:05.848031 [debug] [ThreadPool]: On list_airflow: Close
[0m03:00:05.849843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m03:00:05.850331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m03:00:05.854693 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m03:00:05.856024 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:00:05.856345 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m03:00:05.856634 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:00:05.856903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:05.857170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:05.860787 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m03:00:05.861118 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m03:00:05.861394 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m03:00:05.861703 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:00:05.861993 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:00:05.862336 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:00:05.864283 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:05.864568 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m03:00:05.865578 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m03:00:05.867168 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:00:05.867574 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m03:00:05.867823 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:00:05.877236 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:05.877578 [debug] [MainThread]: On master: BEGIN
[0m03:00:05.877841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:05.881618 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:00:05.881934 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:05.882272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:05.904190 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m03:00:05.905370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b4905316d0>]}
[0m03:00:05.905806 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:05.906220 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:05.906527 [debug] [MainThread]: On master: BEGIN
[0m03:00:05.906946 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:00:05.907267 [debug] [MainThread]: On master: COMMIT
[0m03:00:05.907544 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:05.907795 [debug] [MainThread]: On master: COMMIT
[0m03:00:05.908139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:05.908441 [debug] [MainThread]: On master: Close
[0m03:00:05.912010 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m03:00:05.912468 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m03:00:05.912837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m03:00:05.913140 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m03:00:05.918841 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m03:00:05.919360 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m03:00:05.948067 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m03:00:05.948671 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m03:00:05.948987 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m03:00:05.949273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:05.953369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:05.953701 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m03:00:05.954042 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m03:00:05.984635 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.030 seconds
[0m03:00:05.992014 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m03:00:05.992375 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m03:00:05.992927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:05.995010 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m03:00:05.995354 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m03:00:05.995815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.007337 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m03:00:06.007687 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m03:00:06.007966 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m03:00:06.026035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m03:00:06.030802 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m03:00:06.034899 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m03:00:06.035237 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m03:00:06.039585 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:00:06.041462 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m03:00:06.042831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b49370af60>]}
[0m03:00:06.043369 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.13s]
[0m03:00:06.043844 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m03:00:06.044786 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m03:00:06.045190 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m03:00:06.045727 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m03:00:06.046134 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m03:00:06.046600 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m03:00:06.047000 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m03:00:06.047349 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m03:00:06.047669 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m03:00:06.057615 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m03:00:06.060895 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m03:00:06.061483 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m03:00:06.061847 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m03:00:06.074469 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m03:00:06.076123 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m03:00:06.076779 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m03:00:06.077126 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m03:00:06.077478 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m03:00:06.077801 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m03:00:06.078119 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:00:06.078441 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:00:06.082800 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.083144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.083503 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m03:00:06.083830 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m03:00:06.084155 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m03:00:06.084507 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m03:00:06.086439 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.086740 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.089184 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m03:00:06.090298 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m03:00:06.090742 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m03:00:06.091063 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m03:00:06.091601 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.05s]
[0m03:00:06.092119 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m03:00:06.092528 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.05s]
[0m03:00:06.093129 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m03:00:06.093872 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m03:00:06.094222 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m03:00:06.094961 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m03:00:06.095288 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_sat_readings
[0m03:00:06.094700 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m03:00:06.095766 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m03:00:06.096193 [info ] [Thread-3 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m03:00:06.096663 [info ] [Thread-4 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m03:00:06.097039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m03:00:06.097413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m03:00:06.099073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m03:00:06.099461 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m03:00:06.099796 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m03:00:06.100118 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m03:00:06.100458 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m03:00:06.100773 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m03:00:06.153243 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.155607 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m03:00:06.158705 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.161041 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m03:00:06.161878 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m03:00:06.164523 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.164874 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m03:00:06.165389 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m03:00:06.165760 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m03:00:06.168353 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m03:00:06.168756 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.171369 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.173898 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m03:00:06.174367 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m03:00:06.174846 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m03:00:06.175289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.175708 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.176036 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m03:00:06.176370 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m03:00:06.176827 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m03:00:06.177162 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.177512 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m03:00:06.177852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.178284 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.180788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.181126 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.181442 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m03:00:06.181925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.182260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.182628 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m03:00:06.182950 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.183302 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.183629 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m03:00:06.183966 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m03:00:06.184316 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m03:00:06.184718 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m03:00:06.198759 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.017 seconds
[0m03:00:06.202338 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.202666 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m03:00:06.203018 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.018 seconds
[0m03:00:06.203348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.205576 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m03:00:06.207578 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.207922 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m03:00:06.208270 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m03:00:06.208786 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.209084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.211123 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m03:00:06.212147 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m03:00:06.212507 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m03:00:06.212847 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.213209 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m03:00:06.213576 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.214567 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m03:00:06.214915 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.030 seconds
[0m03:00:06.215225 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m03:00:06.217502 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.217839 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m03:00:06.218168 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m03:00:06.218553 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.033 seconds
[0m03:00:06.220932 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m03:00:06.221260 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:00:06.221599 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m03:00:06.223568 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.223965 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m03:00:06.224308 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.226354 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m03:00:06.226665 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:00:06.226997 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m03:00:06.227964 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m03:00:06.228372 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.228665 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.228983 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m03:00:06.229937 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m03:00:06.230335 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m03:00:06.230616 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m03:00:06.242075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m03:00:06.243870 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m03:00:06.244346 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m03:00:06.244648 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m03:00:06.249444 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m03:00:06.249823 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m03:00:06.250162 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m03:00:06.252874 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m03:00:06.253262 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m03:00:06.254881 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m03:00:06.256544 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m03:00:06.257022 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m03:00:06.258137 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m03:00:06.258633 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m03:00:06.259130 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m03:00:06.259505 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m03:00:06.259899 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m03:00:06.260435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48c21e600>]}
[0m03:00:06.260778 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m03:00:06.261445 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.16s]
[0m03:00:06.261997 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m03:00:06.262572 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m03:00:06.262877 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m03:00:06.263205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m03:00:06.263509 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m03:00:06.263803 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:00:06.268687 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m03:00:06.269038 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m03:00:06.269394 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m03:00:06.270414 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m03:00:06.271510 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m03:00:06.272533 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: Close
[0m03:00:06.272896 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m03:00:06.273379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48d35c860>]}
[0m03:00:06.273893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48d35c710>]}
[0m03:00:06.274382 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48d35c680>]}
[0m03:00:06.276027 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m03:00:06.276545 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.18s]
[0m03:00:06.277074 [info ] [Thread-3 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.18s]
[0m03:00:06.277622 [info ] [Thread-4 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.17s]
[0m03:00:06.278203 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m03:00:06.278692 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m03:00:06.279059 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m03:00:06.279518 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m03:00:06.279873 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m03:00:06.280363 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m03:00:06.280752 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m03:00:06.281200 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m03:00:06.281709 [info ] [Thread-2 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m03:00:06.282060 [info ] [Thread-3 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m03:00:06.282417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.282753 [info ] [Thread-4 (]: 11 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m03:00:06.283125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m03:00:06.283482 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m03:00:06.283936 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m03:00:06.284273 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m03:00:06.284624 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m03:00:06.284985 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m03:00:06.287873 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m03:00:06.292179 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m03:00:06.292557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m03:00:06.295189 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m03:00:06.295792 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m03:00:06.296109 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m03:00:06.296525 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m03:00:06.296923 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.297307 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m03:00:06.298883 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m03:00:06.301586 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m03:00:06.303121 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m03:00:06.303565 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.304147 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m03:00:06.304611 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m03:00:06.305787 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m03:00:06.306194 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m03:00:06.306519 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m03:00:06.306852 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m03:00:06.307232 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m03:00:06.307551 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m03:00:06.307870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.308178 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.308500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.309075 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.05s]
[0m03:00:06.309822 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m03:00:06.310170 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m03:00:06.310555 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m03:00:06.310914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m03:00:06.311199 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m03:00:06.313865 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m03:00:06.314439 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m03:00:06.314793 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m03:00:06.315190 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m03:00:06.315567 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m03:00:06.315921 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m03:00:06.316234 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m03:00:06.316598 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m03:00:06.316942 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.317300 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:00:06.318952 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m03:00:06.319325 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.319999 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m03:00:06.320339 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.320655 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.321000 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m03:00:06.321307 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.322446 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m03:00:06.323524 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m03:00:06.323862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.324914 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m03:00:06.325366 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m03:00:06.325757 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m03:00:06.326194 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m03:00:06.326764 [info ] [Thread-2 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m03:00:06.327275 [info ] [Thread-4 (]: 11 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m03:00:06.328222 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m03:00:06.327823 [info ] [Thread-3 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m03:00:06.328781 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m03:00:06.329156 [debug] [Thread-2 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m03:00:06.329678 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m03:00:06.329996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m03:00:06.330384 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m03:00:06.330750 [info ] [Thread-2 (]: 13 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m03:00:06.331129 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m03:00:06.331593 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m03:00:06.331924 [info ] [Thread-4 (]: 14 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m03:00:06.332312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m03:00:06.332656 [info ] [Thread-3 (]: 15 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m03:00:06.333021 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.333378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m03:00:06.333705 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m03:00:06.334039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m03:00:06.334433 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m03:00:06.337238 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m03:00:06.337617 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m03:00:06.337906 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m03:00:06.340556 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m03:00:06.341769 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m03:00:06.344451 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m03:00:06.344912 [debug] [Thread-2 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m03:00:06.345469 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m03:00:06.347110 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m03:00:06.347507 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m03:00:06.347934 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m03:00:06.349967 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m03:00:06.348445 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m03:00:06.350445 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m03:00:06.351952 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m03:00:06.352500 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m03:00:06.352868 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m03:00:06.353195 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m03:00:06.353651 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m03:00:06.354040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.354412 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m03:00:06.354726 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m03:00:06.355050 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m03:00:06.355519 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m03:00:06.355842 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.356223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m03:00:06.356560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.356968 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m03:00:06.360847 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m03:00:06.361399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m03:00:06.361749 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m03:00:06.362142 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m03:00:06.362476 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m03:00:06.362865 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m03:00:06.363191 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m03:00:06.363539 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m03:00:06.363875 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:00:06.365413 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m03:00:06.365769 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.366110 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.366745 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m03:00:06.367079 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m03:00:06.367490 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.367790 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.368088 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.368400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.369527 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m03:00:06.370588 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m03:00:06.371642 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m03:00:06.372181 [debug] [Thread-2 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m03:00:06.372603 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m03:00:06.372942 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m03:00:06.373422 [info ] [Thread-2 (]: 13 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m03:00:06.373986 [info ] [Thread-4 (]: 14 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m03:00:06.374507 [info ] [Thread-3 (]: 15 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m03:00:06.375041 [debug] [Thread-2 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m03:00:06.375535 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m03:00:06.375842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:00:06.376332 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m03:00:06.376716 [debug] [Thread-2 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m03:00:06.377127 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m03:00:06.377592 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m03:00:06.377967 [debug] [Thread-3 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m03:00:06.378332 [info ] [Thread-2 (]: 17 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m03:00:06.378696 [info ] [Thread-4 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m03:00:06.379053 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.379417 [info ] [Thread-3 (]: 19 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m03:00:06.379804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m03:00:06.380157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m03:00:06.380578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m03:00:06.380914 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m03:00:06.381264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.381560 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m03:00:06.381883 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m03:00:06.388063 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m03:00:06.389187 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m03:00:06.393041 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m03:00:06.395697 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m03:00:06.396243 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m03:00:06.396797 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m03:00:06.397153 [debug] [Thread-2 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m03:00:06.397593 [debug] [Thread-3 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m03:00:06.398036 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m03:00:06.399621 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m03:00:06.401273 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m03:00:06.402814 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m03:00:06.403292 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m03:00:06.403983 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m03:00:06.404409 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m03:00:06.404739 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m03:00:06.405154 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m03:00:06.405502 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m03:00:06.405834 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m03:00:06.406159 [info ] [Thread-1 (]: 20 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m03:00:06.406520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.406843 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m03:00:06.407152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.407501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m03:00:06.407918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.408353 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m03:00:06.411191 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m03:00:06.411742 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.412140 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.412473 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m03:00:06.412863 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m03:00:06.413171 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m03:00:06.413495 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m03:00:06.413824 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.414200 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.416834 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m03:00:06.417204 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m03:00:06.417795 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:00:06.418222 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m03:00:06.418574 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.418890 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.419225 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m03:00:06.419542 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:00:06.420678 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m03:00:06.421751 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m03:00:06.422086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.423123 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m03:00:06.423660 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m03:00:06.423971 [debug] [Thread-2 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m03:00:06.424439 [debug] [Thread-3 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m03:00:06.424882 [info ] [Thread-4 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m03:00:06.425428 [info ] [Thread-2 (]: 17 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.05s]
[0m03:00:06.425875 [info ] [Thread-3 (]: 19 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.05s]
[0m03:00:06.426369 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m03:00:06.426820 [debug] [Thread-2 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m03:00:06.427342 [debug] [Thread-3 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m03:00:06.427667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m03:00:06.428024 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m03:00:06.428429 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m03:00:06.428803 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m03:00:06.429152 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m03:00:06.429497 [info ] [Thread-4 (]: 21 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m03:00:06.429846 [info ] [Thread-2 (]: 22 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m03:00:06.430199 [info ] [Thread-3 (]: 23 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m03:00:06.430571 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.430921 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m03:00:06.431272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m03:00:06.431626 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m03:00:06.432010 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m03:00:06.432341 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m03:00:06.432660 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m03:00:06.435511 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m03:00:06.438226 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m03:00:06.438569 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m03:00:06.442478 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m03:00:06.443911 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m03:00:06.444291 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m03:00:06.444683 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m03:00:06.446325 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m03:00:06.446673 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m03:00:06.447015 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m03:00:06.448528 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m03:00:06.449152 [info ] [Thread-1 (]: 20 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m03:00:06.450739 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m03:00:06.451126 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m03:00:06.451690 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m03:00:06.452162 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m03:00:06.452493 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m03:00:06.452874 [debug] [Thread-1 (]: Began running node test.caspian_vault.test_counts_match
[0m03:00:06.453295 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m03:00:06.453627 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m03:00:06.453958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.454290 [info ] [Thread-1 (]: 24 of 33 START test test_counts_match .......................................... [RUN]
[0m03:00:06.454629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.454960 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m03:00:06.455488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m03:00:06.455947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.456275 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.test_counts_match
[0m03:00:06.458511 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m03:00:06.459017 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.459406 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.459760 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m03:00:06.460059 [debug] [Thread-1 (]: Began executing node test.caspian_vault.test_counts_match
[0m03:00:06.460459 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m03:00:06.460793 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.461142 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.462696 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m03:00:06.463040 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.463393 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m03:00:06.464011 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m03:00:06.464385 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m03:00:06.464771 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m03:00:06.465080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.465437 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.465805 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.466943 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m03:00:06.468014 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m03:00:06.468354 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m03:00:06.468782 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m03:00:06.469832 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m03:00:06.470176 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m03:00:06.470519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.471065 [info ] [Thread-2 (]: 22 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m03:00:06.471485 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m03:00:06.472220 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m03:00:06.471948 [info ] [Thread-4 (]: 21 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m03:00:06.472789 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m03:00:06.473203 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m03:00:06.473733 [info ] [Thread-3 (]: 23 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m03:00:06.474263 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m03:00:06.474673 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_survey_type
[0m03:00:06.475298 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m03:00:06.475654 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_well
[0m03:00:06.476107 [info ] [Thread-2 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m03:00:06.476634 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_well ................................. [RUN]
[0m03:00:06.476994 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:06.477329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now model.caspian_vault.dim_survey_type)
[0m03:00:06.477687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now model.caspian_vault.dim_well)
[0m03:00:06.478775 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m03:00:06.479118 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m03:00:06.479453 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_well
[0m03:00:06.483042 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m03:00:06.485068 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m03:00:06.485400 [debug] [Thread-1 (]: On test.caspian_vault.test_counts_match: Close
[0m03:00:06.486103 [info ] [Thread-1 (]: 24 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.03s]
[0m03:00:06.486559 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_survey_type
[0m03:00:06.486973 [debug] [Thread-1 (]: Finished running node test.caspian_vault.test_counts_match
[0m03:00:06.489711 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m03:00:06.490033 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_well
[0m03:00:06.490683 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_source_format
[0m03:00:06.491044 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_time
[0m03:00:06.493635 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m03:00:06.494128 [info ] [Thread-3 (]: 27 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m03:00:06.494607 [info ] [Thread-1 (]: 28 of 33 START sql table model public.dim_time ................................. [RUN]
[0m03:00:06.494993 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m03:00:06.495459 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_source_format)
[0m03:00:06.495848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now model.caspian_vault.dim_time)
[0m03:00:06.496237 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m03:00:06.496558 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m03:00:06.496900 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_source_format
[0m03:00:06.497217 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_time
[0m03:00:06.497555 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: BEGIN
[0m03:00:06.497871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.499911 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m03:00:06.501915 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m03:00:06.502257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.503026 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_time
[0m03:00:06.505675 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m03:00:06.506101 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_source_format
[0m03:00:06.506556 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m03:00:06.506941 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.509465 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m03:00:06.509881 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m03:00:06.510194 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m03:00:06.510540 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m03:00:06.510961 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: BEGIN
[0m03:00:06.511362 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m03:00:06.511683 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m03:00:06.512024 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m03:00:06.512364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.512689 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m03:00:06.513200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.516434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.516820 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m03:00:06.517143 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.517520 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m03:00:06.517844 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.005 seconds
[0m03:00:06.518194 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m03:00:06.520766 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m03:00:06.521111 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.008 seconds
[0m03:00:06.521493 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m03:00:06.522836 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m03:00:06.525104 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m03:00:06.525509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m03:00:06.525923 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m03:00:06.526311 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.528535 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m03:00:06.530615 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m03:00:06.530977 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:00:06.531294 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m03:00:06.531634 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m03:00:06.533679 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m03:00:06.534111 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m03:00:06.534465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.534792 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:00:06.536846 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m03:00:06.537152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:00:06.537487 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.012 seconds
[0m03:00:06.538490 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m03:00:06.538838 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m03:00:06.539798 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m03:00:06.542089 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m03:00:06.542459 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m03:00:06.542841 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m03:00:06.543179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.543499 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m03:00:06.543820 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m03:00:06.544123 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: COMMIT
[0m03:00:06.545090 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m03:00:06.545578 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m03:00:06.545879 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: COMMIT
[0m03:00:06.546202 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:00:06.548205 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m03:00:06.548535 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m03:00:06.548979 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.549315 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m03:00:06.550336 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m03:00:06.550700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m03:00:06.552319 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m03:00:06.552622 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m03:00:06.552951 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m03:00:06.554540 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m03:00:06.555017 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m03:00:06.557571 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m03:00:06.557910 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m03:00:06.558371 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m03:00:06.558702 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m03:00:06.559155 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m03:00:06.559553 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m03:00:06.559926 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m03:00:06.560993 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m03:00:06.562579 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m03:00:06.563048 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m03:00:06.563406 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:00:06.563713 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:00:06.564017 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m03:00:06.564323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:00:06.565342 [debug] [Thread-4 (]: On model.caspian_vault.dim_well: Close
[0m03:00:06.566328 [debug] [Thread-2 (]: On model.caspian_vault.dim_survey_type: Close
[0m03:00:06.567352 [debug] [Thread-1 (]: On model.caspian_vault.dim_time: Close
[0m03:00:06.567945 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490129400>]}
[0m03:00:06.568439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48d35c8c0>]}
[0m03:00:06.568835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48c1112b0>]}
[0m03:00:06.569690 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:00:06.569367 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.09s]
[0m03:00:06.570266 [info ] [Thread-2 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.09s]
[0m03:00:06.570780 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.07s]
[0m03:00:06.571808 [debug] [Thread-3 (]: On model.caspian_vault.dim_source_format: Close
[0m03:00:06.572290 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_well
[0m03:00:06.572736 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_survey_type
[0m03:00:06.573155 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_time
[0m03:00:06.573597 [debug] [Thread-4 (]: Began running node model.caspian_vault.fct_readings
[0m03:00:06.574004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48c104620>]}
[0m03:00:06.574693 [info ] [Thread-4 (]: 29 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m03:00:06.575201 [info ] [Thread-3 (]: 27 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.08s]
[0m03:00:06.575612 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.fct_readings)
[0m03:00:06.576047 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_source_format
[0m03:00:06.576367 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.fct_readings
[0m03:00:06.578938 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m03:00:06.579431 [debug] [Thread-4 (]: Began executing node model.caspian_vault.fct_readings
[0m03:00:06.581970 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m03:00:06.582492 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m03:00:06.582796 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: BEGIN
[0m03:00:06.583069 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.586999 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.587346 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m03:00:06.587651 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m03:00:06.604432 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.016 seconds
[0m03:00:06.607008 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m03:00:06.607344 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m03:00:06.607865 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.609950 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m03:00:06.610278 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m03:00:06.610724 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.611693 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m03:00:06.612008 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m03:00:06.612294 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: COMMIT
[0m03:00:06.628867 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m03:00:06.630618 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m03:00:06.631066 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m03:00:06.631373 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m03:00:06.635122 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:00:06.636147 [debug] [Thread-4 (]: On model.caspian_vault.fct_readings: Close
[0m03:00:06.636647 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48edce960>]}
[0m03:00:06.637131 [info ] [Thread-4 (]: 29 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.06s]
[0m03:00:06.637585 [debug] [Thread-4 (]: Finished running node model.caspian_vault.fct_readings
[0m03:00:06.638317 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m03:00:06.638678 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m03:00:06.639084 [debug] [Thread-3 (]: Began running node model.caspian_vault.mart_well_performance
[0m03:00:06.639533 [info ] [Thread-2 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m03:00:06.640004 [info ] [Thread-1 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m03:00:06.640444 [info ] [Thread-3 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m03:00:06.640841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.mart_sensor_analysis)
[0m03:00:06.641200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_survey_summary)
[0m03:00:06.641570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_well_performance)
[0m03:00:06.641935 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m03:00:06.642386 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m03:00:06.642811 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m03:00:06.645610 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.648076 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m03:00:06.651757 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m03:00:06.652461 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m03:00:06.652879 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m03:00:06.655569 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.658145 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m03:00:06.658492 [debug] [Thread-3 (]: Began executing node model.caspian_vault.mart_well_performance
[0m03:00:06.661292 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m03:00:06.661714 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.662116 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m03:00:06.662542 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m03:00:06.662914 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m03:00:06.663240 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m03:00:06.663594 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:00:06.663912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:06.664229 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m03:00:06.664769 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:00:06.668117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.668557 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.668877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.669236 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m03:00:06.669573 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m03:00:06.669927 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m03:00:06.670322 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m03:00:06.670664 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m03:00:06.671003 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m03:00:06.678657 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.008 seconds
[0m03:00:06.681328 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.681645 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.010 seconds
[0m03:00:06.681984 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m03:00:06.684300 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m03:00:06.684693 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m03:00:06.685003 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m03:00:06.685328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:00:06.687679 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m03:00:06.688021 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:00:06.690069 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.690433 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m03:00:06.692497 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m03:00:06.692849 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m03:00:06.693266 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m03:00:06.693612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.696566 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m03:00:06.696928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m03:00:06.697242 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m03:00:06.697578 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m03:00:06.698606 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m03:00:06.699572 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m03:00:06.699963 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m03:00:06.700283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:00:06.700609 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.700920 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m03:00:06.701873 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m03:00:06.702203 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m03:00:06.702593 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m03:00:06.702947 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m03:00:06.703879 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m03:00:06.705569 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m03:00:06.705884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:00:06.706366 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m03:00:06.706660 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m03:00:06.708195 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m03:00:06.708559 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m03:00:06.710174 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m03:00:06.710676 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m03:00:06.711198 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m03:00:06.711543 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m03:00:06.711866 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m03:00:06.714158 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:00:06.715182 [debug] [Thread-3 (]: On model.caspian_vault.mart_well_performance: Close
[0m03:00:06.715704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48d35d2e0>]}
[0m03:00:06.716035 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:00:06.716383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:00:06.716913 [info ] [Thread-3 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.07s]
[0m03:00:06.717943 [debug] [Thread-2 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m03:00:06.718942 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m03:00:06.719392 [debug] [Thread-3 (]: Finished running node model.caspian_vault.mart_well_performance
[0m03:00:06.719850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490aa2990>]}
[0m03:00:06.720346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48d3df920>]}
[0m03:00:06.720969 [debug] [Thread-4 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:06.721472 [info ] [Thread-2 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.08s]
[0m03:00:06.721985 [info ] [Thread-1 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.08s]
[0m03:00:06.722450 [info ] [Thread-4 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m03:00:06.722937 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m03:00:06.723381 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m03:00:06.723727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m03:00:06.724236 [debug] [Thread-4 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:06.726712 [debug] [Thread-4 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:06.761511 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.761909 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m03:00:06.762200 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:00:06.766422 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.766762 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.767056 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:00:06.772279 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m03:00:06.802579 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.803010 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp030006801892"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:00:06.805445 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.002 seconds
[0m03:00:06.808627 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.808966 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp030006801892'
        
      order by ordinal_position

  
[0m03:00:06.811346 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.002 seconds
[0m03:00:06.813535 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.813859 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:00:06.815665 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.002 seconds
[0m03:00:06.817774 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.818102 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp030006801892'
        
      order by ordinal_position

  
[0m03:00:06.819922 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.001 seconds
[0m03:00:06.822089 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.822438 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:00:06.824197 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.001 seconds
[0m03:00:06.828893 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.829233 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp030006801892'
        
      order by ordinal_position

  
[0m03:00:06.831047 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.001 seconds
[0m03:00:06.843764 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.844179 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:00:06.844861 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:00:06.848782 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.849125 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:00:06.849607 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:00:06.850024 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.850553 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.850901 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp030006801892" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp030006801892" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:00:06.851746 [debug] [Thread-4 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m03:00:06.852700 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m03:00:06.853010 [debug] [Thread-4 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:06.853298 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m03:00:06.855148 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m03:00:06.857106 [debug] [Thread-4 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m03:00:06.857639 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb77c7-a756-439b-8f2c-f074d0962eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b48c2eb440>]}
[0m03:00:06.858289 [info ] [Thread-4 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.13s]
[0m03:00:06.858762 [debug] [Thread-4 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:06.860124 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:06.860466 [debug] [MainThread]: On master: BEGIN
[0m03:00:06.860743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:06.864749 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:00:06.865079 [debug] [MainThread]: On master: COMMIT
[0m03:00:06.865375 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:06.865646 [debug] [MainThread]: On master: COMMIT
[0m03:00:06.865988 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:06.866288 [debug] [MainThread]: On master: Close
[0m03:00:06.866669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:06.866938 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m03:00:06.867184 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m03:00:06.867450 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m03:00:06.867677 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m03:00:06.868022 [info ] [MainThread]: 
[0m03:00:06.868341 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m03:00:06.871907 [debug] [MainThread]: Command end result
[0m03:00:06.897176 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m03:00:06.898654 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m03:00:06.904627 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m03:00:06.904971 [info ] [MainThread]: 
[0m03:00:06.905321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:06.905632 [info ] [MainThread]: 
[0m03:00:06.905930 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m03:00:06.906482 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:00:06.907352 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.803012, "process_in_blocks": "0", "process_kernel_time": 0.343772, "process_mem_max_rss": "135052", "process_out_blocks": "3624", "process_user_time": 2.61387}
[0m03:00:06.907820 [debug] [MainThread]: Command `dbt build` succeeded at 03:00:06.907741 after 1.80 seconds
[0m03:00:06.908148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b4936e87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b490d8e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b491f93c50>]}
[0m03:00:06.908493 [debug] [MainThread]: Flushing usage events
[0m03:00:07.455718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:09.017636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3a1ef140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3bfe07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a39594fb0>]}


============================== 03:00:09.022533 | f09f49f5-d256-4ca0-82e3-b759b5ac1ff7 ==============================
[0m03:00:09.022533 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:00:09.022976 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'target_path': '/opt/airflow/dbt_target', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'log_path': '/opt/airflow/logs/dbt', 'no_print': 'None'}
[0m03:00:09.067749 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m03:00:09.068219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a39300bf0>]}
[0m03:00:09.068695 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m03:00:09.069032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a39231f10>]}
[0m03:00:09.188132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a395dede0>]}
[0m03:00:09.246314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3b61d340>]}
[0m03:00:09.247117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:00:09.360388 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m03:00:09.486402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:09.486856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:09.491989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m03:00:09.542873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3732bf80>]}
[0m03:00:09.640120 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m03:00:09.641814 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m03:00:09.659689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a373711c0>]}
[0m03:00:09.660135 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m03:00:09.660486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a37bb19a0>]}
[0m03:00:09.662430 [info ] [MainThread]: 
[0m03:00:09.662792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:00:09.663082 [info ] [MainThread]: 
[0m03:00:09.663562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:09.664406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:00:09.697075 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:00:09.697451 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:00:09.697727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:09.702994 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m03:00:09.704023 [debug] [ThreadPool]: On list_airflow: Close
[0m03:00:09.708308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m03:00:09.712652 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:00:09.713110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_snapshots'
[0m03:00:09.713408 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:00:09.715552 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m03:00:09.715859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:09.716157 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m03:00:09.716619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:09.719972 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m03:00:09.720332 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:00:09.720601 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m03:00:09.720919 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:00:09.721219 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m03:00:09.721599 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:00:09.723513 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m03:00:09.723799 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m03:00:09.725383 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:00:09.726352 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m03:00:09.726754 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:00:09.727014 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m03:00:09.736493 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:09.736824 [debug] [MainThread]: On master: BEGIN
[0m03:00:09.737100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:09.740723 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:00:09.741041 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:09.741386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:09.763395 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m03:00:09.764554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a37bf3e00>]}
[0m03:00:09.764986 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:09.765400 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:09.765691 [debug] [MainThread]: On master: BEGIN
[0m03:00:09.766111 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:00:09.766423 [debug] [MainThread]: On master: COMMIT
[0m03:00:09.766694 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:09.766946 [debug] [MainThread]: On master: COMMIT
[0m03:00:09.767294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:09.767579 [debug] [MainThread]: On master: Close
[0m03:00:09.771010 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:09.771472 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m03:00:09.771839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now snapshot.caspian_vault.snap_mart_well_performance)
[0m03:00:09.772142 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:09.777648 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:09.815466 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.815868 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m03:00:09.816162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:09.820394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:00:09.820746 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.821051 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:00:09.826327 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m03:00:09.864808 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.865305 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp030009859392"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:00:09.867766 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m03:00:09.870760 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.871101 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp030009859392'
        
      order by ordinal_position

  
[0m03:00:09.873498 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m03:00:09.875738 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.876073 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:00:09.877896 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m03:00:09.880060 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.880413 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp030009859392'
        
      order by ordinal_position

  
[0m03:00:09.882213 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m03:00:09.884464 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.884797 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:00:09.886546 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m03:00:09.891208 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.891592 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp030009859392'
        
      order by ordinal_position

  
[0m03:00:09.893370 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m03:00:09.906109 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.906544 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:00:09.907217 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:00:09.911032 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.911385 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:00:09.911844 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:00:09.912291 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.912786 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.913140 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp030009859392" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp030009859392" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:00:09.914007 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m03:00:09.924353 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m03:00:09.924710 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m03:00:09.924996 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m03:00:09.929735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m03:00:09.932546 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m03:00:09.933902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09f49f5-d256-4ca0-82e3-b759b5ac1ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3bd06ab0>]}
[0m03:00:09.934576 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m03:00:09.935074 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m03:00:09.936380 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:09.936693 [debug] [MainThread]: On master: BEGIN
[0m03:00:09.936965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:09.940947 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:00:09.941291 [debug] [MainThread]: On master: COMMIT
[0m03:00:09.941580 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:09.941844 [debug] [MainThread]: On master: COMMIT
[0m03:00:09.942185 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:09.942486 [debug] [MainThread]: On master: Close
[0m03:00:09.942870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:09.943137 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m03:00:09.943400 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m03:00:09.943672 [info ] [MainThread]: 
[0m03:00:09.943970 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m03:00:09.944541 [debug] [MainThread]: Command end result
[0m03:00:10.020382 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m03:00:10.021956 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m03:00:10.026885 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m03:00:10.027219 [info ] [MainThread]: 
[0m03:00:10.027621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:10.027907 [info ] [MainThread]: 
[0m03:00:10.028227 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:00:10.028749 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:00:10.029638 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0544317, "process_in_blocks": "0", "process_kernel_time": 0.277467, "process_mem_max_rss": "128280", "process_out_blocks": "2760", "process_user_time": 2.026111}
[0m03:00:10.030102 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:00:10.030018 after 1.06 seconds
[0m03:00:10.030467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3a2ed2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a3bd06ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720a39539f70>]}
[0m03:00:10.030805 [debug] [MainThread]: Flushing usage events
[0m03:00:10.436855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:00:02.253152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278ebc0d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278dd51790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278f5a5a90>]}


============================== 04:00:02.257988 | b14fcd0b-2315-481c-94ac-d51cbb551f0e ==============================
[0m04:00:02.257988 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:00:02.258444 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/logs/dbt', 'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:00:02.264593 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m04:00:02.264958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b14fcd0b-2315-481c-94ac-d51cbb551f0e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278c8a1f40>]}
[0m04:00:02.265352 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m04:00:02.265650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b14fcd0b-2315-481c-94ac-d51cbb551f0e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278c8a1f40>]}
[0m04:00:02.366383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b14fcd0b-2315-481c-94ac-d51cbb551f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278d7d46b0>]}
[0m04:00:02.385161 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5xbb8q9m'
[0m04:00:02.385543 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:00:02.593711 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:00:02.594398 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:00:02.683168 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:00:02.686469 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:00:02.931283 [info ] [MainThread]: Installed from version 1.3.0
[0m04:00:02.931716 [info ] [MainThread]: Updated version available: 1.3.3
[0m04:00:02.932038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b14fcd0b-2315-481c-94ac-d51cbb551f0e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278c74ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278c718e60>]}
[0m04:00:02.932390 [info ] [MainThread]: 
[0m04:00:02.932676 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:00:02.933339 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:00:02.934170 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7232852, "process_in_blocks": "0", "process_kernel_time": 0.214744, "process_mem_max_rss": "108452", "process_out_blocks": "2312", "process_user_time": 1.295458}
[0m04:00:02.934627 [debug] [MainThread]: Command `dbt deps` succeeded at 04:00:02.934552 after 0.72 seconds
[0m04:00:02.934920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278cb7d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278d7d46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c278c815070>]}
[0m04:00:02.935208 [debug] [MainThread]: Flushing usage events
[0m04:00:03.440329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:00:04.946603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f08b95d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0862c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f08b94fb0>]}


============================== 04:00:04.951460 | 12911f88-0441-4fd9-aa9c-edd17b33b6e8 ==============================
[0m04:00:04.951460 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:00:04.951900 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'empty': 'False', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'static_parser': 'True', 'target_path': '/opt/airflow/dbt_target', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/logs/dbt', 'warn_error': 'None'}
[0m04:00:04.995799 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m04:00:04.996272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0767ffb0>]}
[0m04:00:04.996723 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m04:00:04.997051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0767ffb0>]}
[0m04:00:05.114732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0a1075f0>]}
[0m04:00:05.172076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f078d8470>]}
[0m04:00:05.172902 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:00:05.285531 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m04:00:05.410337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:00:05.410755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:00:05.415843 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m04:00:05.466489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f069066c0>]}
[0m04:00:05.562922 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:00:05.564545 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:00:05.592300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f069212e0>]}
[0m04:00:05.592766 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m04:00:05.596193 [info ] [MainThread]: 
[0m04:00:05.596584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:00:05.596863 [info ] [MainThread]: 
[0m04:00:05.597330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:00:05.601362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:00:05.601915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:00:05.636760 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:00:05.637156 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:00:05.637485 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:00:05.637794 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:00:05.638094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:05.638385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:05.643748 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m04:00:05.644090 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m04:00:05.645115 [debug] [ThreadPool]: On list_airflow: Close
[0m04:00:05.646047 [debug] [ThreadPool]: On list_airflow: Close
[0m04:00:05.647857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m04:00:05.648337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m04:00:05.652528 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:00:05.653836 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:00:05.654148 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m04:00:05.654442 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:00:05.654711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:05.654983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:05.658629 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:00:05.658965 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:00:05.659224 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:00:05.659547 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m04:00:05.659840 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:00:05.660170 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:00:05.662094 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:05.662398 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m04:00:05.663329 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m04:00:05.664906 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:00:05.665305 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m04:00:05.665546 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:00:05.674823 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:05.675150 [debug] [MainThread]: On master: BEGIN
[0m04:00:05.675431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:00:05.679158 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:00:05.679487 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:05.679810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:00:05.701812 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m04:00:05.702960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f06dd0a70>]}
[0m04:00:05.703414 [debug] [MainThread]: On master: ROLLBACK
[0m04:00:05.703818 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:05.704102 [debug] [MainThread]: On master: BEGIN
[0m04:00:05.704540 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:00:05.704830 [debug] [MainThread]: On master: COMMIT
[0m04:00:05.705095 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:05.705368 [debug] [MainThread]: On master: COMMIT
[0m04:00:05.705707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:00:05.705987 [debug] [MainThread]: On master: Close
[0m04:00:05.709458 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m04:00:05.709908 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m04:00:05.710286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.stg_readings)
[0m04:00:05.710587 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m04:00:05.716355 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m04:00:05.716857 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m04:00:05.745696 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m04:00:05.746311 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:00:05.746620 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m04:00:05.746888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:05.750987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:00:05.751344 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:00:05.751689 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m04:00:05.780641 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.029 seconds
[0m04:00:05.788106 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:00:05.788463 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m04:00:05.788993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:05.791080 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:00:05.791409 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m04:00:05.791859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:05.803492 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m04:00:05.803848 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:00:05.804133 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m04:00:05.824089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m04:00:05.828849 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m04:00:05.833080 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:00:05.833434 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m04:00:05.836576 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:00:05.838441 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m04:00:05.839766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0a253470>]}
[0m04:00:05.840333 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.13s]
[0m04:00:05.840806 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m04:00:05.841659 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:00:05.842062 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:00:05.842429 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m04:00:05.842826 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m04:00:05.843305 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m04:00:05.843714 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m04:00:05.844046 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:00:05.844374 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:00:05.854390 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:00:05.857685 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:00:05.858274 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:00:05.858648 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:00:05.871233 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:00:05.872821 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:00:05.873433 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:00:05.873811 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:00:05.874116 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m04:00:05.874453 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m04:00:05.874763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:00:05.875066 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:00:05.879069 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:00:05.879425 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m04:00:05.879768 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:00:05.880099 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:00:05.880448 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m04:00:05.880784 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m04:00:05.882654 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:05.882982 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:05.885417 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m04:00:05.886511 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m04:00:05.886954 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m04:00:05.887296 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m04:00:05.887803 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.04s]
[0m04:00:05.888317 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:00:05.888719 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.05s]
[0m04:00:05.889351 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:00:05.890044 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m04:00:05.890414 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m04:00:05.890781 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m04:00:05.891167 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m04:00:05.891528 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_sat_readings
[0m04:00:05.891907 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m04:00:05.892339 [info ] [Thread-3 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m04:00:05.892716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m04:00:05.893105 [info ] [Thread-4 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m04:00:05.893482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.dv_hub_well)
[0m04:00:05.895086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_link_well_survey)
[0m04:00:05.895448 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m04:00:05.895771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_sat_readings)
[0m04:00:05.896092 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m04:00:05.896431 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m04:00:05.948178 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m04:00:05.948691 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m04:00:05.951009 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m04:00:05.954094 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m04:00:05.956541 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m04:00:05.957169 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m04:00:05.957629 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m04:00:05.958101 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m04:00:05.960745 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m04:00:05.961137 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m04:00:05.963712 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m04:00:05.966328 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m04:00:05.969005 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m04:00:05.969754 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:00:05.970161 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:00:05.970648 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:00:05.970985 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m04:00:05.971366 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:00:05.971696 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m04:00:05.972023 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m04:00:05.972354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:05.972680 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m04:00:05.972993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:05.973309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:05.973731 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:05.977849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:05.978191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:00:05.978549 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:05.978866 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:00:05.979179 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:05.979550 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:00:05.979889 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:00:05.980243 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m04:00:05.980597 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:00:05.980930 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m04:00:05.981292 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m04:00:05.981705 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m04:00:05.999312 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.018 seconds
[0m04:00:06.002927 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:00:06.003286 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m04:00:06.003587 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.022 seconds
[0m04:00:06.005873 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:00:06.006194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:00:06.006541 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m04:00:06.008552 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:00:06.008944 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m04:00:06.009302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.009630 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.011654 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:00:06.012681 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m04:00:06.013040 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m04:00:06.013382 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:00:06.013740 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m04:00:06.014027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.014366 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.032 seconds
[0m04:00:06.015390 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m04:00:06.015719 [debug] [Thread-4 (]: SQL status: SELECT 9980 in 0.034 seconds
[0m04:00:06.018015 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:00:06.018380 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:00:06.020791 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:00:06.021144 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m04:00:06.021484 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m04:00:06.021805 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m04:00:06.022354 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.022651 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.024644 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:00:06.026705 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:00:06.027063 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m04:00:06.027417 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m04:00:06.027915 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.028244 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.029198 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m04:00:06.030186 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m04:00:06.030553 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:00:06.030881 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:00:06.031195 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m04:00:06.031522 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m04:00:06.048331 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m04:00:06.050166 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m04:00:06.050503 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m04:00:06.050840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m04:00:06.051188 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m04:00:06.051712 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:00:06.054433 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m04:00:06.056325 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m04:00:06.057985 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m04:00:06.058353 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m04:00:06.058825 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:00:06.059336 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:00:06.059810 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:00:06.060207 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m04:00:06.060556 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m04:00:06.060890 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m04:00:06.062267 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:00:06.063308 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m04:00:06.063826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0559a750>]}
[0m04:00:06.064361 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.17s]
[0m04:00:06.064822 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m04:00:06.065321 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m04:00:06.065769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m04:00:06.066793 [debug] [Thread-3 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m04:00:06.067108 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:00:06.068096 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m04:00:06.068404 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m04:00:06.068797 [info ] [Thread-2 (]: 8 of 33 START test not_null_dv_hub_well_hk_well ................................ [RUN]
[0m04:00:06.069240 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f08a36db0>]}
[0m04:00:06.069697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1effed9a60>]}
[0m04:00:06.070715 [debug] [Thread-4 (]: On model.caspian_vault.dv_sat_readings: Close
[0m04:00:06.071058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m04:00:06.071568 [info ] [Thread-3 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.18s]
[0m04:00:06.072105 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.18s]
[0m04:00:06.072548 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:00:06.072943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1effe26bd0>]}
[0m04:00:06.073448 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m04:00:06.073883 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m04:00:06.078788 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:00:06.079338 [info ] [Thread-4 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.18s]
[0m04:00:06.079764 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:00:06.080200 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:00:06.081018 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m04:00:06.081386 [info ] [Thread-3 (]: 9 of 33 START test not_null_dv_hub_well_well_id_bk ............................. [RUN]
[0m04:00:06.081775 [info ] [Thread-1 (]: 10 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m04:00:06.082153 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:00:06.082511 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:00:06.082963 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m04:00:06.083331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m04:00:06.084942 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:00:06.085309 [info ] [Thread-4 (]: 11 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m04:00:06.085656 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:00:06.085968 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:00:06.086390 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m04:00:06.089179 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:00:06.089556 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:00:06.093786 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:00:06.094153 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:00:06.094585 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m04:00:06.095009 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:00:06.097716 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:00:06.098107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.098468 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:00:06.100085 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:00:06.100700 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:00:06.103333 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:00:06.104977 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:00:06.105523 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:00:06.105962 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m04:00:06.106482 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:00:06.106789 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m04:00:06.107155 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:00:06.107495 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:00:06.107816 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m04:00:06.108125 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.108462 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m04:00:06.108787 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.109102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:06.109532 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:06.110388 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.111581 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m04:00:06.111990 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m04:00:06.112493 [info ] [Thread-2 (]: 8 of 33 PASS not_null_dv_hub_well_hk_well ...................................... [[32mPASS[0m in 0.04s]
[0m04:00:06.112993 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:00:06.113302 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.113701 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:00:06.114163 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:00:06.114523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.114903 [info ] [Thread-2 (]: 12 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m04:00:06.115269 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m04:00:06.115598 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.115936 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:00:06.116289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m04:00:06.116624 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:00:06.117008 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:00:06.117354 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:00:06.117670 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.118004 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.120939 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:00:06.121341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:00:06.122445 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m04:00:06.123655 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m04:00:06.124025 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.124413 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:00:06.124794 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m04:00:06.125132 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m04:00:06.126149 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m04:00:06.127892 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:00:06.128460 [info ] [Thread-3 (]: 9 of 33 PASS not_null_dv_hub_well_well_id_bk ................................... [[32mPASS[0m in 0.05s]
[0m04:00:06.128950 [info ] [Thread-1 (]: 10 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.05s]
[0m04:00:06.129448 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m04:00:06.129969 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:00:06.130480 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:00:06.130813 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:00:06.131340 [info ] [Thread-4 (]: 11 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m04:00:06.131710 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:00:06.132120 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:00:06.132564 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m04:00:06.132998 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:00:06.133334 [info ] [Thread-3 (]: 13 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m04:00:06.133701 [info ] [Thread-1 (]: 14 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m04:00:06.134049 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.134401 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:00:06.134771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m04:00:06.135118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m04:00:06.135572 [info ] [Thread-4 (]: 15 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m04:00:06.135917 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:00:06.136268 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:00:06.136606 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m04:00:06.139315 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:00:06.145019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m04:00:06.145412 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:00:06.145768 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:00:06.146174 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:00:06.146566 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:00:06.149362 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:00:06.149770 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.150137 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:00:06.151674 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:00:06.152214 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:00:06.153742 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:00:06.154107 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:06.156730 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:00:06.157231 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:00:06.158404 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m04:00:06.158907 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m04:00:06.159244 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:00:06.159708 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:00:06.160038 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.160332 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m04:00:06.160676 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m04:00:06.160999 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m04:00:06.161474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:06.161903 [info ] [Thread-2 (]: 12 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.05s]
[0m04:00:06.162289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:06.162837 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:00:06.163315 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:00:06.163696 [info ] [Thread-2 (]: 16 of 33 START test not_null_dv_hub_survey_type_hk_survey_type ................. [RUN]
[0m04:00:06.164044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m04:00:06.164354 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:00:06.167084 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:00:06.167435 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.167913 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:00:06.168226 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m04:00:06.168577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.168963 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.169342 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:00:06.169654 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:00:06.169996 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:00:06.171608 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:00:06.171985 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:00:06.172314 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:06.172681 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.173992 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m04:00:06.174353 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.174716 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:00:06.175888 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m04:00:06.176276 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m04:00:06.176583 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m04:00:06.176893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:06.177329 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m04:00:06.177627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.178043 [info ] [Thread-3 (]: 13 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.04s]
[0m04:00:06.179143 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m04:00:06.179741 [info ] [Thread-4 (]: 15 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m04:00:06.180239 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:00:06.180742 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:00:06.181040 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m04:00:06.181427 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:00:06.181825 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:00:06.182237 [info ] [Thread-3 (]: 17 of 33 START test not_null_dv_hub_survey_type_survey_type_bk ................. [RUN]
[0m04:00:06.182695 [info ] [Thread-1 (]: 14 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.05s]
[0m04:00:06.183092 [info ] [Thread-4 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m04:00:06.183440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:00:06.183801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m04:00:06.184260 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:00:06.184592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m04:00:06.184927 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:00:06.185267 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:00:06.185613 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:00:06.185976 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:00:06.186325 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.189194 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:00:06.189570 [info ] [Thread-1 (]: 19 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m04:00:06.193473 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:00:06.193994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m04:00:06.194399 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:00:06.194717 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.195090 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:00:06.195471 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:00:06.197001 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:00:06.198128 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m04:00:06.200795 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:00:06.202437 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:00:06.203041 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m04:00:06.203531 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:00:06.204041 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m04:00:06.204464 [info ] [Thread-2 (]: 16 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ....................... [[32mPASS[0m in 0.04s]
[0m04:00:06.204871 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:00:06.205194 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.205540 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:00:06.205977 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:00:06.206307 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m04:00:06.207959 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:00:06.208346 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:00:06.208709 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:06.209128 [info ] [Thread-2 (]: 20 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m04:00:06.209663 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:00:06.210007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m04:00:06.210379 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m04:00:06.210702 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.211036 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:00:06.211353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:06.211676 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:00:06.214425 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:00:06.214932 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.215277 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.215829 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:00:06.216152 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:00:06.216500 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.216818 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.219443 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:00:06.220621 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m04:00:06.220960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m04:00:06.221548 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:00:06.221848 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m04:00:06.222258 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:00:06.222580 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:00:06.222904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:06.223414 [info ] [Thread-3 (]: 17 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ....................... [[32mPASS[0m in 0.04s]
[0m04:00:06.223751 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m04:00:06.224864 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m04:00:06.225189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:00:06.225638 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:00:06.225945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.227035 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m04:00:06.227359 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m04:00:06.227704 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:00:06.228278 [info ] [Thread-3 (]: 21 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m04:00:06.228783 [info ] [Thread-4 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.04s]
[0m04:00:06.229158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m04:00:06.229501 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m04:00:06.229959 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:00:06.230307 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:00:06.230715 [debug] [Thread-4 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:00:06.231117 [info ] [Thread-1 (]: 19 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m04:00:06.233955 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:00:06.234339 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m04:00:06.234648 [info ] [Thread-4 (]: 22 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m04:00:06.235114 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:00:06.235510 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:00:06.235868 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:00:06.236221 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m04:00:06.236596 [debug] [Thread-1 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:00:06.237042 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.238619 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:00:06.238966 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:00:06.239300 [info ] [Thread-1 (]: 23 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m04:00:06.242197 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:00:06.242680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m04:00:06.243007 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:00:06.243356 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:00:06.243799 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:00:06.244181 [debug] [Thread-4 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:00:06.245289 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m04:00:06.245636 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m04:00:06.249464 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:00:06.251021 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:00:06.251421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.251717 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m04:00:06.252477 [debug] [Thread-1 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:00:06.252911 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:00:06.254934 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:00:06.253447 [info ] [Thread-2 (]: 20 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.04s]
[0m04:00:06.255384 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m04:00:06.255949 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:00:06.256306 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.256713 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:00:06.257013 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:06.257380 [debug] [Thread-2 (]: Began running node test.caspian_vault.test_counts_match
[0m04:00:06.257760 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:00:06.258106 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m04:00:06.258557 [info ] [Thread-2 (]: 24 of 33 START test test_counts_match .......................................... [RUN]
[0m04:00:06.259001 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.259355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:06.259708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.test_counts_match)
[0m04:00:06.260195 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.test_counts_match
[0m04:00:06.262354 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m04:00:06.262693 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:00:06.263928 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m04:00:06.264325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.264761 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:00:06.265104 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m04:00:06.265428 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.265744 [debug] [Thread-2 (]: Began executing node test.caspian_vault.test_counts_match
[0m04:00:06.266076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.266648 [info ] [Thread-3 (]: 21 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m04:00:06.268275 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m04:00:06.268645 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:00:06.268952 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:06.269403 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:00:06.269828 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m04:00:06.270937 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m04:00:06.271374 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_well
[0m04:00:06.271796 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m04:00:06.272296 [info ] [Thread-3 (]: 25 of 33 START sql table model public.dim_well ................................. [RUN]
[0m04:00:06.272615 [debug] [Thread-4 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m04:00:06.272950 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m04:00:06.273300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now model.caspian_vault.dim_well)
[0m04:00:06.273665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.274068 [info ] [Thread-4 (]: 22 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m04:00:06.274465 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_well
[0m04:00:06.274776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:00:06.275367 [debug] [Thread-4 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:00:06.278674 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m04:00:06.279847 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m04:00:06.280241 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_survey_type
[0m04:00:06.280552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.281134 [info ] [Thread-4 (]: 26 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m04:00:06.281579 [debug] [Thread-1 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m04:00:06.281893 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m04:00:06.282267 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_well
[0m04:00:06.282600 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now model.caspian_vault.dim_survey_type)
[0m04:00:06.282993 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m04:00:06.283430 [info ] [Thread-1 (]: 23 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.04s]
[0m04:00:06.286174 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m04:00:06.286545 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m04:00:06.287043 [debug] [Thread-1 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:00:06.289094 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m04:00:06.289460 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:00:06.290767 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m04:00:06.291151 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:00:06.291571 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_survey_type
[0m04:00:06.291902 [debug] [Thread-2 (]: On test.caspian_vault.test_counts_match: Close
[0m04:00:06.292203 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: BEGIN
[0m04:00:06.294830 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m04:00:06.295223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.295639 [info ] [Thread-2 (]: 24 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m04:00:06.296365 [debug] [Thread-2 (]: Finished running node test.caspian_vault.test_counts_match
[0m04:00:06.296810 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:00:06.297292 [debug] [Thread-1 (]: Began running node model.caspian_vault.dim_source_format
[0m04:00:06.297596 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m04:00:06.297901 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_time
[0m04:00:06.298318 [info ] [Thread-1 (]: 27 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m04:00:06.298669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:06.299060 [info ] [Thread-2 (]: 28 of 33 START sql table model public.dim_time ................................. [RUN]
[0m04:00:06.299477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now model.caspian_vault.dim_source_format)
[0m04:00:06.299800 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.300260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now model.caspian_vault.dim_time)
[0m04:00:06.300588 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dim_source_format
[0m04:00:06.300936 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:00:06.301279 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_time
[0m04:00:06.303260 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m04:00:06.303664 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m04:00:06.304001 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.305987 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m04:00:06.306542 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:00:06.306851 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dim_source_format
[0m04:00:06.307292 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m04:00:06.307668 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_time
[0m04:00:06.310256 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m04:00:06.312864 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m04:00:06.313572 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:00:06.313944 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.008 seconds
[0m04:00:06.314241 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m04:00:06.314580 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:00:06.317838 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:00:06.318180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:06.318544 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.008 seconds
[0m04:00:06.318845 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: BEGIN
[0m04:00:06.319186 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m04:00:06.321571 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:00:06.321905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.322296 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m04:00:06.322616 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.324809 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:00:06.325142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:00:06.325539 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:00:06.325866 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m04:00:06.326232 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:00:06.326568 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.328670 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:00:06.329084 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m04:00:06.329436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.329747 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:00:06.330083 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m04:00:06.331145 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m04:00:06.331509 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m04:00:06.332004 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:00:06.332374 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:00:06.332693 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m04:00:06.333742 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m04:00:06.334262 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:00:06.334554 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m04:00:06.341543 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m04:00:06.343213 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m04:00:06.343587 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m04:00:06.343894 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m04:00:06.344191 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m04:00:06.344639 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:00:06.346968 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:00:06.349295 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:00:06.350988 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m04:00:06.351348 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m04:00:06.351684 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m04:00:06.352025 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m04:00:06.352501 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:00:06.352962 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m04:00:06.353350 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.353652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:00:06.355700 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:00:06.357753 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:00:06.358071 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m04:00:06.358439 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m04:00:06.358803 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m04:00:06.359136 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m04:00:06.360153 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: Close
[0m04:00:06.361185 [debug] [Thread-4 (]: On model.caspian_vault.dim_survey_type: Close
[0m04:00:06.361846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f06d171a0>]}
[0m04:00:06.362286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:00:06.362721 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd4f35c0>]}
[0m04:00:06.363086 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:00:06.363588 [info ] [Thread-3 (]: 25 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.09s]
[0m04:00:06.364663 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m04:00:06.365166 [info ] [Thread-4 (]: 26 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.08s]
[0m04:00:06.367372 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: COMMIT
[0m04:00:06.367835 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_well
[0m04:00:06.368160 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:00:06.368616 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_survey_type
[0m04:00:06.368928 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:00:06.369298 [debug] [Thread-3 (]: Began running node model.caspian_vault.fct_readings
[0m04:00:06.369657 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m04:00:06.370054 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: COMMIT
[0m04:00:06.370441 [info ] [Thread-3 (]: 29 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m04:00:06.370930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now model.caspian_vault.fct_readings)
[0m04:00:06.371220 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.fct_readings
[0m04:00:06.373516 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m04:00:06.373838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m04:00:06.375524 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m04:00:06.375891 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m04:00:06.376348 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:00:06.378004 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m04:00:06.378407 [debug] [Thread-3 (]: Began executing node model.caspian_vault.fct_readings
[0m04:00:06.378731 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m04:00:06.379194 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:00:06.381822 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m04:00:06.382220 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m04:00:06.382750 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:00:06.383059 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: BEGIN
[0m04:00:06.383351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.384205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:00:06.385210 [debug] [Thread-1 (]: On model.caspian_vault.dim_source_format: Close
[0m04:00:06.385527 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:00:06.386553 [debug] [Thread-2 (]: On model.caspian_vault.dim_time: Close
[0m04:00:06.386943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd32bda0>]}
[0m04:00:06.387436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd4a4380>]}
[0m04:00:06.387917 [info ] [Thread-1 (]: 27 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.09s]
[0m04:00:06.388278 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.388765 [info ] [Thread-2 (]: 28 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.09s]
[0m04:00:06.389260 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dim_source_format
[0m04:00:06.389582 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:00:06.390013 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_time
[0m04:00:06.390459 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m04:00:06.407002 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.016 seconds
[0m04:00:06.409617 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:00:06.409943 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m04:00:06.410463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.412456 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:00:06.412774 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m04:00:06.413283 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.414232 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m04:00:06.414565 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:00:06.414842 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: COMMIT
[0m04:00:06.424678 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m04:00:06.426374 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m04:00:06.426885 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:00:06.427184 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m04:00:06.431890 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m04:00:06.432965 [debug] [Thread-3 (]: On model.caspian_vault.fct_readings: Close
[0m04:00:06.433456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1effd50bf0>]}
[0m04:00:06.433949 [info ] [Thread-3 (]: 29 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.06s]
[0m04:00:06.434412 [debug] [Thread-3 (]: Finished running node model.caspian_vault.fct_readings
[0m04:00:06.435166 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m04:00:06.435537 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_survey_summary
[0m04:00:06.435926 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_well_performance
[0m04:00:06.436341 [info ] [Thread-4 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m04:00:06.436786 [info ] [Thread-1 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m04:00:06.437224 [info ] [Thread-2 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m04:00:06.437629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.mart_sensor_analysis)
[0m04:00:06.437983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_survey_summary)
[0m04:00:06.438337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_well_performance)
[0m04:00:06.438675 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m04:00:06.438999 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m04:00:06.439329 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m04:00:06.441557 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.443569 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m04:00:06.446846 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m04:00:06.447490 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m04:00:06.447890 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m04:00:06.450563 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.450984 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_well_performance
[0m04:00:06.453451 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m04:00:06.456115 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m04:00:06.456582 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.457102 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m04:00:06.457520 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:00:06.457832 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:00:06.458162 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:00:06.458519 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m04:00:06.458957 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m04:00:06.459294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:06.459628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:00:06.462661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.462997 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.463368 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m04:00:06.463686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:00:06.464128 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:00:06.464459 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:00:06.464811 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m04:00:06.465146 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:00:06.465539 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m04:00:06.474188 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.010 seconds
[0m04:00:06.476722 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.477046 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m04:00:06.477412 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.011 seconds
[0m04:00:06.477751 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.480025 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:00:06.482130 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.482486 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.017 seconds
[0m04:00:06.482832 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m04:00:06.483173 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m04:00:06.485467 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:00:06.485922 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m04:00:06.486275 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:00:06.486605 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:00:06.488682 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:00:06.488998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:00:06.489985 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m04:00:06.490344 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m04:00:06.493225 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:00:06.493605 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.493992 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m04:00:06.494339 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m04:00:06.494637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:00:06.495700 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m04:00:06.496007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:00:06.496351 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:00:06.497406 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m04:00:06.497736 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m04:00:06.498066 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:00:06.498389 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m04:00:06.498783 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m04:00:06.500418 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m04:00:06.500771 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m04:00:06.501240 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:00:06.502857 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m04:00:06.503217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:00:06.503530 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m04:00:06.503981 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:00:06.505666 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m04:00:06.506058 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m04:00:06.506522 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:00:06.506897 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m04:00:06.507973 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:00:06.509007 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m04:00:06.509326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:00:06.509695 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:00:06.510172 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd37a750>]}
[0m04:00:06.511227 [debug] [Thread-1 (]: On model.caspian_vault.mart_survey_summary: Close
[0m04:00:06.512222 [debug] [Thread-2 (]: On model.caspian_vault.mart_well_performance: Close
[0m04:00:06.512764 [info ] [Thread-4 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.07s]
[0m04:00:06.513302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd341610>]}
[0m04:00:06.513762 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd3bbe00>]}
[0m04:00:06.514237 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m04:00:06.514729 [info ] [Thread-1 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.08s]
[0m04:00:06.515239 [info ] [Thread-2 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.08s]
[0m04:00:06.515853 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m04:00:06.516291 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_well_performance
[0m04:00:06.517054 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:06.517497 [info ] [Thread-3 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m04:00:06.517859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now snapshot.caspian_vault.snap_mart_well_performance)
[0m04:00:06.518164 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:06.520582 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:06.555538 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.555934 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m04:00:06.556223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:00:06.560466 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:00:06.560812 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.561118 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:00:06.566308 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m04:00:06.596614 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.597061 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp040006595928"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m04:00:06.599444 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.002 seconds
[0m04:00:06.602675 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.603017 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp040006595928'
        
      order by ordinal_position

  
[0m04:00:06.605373 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:00:06.607594 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.607950 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:00:06.609795 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.002 seconds
[0m04:00:06.611978 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.612324 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp040006595928'
        
      order by ordinal_position

  
[0m04:00:06.614109 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m04:00:06.616310 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.616643 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:00:06.618391 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m04:00:06.623198 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.623567 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp040006595928'
        
      order by ordinal_position

  
[0m04:00:06.625416 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:00:06.638223 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.638663 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m04:00:06.639382 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:00:06.643187 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.643541 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m04:00:06.644042 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:00:06.644477 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.644960 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.645334 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp040006595928" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp040006595928" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m04:00:06.646234 [debug] [Thread-3 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m04:00:06.647187 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:00:06.647511 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:06.647784 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:00:06.649763 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m04:00:06.651735 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m04:00:06.652262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12911f88-0441-4fd9-aa9c-edd17b33b6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1efd3c4920>]}
[0m04:00:06.652892 [info ] [Thread-3 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.13s]
[0m04:00:06.653382 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:06.654676 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:06.655005 [debug] [MainThread]: On master: BEGIN
[0m04:00:06.655297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:00:06.659077 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:00:06.659420 [debug] [MainThread]: On master: COMMIT
[0m04:00:06.659708 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:06.659974 [debug] [MainThread]: On master: COMMIT
[0m04:00:06.660325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:00:06.660609 [debug] [MainThread]: On master: Close
[0m04:00:06.660981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:00:06.661263 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m04:00:06.661511 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m04:00:06.661741 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m04:00:06.661971 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m04:00:06.662328 [info ] [MainThread]: 
[0m04:00:06.662637 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m04:00:06.666207 [debug] [MainThread]: Command end result
[0m04:00:06.691709 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:00:06.693238 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:00:06.699224 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m04:00:06.699581 [info ] [MainThread]: 
[0m04:00:06.699920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:00:06.700218 [info ] [MainThread]: 
[0m04:00:06.700537 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m04:00:06.701063 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:00:06.701929 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7974286, "process_in_blocks": "0", "process_kernel_time": 0.354554, "process_mem_max_rss": "134972", "process_out_blocks": "3616", "process_user_time": 2.615709}
[0m04:00:06.702422 [debug] [MainThread]: Command `dbt build` succeeded at 04:00:06.702340 after 1.80 seconds
[0m04:00:06.702753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f055c2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f061a6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f06946660>]}
[0m04:00:06.703089 [debug] [MainThread]: Flushing usage events
[0m04:00:07.227038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:00:08.789548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680281b6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680295e0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768029817ec0>]}


============================== 04:00:08.794422 | b28f79d6-e113-4df7-8a0a-c15aeb93b54b ==============================
[0m04:00:08.794422 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:00:08.794865 [debug] [MainThread]: running dbt with arguments {'target_path': '/opt/airflow/dbt_target', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/opt/airflow/logs/dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'empty': 'False', 'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m04:00:08.839188 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m04:00:08.839671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768026942ea0>]}
[0m04:00:08.840117 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m04:00:08.840467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768025d47590>]}
[0m04:00:08.959130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768025d5c3b0>]}
[0m04:00:09.016865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768026876360>]}
[0m04:00:09.017679 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:00:09.129974 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m04:00:09.255006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:00:09.255447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:00:09.260578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m04:00:09.311159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680259558e0>]}
[0m04:00:09.408882 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:00:09.410541 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:00:09.428465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768024976c30>]}
[0m04:00:09.428920 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m04:00:09.429260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76802494ee40>]}
[0m04:00:09.431193 [info ] [MainThread]: 
[0m04:00:09.431585 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:00:09.431872 [info ] [MainThread]: 
[0m04:00:09.432350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:00:09.433196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:00:09.465736 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:00:09.466092 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:00:09.466396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:09.471702 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m04:00:09.472725 [debug] [ThreadPool]: On list_airflow: Close
[0m04:00:09.476902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m04:00:09.477466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m04:00:09.481611 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:00:09.483742 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:00:09.484071 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m04:00:09.484379 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:00:09.484727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:09.485002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:09.488776 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:00:09.489125 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:00:09.489410 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:00:09.489728 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m04:00:09.490034 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:00:09.490396 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:00:09.492322 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m04:00:09.493286 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m04:00:09.493583 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.003 seconds
[0m04:00:09.495106 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:00:09.495388 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m04:00:09.495771 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:00:09.505275 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:09.505603 [debug] [MainThread]: On master: BEGIN
[0m04:00:09.505865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:00:09.509479 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:00:09.509797 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:09.510121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:00:09.532242 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m04:00:09.533520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768026942f30>]}
[0m04:00:09.533961 [debug] [MainThread]: On master: ROLLBACK
[0m04:00:09.534395 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:09.534703 [debug] [MainThread]: On master: BEGIN
[0m04:00:09.535136 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:00:09.535459 [debug] [MainThread]: On master: COMMIT
[0m04:00:09.535727 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:09.535982 [debug] [MainThread]: On master: COMMIT
[0m04:00:09.536329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:00:09.536615 [debug] [MainThread]: On master: Close
[0m04:00:09.540031 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:09.540492 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m04:00:09.540852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now snapshot.caspian_vault.snap_mart_well_performance)
[0m04:00:09.541147 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:09.546639 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:09.584557 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.584949 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m04:00:09.585238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:00:09.588965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:00:09.589311 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.589613 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:00:09.594699 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m04:00:09.633431 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.633906 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp040009627992"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m04:00:09.636400 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m04:00:09.639396 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.639738 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp040009627992'
        
      order by ordinal_position

  
[0m04:00:09.642132 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:00:09.644371 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.644709 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:00:09.646499 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m04:00:09.648676 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.649006 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp040009627992'
        
      order by ordinal_position

  
[0m04:00:09.650800 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m04:00:09.653039 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.653383 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:00:09.655125 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m04:00:09.659804 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.660148 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp040009627992'
        
      order by ordinal_position

  
[0m04:00:09.662027 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:00:09.674879 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.675312 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m04:00:09.676010 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:00:09.679832 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.680178 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m04:00:09.680710 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:00:09.681136 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.681652 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.682011 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp040009627992" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp040009627992" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m04:00:09.682952 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m04:00:09.693314 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:00:09.693677 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:00:09.693963 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:00:09.696191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:00:09.698967 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m04:00:09.700322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28f79d6-e113-4df7-8a0a-c15aeb93b54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76802954adb0>]}
[0m04:00:09.700979 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.16s]
[0m04:00:09.701492 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:00:09.702805 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:09.703132 [debug] [MainThread]: On master: BEGIN
[0m04:00:09.703431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:00:09.707394 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:00:09.707714 [debug] [MainThread]: On master: COMMIT
[0m04:00:09.707991 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:09.708264 [debug] [MainThread]: On master: COMMIT
[0m04:00:09.708616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:00:09.708896 [debug] [MainThread]: On master: Close
[0m04:00:09.709290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:00:09.709558 [debug] [MainThread]: Connection 'list_airflow_snapshots' was properly closed.
[0m04:00:09.709794 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m04:00:09.710064 [info ] [MainThread]: 
[0m04:00:09.710376 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m04:00:09.710945 [debug] [MainThread]: Command end result
[0m04:00:09.784724 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:00:09.786277 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:00:09.791131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m04:00:09.791491 [info ] [MainThread]: 
[0m04:00:09.791862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:00:09.792138 [info ] [MainThread]: 
[0m04:00:09.792455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:00:09.792938 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:00:09.793812 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0465732, "process_in_blocks": "0", "process_kernel_time": 0.26957, "process_mem_max_rss": "128416", "process_out_blocks": "2760", "process_user_time": 2.034759}
[0m04:00:09.794281 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:00:09.794183 after 1.05 seconds
[0m04:00:09.794613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76802785ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768027d0e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76802090eb40>]}
[0m04:00:09.794936 [debug] [MainThread]: Flushing usage events
[0m04:00:10.219925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:17:18.788024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892c34bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892c1801d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892cde3aa0>]}


============================== 04:17:18.793025 | b8705846-5cce-40ea-a7a0-2c1a5dbc6f1b ==============================
[0m04:17:18.793025 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:17:18.793489 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/logs/dbt', 'invocation_command': 'dbt deps --profile caspian_vault --target dev', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m04:17:18.799628 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m04:17:18.800001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8705846-5cce-40ea-a7a0-2c1a5dbc6f1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892c2ac7a0>]}
[0m04:17:18.800416 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m04:17:18.800721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8705846-5cce-40ea-a7a0-2c1a5dbc6f1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892c2ac7a0>]}
[0m04:17:18.901742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8705846-5cce-40ea-a7a0-2c1a5dbc6f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892c1a9130>]}
[0m04:17:18.920759 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v9meghzi'
[0m04:17:18.921125 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:17:19.057293 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:17:19.057969 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:17:19.206282 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:17:19.209663 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:17:19.438634 [info ] [MainThread]: Installed from version 1.3.0
[0m04:17:19.439075 [info ] [MainThread]: Updated version available: 1.3.3
[0m04:17:19.439435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b8705846-5cce-40ea-a7a0-2c1a5dbc6f1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892c041e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892bd77a40>]}
[0m04:17:19.439779 [info ] [MainThread]: 
[0m04:17:19.440073 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:17:19.440805 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:17:19.441673 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6957353, "process_in_blocks": "0", "process_kernel_time": 0.196918, "process_mem_max_rss": "107868", "process_out_blocks": "2304", "process_user_time": 1.331446}
[0m04:17:19.442114 [debug] [MainThread]: Command `dbt deps` succeeded at 04:17:19.442036 after 0.70 seconds
[0m04:17:19.442438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79892d0ddbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79893052b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79893052b170>]}
[0m04:17:19.442739 [debug] [MainThread]: Flushing usage events
[0m04:17:19.956279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:17:21.448807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f85ce510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f7f82b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f84b38f0>]}


============================== 04:17:21.453691 | 753dee64-fd66-4425-8bdb-0d34555d9d43 ==============================
[0m04:17:21.453691 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:17:21.454140 [debug] [MainThread]: running dbt with arguments {'target_path': '/opt/airflow/dbt_target', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'log_path': '/opt/airflow/logs/dbt', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt build --profile caspian_vault --target dev', 'warn_error': 'None'}
[0m04:17:21.498073 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m04:17:21.498573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f70bbfb0>]}
[0m04:17:21.499029 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m04:17:21.499382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f6f67ec0>]}
[0m04:17:21.617656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f6764410>]}
[0m04:17:21.675373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f97922a0>]}
[0m04:17:21.676174 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:17:21.791230 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m04:17:21.915888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:17:21.916331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:17:21.921492 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m04:17:21.972169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f5b33b30>]}
[0m04:17:22.071011 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:17:22.072649 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:17:22.100304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f6374770>]}
[0m04:17:22.100780 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m04:17:22.104216 [info ] [MainThread]: 
[0m04:17:22.104612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:17:22.104900 [info ] [MainThread]: 
[0m04:17:22.105383 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:17:22.109401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:17:22.109953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:17:22.144837 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:17:22.145211 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:17:22.145563 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:17:22.145880 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:17:22.146182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:22.146479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:22.151910 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m04:17:22.152262 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.006 seconds
[0m04:17:22.153265 [debug] [ThreadPool]: On list_airflow: Close
[0m04:17:22.154239 [debug] [ThreadPool]: On list_airflow: Close
[0m04:17:22.156194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m04:17:22.156641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m04:17:22.160955 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:17:22.162275 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:17:22.162602 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:17:22.162902 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m04:17:22.163183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:17:22.163473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:17:22.167120 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.167477 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:17:22.167746 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.168066 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:17:22.168395 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:17:22.168761 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m04:17:22.170714 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m04:17:22.170972 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m04:17:22.172635 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:17:22.173563 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m04:17:22.173956 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:17:22.174206 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m04:17:22.183699 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:22.184045 [debug] [MainThread]: On master: BEGIN
[0m04:17:22.184333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:17:22.188039 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.188382 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:22.188726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:17:22.210598 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m04:17:22.211775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f6f67bf0>]}
[0m04:17:22.212217 [debug] [MainThread]: On master: ROLLBACK
[0m04:17:22.212646 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:22.212951 [debug] [MainThread]: On master: BEGIN
[0m04:17:22.213389 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:17:22.213687 [debug] [MainThread]: On master: COMMIT
[0m04:17:22.213962 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:22.214225 [debug] [MainThread]: On master: COMMIT
[0m04:17:22.214587 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:17:22.214880 [debug] [MainThread]: On master: Close
[0m04:17:22.218330 [debug] [Thread-1 (]: Began running node model.caspian_vault.stg_readings
[0m04:17:22.218796 [info ] [Thread-1 (]: 1 of 33 START sql table model public.stg_readings .............................. [RUN]
[0m04:17:22.219171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_snapshots, now model.caspian_vault.stg_readings)
[0m04:17:22.219493 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.stg_readings
[0m04:17:22.225219 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.stg_readings"
[0m04:17:22.225759 [debug] [Thread-1 (]: Began executing node model.caspian_vault.stg_readings
[0m04:17:22.254690 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.stg_readings"
[0m04:17:22.255295 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:17:22.255611 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: BEGIN
[0m04:17:22.255896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.259944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.260296 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:17:22.260652 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */

  
    

  create  table "airflow"."public"."stg_readings__dbt_tmp"
  
  
    as
  
  (
    

with sgx as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'sgx'                               as source_format,
        cast(source_file as varchar)        as source_file
    from "airflow"."public"."raw_sgx_all"
),
p1 as (
    -- If columns differ, adjust here after you inspect schema
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings.parquet' as source_file
    from "airflow"."public"."raw_recovered_1"
),
p2 as (
    select
        cast(well_id as bigint)            as well_id,
        cast(survey_type_id as bigint)     as survey_type_id,
        cast(depth_ft as double precision)           as depth_ft,
        cast(amplitude as double precision)          as amplitude,
        cast(quality_flag as int)          as quality_flag,
        'parquet_recovered'                as source_format,
        'archive_batch_seismic_readings_2.parquet' as source_file
    from "airflow"."public"."raw_recovered_2"
),

unioned as (
    select * from sgx
    union all
    select * from p1
    union all
    select * from p2
)

select
    *,
    current_timestamp as ingest_ts,
    -- simple deterministic checksum (DuckDB supports md5)
    md5(
      cast(well_id as varchar) || '|' ||
      cast(survey_type_id as varchar) || '|' ||
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_file || '|' || source_format
    ) as row_checksum
from unioned
  );
  
[0m04:17:22.290739 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.030 seconds
[0m04:17:22.298310 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:17:22.298661 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings" rename to "stg_readings__dbt_backup"
[0m04:17:22.299224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.301340 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:17:22.301665 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
alter table "airflow"."public"."stg_readings__dbt_tmp" rename to "stg_readings"
[0m04:17:22.302119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.313740 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m04:17:22.314151 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:17:22.314479 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: COMMIT
[0m04:17:22.328872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m04:17:22.333615 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_readings__dbt_backup"
[0m04:17:22.337738 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.stg_readings"
[0m04:17:22.338079 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.stg_readings"} */
drop table if exists "airflow"."public"."stg_readings__dbt_backup" cascade
[0m04:17:22.341866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:17:22.343766 [debug] [Thread-1 (]: On model.caspian_vault.stg_readings: Close
[0m04:17:22.345122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ef769580>]}
[0m04:17:22.345685 [info ] [Thread-1 (]: 1 of 33 OK created sql table model public.stg_readings ......................... [[32mSELECT 9980[0m in 0.13s]
[0m04:17:22.346169 [debug] [Thread-1 (]: Finished running node model.caspian_vault.stg_readings
[0m04:17:22.347064 [debug] [Thread-3 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:17:22.347447 [debug] [Thread-4 (]: Began running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:17:22.347846 [info ] [Thread-3 (]: 2 of 33 START test dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [RUN]
[0m04:17:22.348239 [info ] [Thread-4 (]: 3 of 33 START test dbt_utils_expression_is_true_stg_readings_well_id_is_not_null  [RUN]
[0m04:17:22.348729 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969'
[0m04:17:22.349138 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd'
[0m04:17:22.349489 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:17:22.349810 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:17:22.360053 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:17:22.363387 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:17:22.363983 [debug] [Thread-3 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:17:22.369452 [debug] [Thread-4 (]: Began executing node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:17:22.377012 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:17:22.378596 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:17:22.379229 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:17:22.379622 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:17:22.379933 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: BEGIN
[0m04:17:22.380279 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: BEGIN
[0m04:17:22.380599 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:17:22.380907 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:17:22.384867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.385242 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.385575 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"
[0m04:17:22.385909 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"
[0m04:17:22.386259 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(survey_type_id is not null)


  
  
      
    ) dbt_internal_test
[0m04:17:22.386604 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "airflow"."public"."stg_readings"

where not(well_id is not null)


  
  
      
    ) dbt_internal_test
[0m04:17:22.388439 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.388760 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:17:22.391362 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: ROLLBACK
[0m04:17:22.392457 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: ROLLBACK
[0m04:17:22.392902 [debug] [Thread-4 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd: Close
[0m04:17:22.393231 [debug] [Thread-3 (]: On test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969: Close
[0m04:17:22.393759 [info ] [Thread-4 (]: 3 of 33 PASS dbt_utils_expression_is_true_stg_readings_well_id_is_not_null ..... [[32mPASS[0m in 0.04s]
[0m04:17:22.394272 [info ] [Thread-3 (]: 2 of 33 PASS dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null  [[32mPASS[0m in 0.05s]
[0m04:17:22.394731 [debug] [Thread-4 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd
[0m04:17:22.395162 [debug] [Thread-3 (]: Finished running node test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969
[0m04:17:22.396005 [debug] [Thread-1 (]: Began running node model.caspian_vault.dv_hub_survey_type
[0m04:17:22.396364 [debug] [Thread-2 (]: Began running node model.caspian_vault.dv_hub_well
[0m04:17:22.396729 [debug] [Thread-4 (]: Began running node model.caspian_vault.dv_link_well_survey
[0m04:17:22.397114 [info ] [Thread-1 (]: 4 of 33 START sql table model public.dv_hub_survey_type ........................ [RUN]
[0m04:17:22.397474 [debug] [Thread-3 (]: Began running node model.caspian_vault.dv_sat_readings
[0m04:17:22.397871 [info ] [Thread-2 (]: 5 of 33 START sql table model public.dv_hub_well ............................... [RUN]
[0m04:17:22.398308 [info ] [Thread-4 (]: 6 of 33 START sql table model public.dv_link_well_survey ....................... [RUN]
[0m04:17:22.398684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.stg_readings, now model.caspian_vault.dv_hub_survey_type)
[0m04:17:22.399085 [info ] [Thread-3 (]: 7 of 33 START sql table model public.dv_sat_readings ........................... [RUN]
[0m04:17:22.399469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.caspian_vault.dv_hub_well)
[0m04:17:22.401096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_well_id_is_not_null.963860fecd, now model.caspian_vault.dv_link_well_survey)
[0m04:17:22.401473 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.dv_hub_survey_type
[0m04:17:22.401813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.dbt_utils_expression_is_true_stg_readings_survey_type_id_is_not_null.c0d2bfe969, now model.caspian_vault.dv_sat_readings)
[0m04:17:22.402143 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dv_hub_well
[0m04:17:22.402490 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dv_link_well_survey
[0m04:17:22.451757 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.452273 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dv_sat_readings
[0m04:17:22.454575 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dv_hub_well"
[0m04:17:22.457687 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.460080 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dv_sat_readings"
[0m04:17:22.460747 [debug] [Thread-1 (]: Began executing node model.caspian_vault.dv_hub_survey_type
[0m04:17:22.461125 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dv_hub_well
[0m04:17:22.463886 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.464220 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dv_link_well_survey
[0m04:17:22.464579 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dv_sat_readings
[0m04:17:22.467184 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dv_hub_well"
[0m04:17:22.469895 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.470351 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.472939 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dv_sat_readings"
[0m04:17:22.473512 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: BEGIN
[0m04:17:22.473944 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:17:22.474332 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.474719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.475079 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: BEGIN
[0m04:17:22.475454 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:17:22.475787 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: BEGIN
[0m04:17:22.476228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.476633 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: BEGIN
[0m04:17:22.476973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.477436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.480312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.480700 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.481015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.481445 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */

  
    

  create  table "airflow"."public"."dv_hub_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(survey_type_id as varchar)) as hk_survey_type,
    survey_type_id             as survey_type_bk,
    min(ingest_ts)             as load_ts,
    min(source_file)     as record_source
from "airflow"."public"."stg_readings"
where survey_type_id is not null
group by 1,2
  );
  
[0m04:17:22.481825 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.482194 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.482532 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:17:22.482937 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:17:22.483286 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.483632 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */

  
    

  create  table "airflow"."public"."dv_hub_well__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar)) as hk_well,
    well_id             as well_id_bk,
    min(ingest_ts)      as load_ts,
    min(source_file) as record_source
from "airflow"."public"."stg_readings"
where well_id is not null
group by 1,2
  );
  
[0m04:17:22.483989 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */

  
    

  create  table "airflow"."public"."dv_sat_readings__dbt_tmp"
  
  
    as
  
  (
    

select
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    ingest_ts                               as load_ts,
    source_file                             as record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    -- hashdiff over descriptive attributes
    md5(
      cast(depth_ft as varchar) || '|' ||
      cast(amplitude as varchar) || '|' ||
      cast(quality_flag as varchar) || '|' ||
      source_format
    ) as hashdiff
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
  );
  
[0m04:17:22.484359 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */

  
    

  create  table "airflow"."public"."dv_link_well_survey__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    md5(cast(well_id as varchar) || '|' || cast(survey_type_id as varchar)) as hk_well_survey,
    md5(cast(well_id as varchar))                   as hk_well,
    md5(cast(survey_type_id as varchar))            as hk_survey_type,
    min(ingest_ts)                        as load_ts,
    min(source_file)                as record_source
from "airflow"."public"."stg_readings"
where well_id is not null and survey_type_id is not null
group by 1,2,3
  );
  
[0m04:17:22.497268 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.014 seconds
[0m04:17:22.500841 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.501169 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.016 seconds
[0m04:17:22.501533 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type" rename to "dv_hub_survey_type__dbt_backup"
[0m04:17:22.503785 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:17:22.504189 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well" rename to "dv_hub_well__dbt_backup"
[0m04:17:22.504540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.506584 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.506929 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:17:22.507240 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
alter table "airflow"."public"."dv_hub_survey_type__dbt_tmp" rename to "dv_hub_survey_type"
[0m04:17:22.509328 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:17:22.509730 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
alter table "airflow"."public"."dv_hub_well__dbt_tmp" rename to "dv_hub_well"
[0m04:17:22.510065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.511105 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m04:17:22.511466 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:17:22.511775 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.512741 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m04:17:22.513074 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.028 seconds
[0m04:17:22.513415 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: COMMIT
[0m04:17:22.513740 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:17:22.516038 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.516394 [debug] [Thread-3 (]: SQL status: SELECT 9980 in 0.032 seconds
[0m04:17:22.516782 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: COMMIT
[0m04:17:22.517113 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey" rename to "dv_link_well_survey__dbt_backup"
[0m04:17:22.519438 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:17:22.519925 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings" rename to "dv_sat_readings__dbt_backup"
[0m04:17:22.520292 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.522417 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.522734 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:17:22.523085 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
alter table "airflow"."public"."dv_link_well_survey__dbt_tmp" rename to "dv_link_well_survey"
[0m04:17:22.525131 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:17:22.525551 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
alter table "airflow"."public"."dv_sat_readings__dbt_tmp" rename to "dv_sat_readings"
[0m04:17:22.525875 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.526880 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m04:17:22.527189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:17:22.527550 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.528517 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m04:17:22.528856 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: COMMIT
[0m04:17:22.529183 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:17:22.529568 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: COMMIT
[0m04:17:22.547179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m04:17:22.549164 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."dv_hub_survey_type__dbt_backup"
[0m04:17:22.549574 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m04:17:22.549898 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m04:17:22.550370 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.dv_hub_survey_type"
[0m04:17:22.550676 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m04:17:22.553428 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dv_sat_readings__dbt_backup"
[0m04:17:22.555036 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dv_hub_well__dbt_backup"
[0m04:17:22.555392 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_survey_type"} */
drop table if exists "airflow"."public"."dv_hub_survey_type__dbt_backup" cascade
[0m04:17:22.557048 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dv_link_well_survey__dbt_backup"
[0m04:17:22.557546 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dv_sat_readings"
[0m04:17:22.558008 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dv_hub_well"
[0m04:17:22.558560 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dv_link_well_survey"
[0m04:17:22.558901 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_sat_readings"} */
drop table if exists "airflow"."public"."dv_sat_readings__dbt_backup" cascade
[0m04:17:22.559242 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_hub_well"} */
drop table if exists "airflow"."public"."dv_hub_well__dbt_backup" cascade
[0m04:17:22.559615 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dv_link_well_survey"} */
drop table if exists "airflow"."public"."dv_link_well_survey__dbt_backup" cascade
[0m04:17:22.560588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:17:22.561674 [debug] [Thread-1 (]: On model.caspian_vault.dv_hub_survey_type: Close
[0m04:17:22.562204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ece06900>]}
[0m04:17:22.562753 [info ] [Thread-1 (]: 4 of 33 OK created sql table model public.dv_hub_survey_type ................... [[32mSELECT 3[0m in 0.16s]
[0m04:17:22.563225 [debug] [Thread-1 (]: Finished running node model.caspian_vault.dv_hub_survey_type
[0m04:17:22.563845 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:17:22.564173 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m04:17:22.564544 [info ] [Thread-1 (]: 8 of 33 START test not_null_dv_hub_survey_type_hk_survey_type .................. [RUN]
[0m04:17:22.564902 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m04:17:22.565270 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m04:17:22.566236 [debug] [Thread-3 (]: On model.caspian_vault.dv_sat_readings: Close
[0m04:17:22.566614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_survey_type, now test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033)
[0m04:17:22.567635 [debug] [Thread-4 (]: On model.caspian_vault.dv_link_well_survey: Close
[0m04:17:22.568621 [debug] [Thread-2 (]: On model.caspian_vault.dv_hub_well: Close
[0m04:17:22.569120 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f413d790>]}
[0m04:17:22.569484 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:17:22.569936 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ef754980>]}
[0m04:17:22.570440 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f413c980>]}
[0m04:17:22.570942 [info ] [Thread-3 (]: 7 of 33 OK created sql table model public.dv_sat_readings ...................... [[32mSELECT 9980[0m in 0.17s]
[0m04:17:22.575972 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:17:22.576527 [info ] [Thread-4 (]: 6 of 33 OK created sql table model public.dv_link_well_survey .................. [[32mSELECT 50[0m in 0.17s]
[0m04:17:22.577080 [info ] [Thread-2 (]: 5 of 33 OK created sql table model public.dv_hub_well .......................... [[32mSELECT 20[0m in 0.17s]
[0m04:17:22.577602 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dv_sat_readings
[0m04:17:22.578132 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dv_link_well_survey
[0m04:17:22.578539 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:17:22.578980 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dv_hub_well
[0m04:17:22.579341 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:17:22.579845 [debug] [Thread-4 (]: Began running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:17:22.581580 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:17:22.581968 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:17:22.582411 [info ] [Thread-3 (]: 9 of 33 START test not_null_dv_hub_survey_type_survey_type_bk .................. [RUN]
[0m04:17:22.582793 [info ] [Thread-4 (]: 10 of 33 START test unique_dv_hub_survey_type_hk_survey_type ................... [RUN]
[0m04:17:22.583272 [info ] [Thread-2 (]: 11 of 33 START test not_null_dv_sat_readings_hk_well_survey .................... [RUN]
[0m04:17:22.583714 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:17:22.584042 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_sat_readings, now test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007)
[0m04:17:22.584398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_link_well_survey, now test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d)
[0m04:17:22.584748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dv_hub_well, now test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688)
[0m04:17:22.585085 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: BEGIN
[0m04:17:22.585426 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:17:22.585749 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:17:22.586071 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:17:22.586402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.589154 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:17:22.593457 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:17:22.596153 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:17:22.596858 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:17:22.598626 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:17:22.599128 [debug] [Thread-4 (]: Began executing node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:17:22.599497 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:17:22.602100 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:17:22.602536 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:17:22.604052 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:17:22.604415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m04:17:22.604875 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: BEGIN
[0m04:17:22.605261 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:17:22.605695 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"
[0m04:17:22.606094 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:17:22.606413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.606754 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: BEGIN
[0m04:17:22.607095 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.607453 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: BEGIN
[0m04:17:22.607884 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.608255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.608793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.610008 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: ROLLBACK
[0m04:17:22.610451 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033: Close
[0m04:17:22.610953 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dv_hub_survey_type_hk_survey_type ........................ [[32mPASS[0m in 0.04s]
[0m04:17:22.611477 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033
[0m04:17:22.611784 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.612259 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:17:22.612630 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.613000 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.613337 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"
[0m04:17:22.613686 [info ] [Thread-1 (]: 12 of 33 START test not_null_dv_sat_readings_load_ts ........................... [RUN]
[0m04:17:22.614045 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"
[0m04:17:22.614395 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"
[0m04:17:22.614746 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select survey_type_bk
from "airflow"."public"."dv_hub_survey_type"
where survey_type_bk is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.615108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_hk_survey_type.3ae66ee033, now test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09)
[0m04:17:22.615464 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_survey_type as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_survey_type"
where hk_survey_type is not null
group by hk_survey_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:17:22.615815 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_sat_readings"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.616209 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:17:22.616648 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:17:22.619459 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:17:22.619811 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:17:22.620940 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: ROLLBACK
[0m04:17:22.621262 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m04:17:22.622416 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: ROLLBACK
[0m04:17:22.622864 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:17:22.623190 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007: Close
[0m04:17:22.624234 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: ROLLBACK
[0m04:17:22.626045 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:17:22.626413 [debug] [Thread-4 (]: On test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d: Close
[0m04:17:22.626954 [info ] [Thread-3 (]: 9 of 33 PASS not_null_dv_hub_survey_type_survey_type_bk ........................ [[32mPASS[0m in 0.04s]
[0m04:17:22.627524 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688: Close
[0m04:17:22.628023 [info ] [Thread-4 (]: 10 of 33 PASS unique_dv_hub_survey_type_hk_survey_type ......................... [[32mPASS[0m in 0.04s]
[0m04:17:22.628508 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007
[0m04:17:22.628909 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:17:22.629395 [debug] [Thread-4 (]: Finished running node test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d
[0m04:17:22.629802 [info ] [Thread-2 (]: 11 of 33 PASS not_null_dv_sat_readings_hk_well_survey .......................... [[32mPASS[0m in 0.05s]
[0m04:17:22.630270 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:17:22.630676 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: BEGIN
[0m04:17:22.631038 [debug] [Thread-4 (]: Began running node test.caspian_vault.test_counts_match
[0m04:17:22.631601 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688
[0m04:17:22.631944 [info ] [Thread-3 (]: 13 of 33 START test not_null_dv_sat_readings_row_checksum ...................... [RUN]
[0m04:17:22.632325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.632655 [info ] [Thread-4 (]: 14 of 33 START test test_counts_match .......................................... [RUN]
[0m04:17:22.633030 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:17:22.633424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_survey_type_survey_type_bk.c9fbaab007, now test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b)
[0m04:17:22.633899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_survey_type_hk_survey_type.36ca59927d, now test.caspian_vault.test_counts_match)
[0m04:17:22.634240 [info ] [Thread-2 (]: 15 of 33 START test not_null_dv_link_well_survey_hk_survey_type ................ [RUN]
[0m04:17:22.634635 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:17:22.634978 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.test_counts_match
[0m04:17:22.635324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_hk_well_survey.f200faa688, now test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652)
[0m04:17:22.638054 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:17:22.640194 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.test_counts_match"
[0m04:17:22.640559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:17:22.640907 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:17:22.641455 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"
[0m04:17:22.641787 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:17:22.644507 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:17:22.644859 [debug] [Thread-4 (]: Began executing node test.caspian_vault.test_counts_match
[0m04:17:22.645205 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_ts
from "airflow"."public"."dv_sat_readings"
where load_ts is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.646862 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:17:22.648510 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.test_counts_match"
[0m04:17:22.648863 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:17:22.650713 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:17:22.651101 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:17:22.651509 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m04:17:22.651824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:17:22.652216 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: BEGIN
[0m04:17:22.652610 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:17:22.652924 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: BEGIN
[0m04:17:22.655077 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: ROLLBACK
[0m04:17:22.655438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.655774 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: BEGIN
[0m04:17:22.656100 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.656610 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09: Close
[0m04:17:22.656914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.657566 [info ] [Thread-1 (]: 12 of 33 PASS not_null_dv_sat_readings_load_ts ................................. [[32mPASS[0m in 0.04s]
[0m04:17:22.658143 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09
[0m04:17:22.658506 [debug] [Thread-1 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:17:22.658870 [info ] [Thread-1 (]: 16 of 33 START test not_null_dv_link_well_survey_hk_well ....................... [RUN]
[0m04:17:22.659211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_load_ts.0b12917b09, now test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b)
[0m04:17:22.659526 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:17:22.662180 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:17:22.662733 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m04:17:22.663104 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.663520 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m04:17:22.663875 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"
[0m04:17:22.664196 [debug] [Thread-1 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:17:22.664573 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"
[0m04:17:22.664926 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.test_counts_match"
[0m04:17:22.665279 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select row_checksum
from "airflow"."public"."dv_sat_readings"
where row_checksum is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.666833 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:17:22.667199 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_survey_type
from "airflow"."public"."dv_link_well_survey"
where hk_survey_type is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.667582 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.test_counts_match"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- test passes if returns 0 rows
-- Only enforce count match when source has data (prevents failure when raw sources are stubbed/empty)

with src as (
  select count(*) as n from "airflow"."public"."stg_readings"
),
sat as (
  select count(*) as n from "airflow"."public"."dv_sat_readings"
)
select
  src.n as src_rows,
  sat.n as sat_rows
from src, sat
where src.n > 0
  and src.n != sat.n
  
  
      
    ) dbt_internal_test
[0m04:17:22.668266 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:17:22.668594 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.668931 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: BEGIN
[0m04:17:22.669241 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.670377 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: ROLLBACK
[0m04:17:22.670754 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:17:22.671066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.672123 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: ROLLBACK
[0m04:17:22.673270 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: ROLLBACK
[0m04:17:22.673597 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652: Close
[0m04:17:22.674126 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b: Close
[0m04:17:22.674488 [debug] [Thread-4 (]: On test.caspian_vault.test_counts_match: Close
[0m04:17:22.674998 [info ] [Thread-2 (]: 15 of 33 PASS not_null_dv_link_well_survey_hk_survey_type ...................... [[32mPASS[0m in 0.04s]
[0m04:17:22.675520 [info ] [Thread-3 (]: 13 of 33 PASS not_null_dv_sat_readings_row_checksum ............................ [[32mPASS[0m in 0.04s]
[0m04:17:22.676482 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652
[0m04:17:22.676068 [info ] [Thread-4 (]: 14 of 33 PASS test_counts_match ................................................ [[32mPASS[0m in 0.04s]
[0m04:17:22.676997 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b
[0m04:17:22.677363 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:17:22.677944 [debug] [Thread-4 (]: Finished running node test.caspian_vault.test_counts_match
[0m04:17:22.678272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:17:22.678630 [debug] [Thread-3 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:17:22.679003 [info ] [Thread-2 (]: 17 of 33 START test not_null_dv_link_well_survey_hk_well_survey ................ [RUN]
[0m04:17:22.679415 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:17:22.679807 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"
[0m04:17:22.680241 [info ] [Thread-3 (]: 18 of 33 START test relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [RUN]
[0m04:17:22.680629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_survey_type.f857109652, now test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6)
[0m04:17:22.680980 [info ] [Thread-4 (]: 19 of 33 START test relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [RUN]
[0m04:17:22.681357 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_link_well_survey"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.681707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_sat_readings_row_checksum.51b9f3aa4b, now test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4)
[0m04:17:22.682038 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:17:22.682384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.test_counts_match, now test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e)
[0m04:17:22.682802 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:17:22.685686 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:17:22.686074 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:17:22.686411 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:17:22.692366 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:17:22.693633 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: ROLLBACK
[0m04:17:22.697545 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:17:22.697968 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:17:22.698592 [debug] [Thread-1 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b: Close
[0m04:17:22.700208 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:17:22.700565 [debug] [Thread-3 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:17:22.700934 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:17:22.701501 [info ] [Thread-1 (]: 16 of 33 PASS not_null_dv_link_well_survey_hk_well ............................. [[32mPASS[0m in 0.04s]
[0m04:17:22.703266 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:17:22.703698 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:17:22.705203 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:17:22.705690 [debug] [Thread-1 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b
[0m04:17:22.706112 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: BEGIN
[0m04:17:22.706527 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:17:22.706981 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:17:22.707374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.707812 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:17:22.708122 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: BEGIN
[0m04:17:22.708483 [info ] [Thread-1 (]: 20 of 33 START test unique_dv_link_well_survey_hk_well_survey .................. [RUN]
[0m04:17:22.708960 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: BEGIN
[0m04:17:22.709300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.709679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well.320d0c7b0b, now test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb)
[0m04:17:22.710057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.710502 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:17:22.713336 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:17:22.713859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.714266 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.714616 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"
[0m04:17:22.715035 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:17:22.715369 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.715693 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"
[0m04:17:22.716041 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well_survey
from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.718702 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:17:22.719103 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"
[0m04:17:22.719494 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_survey_type as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_survey_type is not null
),

parent as (
    select hk_survey_type as to_field
    from "airflow"."public"."dv_hub_survey_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.720038 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well_survey as from_field
    from "airflow"."public"."dv_sat_readings"
    where hk_well_survey is not null
),

parent as (
    select hk_well_survey as to_field
    from "airflow"."public"."dv_link_well_survey"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.720455 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.720825 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:17:22.722060 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: ROLLBACK
[0m04:17:22.722441 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.722745 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: BEGIN
[0m04:17:22.723866 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: ROLLBACK
[0m04:17:22.724268 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:17:22.724568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.724860 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6: Close
[0m04:17:22.725989 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: ROLLBACK
[0m04:17:22.726351 [debug] [Thread-3 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4: Close
[0m04:17:22.726954 [info ] [Thread-2 (]: 17 of 33 PASS not_null_dv_link_well_survey_hk_well_survey ...................... [[32mPASS[0m in 0.05s]
[0m04:17:22.727814 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e: Close
[0m04:17:22.727539 [info ] [Thread-3 (]: 18 of 33 PASS relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_  [[32mPASS[0m in 0.05s]
[0m04:17:22.728389 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6
[0m04:17:22.728895 [debug] [Thread-3 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4
[0m04:17:22.729353 [info ] [Thread-4 (]: 19 of 33 PASS relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_  [[32mPASS[0m in 0.05s]
[0m04:17:22.729809 [debug] [Thread-2 (]: Began running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:17:22.730287 [debug] [Thread-3 (]: Began running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:17:22.730642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.731112 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e
[0m04:17:22.731465 [info ] [Thread-2 (]: 21 of 33 START test not_null_dv_hub_well_hk_well ............................... [RUN]
[0m04:17:22.731832 [info ] [Thread-3 (]: 22 of 33 START test not_null_dv_hub_well_well_id_bk ............................ [RUN]
[0m04:17:22.732176 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"
[0m04:17:22.732562 [debug] [Thread-4 (]: Began running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:17:22.732950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_link_well_survey_hk_well_survey.76e54a32d6, now test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743)
[0m04:17:22.733318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_survey_type__hk_survey_type__ref_dv_hub_survey_type_.96fb7de7c4, now test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7)
[0m04:17:22.733662 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well_survey as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_link_well_survey"
where hk_well_survey is not null
group by hk_well_survey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:17:22.734007 [info ] [Thread-4 (]: 23 of 33 START test relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [RUN]
[0m04:17:22.734383 [debug] [Thread-2 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:17:22.734705 [debug] [Thread-3 (]: Began compiling node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:17:22.735102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_sat_readings_hk_well_survey__hk_well_survey__ref_dv_link_well_survey_.d06db1050e, now test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685)
[0m04:17:22.738028 [debug] [Thread-2 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:17:22.738397 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:17:22.741011 [debug] [Thread-3 (]: Writing injected SQL for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:17:22.741387 [debug] [Thread-4 (]: Began compiling node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:17:22.742579 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: ROLLBACK
[0m04:17:22.742977 [debug] [Thread-2 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:17:22.746945 [debug] [Thread-4 (]: Writing injected SQL for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:17:22.748692 [debug] [Thread-2 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:17:22.749068 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb: Close
[0m04:17:22.749433 [debug] [Thread-3 (]: Began executing node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:17:22.749966 [debug] [Thread-4 (]: Began executing node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:17:22.750475 [info ] [Thread-1 (]: 20 of 33 PASS unique_dv_link_well_survey_hk_well_survey ........................ [[32mPASS[0m in 0.04s]
[0m04:17:22.750892 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:17:22.752461 [debug] [Thread-3 (]: Writing runtime sql for node "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:17:22.754020 [debug] [Thread-4 (]: Writing runtime sql for node "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:17:22.754487 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb
[0m04:17:22.754814 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: BEGIN
[0m04:17:22.755472 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:17:22.755816 [debug] [Thread-1 (]: Began running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:17:22.756166 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:17:22.756636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.756962 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: BEGIN
[0m04:17:22.757301 [info ] [Thread-1 (]: 24 of 33 START test unique_dv_hub_well_hk_well ................................. [RUN]
[0m04:17:22.757668 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: BEGIN
[0m04:17:22.758110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.758475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_link_well_survey_hk_well_survey.24dd935adb, now test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc)
[0m04:17:22.758858 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.759323 [debug] [Thread-1 (]: Began compiling node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:17:22.762173 [debug] [Thread-1 (]: Writing injected SQL for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:17:22.762730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.763080 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.763486 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.763799 [debug] [Thread-2 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"
[0m04:17:22.764108 [debug] [Thread-1 (]: Began executing node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:17:22.764473 [debug] [Thread-3 (]: Using postgres connection "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"
[0m04:17:22.764814 [debug] [Thread-4 (]: Using postgres connection "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"
[0m04:17:22.765151 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hk_well
from "airflow"."public"."dv_hub_well"
where hk_well is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.766710 [debug] [Thread-1 (]: Writing runtime sql for node "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:17:22.767068 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select well_id_bk
from "airflow"."public"."dv_hub_well"
where well_id_bk is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.767471 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select hk_well as from_field
    from "airflow"."public"."dv_link_well_survey"
    where hk_well is not null
),

parent as (
    select hk_well as to_field
    from "airflow"."public"."dv_hub_well"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m04:17:22.768169 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:17:22.768558 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.768881 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.769167 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: BEGIN
[0m04:17:22.769492 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.770642 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: ROLLBACK
[0m04:17:22.771716 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: ROLLBACK
[0m04:17:22.772051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.773110 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: ROLLBACK
[0m04:17:22.773570 [debug] [Thread-3 (]: On test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7: Close
[0m04:17:22.773946 [debug] [Thread-2 (]: On test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743: Close
[0m04:17:22.774431 [debug] [Thread-4 (]: On test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685: Close
[0m04:17:22.774969 [info ] [Thread-3 (]: 22 of 33 PASS not_null_dv_hub_well_well_id_bk .................................. [[32mPASS[0m in 0.04s]
[0m04:17:22.775430 [info ] [Thread-2 (]: 21 of 33 PASS not_null_dv_hub_well_hk_well ..................................... [[32mPASS[0m in 0.04s]
[0m04:17:22.776104 [info ] [Thread-4 (]: 23 of 33 PASS relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_  [[32mPASS[0m in 0.04s]
[0m04:17:22.776599 [debug] [Thread-3 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7
[0m04:17:22.777056 [debug] [Thread-2 (]: Finished running node test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743
[0m04:17:22.777526 [debug] [Thread-4 (]: Finished running node test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685
[0m04:17:22.777839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.778244 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_survey_type
[0m04:17:22.778690 [debug] [Thread-2 (]: Began running node model.caspian_vault.dim_source_format
[0m04:17:22.779076 [debug] [Thread-4 (]: Began running node model.caspian_vault.dim_time
[0m04:17:22.779438 [debug] [Thread-1 (]: Using postgres connection "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"
[0m04:17:22.779870 [info ] [Thread-3 (]: 25 of 33 START sql table model public.dim_survey_type .......................... [RUN]
[0m04:17:22.780330 [info ] [Thread-2 (]: 26 of 33 START sql table model public.dim_source_format ........................ [RUN]
[0m04:17:22.780758 [info ] [Thread-4 (]: 27 of 33 START sql table model public.dim_time ................................. [RUN]
[0m04:17:22.781129 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hk_well as unique_field,
    count(*) as n_records

from "airflow"."public"."dv_hub_well"
where hk_well is not null
group by hk_well
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:17:22.781512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_well_id_bk.e60b1222a7, now model.caspian_vault.dim_survey_type)
[0m04:17:22.781868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.caspian_vault.not_null_dv_hub_well_hk_well.e7db409743, now model.caspian_vault.dim_source_format)
[0m04:17:22.782215 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.caspian_vault.relationships_dv_link_well_survey_hk_well__hk_well__ref_dv_hub_well_.18b280a685, now model.caspian_vault.dim_time)
[0m04:17:22.782636 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_survey_type
[0m04:17:22.782963 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.dim_source_format
[0m04:17:22.783314 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.dim_time
[0m04:17:22.783602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:17:22.786971 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_survey_type"
[0m04:17:22.788974 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.dim_source_format"
[0m04:17:22.790965 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.dim_time"
[0m04:17:22.792090 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: ROLLBACK
[0m04:17:22.792711 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_survey_type
[0m04:17:22.793212 [debug] [Thread-2 (]: Began executing node model.caspian_vault.dim_source_format
[0m04:17:22.793585 [debug] [Thread-1 (]: On test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc: Close
[0m04:17:22.796270 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_survey_type"
[0m04:17:22.796664 [debug] [Thread-4 (]: Began executing node model.caspian_vault.dim_time
[0m04:17:22.799215 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.dim_source_format"
[0m04:17:22.799828 [info ] [Thread-1 (]: 24 of 33 PASS unique_dv_hub_well_hk_well ....................................... [[32mPASS[0m in 0.04s]
[0m04:17:22.802394 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.dim_time"
[0m04:17:22.802755 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:17:22.803338 [debug] [Thread-1 (]: Finished running node test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc
[0m04:17:22.803703 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:17:22.804130 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: BEGIN
[0m04:17:22.804539 [debug] [Thread-1 (]: Began running node model.caspian_vault.fct_readings
[0m04:17:22.804921 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:17:22.805329 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: BEGIN
[0m04:17:22.805667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.806062 [info ] [Thread-1 (]: 28 of 33 START sql table model public.fct_readings ............................. [RUN]
[0m04:17:22.806426 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: BEGIN
[0m04:17:22.806738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.807191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.caspian_vault.unique_dv_hub_well_hk_well.bd27a0d1dc, now model.caspian_vault.fct_readings)
[0m04:17:22.807615 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.808083 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.fct_readings
[0m04:17:22.810438 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.fct_readings"
[0m04:17:22.810964 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.811341 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:17:22.811670 [debug] [Thread-1 (]: Began executing node model.caspian_vault.fct_readings
[0m04:17:22.812062 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.812401 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */

  
    

  create  table "airflow"."public"."dim_survey_type__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  survey_type_bk as survey_type_id,
  load_ts,
  record_source
from "airflow"."public"."dv_hub_survey_type"
  );
  
[0m04:17:22.812737 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.815316 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.fct_readings"
[0m04:17:22.815682 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:17:22.816088 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:17:22.816533 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */

  
    

  create  table "airflow"."public"."dim_source_format__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  source_format,
  md5(source_format) as hk_source_format
from "airflow"."public"."dv_sat_readings"
  );
  
[0m04:17:22.816950 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:17:22.817299 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */

  
    

  create  table "airflow"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

-- Time dimension derived from load timestamps (ingest_ts / load_ts)
with t as (
  select distinct cast(load_ts as timestamp) as ts
  from "airflow"."public"."dv_sat_readings"
)
select
  ts,
  date(ts) as d,
  extract(year from ts) as year,
  extract(month from ts) as month,
  extract(day from ts) as day,
  to_char(ts, 'YYYY-MM') as year_month,
  to_char(ts, 'YYYY-MM-DD') as ymd,
  extract(hour from ts) as hour
from t
  );
  
[0m04:17:22.817699 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: BEGIN
[0m04:17:22.818077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.820308 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.004 seconds
[0m04:17:22.823618 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:17:22.823999 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type" rename to "dim_survey_type__dbt_backup"
[0m04:17:22.824333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.824722 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:17:22.825047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.825371 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */

  
    

  create  table "airflow"."public"."fct_readings__dbt_tmp"
  
  
    as
  
  (
    

with sat as (
  select
    hk_well_survey,
    load_ts,
    record_source,
    source_format,
    row_checksum,
    depth_ft,
    amplitude,
    quality_flag,
    hashdiff
  from "airflow"."public"."dv_sat_readings"
),
lnk as (
  select
    hk_well_survey,
    hk_well,
    hk_survey_type
  from "airflow"."public"."dv_link_well_survey"
)
select
  sat.hk_well_survey,
  lnk.hk_well,
  lnk.hk_survey_type,
  sat.load_ts,
  sat.record_source,
  sat.source_format,
  sat.row_checksum,
  sat.depth_ft,
  sat.amplitude,
  sat.quality_flag,
  sat.hashdiff
from sat
join lnk using (hk_well_survey)
  );
  
[0m04:17:22.827413 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:17:22.827753 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m04:17:22.828169 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
alter table "airflow"."public"."dim_survey_type__dbt_tmp" rename to "dim_survey_type"
[0m04:17:22.830464 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:17:22.830871 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m04:17:22.831203 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.832215 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m04:17:22.832569 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:17:22.832874 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:17:22.833192 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.016 seconds
[0m04:17:22.835218 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:17:22.835574 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: COMMIT
[0m04:17:22.837941 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:17:22.838307 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
alter table "airflow"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m04:17:22.838703 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format" rename to "dim_source_format__dbt_backup"
[0m04:17:22.839227 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.839544 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.840531 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m04:17:22.842564 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:17:22.842913 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:17:22.843258 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
alter table "airflow"."public"."dim_source_format__dbt_tmp" rename to "dim_source_format"
[0m04:17:22.843585 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: COMMIT
[0m04:17:22.844085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.845036 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m04:17:22.845398 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m04:17:22.845730 [debug] [Thread-1 (]: SQL status: SELECT 9980 in 0.018 seconds
[0m04:17:22.846072 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:17:22.847760 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_survey_type__dbt_backup"
[0m04:17:22.850127 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:17:22.850499 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: COMMIT
[0m04:17:22.850804 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m04:17:22.851289 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_survey_type"
[0m04:17:22.851638 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings" rename to "fct_readings__dbt_backup"
[0m04:17:22.853326 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_time__dbt_backup"
[0m04:17:22.853695 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_survey_type"} */
drop table if exists "airflow"."public"."dim_survey_type__dbt_backup" cascade
[0m04:17:22.854023 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m04:17:22.854523 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.dim_time"
[0m04:17:22.854835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.857392 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_source_format__dbt_backup"
[0m04:17:22.857762 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:17:22.858067 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_time"} */
drop table if exists "airflow"."public"."dim_time__dbt_backup" cascade
[0m04:17:22.860119 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:17:22.860622 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.dim_source_format"
[0m04:17:22.861641 [debug] [Thread-3 (]: On model.caspian_vault.dim_survey_type: Close
[0m04:17:22.862041 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
alter table "airflow"."public"."fct_readings__dbt_tmp" rename to "fct_readings"
[0m04:17:22.862392 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_source_format"} */
drop table if exists "airflow"."public"."dim_source_format__dbt_backup" cascade
[0m04:17:22.862950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecd8e750>]}
[0m04:17:22.863320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.864283 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:17:22.865265 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m04:17:22.863932 [info ] [Thread-3 (]: 25 of 33 OK created sql table model public.dim_survey_type ..................... [[32mSELECT 3[0m in 0.08s]
[0m04:17:22.865718 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:17:22.866684 [debug] [Thread-4 (]: On model.caspian_vault.dim_time: Close
[0m04:17:22.867024 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:17:22.867490 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_survey_type
[0m04:17:22.868480 [debug] [Thread-2 (]: On model.caspian_vault.dim_source_format: Close
[0m04:17:22.868857 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: COMMIT
[0m04:17:22.869277 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecd9e0c0>]}
[0m04:17:22.869691 [debug] [Thread-3 (]: Began running node model.caspian_vault.dim_well
[0m04:17:22.870210 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecd7b140>]}
[0m04:17:22.870773 [info ] [Thread-4 (]: 27 of 33 OK created sql table model public.dim_time ............................ [[32mSELECT 1[0m in 0.09s]
[0m04:17:22.871239 [info ] [Thread-3 (]: 29 of 33 START sql table model public.dim_well ................................. [RUN]
[0m04:17:22.872225 [debug] [Thread-4 (]: Finished running node model.caspian_vault.dim_time
[0m04:17:22.872538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:17:22.871780 [info ] [Thread-2 (]: 26 of 33 OK created sql table model public.dim_source_format ................... [[32mSELECT 2[0m in 0.09s]
[0m04:17:22.873002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_survey_type, now model.caspian_vault.dim_well)
[0m04:17:22.874880 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fct_readings__dbt_backup"
[0m04:17:22.875366 [debug] [Thread-2 (]: Finished running node model.caspian_vault.dim_source_format
[0m04:17:22.875698 [debug] [Thread-3 (]: Began compiling node model.caspian_vault.dim_well
[0m04:17:22.876173 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.fct_readings"
[0m04:17:22.878476 [debug] [Thread-3 (]: Writing injected SQL for node "model.caspian_vault.dim_well"
[0m04:17:22.878836 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.fct_readings"} */
drop table if exists "airflow"."public"."fct_readings__dbt_backup" cascade
[0m04:17:22.879368 [debug] [Thread-3 (]: Began executing node model.caspian_vault.dim_well
[0m04:17:22.881991 [debug] [Thread-3 (]: Writing runtime sql for node "model.caspian_vault.dim_well"
[0m04:17:22.882500 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:17:22.882809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m04:17:22.883141 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: BEGIN
[0m04:17:22.884160 [debug] [Thread-1 (]: On model.caspian_vault.fct_readings: Close
[0m04:17:22.884503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:22.885047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecd37b90>]}
[0m04:17:22.885540 [info ] [Thread-1 (]: 28 of 33 OK created sql table model public.fct_readings ........................ [[32mSELECT 9980[0m in 0.08s]
[0m04:17:22.886013 [debug] [Thread-1 (]: Finished running node model.caspian_vault.fct_readings
[0m04:17:22.886556 [debug] [Thread-4 (]: Began running node model.caspian_vault.mart_sensor_analysis
[0m04:17:22.886903 [debug] [Thread-2 (]: Began running node model.caspian_vault.mart_survey_summary
[0m04:17:22.887276 [debug] [Thread-1 (]: Began running node model.caspian_vault.mart_well_performance
[0m04:17:22.887651 [info ] [Thread-4 (]: 30 of 33 START sql table model public.mart_sensor_analysis ..................... [RUN]
[0m04:17:22.888089 [info ] [Thread-2 (]: 31 of 33 START sql table model public.mart_survey_summary ...................... [RUN]
[0m04:17:22.888556 [info ] [Thread-1 (]: 32 of 33 START sql table model public.mart_well_performance .................... [RUN]
[0m04:17:22.888892 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:22.889273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_time, now model.caspian_vault.mart_sensor_analysis)
[0m04:17:22.889622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_source_format, now model.caspian_vault.mart_survey_summary)
[0m04:17:22.889970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspian_vault.fct_readings, now model.caspian_vault.mart_well_performance)
[0m04:17:22.890319 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:17:22.890655 [debug] [Thread-4 (]: Began compiling node model.caspian_vault.mart_sensor_analysis
[0m04:17:22.890978 [debug] [Thread-2 (]: Began compiling node model.caspian_vault.mart_survey_summary
[0m04:17:22.891313 [debug] [Thread-1 (]: Began compiling node model.caspian_vault.mart_well_performance
[0m04:17:22.891656 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */

  
    

  create  table "airflow"."public"."dim_well__dbt_tmp"
  
  
    as
  
  (
    

-- If you don't have real lat/lon in the raw data, we generate deterministic pseudo coords
-- within a Caspian-ish bounding box so the map can still work for the demo.
with base as (
  select
    hk_well,
    well_id_bk as well_id,
    load_ts,
    record_source
  from "airflow"."public"."dv_hub_well"
),
geo as (
  select
    *,
    -- deterministic pseudo geo: map well_id -> lat/lon
    38.0 + (abs(abs(('x' || substr(md5(cast(well_id as text)), 1, 8))::bit(32)::int)) % 6000) / 1000.0 as lat,   -- 38..44
47.0 + (abs((('x' || substr(md5('x' || cast(well_id as text)), 1, 8))::bit(32)::int)) % 7000) / 1000.0 as lon -- 47..54
  from base
)
select * from geo
  );
  
[0m04:17:22.893757 [debug] [Thread-4 (]: Writing injected SQL for node "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.895776 [debug] [Thread-2 (]: Writing injected SQL for node "model.caspian_vault.mart_survey_summary"
[0m04:17:22.897765 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspian_vault.mart_well_performance"
[0m04:17:22.898497 [debug] [Thread-4 (]: Began executing node model.caspian_vault.mart_sensor_analysis
[0m04:17:22.898813 [debug] [Thread-2 (]: Began executing node model.caspian_vault.mart_survey_summary
[0m04:17:22.901464 [debug] [Thread-4 (]: Writing runtime sql for node "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.901792 [debug] [Thread-1 (]: Began executing node model.caspian_vault.mart_well_performance
[0m04:17:22.902127 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.004 seconds
[0m04:17:22.905643 [debug] [Thread-2 (]: Writing runtime sql for node "model.caspian_vault.mart_survey_summary"
[0m04:17:22.908193 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspian_vault.mart_well_performance"
[0m04:17:22.908670 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.910982 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:17:22.911585 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: BEGIN
[0m04:17:22.911963 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:17:22.912331 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well" rename to "dim_well__dbt_backup"
[0m04:17:22.912662 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:17:22.913007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:17:22.913348 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: BEGIN
[0m04:17:22.913736 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: BEGIN
[0m04:17:22.914044 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.914482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:17:22.914827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:22.917005 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:17:22.917599 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
alter table "airflow"."public"."dim_well__dbt_tmp" rename to "dim_well"
[0m04:17:22.918144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:17:22.918503 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:17:22.918857 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.919868 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m04:17:22.920229 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */

  
    

  create  table "airflow"."public"."mart_sensor_analysis__dbt_tmp"
  
  
    as
  
  (
    

-- treating survey_type as sensor type (only available categorical dimension)
select
  hk_survey_type as hk_sensor_type,
  count(*) as total_readings,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate,
  avg(amplitude) as avg_amplitude
from "airflow"."public"."fct_readings"
group by 1
  );
  
[0m04:17:22.920628 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:17:22.920958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:17:22.921399 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: COMMIT
[0m04:17:22.921724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:17:22.922067 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:17:22.922477 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:17:22.922822 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */

  
    

  create  table "airflow"."public"."mart_survey_summary__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_survey_type,
  source_format,
  count(distinct hk_well) as wells_surveyed,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  min(load_ts) as first_ingest_ts,
  max(load_ts) as last_ingest_ts
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m04:17:22.924093 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */

  
    

  create  table "airflow"."public"."mart_well_performance__dbt_tmp"
  
  
    as
  
  (
    

select
  hk_well,
  source_format,
  count(*) as total_readings,
  avg(amplitude) as avg_amplitude,
  avg(case when quality_flag = 1 then 1 else 0 end) as data_quality_rate
from "airflow"."public"."fct_readings"
group by 1,2
  );
  
[0m04:17:22.924434 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m04:17:22.926166 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_well__dbt_backup"
[0m04:17:22.926635 [debug] [Thread-3 (]: Using postgres connection "model.caspian_vault.dim_well"
[0m04:17:22.926942 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.dim_well"} */
drop table if exists "airflow"."public"."dim_well__dbt_backup" cascade
[0m04:17:22.930089 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.009 seconds
[0m04:17:22.932431 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.932758 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m04:17:22.933121 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis" rename to "mart_sensor_analysis__dbt_backup"
[0m04:17:22.933482 [debug] [Thread-1 (]: SQL status: SELECT 21 in 0.009 seconds
[0m04:17:22.934473 [debug] [Thread-3 (]: On model.caspian_vault.dim_well: Close
[0m04:17:22.936873 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:17:22.937209 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:17:22.937582 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.013 seconds
[0m04:17:22.937978 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance" rename to "mart_well_performance__dbt_backup"
[0m04:17:22.938466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecd4e750>]}
[0m04:17:22.940541 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.942841 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:17:22.943763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:17:22.943469 [info ] [Thread-3 (]: 29 of 33 OK created sql table model public.dim_well ............................ [[32mSELECT 20[0m in 0.07s]
[0m04:17:22.944190 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
alter table "airflow"."public"."mart_sensor_analysis__dbt_tmp" rename to "mart_sensor_analysis"
[0m04:17:22.944558 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary" rename to "mart_survey_summary__dbt_backup"
[0m04:17:22.946600 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:17:22.947072 [debug] [Thread-3 (]: Finished running node model.caspian_vault.dim_well
[0m04:17:22.947523 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
alter table "airflow"."public"."mart_well_performance__dbt_tmp" rename to "mart_well_performance"
[0m04:17:22.947887 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.948316 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:17:22.950515 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m04:17:22.950880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:17:22.952898 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:17:22.953268 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.954231 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m04:17:22.954602 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
alter table "airflow"."public"."mart_survey_summary__dbt_tmp" rename to "mart_survey_summary"
[0m04:17:22.954937 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: COMMIT
[0m04:17:22.955285 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:17:22.955716 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: COMMIT
[0m04:17:22.956010 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:17:22.957049 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m04:17:22.957400 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m04:17:22.957704 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:17:22.959342 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."mart_sensor_analysis__dbt_backup"
[0m04:17:22.959671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m04:17:22.959996 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: COMMIT
[0m04:17:22.960471 [debug] [Thread-4 (]: Using postgres connection "model.caspian_vault.mart_sensor_analysis"
[0m04:17:22.962142 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."mart_well_performance__dbt_backup"
[0m04:17:22.962563 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_sensor_analysis"} */
drop table if exists "airflow"."public"."mart_sensor_analysis__dbt_backup" cascade
[0m04:17:22.963064 [debug] [Thread-1 (]: Using postgres connection "model.caspian_vault.mart_well_performance"
[0m04:17:22.963492 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_well_performance"} */
drop table if exists "airflow"."public"."mart_well_performance__dbt_backup" cascade
[0m04:17:22.964097 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m04:17:22.965699 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."mart_survey_summary__dbt_backup"
[0m04:17:22.966009 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:17:22.966473 [debug] [Thread-2 (]: Using postgres connection "model.caspian_vault.mart_survey_summary"
[0m04:17:22.966799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:17:22.967821 [debug] [Thread-4 (]: On model.caspian_vault.mart_sensor_analysis: Close
[0m04:17:22.968183 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "model.caspian_vault.mart_survey_summary"} */
drop table if exists "airflow"."public"."mart_survey_summary__dbt_backup" cascade
[0m04:17:22.969204 [debug] [Thread-1 (]: On model.caspian_vault.mart_well_performance: Close
[0m04:17:22.969792 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ef748980>]}
[0m04:17:22.970324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f63468d0>]}
[0m04:17:22.970825 [info ] [Thread-4 (]: 30 of 33 OK created sql table model public.mart_sensor_analysis ................ [[32mSELECT 3[0m in 0.08s]
[0m04:17:22.971381 [info ] [Thread-1 (]: 32 of 33 OK created sql table model public.mart_well_performance ............... [[32mSELECT 21[0m in 0.08s]
[0m04:17:22.971786 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:17:22.972230 [debug] [Thread-4 (]: Finished running node model.caspian_vault.mart_sensor_analysis
[0m04:17:22.972693 [debug] [Thread-1 (]: Finished running node model.caspian_vault.mart_well_performance
[0m04:17:22.973684 [debug] [Thread-2 (]: On model.caspian_vault.mart_survey_summary: Close
[0m04:17:22.974339 [debug] [Thread-3 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:22.974883 [info ] [Thread-3 (]: 33 of 33 START snapshot snapshots.snap_mart_well_performance ................... [RUN]
[0m04:17:22.975347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203eccff5c0>]}
[0m04:17:22.975721 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.caspian_vault.dim_well, now snapshot.caspian_vault.snap_mart_well_performance)
[0m04:17:22.976237 [info ] [Thread-2 (]: 31 of 33 OK created sql table model public.mart_survey_summary ................. [[32mSELECT 6[0m in 0.09s]
[0m04:17:22.976633 [debug] [Thread-3 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:22.977099 [debug] [Thread-2 (]: Finished running node model.caspian_vault.mart_survey_summary
[0m04:17:22.979559 [debug] [Thread-3 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:23.014455 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.014853 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m04:17:23.015164 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:17:23.018977 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:23.019355 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.019682 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:17:23.024814 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.005 seconds
[0m04:17:23.055300 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.055772 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp041723054591"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m04:17:23.058316 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.002 seconds
[0m04:17:23.061747 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.062107 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp041723054591'
        
      order by ordinal_position

  
[0m04:17:23.064474 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:17:23.066726 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.067072 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:17:23.068887 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m04:17:23.071103 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.071456 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp041723054591'
        
      order by ordinal_position

  
[0m04:17:23.073266 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m04:17:23.075446 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.075794 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:17:23.077556 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.001 seconds
[0m04:17:23.082374 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.082733 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp041723054591'
        
      order by ordinal_position

  
[0m04:17:23.084516 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.001 seconds
[0m04:17:23.097343 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.097784 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m04:17:23.098517 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:17:23.102367 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.102724 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m04:17:23.103265 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:17:23.103702 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.104213 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.104596 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp041723054591" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp041723054591" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m04:17:23.105549 [debug] [Thread-3 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m04:17:23.106524 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:17:23.106846 [debug] [Thread-3 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:23.107133 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:17:23.109544 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m04:17:23.111520 [debug] [Thread-3 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m04:17:23.112046 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '753dee64-fd66-4425-8bdb-0d34555d9d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203eccaba10>]}
[0m04:17:23.112709 [info ] [Thread-3 (]: 33 of 33 OK snapshotted snapshots.snap_mart_well_performance ................... [[32mINSERT 0 21[0m in 0.14s]
[0m04:17:23.113188 [debug] [Thread-3 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:23.114511 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:23.114847 [debug] [MainThread]: On master: BEGIN
[0m04:17:23.115136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:17:23.119167 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:17:23.119535 [debug] [MainThread]: On master: COMMIT
[0m04:17:23.119825 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:23.120107 [debug] [MainThread]: On master: COMMIT
[0m04:17:23.120475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:17:23.120769 [debug] [MainThread]: On master: Close
[0m04:17:23.121148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:17:23.121449 [debug] [MainThread]: Connection 'model.caspian_vault.mart_well_performance' was properly closed.
[0m04:17:23.121707 [debug] [MainThread]: Connection 'model.caspian_vault.mart_survey_summary' was properly closed.
[0m04:17:23.121959 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m04:17:23.122207 [debug] [MainThread]: Connection 'model.caspian_vault.mart_sensor_analysis' was properly closed.
[0m04:17:23.122585 [info ] [MainThread]: 
[0m04:17:23.122903 [info ] [MainThread]: Finished running 1 snapshot, 13 table models, 19 data tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m04:17:23.126498 [debug] [MainThread]: Command end result
[0m04:17:23.152165 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:17:23.153706 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:17:23.159650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m04:17:23.160007 [info ] [MainThread]: 
[0m04:17:23.160368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:17:23.160674 [info ] [MainThread]: 
[0m04:17:23.160979 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m04:17:23.161522 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:17:23.162396 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7557988, "process_in_blocks": "0", "process_kernel_time": 0.369909, "process_mem_max_rss": "135144", "process_out_blocks": "3624", "process_user_time": 2.603439}
[0m04:17:23.162872 [debug] [MainThread]: Command `dbt build` succeeded at 04:17:23.162790 after 1.76 seconds
[0m04:17:23.163216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203f72f5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecdfe060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7203ecd4c050>]}
[0m04:17:23.163582 [debug] [MainThread]: Flushing usage events
[0m04:17:23.691166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:17:25.240146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07ae3481a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07ade017f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07acc57b90>]}


============================== 04:17:25.245071 | ac8a5b02-49a2-49e6-a3f2-1691c46541ae ==============================
[0m04:17:25.245071 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:17:25.245566 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/project/caspian_vault/dbt_profiles', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'target_path': '/opt/airflow/dbt_target', 'log_path': '/opt/airflow/logs/dbt', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt snapshot --profile caspian_vault --target dev', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False'}
[0m04:17:25.291108 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `log-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
logs to a custom directory, please use the --log-path CLI flag or DBT_LOG_PATH
env var instead.
[0m04:17:25.291626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07acaaa270>]}
[0m04:17:25.292100 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m04:17:25.292462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07acaaa270>]}
[0m04:17:25.410694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07aca7b1d0>]}
[0m04:17:25.468365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07ad8121e0>]}
[0m04:17:25.469192 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:17:25.581009 [debug] [MainThread]: checksum: 823572ff9a3901b0d1f781345271440592c4c0ae850bba08a70c8a0706cad0a7, vars: {}, profile: caspian_vault, target: dev, version: 1.10.15
[0m04:17:25.705852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:17:25.706301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:17:25.711442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspian_vault.example
[0m04:17:25.762226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07abd3f530>]}
[0m04:17:25.859871 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:17:25.861529 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:17:25.879487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07abd052e0>]}
[0m04:17:25.879958 [info ] [MainThread]: Found 13 models, 1 snapshot, 19 data tests, 3 sources, 578 macros
[0m04:17:25.880315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07adf1b200>]}
[0m04:17:25.882264 [info ] [MainThread]: 
[0m04:17:25.882635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:17:25.882937 [info ] [MainThread]: 
[0m04:17:25.883433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:17:25.884302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:17:25.916706 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:17:25.917075 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:17:25.917388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:25.922665 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.005 seconds
[0m04:17:25.923701 [debug] [ThreadPool]: On list_airflow: Close
[0m04:17:25.927949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_snapshots)
[0m04:17:25.928488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m04:17:25.932706 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:17:25.934876 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:17:25.935209 [debug] [ThreadPool]: On list_airflow_snapshots: BEGIN
[0m04:17:25.935522 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:17:25.935875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:17:25.936156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:25.939897 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:17:25.940255 [debug] [ThreadPool]: Using postgres connection "list_airflow_snapshots"
[0m04:17:25.940526 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:17:25.940846 [debug] [ThreadPool]: On list_airflow_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_snapshots"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m04:17:25.941154 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:17:25.941535 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:17:25.943408 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m04:17:25.943672 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.002 seconds
[0m04:17:25.944650 [debug] [ThreadPool]: On list_airflow_snapshots: ROLLBACK
[0m04:17:25.946140 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:17:25.946550 [debug] [ThreadPool]: On list_airflow_snapshots: Close
[0m04:17:25.946804 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:17:25.956227 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:25.956591 [debug] [MainThread]: On master: BEGIN
[0m04:17:25.956865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:17:25.960654 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:17:25.960986 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:25.961337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:17:25.983306 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m04:17:25.984597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07a9d57e30>]}
[0m04:17:25.985044 [debug] [MainThread]: On master: ROLLBACK
[0m04:17:25.985473 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:25.985776 [debug] [MainThread]: On master: BEGIN
[0m04:17:25.986202 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:17:25.986531 [debug] [MainThread]: On master: COMMIT
[0m04:17:25.986807 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:25.987071 [debug] [MainThread]: On master: COMMIT
[0m04:17:25.987429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:17:25.987729 [debug] [MainThread]: On master: Close
[0m04:17:25.991160 [debug] [Thread-1 (]: Began running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:25.991639 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_mart_well_performance ..................... [RUN]
[0m04:17:25.992013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now snapshot.caspian_vault.snap_mart_well_performance)
[0m04:17:25.992340 [debug] [Thread-1 (]: Began compiling node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:25.997816 [debug] [Thread-1 (]: Began executing node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:26.035392 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.035790 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: BEGIN
[0m04:17:26.036103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:26.040292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:17:26.040637 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.040963 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:17:26.046161 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m04:17:26.084857 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.085365 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

        
  
    

  create temporary table "snap_mart_well_performance__dbt_tmp041726079389"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m04:17:26.087826 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.002 seconds
[0m04:17:26.090825 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.091182 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp041726079389'
        
      order by ordinal_position

  
[0m04:17:26.093619 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:17:26.095845 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.096195 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:17:26.098075 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m04:17:26.100271 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.100622 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp041726079389'
        
      order by ordinal_position

  
[0m04:17:26.102488 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:17:26.104744 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.105084 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m04:17:26.106922 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m04:17:26.111612 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.111965 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_mart_well_performance__dbt_tmp041726079389'
        
      order by ordinal_position

  
[0m04:17:26.113826 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m04:17:26.126678 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.127110 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        
    
    with snapshot_query as (

        


select
  cast(hk_well as varchar) || '|' || cast(source_format as varchar) as snap_key,
  m.*,
  cast(current_timestamp as timestamp) as load_ts
from "airflow"."public"."mart_well_performance" m


    ),

    snapshotted_data as (

        select *, 
    
        snap_key as dbt_unique_key
    

        from "airflow"."snapshots"."snap_mart_well_performance"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            
  
  coalesce(nullif(load_ts, load_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_key as varchar ), '')
         || '|' || coalesce(cast(load_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_key as dbt_unique_key
    
,
            load_ts as dbt_updated_at,
            load_ts as dbt_valid_from,
            load_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.load_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m04:17:26.127843 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:17:26.131731 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.132082 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m04:17:26.132618 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m04:17:26.133055 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.133592 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.133960 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "caspian_vault", "target_name": "dev", "node_id": "snapshot.caspian_vault.snap_mart_well_performance"} */

      update "airflow"."snapshots"."snap_mart_well_performance"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_mart_well_performance__dbt_tmp041726079389" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "airflow"."snapshots"."snap_mart_well_performance".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "airflow"."snapshots"."snap_mart_well_performance".dbt_valid_to is null;
      


    insert into "airflow"."snapshots"."snap_mart_well_performance" ("snap_key", "hk_well", "source_format", "total_readings", "avg_amplitude", "data_quality_rate", "load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."snap_key",DBT_INTERNAL_SOURCE."hk_well",DBT_INTERNAL_SOURCE."source_format",DBT_INTERNAL_SOURCE."total_readings",DBT_INTERNAL_SOURCE."avg_amplitude",DBT_INTERNAL_SOURCE."data_quality_rate",DBT_INTERNAL_SOURCE."load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snap_mart_well_performance__dbt_tmp041726079389" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m04:17:26.134929 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m04:17:26.145362 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:17:26.145743 [debug] [Thread-1 (]: Using postgres connection "snapshot.caspian_vault.snap_mart_well_performance"
[0m04:17:26.146048 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: COMMIT
[0m04:17:26.156843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m04:17:26.159686 [debug] [Thread-1 (]: On snapshot.caspian_vault.snap_mart_well_performance: Close
[0m04:17:26.161032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8a5b02-49a2-49e6-a3f2-1691c46541ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07af5cf260>]}
[0m04:17:26.161725 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_mart_well_performance ..................... [[32mINSERT 0 21[0m in 0.17s]
[0m04:17:26.162235 [debug] [Thread-1 (]: Finished running node snapshot.caspian_vault.snap_mart_well_performance
[0m04:17:26.163518 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:26.163857 [debug] [MainThread]: On master: BEGIN
[0m04:17:26.164141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:17:26.168207 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:17:26.168565 [debug] [MainThread]: On master: COMMIT
[0m04:17:26.168862 [debug] [MainThread]: Using postgres connection "master"
[0m04:17:26.169137 [debug] [MainThread]: On master: COMMIT
[0m04:17:26.169534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:17:26.169829 [debug] [MainThread]: On master: Close
[0m04:17:26.170211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:17:26.170504 [debug] [MainThread]: Connection 'list_airflow_snapshots' was properly closed.
[0m04:17:26.170754 [debug] [MainThread]: Connection 'snapshot.caspian_vault.snap_mart_well_performance' was properly closed.
[0m04:17:26.171033 [info ] [MainThread]: 
[0m04:17:26.171343 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m04:17:26.171914 [debug] [MainThread]: Command end result
[0m04:17:26.243831 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_target/manifest.json
[0m04:17:26.245446 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_target/semantic_manifest.json
[0m04:17:26.250327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_target/run_results.json
[0m04:17:26.250669 [info ] [MainThread]: 
[0m04:17:26.251050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:17:26.251354 [info ] [MainThread]: 
[0m04:17:26.251656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:17:26.252142 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigLogPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:17:26.253026 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0550694, "process_in_blocks": "0", "process_kernel_time": 0.295222, "process_mem_max_rss": "128544", "process_out_blocks": "2760", "process_user_time": 1.995747}
[0m04:17:26.253498 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:17:26.253416 after 1.06 seconds
[0m04:17:26.253849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07ae295880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07a9bc6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07a9bc78f0>]}
[0m04:17:26.254186 [debug] [MainThread]: Flushing usage events
[0m04:17:26.677801 [debug] [MainThread]: An error was encountered while trying to flush usage events
